<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æ·±å…¥ç†è§£Javaæ³¨è§£</title>
      <link href="/posts/Annotation.html"/>
      <url>/posts/Annotation.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ³¨è§£åŸºç¡€"><a href="#æ³¨è§£åŸºç¡€" class="headerlink" title="æ³¨è§£åŸºç¡€"></a>æ³¨è§£åŸºç¡€</h2><p>æ³¨è§£æ˜¯JDK1.5ç‰ˆæœ¬å¼€å§‹å¼•å…¥çš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äºå¯¹ä»£ç è¿›è¡Œè¯´æ˜ï¼Œå¯ä»¥å¯¹åŒ…ã€ç±»ã€æ¥å£ã€å­—æ®µã€æ–¹æ³•å‚æ•°ã€å±€éƒ¨å˜é‡ç­‰è¿›è¡Œæ³¨è§£ã€‚å®ƒä¸»è¦çš„ä½œç”¨æœ‰ä»¥ä¸‹å››æ–¹é¢ï¼š</p><ul><li>ç”Ÿæˆæ–‡æ¡£ï¼Œé€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®ç”Ÿæˆjavadocæ–‡æ¡£ã€‚</li><li>ç¼–è¯‘æ£€æŸ¥ï¼Œé€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®è®©ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´è¿›è¡Œæ£€æŸ¥éªŒè¯ã€‚</li><li>ç¼–è¯‘æ—¶åŠ¨æ€å¤„ç†ï¼Œç¼–è¯‘æ—¶é€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®åŠ¨æ€å¤„ç†ï¼Œä¾‹å¦‚åŠ¨æ€ç”Ÿæˆä»£ç ã€‚</li><li>è¿è¡Œæ—¶åŠ¨æ€å¤„ç†ï¼Œè¿è¡Œæ—¶é€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„å…ƒæ•°æ®åŠ¨æ€å¤„ç†ï¼Œä¾‹å¦‚ä½¿ç”¨åå°„æ³¨å…¥å®ä¾‹ã€‚</li></ul><p>è¿™ä¹ˆæ¥è¯´æ˜¯æ¯”è¾ƒæŠ½è±¡çš„ï¼Œæˆ‘ä»¬å…·ä½“çœ‹ä¸‹æ³¨è§£çš„å¸¸è§åˆ†ç±»ï¼š</p><ul><li><strong>Javaè‡ªå¸¦çš„æ ‡å‡†æ³¨è§£</strong>ï¼ŒåŒ…æ‹¬<code>@Override</code>ã€<code>@Deprecated</code>å’Œ<code>@SuppressWarnings</code>ï¼Œåˆ†åˆ«ç”¨äºæ ‡æ˜é‡å†™æŸä¸ªæ–¹æ³•ã€æ ‡æ˜æŸä¸ªç±»æˆ–æ–¹æ³•è¿‡æ—¶ã€æ ‡æ˜è¦å¿½ç•¥çš„è­¦å‘Šï¼Œç”¨è¿™äº›æ³¨è§£æ ‡æ˜åç¼–è¯‘å™¨å°±ä¼šè¿›è¡Œæ£€æŸ¥ã€‚</li><li><strong>å…ƒæ³¨è§£</strong>ï¼Œå…ƒæ³¨è§£æ˜¯ç”¨äºå®šä¹‰æ³¨è§£çš„æ³¨è§£ï¼ŒåŒ…æ‹¬<code>@Retention</code>ã€<code>@Target</code>ã€<code>@Inherited</code>ã€<code>@Documented</code>ï¼Œ<code>@Retention</code>ç”¨äºæ ‡æ˜æ³¨è§£è¢«ä¿ç•™çš„é˜¶æ®µï¼Œ<code>@Target</code>ç”¨äºæ ‡æ˜æ³¨è§£ä½¿ç”¨çš„èŒƒå›´ï¼Œ<code>@Inherited</code>ç”¨äºæ ‡æ˜æ³¨è§£å¯ç»§æ‰¿ï¼Œ<code>@Documented</code>ç”¨äºæ ‡æ˜æ˜¯å¦ç”Ÿæˆjavadocæ–‡æ¡£ã€‚</li><li><strong>è‡ªå®šä¹‰æ³¨è§£</strong>ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å®šä¹‰æ³¨è§£ï¼Œå¹¶å¯ç”¨å…ƒæ³¨è§£å¯¹è‡ªå®šä¹‰æ³¨è§£è¿›è¡Œæ³¨è§£ã€‚</li></ul><h3 id="æ³¨è§£çš„å½¢å¼"><a href="#æ³¨è§£çš„å½¢å¼" class="headerlink" title="æ³¨è§£çš„å½¢å¼"></a>æ³¨è§£çš„å½¢å¼</h3><p>Java ä¸­ï¼Œæ³¨è§£æ˜¯ä»¥ <code>@</code> å­—ç¬¦å¼€å§‹çš„ä¿®é¥°ç¬¦ã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">mySuperMethod</span><span class="params">()</span> &#123; ... &#125;</span><br></pre></td></tr></table></figure><p>æ³¨è§£å¯ä»¥åŒ…å«å‘½åæˆ–æœªå‘½åçš„å±æ€§ï¼Œå¹¶ä¸”è¿™äº›å±æ€§æœ‰å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Author(</span></span><br><span class="line"><span class="meta">   name = &quot;Benjamin Franklin&quot;,</span></span><br><span class="line"><span class="meta">   date = &quot;3/27/2003&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>() &#123; ... &#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœåªæœ‰ä¸€ä¸ªåä¸º value çš„å±æ€§ï¼Œé‚£ä¹ˆåç§°å¯ä»¥çœç•¥ï¼Œå¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">myMethod</span><span class="params">()</span> &#123; ... &#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæ³¨è§£æ²¡æœ‰å±æ€§ï¼Œåˆ™ç§°ä¸º<code>æ ‡è®°æ³¨è§£</code>ã€‚å¦‚ï¼š<code>@Override</code>ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯æ³¨è§£"><a href="#ä»€ä¹ˆæ˜¯æ³¨è§£" class="headerlink" title="ä»€ä¹ˆæ˜¯æ³¨è§£"></a>ä»€ä¹ˆæ˜¯æ³¨è§£</h3><p>ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œ<strong>æ³¨è§£æ˜¯ä¸€ç§æ ‡ç­¾ï¼Œå…¶å®è´¨ä¸Šå¯ä»¥è§†ä¸ºä¸€ç§ç‰¹æ®Šçš„æ³¨é‡Šï¼Œå¦‚æœæ²¡æœ‰è§£æå®ƒçš„ä»£ç ï¼Œå®ƒå¹¶ä¸æ¯”æ™®é€šæ³¨é‡Šå¼ºã€‚</strong></p><p>è§£æä¸€ä¸ªæ³¨è§£å¾€å¾€æœ‰ä¸¤ç§å½¢å¼ï¼š</p><ul><li><strong>ç¼–è¯‘æœŸç›´æ¥çš„æ‰«æ</strong> - ç¼–è¯‘å™¨çš„æ‰«ææŒ‡çš„æ˜¯ç¼–è¯‘å™¨åœ¨å¯¹ java ä»£ç ç¼–è¯‘å­—èŠ‚ç çš„è¿‡ç¨‹ä¸­ä¼šæ£€æµ‹åˆ°æŸä¸ªç±»æˆ–è€…æ–¹æ³•è¢«ä¸€äº›æ³¨è§£ä¿®é¥°ï¼Œè¿™æ—¶å®ƒå°±ä¼šå¯¹äºè¿™äº›æ³¨è§£è¿›è¡ŒæŸäº›å¤„ç†ã€‚è¿™ç§æƒ…å†µåªé€‚ç”¨äº JDK å†…ç½®çš„æ³¨è§£ç±»ã€‚</li><li><strong>è¿è¡ŒæœŸçš„åå°„</strong> - å¦‚æœè¦è‡ªå®šä¹‰æ³¨è§£ï¼ŒJava ç¼–è¯‘å™¨æ— æ³•è¯†åˆ«å¹¶å¤„ç†è¿™ä¸ªæ³¨è§£ï¼Œå®ƒåªèƒ½æ ¹æ®è¯¥æ³¨è§£çš„ä½œç”¨èŒƒå›´æ¥é€‰æ‹©æ˜¯å¦ç¼–è¯‘è¿›å­—èŠ‚ç æ–‡ä»¶ã€‚å¦‚æœè¦å¤„ç†æ³¨è§£ï¼Œå¿…é¡»åˆ©ç”¨åå°„æŠ€æœ¯ï¼Œè¯†åˆ«è¯¥æ³¨è§£ä»¥åŠå®ƒæ‰€æºå¸¦çš„ä¿¡æ¯ï¼Œç„¶ååšç›¸åº”çš„å¤„ç†ã€‚</li></ul><h3 id="æ³¨è§£çš„ä½œç”¨"><a href="#æ³¨è§£çš„ä½œç”¨" class="headerlink" title="æ³¨è§£çš„ä½œç”¨"></a>æ³¨è§£çš„ä½œç”¨</h3><p>æ³¨è§£æœ‰è®¸å¤šç”¨é€”ï¼š</p><ul><li>ç¼–è¯‘å™¨ä¿¡æ¯ - ç¼–è¯‘å™¨å¯ä»¥ä½¿ç”¨æ³¨è§£æ¥æ£€æµ‹é”™è¯¯æˆ–æŠ‘åˆ¶è­¦å‘Šã€‚</li><li>ç¼–è¯‘æ—¶å’Œéƒ¨ç½²æ—¶çš„å¤„ç† - ç¨‹åºå¯ä»¥å¤„ç†æ³¨è§£ä¿¡æ¯ä»¥ç”Ÿæˆä»£ç ï¼ŒXML æ–‡ä»¶ç­‰ã€‚</li><li>è¿è¡Œæ—¶å¤„ç† - å¯ä»¥åœ¨è¿è¡Œæ—¶æ£€æŸ¥æŸäº›æ³¨è§£å¹¶å¤„ç†ã€‚</li></ul><p>ä½œä¸º Java ç¨‹åºå‘˜ï¼Œå¤šå¤šå°‘å°‘éƒ½æ›¾ç»å†è¿‡è¢«å„ç§é…ç½®æ–‡ä»¶ï¼ˆxmlã€propertiesï¼‰æ”¯é…çš„ææƒ§ã€‚è¿‡å¤šçš„é…ç½®æ–‡ä»¶ä¼šä½¿å¾—é¡¹ç›®éš¾ä»¥ç»´æŠ¤ã€‚ä¸ªäººè®¤ä¸ºï¼Œä½¿ç”¨æ³¨è§£ä»¥å‡å°‘é…ç½®æ–‡ä»¶æˆ–ä»£ç ï¼Œæ˜¯æ³¨è§£æœ€å¤§çš„ç”¨å¤„ã€‚</p><h3 id="æ³¨è§£çš„ä»£ä»·"><a href="#æ³¨è§£çš„ä»£ä»·" class="headerlink" title="æ³¨è§£çš„ä»£ä»·"></a>æ³¨è§£çš„ä»£ä»·</h3><p>å‡¡äº‹æœ‰å¾—å¿…æœ‰å¤±ï¼Œæ³¨è§£æŠ€æœ¯åŒæ ·å¦‚æ­¤ã€‚ä½¿ç”¨æ³¨è§£ä¹Ÿæœ‰ä¸€å®šçš„ä»£ä»·ï¼š</p><ul><li>æ˜¾ç„¶ï¼Œå®ƒæ˜¯ä¸€ç§ä¾µå…¥å¼ç¼–ç¨‹ï¼Œé‚£ä¹ˆï¼Œè‡ªç„¶å°±å­˜åœ¨ç€å¢åŠ ç¨‹åºè€¦åˆåº¦çš„é—®é¢˜ã€‚</li><li>è‡ªå®šä¹‰æ³¨è§£çš„å¤„ç†éœ€è¦åœ¨è¿è¡Œæ—¶ï¼Œé€šè¿‡åå°„æŠ€æœ¯æ¥è·å–å±æ€§ã€‚å¦‚æœæ³¨è§£æ‰€ä¿®é¥°çš„å…ƒç´ æ˜¯ç±»çš„é public æˆå‘˜ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åå°„è·å–ã€‚è¿™å°±è¿èƒŒäº†é¢å‘å¯¹è±¡çš„å°è£…æ€§ã€‚</li><li>æ³¨è§£æ‰€äº§ç”Ÿçš„é—®é¢˜ï¼Œç›¸å¯¹è€Œè¨€ï¼Œæ›´éš¾ä»¥ debug æˆ–å®šä½ã€‚</li></ul><p>ä½†æ˜¯ï¼Œæ­£æ‰€è°“ç‘•ä¸æ©ç‘œï¼Œæ³¨è§£æ‰€ä»˜å‡ºçš„ä»£ä»·ï¼Œç›¸è¾ƒäºå®ƒæä¾›çš„åŠŸèƒ½è€Œè¨€ï¼Œè¿˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p><h3 id="æ³¨è§£çš„åº”ç”¨èŒƒå›´"><a href="#æ³¨è§£çš„åº”ç”¨èŒƒå›´" class="headerlink" title="æ³¨è§£çš„åº”ç”¨èŒƒå›´"></a>æ³¨è§£çš„åº”ç”¨èŒƒå›´</h3><p>æ³¨è§£å¯ä»¥åº”ç”¨äºç±»ã€å­—æ®µã€æ–¹æ³•å’Œå…¶ä»–ç¨‹åºå…ƒç´ çš„å£°æ˜ã€‚</p><p>JDK8 å¼€å§‹ï¼Œæ³¨è§£çš„åº”ç”¨èŒƒå›´è¿›ä¸€æ­¥æ‰©å¤§ï¼Œä»¥ä¸‹æ˜¯æ–°çš„åº”ç”¨èŒƒå›´ï¼š</p><p>ç±»å®ä¾‹åˆå§‹åŒ–è¡¨è¾¾å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="meta">@Interned</span> MyObject();</span><br></pre></td></tr></table></figure><p>ç±»å‹è½¬æ¢ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myString = (<span class="meta">@NonNull</span> String) str;</span><br></pre></td></tr></table></figure><p>å®ç°æ¥å£çš„å£°æ˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UnmodifiableList</span>&lt;T&gt; implements</span><br><span class="line">    <span class="meta">@Readonly</span> List&lt;<span class="meta">@Readonly</span> T&gt; &#123;&#125;</span><br></pre></td></tr></table></figure><p>æŠ›å‡ºå¼‚å¸¸å£°æ˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">monitorTemperature</span><span class="params">()</span></span><br><span class="line">    <span class="keyword">throws</span> <span class="meta">@Critical</span> TemperatureException &#123;&#125;</span><br></pre></td></tr></table></figure><h2 id="Javaå†…ç½®æ³¨è§£"><a href="#Javaå†…ç½®æ³¨è§£" class="headerlink" title="Javaå†…ç½®æ³¨è§£"></a>Javaå†…ç½®æ³¨è§£</h2><p>Java 1.5å¼€å§‹è‡ªå¸¦çš„æ ‡å‡†æ³¨è§£ï¼ŒåŒ…æ‹¬<code>@Override</code>ã€<code>@Deprecated</code>ã€<code>@SuppressWarnings</code>ã€<code>@SafeVarargs</code>ï¼ˆJDK7 å¼•å…¥ï¼‰å’Œ<code>@FunctionalInterface</code>ï¼ˆJDK8 å¼•å…¥ï¼‰ï¼š</p><ul><li><code>@Override</code>ï¼šè¡¨ç¤ºå½“å‰çš„æ–¹æ³•å®šä¹‰å°†è¦†ç›–çˆ¶ç±»ä¸­çš„æ–¹æ³•</li><li><code>@Deprecated</code>ï¼šè¡¨ç¤ºä»£ç è¢«å¼ƒç”¨ï¼Œå¦‚æœä½¿ç”¨äº†è¢«@Deprecatedæ³¨è§£çš„ä»£ç åˆ™ç¼–è¯‘å™¨å°†å‘å‡ºè­¦å‘Š</li><li><code>@SuppressWarnings</code>ï¼šè¡¨ç¤ºå…³é—­ç¼–è¯‘å™¨è­¦å‘Šä¿¡æ¯</li><li><code>@SafeVarargs</code>ï¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œåœ¨å¯å˜é•¿å‚æ•°ä¸­çš„æ³›å‹æ˜¯ç±»å‹å®‰å…¨çš„ã€‚å¯å˜é•¿å‚æ•°æ˜¯ä½¿ç”¨æ•°ç»„å­˜å‚¨çš„ï¼Œè€Œæ•°ç»„å’Œæ³›å‹ä¸èƒ½å¾ˆå¥½çš„æ··åˆä½¿ç”¨</li><li><code>@FunctionalInterface</code>ï¼šç”¨äºæŒ‡ç¤ºè¢«ä¿®é¥°çš„æ¥å£æ˜¯å‡½æ•°å¼æ¥å£</li></ul><p>æˆ‘ä»¬å†å…·ä½“çœ‹ä¸‹è¿™å‡ ä¸ªå†…ç½®æ³¨è§£ï¼ŒåŒæ—¶é€šè¿‡è¿™å‡ ä¸ªå†…ç½®æ³¨è§£ä¸­çš„å…ƒæ³¨è§£çš„å®šä¹‰æ¥å¼•å‡ºå…ƒæ³¨è§£ã€‚</p><h3 id="Override"><a href="#Override" class="headerlink" title="@Override"></a>@Override</h3><p><strong><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Override.html"><code>@Override</code></a>ç”¨äºè¡¨æ˜è¢«ä¿®é¥°æ–¹æ³•è¦†å†™äº†çˆ¶ç±»çš„æ–¹æ³•ã€‚</strong></p><p>å¦‚æœè¯•å›¾ä½¿ç”¨ <code>@Override</code> æ ‡è®°ä¸€ä¸ªå®é™…ä¸Šå¹¶æ²¡æœ‰è¦†å†™çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œjava ç¼–è¯‘å™¨ä¼šå‘Šè­¦ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ³¨è§£ç±»å‹çš„å®šä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.SOURCE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Override &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»å®ƒçš„å®šä¹‰æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ³¨è§£å¯ä»¥è¢«ç”¨æ¥ä¿®é¥°æ–¹æ³•ï¼Œå¹¶ä¸”å®ƒåªåœ¨ç¼–è¯‘æ—¶æœ‰æ•ˆï¼Œåœ¨ç¼–è¯‘åçš„classæ–‡ä»¶ä¸­ä¾¿ä¸å†å­˜åœ¨ã€‚è¿™ä¸ªæ³¨è§£çš„ä½œç”¨æˆ‘ä»¬å¤§å®¶éƒ½ä¸é™Œç”Ÿï¼Œé‚£å°±æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨è¢«ä¿®é¥°çš„æ–¹æ³•æ˜¯é‡å†™çš„çˆ¶ç±»çš„ä¸­çš„ç›¸åŒç­¾åçš„æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šå¯¹æ­¤åšå‡ºæ£€æŸ¥ï¼Œè‹¥å‘ç°çˆ¶ç±»ä¸­ä¸å­˜åœ¨è¿™ä¸ªæ–¹æ³•æˆ–æ˜¯å­˜åœ¨çš„æ–¹æ³•ç­¾åä¸åŒï¼Œåˆ™ä¼šæŠ¥é”™ã€‚</p><p><code>@Override</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OverrideAnnotationDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;getName&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Man</span> <span class="keyword">extends</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;override getName&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *  æ”¾å¼€ä¸‹é¢çš„æ³¨é‡Šï¼Œç¼–è¯‘æ—¶ä¼šå‘Šè­¦</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">       <span class="comment">/*</span></span><br><span class="line"><span class="comment">        @Override</span></span><br><span class="line"><span class="comment">        public String getName2() &#123;</span></span><br><span class="line"><span class="comment">            return &quot;override getName2&quot;;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Person</span> <span class="variable">per</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Man</span>();</span><br><span class="line">        System.out.println(per.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Deprecated"><a href="#Deprecated" class="headerlink" title="@Deprecated"></a>@Deprecated</h3><p><strong><code>@Deprecated</code> ç”¨äºæ ‡æ˜è¢«ä¿®é¥°çš„ç±»æˆ–ç±»æˆå‘˜ã€ç±»æ–¹æ³•å·²ç»åºŸå¼ƒã€è¿‡æ—¶ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚</strong></p><p><code>@Deprecated</code> æœ‰ä¸€å®šçš„<strong>å»¶ç»­æ€§</strong>ï¼šå¦‚æœæˆ‘ä»¬åœ¨ä»£ç ä¸­é€šè¿‡ç»§æ‰¿æˆ–è€…è¦†ç›–çš„æ–¹å¼ä½¿ç”¨äº†è¿‡æ—¶çš„ç±»æˆ–ç±»æˆå‘˜ï¼Œå³ä½¿å­ç±»æˆ–å­æ–¹æ³•æ²¡æœ‰æ ‡è®°ä¸º <code>@Deprecated</code>ï¼Œä½†ç¼–è¯‘å™¨ä»ç„¶ä¼šå‘Šè­¦ã€‚</p><blockquote><p>ğŸ”” æ³¨æ„ï¼š <code>@Deprecated</code> è¿™ä¸ªæ³¨è§£ç±»å‹å’Œ javadoc ä¸­çš„ <code>@deprecated</code> è¿™ä¸ª tag æ˜¯æœ‰åŒºåˆ«çš„ï¼šå‰è€…æ˜¯ java ç¼–è¯‘å™¨è¯†åˆ«çš„ï¼›è€Œåè€…æ˜¯è¢« javadoc å·¥å…·æ‰€è¯†åˆ«ç”¨æ¥ç”Ÿæˆæ–‡æ¡£ï¼ˆåŒ…å«ç¨‹åºæˆå‘˜ä¸ºä»€ä¹ˆå·²ç»è¿‡æ—¶ã€å®ƒåº”å½“å¦‚ä½•è¢«ç¦æ­¢æˆ–è€…æ›¿ä»£çš„æè¿°ï¼‰ã€‚</p></blockquote><p>è¿™ä¸ªæ³¨è§£çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(value=&#123;CONSTRUCTOR, FIELD, LOCAL_VARIABLE, METHOD, PACKAGE, PARAMETER, TYPE&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Deprecated &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»å®ƒçš„å®šä¹‰æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå®ƒä¼šè¢«æ–‡æ¡£åŒ–ï¼Œèƒ½å¤Ÿä¿ç•™åˆ°è¿è¡Œæ—¶ï¼Œèƒ½å¤Ÿä¿®é¥°æ„é€ æ–¹æ³•ã€å±æ€§ã€å±€éƒ¨å˜é‡ã€æ–¹æ³•ã€åŒ…ã€å‚æ•°ã€ç±»å‹ã€‚è¿™ä¸ªæ³¨è§£çš„ä½œç”¨æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨è¢«ä¿®é¥°çš„ç¨‹åºå…ƒç´ å·²è¢«â€œåºŸå¼ƒâ€ï¼Œä¸å†å»ºè®®ç”¨æˆ·ä½¿ç”¨ã€‚</p><p><code>@Deprecated</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeprecatedAnnotationDemo</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DeprecatedField</span> &#123;</span><br><span class="line">        <span class="meta">@Deprecated</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEPRECATED_FIELD</span> <span class="operator">=</span> <span class="string">&quot;DeprecatedField&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DeprecatedMethod</span> &#123;</span><br><span class="line">        <span class="meta">@Deprecated</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;DeprecatedMethod&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DeprecatedClass</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;DeprecatedClass&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(DeprecatedField.DEPRECATED_FIELD);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeprecatedMethod</span> <span class="variable">dm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DeprecatedMethod</span>();</span><br><span class="line">        System.out.println(dm.print());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">DeprecatedClass</span> <span class="variable">dc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DeprecatedClass</span>();</span><br><span class="line">        System.out.println(dc.print());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Output:</span></span><br><span class="line"><span class="comment">//DeprecatedField</span></span><br><span class="line"><span class="comment">//DeprecatedMethod</span></span><br><span class="line"><span class="comment">//DeprecatedClass</span></span><br></pre></td></tr></table></figure><h3 id="SuppressWarnnings"><a href="#SuppressWarnnings" class="headerlink" title="@SuppressWarnnings"></a>@SuppressWarnnings</h3><p><strong><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/SuppressWarnings.html"><code>@SuppressWarnings</code></a>ç”¨äºå…³é—­å¯¹ç±»ã€æ–¹æ³•ã€æˆå‘˜ç¼–è¯‘æ—¶äº§ç”Ÿçš„ç‰¹å®šè­¦å‘Šã€‚</strong></p><p><code>@SuppressWarning</code> ä¸æ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ã€‚å®ƒæœ‰ä¸€ä¸ªç±»å‹ä¸º <code>String[]</code> çš„æ•°ç»„æˆå‘˜ï¼Œè¿™ä¸ªæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯è¦å…³é—­çš„å‘Šè­¦ç±»å‹ã€‚å¯¹äº javac ç¼–è¯‘å™¨æ¥è®²ï¼Œå¯¹ <code>-Xlint</code> é€‰é¡¹æœ‰æ•ˆçš„è­¦å‘Šåä¹ŸåŒæ ·å¯¹ <code>@SuppressWarings</code> æœ‰æ•ˆï¼ŒåŒæ—¶ç¼–è¯‘å™¨ä¼šå¿½ç•¥æ‰æ— æ³•è¯†åˆ«çš„è­¦å‘Šåã€‚</p><p>è¿™ä¸ªæ³¨è§£æˆ‘ä»¬ä¹Ÿæ¯”è¾ƒå¸¸ç”¨åˆ°ï¼Œå…ˆæ¥çœ‹ä¸‹å®ƒçš„å®šä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.SOURCE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SuppressWarnings &#123;</span><br><span class="line">    String[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒèƒ½å¤Ÿä¿®é¥°çš„ç¨‹åºå…ƒç´ åŒ…æ‹¬ç±»å‹ã€å±æ€§ã€æ–¹æ³•ã€å‚æ•°ã€æ„é€ å™¨ã€å±€éƒ¨å˜é‡ï¼Œåªèƒ½å­˜æ´»åœ¨æºç æ—¶ï¼Œå–å€¼ä¸ºString[]ã€‚å®ƒçš„ä½œç”¨æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨å¿½ç•¥æŒ‡å®šçš„è­¦å‘Šä¿¡æ¯ï¼Œå®ƒå¯ä»¥å–çš„å€¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>ä½œç”¨</th><th>åŸæè¿°</th></tr></thead><tbody><tr><td>all</td><td>æŠ‘åˆ¶æ‰€æœ‰è­¦å‘Š</td><td>to suppress all warnings</td></tr><tr><td>boxing</td><td>æŠ‘åˆ¶è£…ç®±ã€æ‹†ç®±æ“ä½œæ—¶å€™çš„è­¦å‘Š</td><td>to suppress warnings relative to boxing/unboxing operations</td></tr><tr><td>cast</td><td>æŠ‘åˆ¶æ˜ å°„ç›¸å…³çš„è­¦å‘Š</td><td>to suppress warnings relative to cast operations</td></tr><tr><td>dep-ann</td><td>æŠ‘åˆ¶å¯ç”¨æ³¨é‡Šçš„è­¦å‘Š</td><td>to suppress warnings relative to deprecated annotation</td></tr><tr><td>deprecation</td><td>ä½¿ç”¨äº†ä¸èµæˆä½¿ç”¨çš„ç±»æˆ–æ–¹æ³•æ—¶çš„è­¦å‘Š</td><td>to suppress warnings relative to deprecation</td></tr><tr><td>fallthrough</td><td>å½“ Switch ç¨‹åºå—ç›´æ¥é€šå¾€ä¸‹ä¸€ç§æƒ…å†µè€Œæ²¡æœ‰ Break æ—¶çš„è­¦å‘Š</td><td>to suppress warnings relative to missing breaks in switch statements</td></tr><tr><td>finally</td><td>ä»»ä½• finally å­å¥ä¸èƒ½æ­£å¸¸å®Œæˆæ—¶çš„è­¦å‘Š</td><td>to suppress warnings relative to finally block that donâ€™t return</td></tr><tr><td>hiding</td><td>æŠ‘åˆ¶ä¸éšè—å˜æ•°çš„åŒºåŸŸå˜æ•°ç›¸å…³çš„è­¦å‘Š</td><td>to suppress warnings relative to locals that hide variableï¼ˆï¼‰</td></tr><tr><td>incomplete-switch</td><td>å¿½ç•¥æ²¡æœ‰å®Œæ•´çš„switchè¯­å¥</td><td>to suppress warnings relative to missing entries in a switch statement (enum case)</td></tr><tr><td>nls</td><td>å¿½ç•¥énlsæ ¼å¼çš„å­—ç¬¦</td><td>to suppress warnings relative to non-nls string literals</td></tr><tr><td>null</td><td>å¿½ç•¥å¯¹nullçš„æ“ä½œ</td><td>to suppress warnings relative to null analysis</td></tr><tr><td>rawtype</td><td>ä½¿ç”¨genericsæ—¶å¿½ç•¥æ²¡æœ‰æŒ‡å®šç›¸åº”çš„ç±»å‹</td><td>to suppress warnings relative to un-specific types when using</td></tr><tr><td>restriction</td><td>æŠ‘åˆ¶ä¸ä½¿ç”¨ä¸å»ºè®®æˆ–ç¦æ­¢å‚ç…§ç›¸å…³çš„è­¦å‘Š</td><td>to suppress warnings relative to usage of discouraged or</td></tr><tr><td>serial</td><td>å½“åœ¨å¯åºåˆ—åŒ–çš„ç±»ä¸Šç¼ºå°‘ serialVersionUID å®šä¹‰æ—¶çš„è­¦å‘Š</td><td>to suppress warnings relative to missing serialVersionUID field for a serializable class</td></tr><tr><td>static-access</td><td>æŠ‘åˆ¶ä¸æ­£ç¡®çš„é™æ€è®¿é—®æ–¹å¼è­¦å‘Š</td><td>to suppress warnings relative to incorrect static access</td></tr><tr><td>synthetic-access</td><td>æŠ‘åˆ¶å­ç±»æ²¡æœ‰æŒ‰æœ€ä¼˜æ–¹æ³•è®¿é—®å†…éƒ¨ç±»çš„è­¦å‘Š</td><td>to suppress warnings relative to unoptimized access from inner classes</td></tr><tr><td>unchecked</td><td>æ‰§è¡Œäº†æœªæ£€æŸ¥çš„è½¬æ¢æ—¶çš„è­¦å‘Šï¼Œä¾‹å¦‚å½“ä½¿ç”¨é›†åˆæ—¶æ²¡æœ‰ç”¨æ³›å‹ (Generics) æ¥æŒ‡å®šé›†åˆä¿å­˜çš„ç±»å‹</td><td>to suppress warnings relative to unchecked operations</td></tr><tr><td>unqualified-field-access</td><td>æŠ‘åˆ¶æ²¡æœ‰æƒé™è®¿é—®çš„åŸŸçš„è­¦å‘Š</td><td>to suppress warnings relative to field access unqualified</td></tr><tr><td>unused</td><td>æŠ‘åˆ¶æ²¡è¢«ä½¿ç”¨è¿‡çš„ä»£ç çš„è­¦å‘Š</td><td>to suppress warnings relative to unused code</td></tr></tbody></table></div><p><code>@SuppressWarning</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;, &quot;unchecked&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SuppressWarningsAnnotationDemo</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SuppressDemo</span>&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> T value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> T <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(T <span class="keyword">var</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.value = <span class="keyword">var</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;deprecation&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SuppressDemo</span> <span class="variable">d</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SuppressDemo</span>();</span><br><span class="line">        d.setValue(<span class="string">&quot;å—äº¬&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åœ°åï¼š&quot;</span> + d.getValue());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;uncheck&quot;, &quot;deprecation&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InternalAnnotationDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@SuppressWarnings</span> æ ‡è®°æ¶ˆé™¤å½“å‰ç±»çš„å‘Šè­¦ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;deprecation&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method1</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;call method1&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@Deprecated</span> æ ‡è®°å½“å‰æ–¹æ³•ä¸ºåºŸå¼ƒæ–¹æ³•ï¼Œä¸å»ºè®®ä½¿ç”¨</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="meta">@Deprecated</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method2</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;call method2&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Deprecated</span> æ ‡è®°å½“å‰ç±»ä¸ºåºŸå¼ƒç±»ï¼Œä¸å»ºè®®ä½¿ç”¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_">A</span> &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@Override</span> æ ‡è®°æ˜¾ç¤ºæŒ‡æ˜å½“å‰æ–¹æ³•è¦†å†™äº†çˆ¶ç±»æˆ–æ¥å£çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method1</span><span class="params">()</span> &#123; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">A</span> <span class="variable">obj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">B</span>();</span><br><span class="line">        obj.method1();</span><br><span class="line">        obj.method2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="SafeVarargs"><a href="#SafeVarargs" class="headerlink" title="@SafeVarargs"></a>@SafeVarargs</h3><p><code>@SafeVarargs</code> åœ¨ JDK7 ä¸­å¼•å…¥ã€‚</p><p><strong><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/SafeVarargs.html"><code>@SafeVarargs</code></a>çš„ä½œç”¨æ˜¯ï¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œåœ¨å¯å˜é•¿å‚æ•°ä¸­çš„æ³›å‹æ˜¯ç±»å‹å®‰å…¨çš„ã€‚å¯å˜é•¿å‚æ•°æ˜¯ä½¿ç”¨æ•°ç»„å­˜å‚¨çš„ï¼Œè€Œæ•°ç»„å’Œæ³›å‹ä¸èƒ½å¾ˆå¥½çš„æ··åˆä½¿ç”¨ã€‚</strong></p><p>ç®€å•çš„è¯´ï¼Œæ•°ç»„å…ƒç´ çš„æ•°æ®ç±»å‹åœ¨ç¼–è¯‘å’Œè¿è¡Œæ—¶éƒ½æ˜¯ç¡®å®šçš„ï¼Œè€Œæ³›å‹çš„æ•°æ®ç±»å‹åªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šä¸‹æ¥ã€‚å› æ­¤ï¼Œå½“æŠŠä¸€ä¸ªæ³›å‹å­˜å‚¨åˆ°æ•°ç»„ä¸­æ—¶ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µæ— æ³•ç¡®è®¤æ•°æ®ç±»å‹æ˜¯å¦åŒ¹é…ï¼Œå› æ­¤ä¼šç»™å‡ºè­¦å‘Šä¿¡æ¯ï¼›å³å¦‚æœæ³›å‹çš„çœŸå®æ•°æ®ç±»å‹æ— æ³•å’Œå‚æ•°æ•°ç»„çš„ç±»å‹åŒ¹é…ï¼Œä¼šå¯¼è‡´ <code>ClassCastException</code> å¼‚å¸¸ã€‚</p><p><code>@SafeVarargs</code> æ³¨è§£ä½¿ç”¨èŒƒå›´ï¼š</p><ul><li><code>@SafeVarargs</code> æ³¨è§£å¯ä»¥ç”¨äºæ„é€ æ–¹æ³•ã€‚</li><li><code>@SafeVarargs</code> æ³¨è§£å¯ä»¥ç”¨äº <code>static</code> æˆ– <code>final</code> æ–¹æ³•ã€‚</li></ul><p><code>@SafeVarargs</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SafeVarargsAnnotationDemo</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ­¤æ–¹æ³•å®é™…ä¸Šå¹¶ä¸å®‰å…¨ï¼Œä¸ä½¿ç”¨æ­¤æ³¨è§£ï¼Œç¼–è¯‘æ—¶ä¼šå‘Šè­¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SafeVarargs</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">wrongMethod</span><span class="params">(List&lt;String&gt;... stringLists)</span> &#123;</span><br><span class="line">        Object[] array = stringLists;</span><br><span class="line">        List&lt;Integer&gt; tmpList = Arrays.asList(<span class="number">42</span>);</span><br><span class="line">        array[<span class="number">0</span>] = tmpList; <span class="comment">// ç¼–è¯‘ä¸å‘Šè­¦</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> stringLists[<span class="number">0</span>].get(<span class="number">0</span>); <span class="comment">// è¿è¡Œæ—¶æŠ¥ ClassCastException</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;A&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;B&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; list2 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;2&quot;</span>);</span><br><span class="line"></span><br><span class="line">        wrongMethod(list, list2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="FunctionalInterface"><a href="#FunctionalInterface" class="headerlink" title="@FunctionalInterface"></a>@FunctionalInterface</h3><p><code>@FunctionalInterface</code> åœ¨ JDK8 å¼•å…¥ã€‚</p><p><strong><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/FunctionalInterface.html"><code>@FunctionalInterface</code></a>ç”¨äºæŒ‡ç¤ºè¢«ä¿®é¥°çš„æ¥å£æ˜¯å‡½æ•°å¼æ¥å£ã€‚</strong></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªæ¥å£ç¬¦åˆâ€å‡½æ•°å¼æ¥å£â€å®šä¹‰ï¼Œä¸åŠ  <code>@FunctionalInterface</code> ä¹Ÿæ²¡å…³ç³»ï¼›ä½†å¦‚æœç¼–å†™çš„ä¸æ˜¯å‡½æ•°å¼æ¥å£ï¼Œå´ä½¿ç”¨ <code>@FunctionInterface</code>ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</p><p>ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£ï¼Ÿ</p><p><strong>å‡½æ•°å¼æ¥å£(Functional Interface)å°±æ˜¯ä¸€ä¸ªæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥æœ‰å¤šä¸ªéæŠ½è±¡æ–¹æ³•çš„æ¥å£</strong>ã€‚å‡½æ•°å¼æ¥å£å¯ä»¥è¢«éšå¼è½¬æ¢ä¸º lambda è¡¨è¾¾å¼ã€‚</p><p>å‡½æ•°å¼æ¥å£çš„ç‰¹ç‚¹ï¼š</p><ul><li>æ¥å£æœ‰ä¸”åªèƒ½æœ‰ä¸ªä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼ˆæŠ½è±¡æ–¹æ³•åªæœ‰æ–¹æ³•å®šä¹‰ï¼Œæ²¡æœ‰æ–¹æ³•ä½“ï¼‰ã€‚</li><li>ä¸èƒ½åœ¨æ¥å£ä¸­è¦†å†™ Object ç±»ä¸­çš„ public æ–¹æ³•ï¼ˆå†™äº†ç¼–è¯‘å™¨ä¹Ÿä¼šæŠ¥é”™ï¼‰ã€‚</li><li>å…è®¸æœ‰ default å®ç°æ–¹æ³•ã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FunctionalInterfaceAnnotationDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@FunctionalInterface</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Func1</span>&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">printMessage</span><span class="params">(T message)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@FunctionalInterface</span> ä¿®é¥°çš„æ¥å£ä¸­å®šä¹‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç¼–è¯‘æ—¶ä¼šæŠ¥é”™</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*@FunctionalInterface</span></span><br><span class="line"><span class="comment">    public interface Func2&lt;T&gt; &#123;</span></span><br><span class="line"><span class="comment">        void printMessage(T message);</span></span><br><span class="line"><span class="comment">        void printMessage2(T message);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Func1</span> <span class="variable">func1</span> <span class="operator">=</span> message -&gt; System.out.println(message);</span><br><span class="line">        func1.printMessage(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">        func1.printMessage(<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å…ƒæ³¨è§£"><a href="#å…ƒæ³¨è§£" class="headerlink" title="å…ƒæ³¨è§£"></a>å…ƒæ³¨è§£</h2><p>JDK ä¸­è™½ç„¶å†…ç½®äº†å‡ ä¸ªæ³¨è§£ï¼Œä½†è¿™è¿œè¿œä¸èƒ½æ»¡è¶³å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„åƒå˜ä¸‡åŒ–çš„éœ€æ±‚ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ³¨è§£ï¼Œè€Œè¿™å°±éœ€è¦ç”¨åˆ°å…ƒæ³¨è§£ã€‚</p><p><strong>å…ƒæ³¨è§£çš„ä½œç”¨å°±æ˜¯ç”¨äºå®šä¹‰å…¶å®ƒçš„æ³¨è§£</strong>ã€‚</p><p>Java ä¸­æä¾›äº†ä»¥ä¸‹å…ƒæ³¨è§£ç±»å‹ï¼š</p><ul><li><code>@Retention</code></li><li><code>@Target</code></li><li><code>@Documented</code></li><li><code>@Inherited</code>ï¼ˆJDK8 å¼•å…¥ï¼‰</li><li><code>@Repeatable</code>ï¼ˆJDK8 å¼•å…¥ï¼‰</li><li><code>@Native</code>ï¼ˆJDK8 å¼•å…¥ï¼‰</li></ul><p>è¿™äº›ç±»å‹å’Œå®ƒä»¬æ‰€æ”¯æŒçš„ç±»åœ¨ <code>java.lang.annotation</code> åŒ…ä¸­å¯ä»¥æ‰¾åˆ°ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹æ¯ä¸ªå…ƒæ³¨è§£çš„ä½œç”¨å’Œç›¸åº”åˆ†å‚æ•°çš„ä½¿ç”¨è¯´æ˜ã€‚</p><h3 id="Retention"><a href="#Retention" class="headerlink" title="@Retention"></a>@Retention</h3><p><strong><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Retention.html"><code>@Retention</code></a>æŒ‡æ˜äº†æ³¨è§£çš„ä¿ç•™çº§åˆ«ã€‚</strong></p><blockquote><p>Retenitonæ³¨è§£çš„ä½œç”¨æ˜¯ï¼šæè¿°æ³¨è§£ä¿ç•™çš„æ—¶é—´èŒƒå›´ï¼ˆå³ï¼šè¢«æè¿°çš„æ³¨è§£åœ¨å®ƒæ‰€ä¿®é¥°çš„ç±»ä¸­å¯ä»¥è¢«ä¿ç•™åˆ°ä½•æ—¶ï¼‰ ã€‚</p></blockquote><p><code>@Retention</code> æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.ANNOTATION_TYPE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Retention &#123;</span><br><span class="line">    RetentionPolicy <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Retenitonæ³¨è§£ç”¨æ¥é™å®šé‚£äº›è¢«å®ƒæ‰€æ³¨è§£çš„æ³¨è§£ç±»åœ¨æ³¨è§£åˆ°å…¶ä»–ç±»ä¸Šä»¥åï¼Œå¯è¢«ä¿ç•™åˆ°ä½•æ—¶ï¼Œä¸€å…±æœ‰ä¸‰ç§ç­–ç•¥ï¼Œå®šä¹‰åœ¨RetentionPolicyæšä¸¾ä¸­ã€‚</p><p><code>RetentionPolicy</code> æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œå®ƒå®šä¹‰äº†è¢« <code>@Retention</code> ä¿®é¥°çš„æ³¨è§£æ‰€æ”¯æŒçš„ä¿ç•™çº§åˆ«ï¼š</p><ul><li><code>RetentionPolicy.SOURCE</code> - æ ‡è®°çš„æ³¨è§£ä»…åœ¨æºæ–‡ä»¶ä¸­æœ‰æ•ˆï¼ˆæºæ–‡ä»¶ä¿ç•™ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šå¿½ç•¥ã€‚</li><li><code>RetentionPolicy.CLASS</code> - æ ‡è®°çš„æ³¨è§£åœ¨ class æ–‡ä»¶ä¸­æœ‰æ•ˆï¼ˆç¼–è¯‘æœŸä¿ç•™ï¼Œé»˜è®¤å€¼ï¼‰ï¼ŒJVM ä¼šå¿½ç•¥ã€‚</li><li><code>RetentionPolicy.RUNTIME</code> - æ ‡è®°çš„æ³¨è§£åœ¨è¿è¡Œæ—¶æœ‰æ•ˆï¼ˆè¿è¡ŒæœŸä¿ç•™ï¼Œå¯é€šè¿‡åå°„å»è·å–æ³¨è§£ä¿¡æ¯ï¼‰ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">RetentionPolicy</span> &#123;</span><br><span class="line">    SOURCE,    <span class="comment">// æºæ–‡ä»¶ä¿ç•™</span></span><br><span class="line">    CLASS,       <span class="comment">// ç¼–è¯‘æœŸä¿ç•™ï¼Œé»˜è®¤å€¼</span></span><br><span class="line">    RUNTIME   <span class="comment">// è¿è¡ŒæœŸä¿ç•™ï¼Œå¯é€šè¿‡åå°„å»è·å–æ³¨è§£ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†éªŒè¯åº”ç”¨äº†è¿™ä¸‰ç§ç­–ç•¥çš„æ³¨è§£ç±»æœ‰ä½•åŒºåˆ«ï¼Œåˆ†åˆ«ä½¿ç”¨ä¸‰ç§ç­–ç•¥å„å®šä¹‰ä¸€ä¸ªæ³¨è§£ç±»åšæµ‹è¯•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.SOURCE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SourcePolicy &#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.CLASS)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> ClassPolicy &#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RuntimePolicy &#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨å®šä¹‰å¥½çš„ä¸‰ä¸ªæ³¨è§£ç±»åˆ†åˆ«å»æ³¨è§£ä¸€ä¸ªæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RetentionTest</span> &#123;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@SourcePolicy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sourcePolicy</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@ClassPolicy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">classPolicy</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RuntimePolicy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">runtimePolicy</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ‰§è¡Œ <code>javap -verbose RetentionTest</code>å‘½ä»¤è·å–åˆ°çš„RetentionTest çš„ class å­—èŠ‚ç å†…å®¹å¦‚ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> retention.RetentionTest();</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">1</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         <span class="number">1</span>: invokespecial #<span class="number">1</span>                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">3</span>: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sourcePolicy</span><span class="params">()</span>;</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">0</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">7</span>: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">classPolicy</span><span class="params">()</span>;</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">0</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">11</span>: <span class="number">0</span></span><br><span class="line">    RuntimeInvisibleAnnotations:</span><br><span class="line">      <span class="number">0</span>: #<span class="number">11</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">runtimePolicy</span><span class="params">()</span>;</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">0</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">15</span>: <span class="number">0</span></span><br><span class="line">    RuntimeVisibleAnnotations:</span><br><span class="line">      <span class="number">0</span>: #<span class="number">14</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä» RetentionTest çš„å­—èŠ‚ç å†…å®¹æˆ‘ä»¬å¯ä»¥å¾—å‡ºä»¥ä¸‹ä¸¤ç‚¹ç»“è®ºï¼š</p><ul><li>ç¼–è¯‘å™¨å¹¶æ²¡æœ‰è®°å½•ä¸‹ sourcePolicy() æ–¹æ³•çš„æ³¨è§£ä¿¡æ¯ï¼›</li><li>ç¼–è¯‘å™¨åˆ†åˆ«ä½¿ç”¨äº† <code>RuntimeInvisibleAnnotations</code> å’Œ <code>RuntimeVisibleAnnotations</code> å±æ€§å»è®°å½•äº†<code>classPolicy()</code>æ–¹æ³• å’Œ <code>runtimePolicy()</code>æ–¹æ³• çš„æ³¨è§£ä¿¡æ¯ï¼›</li></ul><h3 id="Documented"><a href="#Documented" class="headerlink" title="@Documented"></a>@Documented</h3><p><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Documented.html"><code>@Documented</code></a>è¡¨ç¤ºæ— è®ºä½•æ—¶ä½¿ç”¨æŒ‡å®šçš„æ³¨è§£ï¼Œéƒ½åº”ä½¿ç”¨ Javadocï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œæ³¨é‡Šä¸åŒ…å«åœ¨ Javadoc ä¸­ï¼‰ã€‚æ›´å¤šå†…å®¹å¯ä»¥å‚è€ƒï¼š<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/javadoc/index.html">Javadoc tools page</a>ã€‚</p><blockquote><p>Documentedæ³¨è§£çš„ä½œç”¨æ˜¯ï¼šæè¿°åœ¨ä½¿ç”¨ javadoc å·¥å…·ä¸ºç±»ç”Ÿæˆå¸®åŠ©æ–‡æ¡£æ—¶æ˜¯å¦è¦ä¿ç•™å…¶æ³¨è§£ä¿¡æ¯ã€‚</p></blockquote><p>ä»¥ä¸‹ä»£ç åœ¨ä½¿ç”¨Javadocå·¥å…·å¯ä»¥ç”Ÿæˆ<code>@TestDocAnnotation</code>æ³¨è§£ä¿¡æ¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.Documented;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> TestDocAnnotation &#123;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;default&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TestDocAnnotation(&quot;myMethodDoc&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDoc</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Target"><a href="#Target" class="headerlink" title="@Target"></a>@Target</h3><p><strong><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Target.html"><code>@Target</code></a>æŒ‡å®šæ³¨è§£å¯ä»¥ä¿®é¥°çš„å…ƒç´ ç±»å‹ã€‚</strong></p><blockquote><p>Targetæ³¨è§£çš„ä½œç”¨æ˜¯ï¼šæè¿°æ³¨è§£çš„ä½¿ç”¨èŒƒå›´ï¼ˆå³ï¼šè¢«ä¿®é¥°çš„æ³¨è§£å¯ä»¥ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹ï¼‰ ã€‚</p></blockquote><p>Targetæ³¨è§£ç”¨æ¥è¯´æ˜é‚£äº›è¢«å®ƒæ‰€æ³¨è§£çš„æ³¨è§£ç±»å¯ä¿®é¥°çš„å¯¹è±¡èŒƒå›´ï¼šæ³¨è§£å¯ä»¥ç”¨äºä¿®é¥° packagesã€typesï¼ˆç±»ã€æ¥å£ã€æšä¸¾ã€æ³¨è§£ç±»ï¼‰ã€ç±»æˆå‘˜ï¼ˆæ–¹æ³•ã€æ„é€ æ–¹æ³•ã€æˆå‘˜å˜é‡ã€æšä¸¾å€¼ï¼‰ã€æ–¹æ³•å‚æ•°å’Œæœ¬åœ°å˜é‡ï¼ˆå¦‚å¾ªç¯å˜é‡ã€catchå‚æ•°ï¼‰ï¼Œåœ¨å®šä¹‰æ³¨è§£ç±»æ—¶ä½¿ç”¨äº†@Target èƒ½å¤Ÿæ›´åŠ æ¸…æ™°çš„çŸ¥é“å®ƒèƒ½å¤Ÿè¢«ç”¨æ¥ä¿®é¥°å“ªäº›å¯¹è±¡ï¼Œå®ƒçš„å–å€¼èŒƒå›´å®šä¹‰åœ¨ElementType æšä¸¾ä¸­ã€‚</p><p><code>@Target</code> æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.ANNOTATION_TYPE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Target &#123;</span><br><span class="line">    ElementType[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ElementType</code> æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œå®ƒå®šä¹‰äº†è¢« <code>@Target</code> ä¿®é¥°çš„æ³¨è§£å¯ä»¥åº”ç”¨çš„èŒƒå›´ï¼š</p><ul><li><code>ElementType.ANNOTATION_TYPE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ³¨è§£ç±»å‹ã€‚</li><li><code>ElementType.CONSTRUCTOR</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ„é€ å‡½æ•°ã€‚</li><li><code>ElementType.FIELD</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºå­—æ®µæˆ–å±æ€§ã€‚</li><li><code>ElementType.LOCAL_VARIABLE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºå±€éƒ¨å˜é‡ã€‚</li><li><code>ElementType.METHOD</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ–¹æ³•ã€‚</li><li><code>ElementType.PACKAGE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºåŒ…å£°æ˜ã€‚</li><li><code>ElementType.PARAMETER</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ–¹æ³•çš„å‚æ•°ã€‚</li><li><code>ElementType.TYPE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºç±»çš„ä»»ä½•å…ƒç´ ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ElementType</span> &#123;</span><br><span class="line"> </span><br><span class="line">    TYPE, <span class="comment">// ç±»ã€æ¥å£ã€æšä¸¾ç±»</span></span><br><span class="line"> </span><br><span class="line">    FIELD, <span class="comment">// æˆå‘˜å˜é‡ï¼ˆåŒ…æ‹¬ï¼šæšä¸¾å¸¸é‡ï¼‰</span></span><br><span class="line"> </span><br><span class="line">    METHOD, <span class="comment">// æˆå‘˜æ–¹æ³•</span></span><br><span class="line"> </span><br><span class="line">    PARAMETER, <span class="comment">// æ–¹æ³•å‚æ•°</span></span><br><span class="line"> </span><br><span class="line">    CONSTRUCTOR, <span class="comment">// æ„é€ æ–¹æ³•</span></span><br><span class="line"> </span><br><span class="line">    LOCAL_VARIABLE, <span class="comment">// å±€éƒ¨å˜é‡</span></span><br><span class="line"> </span><br><span class="line">    ANNOTATION_TYPE, <span class="comment">// æ³¨è§£ç±»</span></span><br><span class="line"> </span><br><span class="line">    PACKAGE, <span class="comment">// å¯ç”¨äºä¿®é¥°ï¼šåŒ…</span></span><br><span class="line"> </span><br><span class="line">    TYPE_PARAMETER, <span class="comment">// ç±»å‹å‚æ•°ï¼ŒJDK 1.8 æ–°å¢</span></span><br><span class="line"> </span><br><span class="line">    TYPE_USE <span class="comment">// ä½¿ç”¨ç±»å‹çš„ä»»ä½•åœ°æ–¹ï¼ŒJDK 1.8 æ–°å¢</span></span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@Target</code> ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Table &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®è¡¨åç§°æ³¨è§£ï¼Œé»˜è®¤å€¼ä¸ºç±»åç§°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">tableName</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;className&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> NoDBColumn &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="Inherited"><a href="#Inherited" class="headerlink" title="@Inherited"></a>@Inherited</h3><p><strong><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Inherited.html"><code>@Inherited</code></a>è¡¨ç¤ºæ³¨è§£ç±»å‹å¯ä»¥è¢«ç»§æ‰¿ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä¸æ˜¯è¿™æ ·ï¼‰</strong>ã€‚</p><blockquote><p>Inheritedæ³¨è§£çš„ä½œç”¨ï¼šè¢«å®ƒä¿®é¥°çš„Annotationå°†å…·æœ‰ç»§æ‰¿æ€§ã€‚å¦‚æœæŸä¸ªç±»ä½¿ç”¨äº†è¢«@Inheritedä¿®é¥°çš„Annotationï¼Œåˆ™å…¶å­ç±»å°†è‡ªåŠ¨å…·æœ‰è¯¥æ³¨è§£ã€‚</p><p>ğŸ”” æ³¨æ„ï¼š<code>@Inherited</code> æ³¨è§£ç±»å‹æ˜¯è¢«æ ‡æ³¨è¿‡çš„ç±»çš„å­ç±»æ‰€ç»§æ‰¿ã€‚ç±»å¹¶ä¸ä»å®ƒæ‰€å®ç°çš„æ¥å£ç»§æ‰¿æ³¨è§£ï¼Œæ–¹æ³•å¹¶ä¸ä»å®ƒæ‰€è¦†å†™çš„æ–¹æ³•ç»§æ‰¿æ³¨è§£ã€‚</p><p>æ­¤å¤–ï¼Œå½“ <code>@Inherited</code> ç±»å‹æ ‡æ³¨çš„æ³¨è§£çš„ <code>@Retention</code> æ˜¯ <code>RetentionPolicy.RUNTIME</code>ï¼Œåˆ™åå°„ API å¢å¼ºäº†è¿™ç§ç»§æ‰¿æ€§ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ <code>java.lang.reflect</code> å»æŸ¥è¯¢ä¸€ä¸ª <code>@Inherited</code> ç±»å‹çš„æ³¨è§£æ—¶ï¼Œåå°„ä»£ç æ£€æŸ¥å°†å±•å¼€å·¥ä½œï¼šæ£€æŸ¥ç±»å’Œå…¶çˆ¶ç±»ï¼Œç›´åˆ°å‘ç°æŒ‡å®šçš„æ³¨è§£ç±»å‹è¢«å‘ç°ï¼Œæˆ–è€…åˆ°è¾¾ç±»ç»§æ‰¿ç»“æ„çš„é¡¶å±‚ã€‚</p></blockquote><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸‹è¿™ä¸ªæ³¨è§£ï¼š</p><ul><li>å®šä¹‰<code>@Inherited</code>æ³¨è§£ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> TestInheritedAnnotation &#123;</span><br><span class="line">    String[] values();</span><br><span class="line">    <span class="type">int</span> <span class="title function_">number</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨è¿™ä¸ªæ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TestInheritedAnnotation(values = &#123;&quot;value&quot;&#125;, number = 10)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_">Person</span>&#123;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Student.class;</span><br><span class="line">        Annotation[] annotations = clazz.getAnnotations();</span><br><span class="line">        <span class="keyword">for</span> (Annotation annotation : annotations) &#123;</span><br><span class="line">            System.out.println(annotation.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¾“å‡º</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxxxxxx.TestInheritedAnnotation(values=[value], number=<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p>å³ä½¿Studentç±»æ²¡æœ‰æ˜¾ç¤ºåœ°è¢«æ³¨è§£<code>@TestInheritedAnnotation</code>ï¼Œä½†æ˜¯å®ƒçš„çˆ¶ç±»Personè¢«æ³¨è§£ï¼Œè€Œä¸”<code>@TestInheritedAnnotation</code>è¢«<code>@Inherited</code>æ³¨è§£ï¼Œå› æ­¤Studentç±»è‡ªåŠ¨æœ‰äº†è¯¥æ³¨è§£ã€‚</p><h3 id="Repeatable"><a href="#Repeatable" class="headerlink" title="@Repeatable"></a>@Repeatable</h3><p><strong><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Repeatable.html"><code>@Repeatable</code></a>è¡¨ç¤ºæ³¨è§£å¯ä»¥é‡å¤ä½¿ç”¨ã€‚</strong>å…è®¸åœ¨åŒä¸€ç”³æ˜ç±»å‹(ç±»ï¼Œå±æ€§ï¼Œæˆ–æ–¹æ³•)å¤šæ¬¡ä½¿ç”¨åŒä¸€ä¸ªæ³¨è§£ã€‚</p><p>java 8ä¹‹å‰ä¹Ÿæœ‰é‡å¤ä½¿ç”¨æ³¨è§£çš„è§£å†³æ–¹æ¡ˆï¼Œä½†å¯è¯»æ€§ä¸æ˜¯å¾ˆå¥½ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Authority &#123;</span><br><span class="line">     String <span class="title function_">role</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Authorities &#123;</span><br><span class="line">    Authority[] value();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RepeatAnnotationUseOldVersion</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Authorities(&#123;@Authority(role=&quot;Admin&quot;),@Authority(role=&quot;Manager&quot;)&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomeThing</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±å¦ä¸€ä¸ªæ³¨è§£æ¥å­˜å‚¨é‡å¤æ³¨è§£ï¼Œåœ¨ä½¿ç”¨æ—¶å€™ï¼Œç”¨å­˜å‚¨æ³¨è§£Authoritiesæ¥æ‰©å±•é‡å¤æ³¨è§£ã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹java 8é‡Œé¢çš„åšæ³•:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repeatable(Authorities.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Authority &#123;</span><br><span class="line">     String <span class="title function_">role</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Authorities &#123;</span><br><span class="line">    Authority[] value();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RepeatAnnotationUseNewVersion</span> &#123;</span><br><span class="line">    <span class="meta">@Authority(role=&quot;Admin&quot;)</span></span><br><span class="line">    <span class="meta">@Authority(role=&quot;Manager&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomeThing</span><span class="params">()</span>&#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸åŒçš„åœ°æ–¹æ˜¯ï¼Œåˆ›å»ºé‡å¤æ³¨è§£Authorityæ—¶ï¼ŒåŠ ä¸Š@Repeatable,æŒ‡å‘å­˜å‚¨æ³¨è§£Authoritiesï¼Œåœ¨ä½¿ç”¨æ—¶å€™ï¼Œç›´æ¥å¯ä»¥é‡å¤ä½¿ç”¨Authorityæ³¨è§£ã€‚ä»ä¸Šé¢ä¾‹å­çœ‹å‡ºï¼Œjava 8é‡Œé¢åšæ³•æ›´é€‚åˆå¸¸è§„çš„æ€ç»´ï¼Œå¯è¯»æ€§å¼ºä¸€ç‚¹ã€‚</p><h3 id="Native"><a href="#Native" class="headerlink" title="@Native"></a>@Native</h3><p>ä½¿ç”¨<code>@Native</code> æ³¨è§£ä¿®é¥°æˆå‘˜å˜é‡ï¼Œåˆ™è¡¨ç¤ºè¿™ä¸ªå˜é‡å¯ä»¥è¢«æœ¬åœ°ä»£ç å¼•ç”¨ï¼Œå¸¸å¸¸è¢«ä»£ç ç”Ÿæˆå·¥å…·ä½¿ç”¨ã€‚å¯¹äº @Native æ³¨è§£ä¸å¸¸ä½¿ç”¨ï¼Œäº†è§£å³å¯ã€‚</p><h2 id="æ³¨è§£ä¸åå°„æ¥å£"><a href="#æ³¨è§£ä¸åå°„æ¥å£" class="headerlink" title="æ³¨è§£ä¸åå°„æ¥å£"></a>æ³¨è§£ä¸åå°„æ¥å£</h2><blockquote><p>å®šä¹‰æ³¨è§£åï¼Œå¦‚ä½•è·å–æ³¨è§£ä¸­çš„å†…å®¹å‘¢ï¼Ÿåå°„åŒ…java.lang.reflectä¸‹çš„AnnotatedElementæ¥å£æä¾›è¿™äº›æ–¹æ³•ã€‚è¿™é‡Œæ³¨æ„ï¼šåªæœ‰æ³¨è§£è¢«å®šä¹‰ä¸ºRUNTIMEåï¼Œè¯¥æ³¨è§£æ‰èƒ½æ˜¯è¿è¡Œæ—¶å¯è§ï¼Œå½“classæ–‡ä»¶è¢«è£…è½½æ—¶è¢«ä¿å­˜åœ¨classæ–‡ä»¶ä¸­çš„Annotationæ‰ä¼šè¢«è™šæ‹Ÿæœºè¯»å–ã€‚</p></blockquote><p>AnnotatedElement æ¥å£æ˜¯æ‰€æœ‰ç¨‹åºå…ƒç´ ï¼ˆClassã€Methodå’ŒConstructorï¼‰çš„çˆ¶æ¥å£ï¼Œæ‰€ä»¥ç¨‹åºé€šè¿‡åå°„è·å–äº†æŸä¸ªç±»çš„AnnotatedElementå¯¹è±¡ä¹‹åï¼Œç¨‹åºå°±å¯ä»¥è°ƒç”¨è¯¥å¯¹è±¡çš„æ–¹æ³•æ¥è®¿é—®Annotationä¿¡æ¯ã€‚æˆ‘ä»¬çœ‹ä¸‹å…·ä½“çš„ç›¸å…³æ¥å£</p><ul><li><code>boolean isAnnotationPresent(Class&lt;?extends Annotation&gt; annotationClass)</code></li></ul><p>åˆ¤æ–­è¯¥ç¨‹åºå…ƒç´ ä¸Šæ˜¯å¦åŒ…å«æŒ‡å®šç±»å‹çš„æ³¨è§£ï¼Œå­˜åœ¨åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚æ³¨æ„ï¼šæ­¤æ–¹æ³•ä¼šå¿½ç•¥æ³¨è§£å¯¹åº”çš„æ³¨è§£å®¹å™¨ã€‚</p><ul><li><code>&lt;T extends Annotation&gt; T getAnnotation(Class&lt;T&gt; annotationClass)</code></li></ul><p>è¿”å›è¯¥ç¨‹åºå…ƒç´ ä¸Šå­˜åœ¨çš„ã€æŒ‡å®šç±»å‹çš„æ³¨è§£ï¼Œå¦‚æœè¯¥ç±»å‹æ³¨è§£ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›nullã€‚</p><ul><li><code>Annotation[] getAnnotations()</code></li></ul><p>è¿”å›è¯¥ç¨‹åºå…ƒç´ ä¸Šå­˜åœ¨çš„æ‰€æœ‰æ³¨è§£ï¼Œè‹¥æ²¡æœ‰æ³¨è§£ï¼Œè¿”å›é•¿åº¦ä¸º0çš„æ•°ç»„ã€‚</p><ul><li><code>&lt;T extends Annotation&gt; T[] getAnnotationsByType(Class&lt;T&gt; annotationClass)</code></li></ul><p>è¿”å›è¯¥ç¨‹åºå…ƒç´ ä¸Šå­˜åœ¨çš„ã€æŒ‡å®šç±»å‹çš„æ³¨è§£æ•°ç»„ã€‚æ²¡æœ‰æ³¨è§£å¯¹åº”ç±»å‹çš„æ³¨è§£æ—¶ï¼Œè¿”å›é•¿åº¦ä¸º0çš„æ•°ç»„ã€‚è¯¥æ–¹æ³•çš„è°ƒç”¨è€…å¯ä»¥éšæ„ä¿®æ”¹è¿”å›çš„æ•°ç»„ï¼Œè€Œä¸ä¼šå¯¹å…¶ä»–è°ƒç”¨è€…è¿”å›çš„æ•°ç»„äº§ç”Ÿä»»ä½•å½±å“ã€‚<code>getAnnotationsByType</code>æ–¹æ³•ä¸ <code>getAnnotation</code>çš„åŒºåˆ«åœ¨äºï¼Œ<code>getAnnotationsByType</code>ä¼šæ£€æµ‹æ³¨è§£å¯¹åº”çš„é‡å¤æ³¨è§£å®¹å™¨ã€‚è‹¥ç¨‹åºå…ƒç´ ä¸ºç±»ï¼Œå½“å‰ç±»ä¸Šæ‰¾ä¸åˆ°æ³¨è§£ï¼Œä¸”è¯¥æ³¨è§£ä¸ºå¯ç»§æ‰¿çš„ï¼Œåˆ™ä¼šå»çˆ¶ç±»ä¸Šæ£€æµ‹å¯¹åº”çš„æ³¨è§£ã€‚</p><ul><li><code>&lt;T extends Annotation&gt; T getDeclaredAnnotation(Class&lt;T&gt; annotationClass)</code></li></ul><p>è¿”å›ç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šçš„æ‰€æœ‰æ³¨è§£ã€‚ä¸æ­¤æ¥å£ä¸­çš„å…¶ä»–æ–¹æ³•ä¸åŒï¼Œè¯¥æ–¹æ³•å°†å¿½ç•¥ç»§æ‰¿çš„æ³¨é‡Šã€‚å¦‚æœæ²¡æœ‰æ³¨é‡Šç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šï¼Œåˆ™è¿”å›null</p><ul><li><code>&lt;T extends Annotation&gt; T[] getDeclaredAnnotationsByType(Class&lt;T&gt; annotationClass)</code></li></ul><p>è¿”å›ç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šçš„æ‰€æœ‰æ³¨è§£ã€‚ä¸æ­¤æ¥å£ä¸­çš„å…¶ä»–æ–¹æ³•ä¸åŒï¼Œè¯¥æ–¹æ³•å°†å¿½ç•¥ç»§æ‰¿çš„æ³¨é‡Š</p><ul><li><code>Annotation[] getDeclaredAnnotations()</code></li></ul><p>è¿”å›ç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šçš„æ‰€æœ‰æ³¨è§£åŠæ³¨è§£å¯¹åº”çš„é‡å¤æ³¨è§£å®¹å™¨ã€‚ä¸æ­¤æ¥å£ä¸­çš„å…¶ä»–æ–¹æ³•ä¸åŒï¼Œè¯¥æ–¹æ³•å°†å¿½ç•¥ç»§æ‰¿çš„æ³¨è§£ã€‚å¦‚æœæ²¡æœ‰æ³¨é‡Šç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šï¼Œåˆ™è¿”å›é•¿åº¦ä¸ºé›¶çš„ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ–¹æ³•çš„è°ƒç”¨è€…å¯ä»¥éšæ„ä¿®æ”¹è¿”å›çš„æ•°ç»„ï¼Œè€Œä¸ä¼šå¯¹å…¶ä»–è°ƒç”¨è€…è¿”å›çš„æ•°ç»„äº§ç”Ÿä»»ä½•å½±å“ã€‚</p><h2 id="è‡ªå®šä¹‰æ³¨è§£"><a href="#è‡ªå®šä¹‰æ³¨è§£" class="headerlink" title="è‡ªå®šä¹‰æ³¨è§£"></a>è‡ªå®šä¹‰æ³¨è§£</h2><p>ä½¿ç”¨ <code>@interface</code> è‡ªå®šä¹‰æ³¨è§£æ—¶ï¼Œè‡ªåŠ¨ç»§æ‰¿äº† <code>java.lang.annotation.Annotation</code> æ¥å£ï¼Œç”±ç¼–è¯‘ç¨‹åºè‡ªåŠ¨å®Œæˆå…¶ä»–ç»†èŠ‚ã€‚åœ¨å®šä¹‰æ³¨è§£æ—¶ï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–çš„æ³¨è§£æˆ–æ¥å£ã€‚<code>@interface</code> ç”¨æ¥å£°æ˜ä¸€ä¸ªæ³¨è§£ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªæ–¹æ³•å®é™…ä¸Šæ˜¯å£°æ˜äº†ä¸€ä¸ªé…ç½®å‚æ•°ã€‚æ–¹æ³•çš„åç§°å°±æ˜¯å‚æ•°çš„åç§°ï¼Œè¿”å›å€¼ç±»å‹å°±æ˜¯å‚æ•°çš„ç±»å‹ï¼ˆè¿”å›å€¼ç±»å‹åªèƒ½æ˜¯åŸºæœ¬ç±»å‹ã€Classã€Stringã€enumï¼‰ã€‚å¯ä»¥é€šè¿‡ <code>default</code> æ¥å£°æ˜å‚æ•°çš„é»˜è®¤å€¼ã€‚è¿™é‡Œï¼Œæˆ‘ä¼šé€šè¿‡å®ç°ä¸€ä¸ªåä¸º <code>RegexValid</code> çš„æ­£åˆ™æ ¡éªŒæ³¨è§£å·¥å…·æ¥å±•ç¤ºè‡ªå®šä¹‰æ³¨è§£çš„å…¨æ­¥éª¤ã€‚</p><h3 id="æ³¨è§£çš„å®šä¹‰"><a href="#æ³¨è§£çš„å®šä¹‰" class="headerlink" title="æ³¨è§£çš„å®šä¹‰"></a>æ³¨è§£çš„å®šä¹‰</h3><p>æ³¨è§£çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> æ³¨è§£å &#123;å®šä¹‰ä½“&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªæ³¨è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD, ElementType.PARAMETER&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RegexValid &#123;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼š</p><p>é€šè¿‡ä¸Šä¸€èŠ‚å¯¹äºå…ƒæ³¨è§£ <code>@Target</code>ã€<code>@Retention</code>ã€<code>@Documented</code> çš„è¯´æ˜ï¼Œè¿™é‡Œå°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚</p><ul><li>ä¸Šé¢çš„ä»£ç ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>@RegexValid</code> çš„æ³¨è§£ã€‚</li><li><code>@Documented</code> è¡¨ç¤º <code>@RegexValid</code> åº”è¯¥ä½¿ç”¨ javadocã€‚</li><li><code>@Target(&#123;ElementType.FIELD, ElementType.PARAMETER&#125;)</code> è¡¨ç¤º <code>@RegexValid</code> å¯ä»¥åœ¨ç±»æˆå‘˜æˆ–æ–¹æ³•å‚æ•°ä¸Šä¿®é¥°ã€‚</li><li>@Retention(RetentionPolicy.RUNTIME) è¡¨ç¤º <code>@RegexValid</code> åœ¨è¿è¡Œæ—¶æœ‰æ•ˆã€‚</li></ul></blockquote><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å·²ç»å®šä¹‰äº†ä¸€ä¸ªæ²¡æœ‰ä»»ä½•å±æ€§çš„æ³¨è§£ï¼Œå¦‚æœåˆ°æ­¤ä¸ºæ­¢ï¼Œå®ƒä»…ä»…æ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ã€‚ä½œä¸ºæ­£åˆ™å·¥å…·ï¼Œæ²¡æœ‰å±æ€§å¯ä»€ä¹ˆä¹Ÿåšä¸äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä¸ºå®ƒæ·»åŠ æ³¨è§£å±æ€§ã€‚</p><h3 id="æ³¨è§£å±æ€§"><a href="#æ³¨è§£å±æ€§" class="headerlink" title="æ³¨è§£å±æ€§"></a>æ³¨è§£å±æ€§</h3><p>æ³¨è§£å±æ€§çš„è¯­æ³•å½¢å¼å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[è®¿é—®çº§åˆ«ä¿®é¥°ç¬¦] [æ•°æ®ç±»å‹] åç§°() <span class="keyword">default</span> é»˜è®¤å€¼;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦å®šä¹‰åœ¨æ³¨è§£ä¸­å®šä¹‰ä¸€ä¸ªåä¸º value çš„å­—ç¬¦ä¸²å±æ€§ï¼Œå…¶é»˜è®¤å€¼ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè®¿é—®çº§åˆ«ä¸ºé»˜è®¤çº§åˆ«ï¼Œé‚£ä¹ˆåº”è¯¥å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ”” æ³¨æ„ï¼š<strong>åœ¨æ³¨è§£ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰å±æ€§æ—¶ï¼Œå±æ€§ååé¢éœ€è¦åŠ  <code>()</code></strong>ã€‚</p></blockquote><p>å®šä¹‰æ³¨è§£å±æ€§æœ‰ä»¥ä¸‹è¦ç‚¹ï¼š</p><ul><li><strong>æ³¨è§£å±æ€§åªèƒ½ä½¿ç”¨ <code>public</code> æˆ–é»˜è®¤è®¿é—®çº§åˆ«ï¼ˆå³ä¸æŒ‡å®šè®¿é—®çº§åˆ«ä¿®é¥°ç¬¦ï¼‰ä¿®é¥°</strong>ã€‚</li><li><strong>æ³¨è§£å±æ€§çš„æ•°æ®ç±»å‹æœ‰é™åˆ¶è¦æ±‚</strong>ã€‚æ”¯æŒçš„æ•°æ®ç±»å‹å¦‚ä¸‹ï¼š<ul><li>æ‰€æœ‰åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆbyteã€charã€shortã€intã€longã€floatã€doubleã€booleanï¼‰</li><li>String ç±»å‹</li><li>Class ç±»</li><li>enum ç±»å‹</li><li>Annotation ç±»å‹</li><li>ä»¥ä¸Šæ‰€æœ‰ç±»å‹çš„æ•°ç»„</li></ul></li><li><strong>æ³¨è§£å±æ€§å¿…é¡»æœ‰ç¡®å®šçš„å€¼ï¼Œå»ºè®®æŒ‡å®šé»˜è®¤å€¼</strong>ã€‚æ³¨è§£å±æ€§åªèƒ½é€šè¿‡æŒ‡å®šé»˜è®¤å€¼æˆ–ä½¿ç”¨æ³¨è§£æ—¶æŒ‡å®šå±æ€§å€¼ï¼Œç›¸è¾ƒä¹‹ä¸‹ï¼ŒæŒ‡å®šé»˜è®¤å€¼çš„æ–¹å¼æ›´ä¸ºå¯é ã€‚æ³¨è§£å±æ€§å¦‚æœæ˜¯å¼•ç”¨ç±»å‹ï¼Œä¸å¯ä»¥ä¸º nullã€‚è¿™ä¸ªçº¦æŸä½¿å¾—æ³¨è§£å¤„ç†å™¨å¾ˆéš¾åˆ¤æ–­æ³¨è§£å±æ€§æ˜¯é»˜è®¤å€¼ï¼Œæˆ–æ˜¯ä½¿ç”¨æ³¨è§£æ—¶æ‰€æŒ‡å®šçš„å±æ€§å€¼ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬è®¾ç½®é»˜è®¤å€¼æ—¶ï¼Œä¸€èˆ¬ä¼šå®šä¹‰ä¸€äº›ç‰¹æ®Šçš„å€¼ï¼Œä¾‹å¦‚ç©ºå­—ç¬¦ä¸²æˆ–è€…è´Ÿæ•°ã€‚</li><li>å¦‚æœæ³¨è§£ä¸­åªæœ‰ä¸€ä¸ªå±æ€§å€¼ï¼Œæœ€å¥½å°†å…¶å‘½åä¸º valueã€‚å› ä¸ºï¼ŒæŒ‡å®šå±æ€§åä¸º valueï¼Œåœ¨ä½¿ç”¨æ³¨è§£æ—¶ï¼ŒæŒ‡å®š value çš„å€¼å¯ä»¥ä¸æŒ‡å®šå±æ€§åç§°ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸¤ç§æ–¹å¼æ•ˆæœç›¸åŒ</span></span><br><span class="line"><span class="meta">@RegexValid(&quot;^((\\+)?86\\s*)?((13[0-9])|(15([0-3]|[5-9]))|(18[0,2,5-9]))\\d&#123;8&#125;$&quot;)</span></span><br><span class="line"><span class="meta">@RegexValid(value = &quot;^((\\+)?86\\s*)?((13[0-9])|(15([0-3]|[5-9]))|(18[0,2,5-9]))\\d&#123;8&#125;$&quot;)</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><p>äº†è§£äº†æ³¨è§£å±æ€§çš„å®šä¹‰è¦ç‚¹ï¼Œè®©æˆ‘ä»¬æ¥ä¸º <code>@RegexValid</code> æ³¨è§£å®šä¹‰å‡ ä¸ªå±æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD, ElementType.PARAMETER&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RegexValid &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Policy</span> &#123;</span><br><span class="line">        <span class="comment">// @formatter:off</span></span><br><span class="line">        EMPTY(<span class="literal">null</span>),</span><br><span class="line">        DATE(<span class="string">&quot;^(?:(?!0000)[0-9]&#123;4&#125;([-/.]?)(?:(?:0?[1-9]|1[0-2])\\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\\1&quot;</span></span><br><span class="line">            + <span class="string">&quot;(?:29|30)|(?:0?[13578]|1[02])\\1(?:31))|(?:[0-9]&#123;2&#125;(?:0[48]|[2468][048]|[13579][26])|&quot;</span></span><br><span class="line">            + <span class="string">&quot;(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\\2(?:29))$&quot;</span>),</span><br><span class="line">        MAIL(<span class="string">&quot;^[A-Za-z0-9](([_\\.\\-]?[a-zA-Z0-9]+)*)@([A-Za-z0-9]+)(([\\.\\-]?[a-zA-Z0-9]+)*)\\.([A-Za-z]&#123;2,&#125;)$&quot;</span>);</span><br><span class="line">        <span class="comment">// @formatter:on</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String policy;</span><br><span class="line"></span><br><span class="line">        Policy(String policy) &#123;</span><br><span class="line">            <span class="built_in">this</span>.policy = policy;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getPolicy</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> policy;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    Policy <span class="title function_">policy</span><span class="params">()</span> <span class="keyword">default</span> Policy.EMPTY;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼š</p><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªæ³¨è§£å±æ€§ï¼š<code>String</code> ç±»å‹çš„ value å±æ€§å’Œ <code>Policy</code> æšä¸¾ç±»å‹çš„ policy å±æ€§ã€‚<code>Policy</code> æšä¸¾ä¸­å®šä¹‰äº†å‡ ä¸ªé»˜è®¤çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿™æ˜¯ä¸ºäº†ç›´æ¥ä½¿ç”¨è¿™å‡ ä¸ªå¸¸ç”¨è¡¨è¾¾å¼å»æ­£åˆ™æ ¡éªŒã€‚è€ƒè™‘åˆ°ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è‡ªå·±ä¼ å…¥ä¸€äº›è‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼å»æ ¡éªŒå…¶ä»–åœºæ™¯ï¼Œæ‰€ä»¥å®šä¹‰äº† value å±æ€§ï¼Œå…è®¸ä½¿ç”¨è€…ä¼ å…¥æ­£åˆ™è¡¨è¾¾å¼ã€‚</p></blockquote><p>è‡³æ­¤ï¼Œ<code>@RegexValid</code> çš„å£°æ˜å·²ç»ç»“æŸã€‚ä½†æ˜¯ï¼Œç¨‹åºä»ä¸çŸ¥é“å¦‚ä½•å¤„ç† <code>@RegexValid</code> è¿™ä¸ªæ³¨è§£ã€‚æˆ‘ä»¬è¿˜éœ€è¦å®šä¹‰æ³¨è§£å¤„ç†å™¨ã€‚</p><h3 id="æ³¨è§£å¤„ç†å™¨"><a href="#æ³¨è§£å¤„ç†å™¨" class="headerlink" title="æ³¨è§£å¤„ç†å™¨"></a>æ³¨è§£å¤„ç†å™¨</h3><p>å¦‚æœæ²¡æœ‰ç”¨æ¥è¯»å–æ³¨è§£çš„æ–¹æ³•å’Œå·¥ä½œï¼Œé‚£ä¹ˆæ³¨è§£ä¹Ÿå°±ä¸ä¼šæ¯”æ³¨é‡Šæ›´æœ‰ç”¨å¤„äº†ã€‚ä½¿ç”¨æ³¨è§£çš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†å°±æ˜¯åˆ›å»ºä¸ä½¿ç”¨æ³¨è§£å¤„ç†å™¨ã€‚JDK5 æ‰©å±•äº†åå°„æœºåˆ¶çš„ APIï¼Œä»¥å¸®åŠ©ç¨‹åºå‘˜å¿«é€Ÿåœ°æ„é€ è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨ã€‚</p><p><strong><code>java.lang.annotation.Annotation</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç¨‹åºå¯ä»¥é€šè¿‡åå°„æ¥è·å–æŒ‡å®šç¨‹åºå…ƒç´ çš„æ³¨è§£å¯¹è±¡ï¼Œç„¶åé€šè¿‡æ³¨è§£å¯¹è±¡æ¥è·å–æ³¨è§£é‡Œé¢çš„å…ƒæ•°æ®</strong>ã€‚</p><p><code>Annotation</code> æ¥å£æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Annotation</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object obj)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">toString</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">Annotation</span>&gt; annotationType();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼ŒJava ä¸­æ”¯æŒ<strong>æ³¨è§£å¤„ç†å™¨æ¥å£ <code>java.lang.reflect.AnnotatedElement</code></strong> ï¼Œè¯¥æ¥å£ä»£è¡¨ç¨‹åºä¸­å¯ä»¥æ¥å—æ³¨è§£çš„ç¨‹åºå…ƒç´ ï¼Œè¯¥æ¥å£ä¸»è¦æœ‰å¦‚ä¸‹å‡ ä¸ªå®ç°ç±»ï¼š</p><ul><li><code>Class</code> - ç±»å®šä¹‰</li><li><code>Constructor</code> - æ„é€ å™¨å®šä¹‰</li><li><code>Field</code> - ç±»çš„æˆå‘˜å˜é‡å®šä¹‰</li><li><code>Method</code> - ç±»çš„æ–¹æ³•å®šä¹‰</li><li><code>Package</code> - ç±»çš„åŒ…å®šä¹‰</li></ul><p><code>java.lang.reflect</code> åŒ…ä¸‹ä¸»è¦åŒ…å«ä¸€äº›å®ç°åå°„åŠŸèƒ½çš„å·¥å…·ç±»ã€‚å®é™…ä¸Šï¼Œ<code>java.lang.reflect</code> åŒ…æ‰€æœ‰æä¾›çš„åå°„ API æ‰©å……äº†è¯»å–è¿è¡Œæ—¶æ³¨è§£ä¿¡æ¯çš„èƒ½åŠ›ã€‚å½“ä¸€ä¸ªæ³¨è§£ç±»å‹è¢«å®šä¹‰ä¸ºè¿è¡Œæ—¶çš„æ³¨è§£åï¼Œè¯¥æ³¨è§£æ‰èƒ½æ˜¯è¿è¡Œæ—¶å¯è§ï¼Œå½“ class æ–‡ä»¶è¢«è£…è½½æ—¶è¢«ä¿å­˜åœ¨ class æ–‡ä»¶ä¸­çš„æ³¨è§£æ‰ä¼šè¢«è™šæ‹Ÿæœºè¯»å–ã€‚ <code>AnnotatedElement</code> æ¥å£æ˜¯æ‰€æœ‰ç¨‹åºå…ƒç´ ï¼ˆClassã€Method å’Œ Constructorï¼‰çš„çˆ¶æ¥å£ï¼Œæ‰€ä»¥ç¨‹åºé€šè¿‡åå°„è·å–äº†æŸä¸ªç±»çš„<code>AnnotatedElement</code> å¯¹è±¡ä¹‹åï¼Œç¨‹åºå°±å¯ä»¥è°ƒç”¨è¯¥å¯¹è±¡çš„å¦‚ä¸‹å››ä¸ªä¸ªæ–¹æ³•æ¥è®¿é—®æ³¨è§£ä¿¡æ¯ï¼š</p><ul><li><code>getAnnotation</code> - è¿”å›è¯¥ç¨‹åºå…ƒç´ ä¸Šå­˜åœ¨çš„ã€æŒ‡å®šç±»å‹çš„æ³¨è§£ï¼Œå¦‚æœè¯¥ç±»å‹æ³¨è§£ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› nullã€‚</li><li><code>getAnnotations</code> - è¿”å›è¯¥ç¨‹åºå…ƒç´ ä¸Šå­˜åœ¨çš„æ‰€æœ‰æ³¨è§£ã€‚</li><li><code>isAnnotationPresent</code> - åˆ¤æ–­è¯¥ç¨‹åºå…ƒç´ ä¸Šæ˜¯å¦åŒ…å«æŒ‡å®šç±»å‹çš„æ³¨è§£ï¼Œå­˜åœ¨åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</li><li><code>getDeclaredAnnotations</code> - è¿”å›ç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šçš„æ‰€æœ‰æ³¨è§£ã€‚ä¸æ­¤æ¥å£ä¸­çš„å…¶ä»–æ–¹æ³•ä¸åŒï¼Œè¯¥æ–¹æ³•å°†å¿½ç•¥ç»§æ‰¿çš„æ³¨è§£ã€‚ï¼ˆå¦‚æœæ²¡æœ‰æ³¨è§£ç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šï¼Œåˆ™è¿”å›é•¿åº¦ä¸ºé›¶çš„ä¸€ä¸ªæ•°ç»„ã€‚ï¼‰è¯¥æ–¹æ³•çš„è°ƒç”¨è€…å¯ä»¥éšæ„ä¿®æ”¹è¿”å›çš„æ•°ç»„ï¼›è¿™ä¸ä¼šå¯¹å…¶ä»–è°ƒç”¨è€…è¿”å›çš„æ•°ç»„äº§ç”Ÿä»»ä½•å½±å“ã€‚</li></ul><p>äº†è§£äº†ä»¥ä¸Šå†…å®¹ï¼Œè®©æˆ‘ä»¬æ¥å®ç° <code>@RegexValid</code> çš„æ³¨è§£å¤„ç†å™¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RegexValidUtil</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        Field[] fields = obj.getClass().getDeclaredFields();</span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æˆå‘˜æ˜¯å¦è¢« @RegexValid æ³¨è§£æ‰€ä¿®é¥°</span></span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(RegexValid.class)) &#123;</span><br><span class="line">                <span class="type">RegexValid</span> <span class="variable">valid</span> <span class="operator">=</span> field.getAnnotation(RegexValid.class);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å¦‚æœ value ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè¯´æ˜æ²¡æœ‰æ³¨å…¥è‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ”¹ç”¨ policy å±æ€§</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> valid.value();</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;&quot;</span>.equals(value)) &#123;</span><br><span class="line">                    RegexValid.<span class="type">Policy</span> <span class="variable">policy</span> <span class="operator">=</span> valid.policy();</span><br><span class="line">                    value = policy.getPolicy();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// é€šè¿‡è®¾ç½® setAccessible(true) æ¥è®¿é—®ç§æœ‰æˆå‘˜</span></span><br><span class="line">                field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                <span class="type">Object</span> <span class="variable">fieldObj</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fieldObj = field.get(obj);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (fieldObj == <span class="literal">null</span>) &#123;</span><br><span class="line">                    sb.append(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">                        .append(String.format(<span class="string">&quot;%s ç±»ä¸­çš„ %s å­—æ®µä¸èƒ½ä¸ºç©ºï¼&quot;</span>, obj.getClass().getName(), field.getName()));</span><br><span class="line">                    result = <span class="literal">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (fieldObj <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">                        <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> (String) fieldObj;</span><br><span class="line">                        <span class="type">Pattern</span> <span class="variable">p</span> <span class="operator">=</span> Pattern.compile(value);</span><br><span class="line">                        <span class="type">Matcher</span> <span class="variable">m</span> <span class="operator">=</span> p.matcher(text);</span><br><span class="line">                        result = m.matches();</span><br><span class="line">                        <span class="keyword">if</span> (!result) &#123;</span><br><span class="line">                            sb.append(<span class="string">&quot;\n&quot;</span>).append(String.format(<span class="string">&quot;%s ä¸æ˜¯åˆæ³•çš„ %s ï¼&quot;</span>, text, field.getName()));</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        sb.append(<span class="string">&quot;\n&quot;</span>).append(</span><br><span class="line">                            String.format(<span class="string">&quot;%s ç±»ä¸­çš„ %s å­—æ®µä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä¸èƒ½ä½¿ç”¨æ­¤æ³¨è§£æ ¡éªŒï¼&quot;</span>, obj.getClass().getName(), field.getName()));</span><br><span class="line">                        result = <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (sb.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(sb.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼š</p><p>ä»¥ä¸Šç¤ºä¾‹ä¸­çš„æ³¨è§£å¤„ç†å™¨ï¼Œæ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>é€šè¿‡ getDeclaredFields åå°„æ–¹æ³•è·å–ä¼ å…¥å¯¹è±¡çš„æ‰€æœ‰æˆå‘˜ã€‚</li><li>éå†æˆå‘˜ï¼Œä½¿ç”¨ isAnnotationPresent åˆ¤æ–­æˆå‘˜æ˜¯å¦è¢«æŒ‡å®šæ³¨è§£æ‰€ä¿®é¥°ï¼Œå¦‚æœä¸æ˜¯ï¼Œç›´æ¥è·³è¿‡ã€‚</li><li>å¦‚æœæˆå‘˜è¢«æ³¨è§£æ‰€ä¿®é¥°ï¼Œé€šè¿‡ <code>RegexValid valid = field.getAnnotation(RegexValid.class);</code> è¿™æ ·çš„å½¢å¼è·å–ï¼Œæ³¨è§£å®ä¾‹åŒ–å¯¹è±¡ï¼Œç„¶åï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>valid.value()</code> æˆ– <code>valid.policy()</code> è¿™æ ·çš„å½¢å¼è·å–æ³¨è§£ä¸­è®¾å®šçš„å±æ€§å€¼ã€‚</li><li>æ ¹æ®å±æ€§å€¼ï¼Œè¿›è¡Œé€»è¾‘å¤„ç†ã€‚</li></ol></blockquote><h3 id="ä½¿ç”¨æ³¨è§£"><a href="#ä½¿ç”¨æ³¨è§£" class="headerlink" title="ä½¿ç”¨æ³¨è§£"></a>ä½¿ç”¨æ³¨è§£</h3><p>å®Œæˆäº†ä»¥ä¸Šå·¥ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£äº†ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RegexValidDemo</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="meta">@RegexValid(policy = RegexValid.Policy.DATE)</span></span><br><span class="line">        <span class="keyword">private</span> String date;</span><br><span class="line">        <span class="meta">@RegexValid(policy = RegexValid.Policy.MAIL)</span></span><br><span class="line">        <span class="keyword">private</span> String mail;</span><br><span class="line">        <span class="meta">@RegexValid(&quot;^((\\+)?86\\s*)?((13[0-9])|(15([0-3]|[5-9]))|(18[0,2,5-9]))\\d&#123;8&#125;$&quot;)</span></span><br><span class="line">        <span class="keyword">private</span> String phone;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, String date, String mail, String phone)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.date = date;</span><br><span class="line">            <span class="built_in">this</span>.mail = mail;</span><br><span class="line">            <span class="built_in">this</span>.phone = phone;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> + <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> + <span class="string">&quot;, date=&#x27;&quot;</span> + date + <span class="string">&#x27;\&#x27;&#x27;</span> + <span class="string">&quot;, mail=&#x27;&quot;</span> + mail + <span class="string">&#x27;\&#x27;&#x27;</span> + <span class="string">&quot;, phone=&#x27;&quot;</span></span><br><span class="line">                + phone + <span class="string">&#x27;\&#x27;&#x27;</span> + <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printDate</span><span class="params">(<span class="meta">@RegexValid(policy = RegexValid.Policy.DATE)</span> String date)</span>&#123;</span><br><span class="line">        System.out.println(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;Tom&quot;</span>, <span class="string">&quot;1990-01-31&quot;</span>, <span class="string">&quot;xxx@163.com&quot;</span>, <span class="string">&quot;18612341234&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;2019-02-29&quot;</span>, <span class="string">&quot;sadhgs&quot;</span>, <span class="string">&quot;183xxxxxxxx&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (RegexValidUtil.check(user)) &#123;</span><br><span class="line">            System.out.println(user + <span class="string">&quot;æ­£åˆ™æ ¡éªŒé€šè¿‡&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (RegexValidUtil.check(user2)) &#123;</span><br><span class="line">            System.out.println(user2 + <span class="string">&quot;æ­£åˆ™æ ¡éªŒé€šè¿‡&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ·±å…¥ç†è§£æ³¨è§£"><a href="#æ·±å…¥ç†è§£æ³¨è§£" class="headerlink" title="æ·±å…¥ç†è§£æ³¨è§£"></a>æ·±å…¥ç†è§£æ³¨è§£</h2><h3 id="æ³¨è§£æ”¯æŒç»§æ‰¿å—ï¼Ÿ"><a href="#æ³¨è§£æ”¯æŒç»§æ‰¿å—ï¼Ÿ" class="headerlink" title="æ³¨è§£æ”¯æŒç»§æ‰¿å—ï¼Ÿ"></a>æ³¨è§£æ”¯æŒç»§æ‰¿å—ï¼Ÿ</h3><blockquote><p>æ³¨è§£æ˜¯ä¸æ”¯æŒç»§æ‰¿çš„</p></blockquote><p>ä¸èƒ½ä½¿ç”¨å…³é”®å­—extendsæ¥ç»§æ‰¿æŸä¸ª@interfaceï¼Œä½†æ³¨è§£åœ¨ç¼–è¯‘åï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç»§æ‰¿java.lang.annotation.Annotationæ¥å£.</p><p>è™½ç„¶åç¼–è¯‘åå‘ç°æ³¨è§£ç»§æ‰¿äº†Annotationæ¥å£ï¼Œè¯·è®°ä½ï¼Œå³ä½¿Javaçš„æ¥å£å¯ä»¥å®ç°å¤šç»§æ‰¿ï¼Œä½†å®šä¹‰æ³¨è§£æ—¶ä¾ç„¶æ— æ³•ä½¿ç”¨extendså…³é”®å­—ç»§æ‰¿@interfaceã€‚</p><p>åŒºåˆ«äºæ³¨è§£çš„ç»§æ‰¿ï¼Œè¢«æ³¨è§£çš„å­ç±»ç»§æ‰¿çˆ¶ç±»æ³¨è§£å¯ä»¥ç”¨@Inheritedï¼š å¦‚æœæŸä¸ªç±»ä½¿ç”¨äº†è¢«@Inheritedä¿®é¥°çš„Annotationï¼Œåˆ™å…¶å­ç±»å°†è‡ªåŠ¨å…·æœ‰è¯¥æ³¨è§£ã€‚</p><h3 id="æ³¨è§£å®ç°çš„åŸç†ï¼Ÿ"><a href="#æ³¨è§£å®ç°çš„åŸç†ï¼Ÿ" class="headerlink" title="æ³¨è§£å®ç°çš„åŸç†ï¼Ÿ"></a>æ³¨è§£å®ç°çš„åŸç†ï¼Ÿ</h3><ul><li><a href="https://blog.csdn.net/qq_20009015/article/details/106038023">https://blog.csdn.net/qq_20009015/article/details/106038023</a></li><li><a href="https://www.race604.com/annotation-processing/">https://www.race604.com/annotation-processing/</a></li></ul><h2 id="æ³¨è§£çš„åº”ç”¨åœºæ™¯"><a href="#æ³¨è§£çš„åº”ç”¨åœºæ™¯" class="headerlink" title="æ³¨è§£çš„åº”ç”¨åœºæ™¯"></a>æ³¨è§£çš„åº”ç”¨åœºæ™¯</h2><h3 id="é…ç½®åŒ–åˆ°æ³¨è§£åŒ–-æ¡†æ¶çš„æ¼”è¿›"><a href="#é…ç½®åŒ–åˆ°æ³¨è§£åŒ–-æ¡†æ¶çš„æ¼”è¿›" class="headerlink" title="é…ç½®åŒ–åˆ°æ³¨è§£åŒ– - æ¡†æ¶çš„æ¼”è¿›"></a>é…ç½®åŒ–åˆ°æ³¨è§£åŒ– - æ¡†æ¶çš„æ¼”è¿›</h3><p>Spring æ¡†æ¶ é…ç½®åŒ–åˆ°æ³¨è§£åŒ–çš„è½¬å˜ã€‚</p><h3 id="ç»§æ‰¿å®ç°åˆ°æ³¨è§£å®ç°-Junit3åˆ°Junit4"><a href="#ç»§æ‰¿å®ç°åˆ°æ³¨è§£å®ç°-Junit3åˆ°Junit4" class="headerlink" title="ç»§æ‰¿å®ç°åˆ°æ³¨è§£å®ç° - Junit3åˆ°Junit4"></a>ç»§æ‰¿å®ç°åˆ°æ³¨è§£å®ç° - Junit3åˆ°Junit4</h3><blockquote><p>ä¸€ä¸ªæ¨¡å—çš„å°è£…å¤§å¤šæ•°äººéƒ½æ˜¯é€šè¿‡ç»§æ‰¿å’Œç»„åˆç­‰æ¨¡å¼æ¥å®ç°çš„ï¼Œä½†æ˜¯å¦‚æœç»“åˆæ³¨è§£å°†å¯ä»¥æå¤§ç¨‹åº¦æé«˜å®ç°çš„ä¼˜é›…åº¦ï¼ˆé™ä½è€¦åˆåº¦ï¼‰ã€‚è€ŒJunit3 åˆ°Junit4çš„æ¼”åŒ–å°±æ˜¯æœ€å¥½çš„ä¸€ä¸ªä¾‹å­ã€‚</p></blockquote><ul><li>è¢«æµ‹è¯•ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> &#123;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span>&#123;</span><br><span class="line"> System.out.println(<span class="string">&quot;hello....&quot;</span>);</span><br><span class="line"> <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NumberFormatException</span>();</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayWorld</span><span class="params">()</span>&#123;</span><br><span class="line"> System.out.println(<span class="string">&quot;world....&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">public</span> String <span class="title function_">say</span><span class="params">()</span>&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="string">&quot;hello world!&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Junit 3 å®ç°UT</li></ul><p>é€šè¿‡ç»§æ‰¿ TestCaseæ¥å®ç°ï¼Œåˆå§‹åŒ–æ˜¯é€šè¿‡Overrideçˆ¶ç±»æ–¹æ³•æ¥è¿›è¡Œï¼Œæµ‹è¯•æ–¹å¼é€šè¿‡testçš„å‰ç¼€æ–¹æ³•è·å–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldTest</span> <span class="keyword">extends</span> <span class="title class_">TestCase</span>&#123;</span><br><span class="line"> <span class="keyword">private</span> HelloWorld hw;</span><br><span class="line"> </span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"> <span class="built_in">super</span>.setUp();</span><br><span class="line"> hw=<span class="keyword">new</span> <span class="title class_">HelloWorld</span>();</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">//1.æµ‹è¯•æ²¡æœ‰è¿”å›å€¼</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testHello</span><span class="params">()</span>&#123;</span><br><span class="line"> <span class="keyword">try</span> &#123;</span><br><span class="line"> hw.sayHello();</span><br><span class="line"> &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"> System.out.println(<span class="string">&quot;å‘ç”Ÿå¼‚å¸¸.....&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testWorld</span><span class="params">()</span>&#123;</span><br><span class="line"> hw.sayWorld();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//2.æµ‹è¯•æœ‰è¿”å›å€¼çš„æ–¹æ³•</span></span><br><span class="line"> <span class="comment">// è¿”å›å­—ç¬¦ä¸²</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSay</span><span class="params">()</span>&#123;</span><br><span class="line"> assertEquals(<span class="string">&quot;æµ‹è¯•å¤±è´¥&quot;</span>, hw.say(), <span class="string">&quot;hello world!&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">//è¿”å›å¯¹è±¡</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testObj</span><span class="params">()</span>&#123;</span><br><span class="line"> assertNull(<span class="string">&quot;æµ‹è¯•å¯¹è±¡ä¸ä¸ºç©º&quot;</span>, <span class="literal">null</span>);</span><br><span class="line"> assertNotNull(<span class="string">&quot;æµ‹è¯•å¯¹è±¡ä¸ºç©º&quot;</span>,<span class="keyword">new</span> <span class="title class_">String</span>());</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">tearDown</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"> <span class="built_in">super</span>.tearDown();</span><br><span class="line"> hw=<span class="literal">null</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Junit 4 å®ç°UT</li></ul><p>é€šè¿‡å®šä¹‰@Beforeï¼Œ@Testï¼Œ@Afterç­‰ç­‰æ³¨è§£æ¥å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldTest</span> &#123;</span><br><span class="line"> <span class="keyword">private</span> HelloWorld hw;</span><br><span class="line"> </span><br><span class="line"> <span class="meta">@Before</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUp</span><span class="params">()</span> &#123;</span><br><span class="line"> hw = <span class="keyword">new</span> <span class="title class_">HelloWorld</span>();</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="meta">@Test(expected=NumberFormatException.class)</span></span><br><span class="line"> <span class="comment">// 1.æµ‹è¯•æ²¡æœ‰è¿”å›å€¼,æœ‰åˆ«äºjunit3çš„ä½¿ç”¨ï¼Œæ›´åŠ æ–¹ä¾¿</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testHello</span><span class="params">()</span> &#123;</span><br><span class="line"> hw.sayHello();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="meta">@Test</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testWorld</span><span class="params">()</span> &#123;</span><br><span class="line"> hw.sayWorld();</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="meta">@Test</span></span><br><span class="line"> <span class="comment">// 2.æµ‹è¯•æœ‰è¿”å›å€¼çš„æ–¹æ³•</span></span><br><span class="line"> <span class="comment">// è¿”å›å­—ç¬¦ä¸²</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSay</span><span class="params">()</span> &#123;</span><br><span class="line"> assertEquals(<span class="string">&quot;æµ‹è¯•å¤±è´¥&quot;</span>, hw.say(), <span class="string">&quot;hello world!&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="meta">@Test</span></span><br><span class="line"> <span class="comment">// è¿”å›å¯¹è±¡</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testObj</span><span class="params">()</span> &#123;</span><br><span class="line"> assertNull(<span class="string">&quot;æµ‹è¯•å¯¹è±¡ä¸ä¸ºç©º&quot;</span>, <span class="literal">null</span>);</span><br><span class="line"> assertNotNull(<span class="string">&quot;æµ‹è¯•å¯¹è±¡ä¸ºç©º&quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>());</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="meta">@After</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">tearDown</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"> hw = <span class="literal">null</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å‘ç°é€šè¿‡æ³¨è§£çš„æ–¹å¼ï¼Œæˆ‘ä»¬å®ç°å•å…ƒæµ‹è¯•æ—¶å°†æ›´ä¸ºä¼˜é›…ã€‚</p><h3 id="è‡ªå®šä¹‰æ³¨è§£å’ŒAOP-é€šè¿‡åˆ‡é¢å®ç°è§£è€¦"><a href="#è‡ªå®šä¹‰æ³¨è§£å’ŒAOP-é€šè¿‡åˆ‡é¢å®ç°è§£è€¦" class="headerlink" title="è‡ªå®šä¹‰æ³¨è§£å’ŒAOP - é€šè¿‡åˆ‡é¢å®ç°è§£è€¦"></a>è‡ªå®šä¹‰æ³¨è§£å’ŒAOP - é€šè¿‡åˆ‡é¢å®ç°è§£è€¦</h3><blockquote><p>æœ€ä¸ºå¸¸è§çš„å°±æ˜¯ä½¿ç”¨Spring AOPåˆ‡é¢å®ç°<strong>ç»Ÿä¸€çš„æ“ä½œæ—¥å¿—ç®¡ç†</strong>ï¼Œæˆ‘è¿™é‡Œæ‰¾äº†ä¸€ä¸ªå¼€æºé¡¹ç›®ä¸­çš„ä¾‹å­ï¼ˆåªå±•ç¤ºä¸»è¦ä»£ç ï¼‰ï¼Œå±•ç¤ºä¸‹å¦‚ä½•é€šè¿‡æ³¨è§£å®ç°è§£è€¦çš„ã€‚</p></blockquote><ul><li>è‡ªå®šä¹‰Logæ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123; ElementType.PARAMETER, ElementType.METHOD &#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Log &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¨¡å— </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">title</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠŸèƒ½</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> BusinessType <span class="title function_">businessType</span><span class="params">()</span> <span class="keyword">default</span> BusinessType.OTHER;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ“ä½œäººç±»åˆ«</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> OperatorType <span class="title function_">operatorType</span><span class="params">()</span> <span class="keyword">default</span> OperatorType.MANAGE;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦ä¿å­˜è¯·æ±‚çš„å‚æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSaveRequestData</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å®ç°æ—¥å¿—çš„åˆ‡é¢, å¯¹è‡ªå®šä¹‰æ³¨è§£Logä½œåˆ‡ç‚¹è¿›è¡Œæ‹¦æˆª</li></ul><p>å³å¯¹æ³¨è§£äº†@Logçš„æ–¹æ³•è¿›è¡Œåˆ‡ç‚¹æ‹¦æˆªï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogAspect</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(LogAspect.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é…ç½®ç»‡å…¥ç‚¹ - è‡ªå®šä¹‰æ³¨è§£çš„åŒ…è·¯å¾„</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;@annotation(com.xxx.aspectj.lang.annotation.Log)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logPointCut</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†å®Œè¯·æ±‚åæ‰§è¡Œ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> joinPoint åˆ‡ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AfterReturning(pointcut = &quot;logPointCut()&quot;, returning = &quot;jsonResult&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAfterReturning</span><span class="params">(JoinPoint joinPoint, Object jsonResult)</span> &#123;</span><br><span class="line">        handleLog(joinPoint, <span class="literal">null</span>, jsonResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‹¦æˆªå¼‚å¸¸æ“ä½œ</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> joinPoint åˆ‡ç‚¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e å¼‚å¸¸</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AfterThrowing(value = &quot;logPointCut()&quot;, throwing = &quot;e&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAfterThrowing</span><span class="params">(JoinPoint joinPoint, Exception e)</span> &#123;</span><br><span class="line">        handleLog(joinPoint, e, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">handleLog</span><span class="params">(<span class="keyword">final</span> JoinPoint joinPoint, <span class="keyword">final</span> Exception e, Object jsonResult)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// è·å¾—æ³¨è§£</span></span><br><span class="line">            <span class="type">Log</span> <span class="variable">controllerLog</span> <span class="operator">=</span> getAnnotationLog(joinPoint);</span><br><span class="line">            <span class="keyword">if</span> (controllerLog == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–å½“å‰çš„ç”¨æˆ·</span></span><br><span class="line">            <span class="type">User</span> <span class="variable">currentUser</span> <span class="operator">=</span> ShiroUtils.getSysUser();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// *========æ•°æ®åº“æ—¥å¿—=========*//</span></span><br><span class="line">            <span class="type">OperLog</span> <span class="variable">operLog</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OperLog</span>();</span><br><span class="line">            operLog.setStatus(BusinessStatus.SUCCESS.ordinal());</span><br><span class="line">            <span class="comment">// è¯·æ±‚çš„åœ°å€</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">ip</span> <span class="operator">=</span> ShiroUtils.getIp();</span><br><span class="line">            operLog.setOperIp(ip);</span><br><span class="line">            <span class="comment">// è¿”å›å‚æ•°</span></span><br><span class="line">            operLog.setJsonResult(JSONObject.toJSONString(jsonResult));</span><br><span class="line"></span><br><span class="line">            operLog.setOperUrl(ServletUtils.getRequest().getRequestURI());</span><br><span class="line">            <span class="keyword">if</span> (currentUser != <span class="literal">null</span>) &#123;</span><br><span class="line">                operLog.setOperName(currentUser.getLoginName());</span><br><span class="line">                <span class="keyword">if</span> (StringUtils.isNotNull(currentUser.getDept())</span><br><span class="line">                        &amp;&amp; StringUtils.isNotEmpty(currentUser.getDept().getDeptName())) &#123;</span><br><span class="line">                    operLog.setDeptName(currentUser.getDept().getDeptName());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123;</span><br><span class="line">                operLog.setStatus(BusinessStatus.FAIL.ordinal());</span><br><span class="line">                operLog.setErrorMsg(StringUtils.substring(e.getMessage(), <span class="number">0</span>, <span class="number">2000</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è®¾ç½®æ–¹æ³•åç§°</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> joinPoint.getTarget().getClass().getName();</span><br><span class="line">            <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> joinPoint.getSignature().getName();</span><br><span class="line">            operLog.setMethod(className + <span class="string">&quot;.&quot;</span> + methodName + <span class="string">&quot;()&quot;</span>);</span><br><span class="line">            <span class="comment">// è®¾ç½®è¯·æ±‚æ–¹å¼</span></span><br><span class="line">            operLog.setRequestMethod(ServletUtils.getRequest().getMethod());</span><br><span class="line">            <span class="comment">// å¤„ç†è®¾ç½®æ³¨è§£ä¸Šçš„å‚æ•°</span></span><br><span class="line">            getControllerMethodDescription(controllerLog, operLog);</span><br><span class="line">            <span class="comment">// ä¿å­˜æ•°æ®åº“</span></span><br><span class="line">            AsyncManager.me().execute(AsyncFactory.recordOper(operLog));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception exp) &#123;</span><br><span class="line">            <span class="comment">// è®°å½•æœ¬åœ°å¼‚å¸¸æ—¥å¿—</span></span><br><span class="line">            log.error(<span class="string">&quot;==å‰ç½®é€šçŸ¥å¼‚å¸¸==&quot;</span>);</span><br><span class="line">            log.error(<span class="string">&quot;å¼‚å¸¸ä¿¡æ¯:&#123;&#125;&quot;</span>, exp.getMessage());</span><br><span class="line">            exp.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ³¨è§£ä¸­å¯¹æ–¹æ³•çš„æè¿°ä¿¡æ¯ ç”¨äºControllerå±‚æ³¨è§£</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> log æ—¥å¿—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> operLog æ“ä½œæ—¥å¿—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getControllerMethodDescription</span><span class="params">(Log log, OperLog operLog)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®actionåŠ¨ä½œ</span></span><br><span class="line">        operLog.setBusinessType(log.businessType().ordinal());</span><br><span class="line">        <span class="comment">// è®¾ç½®æ ‡é¢˜</span></span><br><span class="line">        operLog.setTitle(log.title());</span><br><span class="line">        <span class="comment">// è®¾ç½®æ“ä½œäººç±»åˆ«</span></span><br><span class="line">        operLog.setOperatorType(log.operatorType().ordinal());</span><br><span class="line">        <span class="comment">// æ˜¯å¦éœ€è¦ä¿å­˜requestï¼Œå‚æ•°å’Œå€¼</span></span><br><span class="line">        <span class="keyword">if</span> (log.isSaveRequestData()) &#123;</span><br><span class="line">            <span class="comment">// è·å–å‚æ•°çš„ä¿¡æ¯ï¼Œä¼ å…¥åˆ°æ•°æ®åº“ä¸­ã€‚</span></span><br><span class="line">            setRequestValue(operLog);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–è¯·æ±‚çš„å‚æ•°ï¼Œæ”¾åˆ°logä¸­</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> operLog</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">setRequestValue</span><span class="params">(OperLog operLog)</span> &#123;</span><br><span class="line">        Map&lt;String, String[]&gt; map = ServletUtils.getRequest().getParameterMap();</span><br><span class="line">        <span class="type">String</span> <span class="variable">params</span> <span class="operator">=</span> JSONObject.toJSONString(map);</span><br><span class="line">        operLog.setOperParam(StringUtils.substring(params, <span class="number">0</span>, <span class="number">2000</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦å­˜åœ¨æ³¨è§£ï¼Œå¦‚æœå­˜åœ¨å°±è·å–</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Log <span class="title function_">getAnnotationLog</span><span class="params">(JoinPoint joinPoint)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Signature</span> <span class="variable">signature</span> <span class="operator">=</span> joinPoint.getSignature();</span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">methodSignature</span> <span class="operator">=</span> (MethodSignature) signature;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> methodSignature.getMethod();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (method != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> method.getAnnotation(Log.class);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨@Logæ³¨è§£</li></ul><p>ä»¥ä¸€ä¸ªç®€å•çš„CRUDæ“ä½œä¸ºä¾‹, è¿™é‡Œå±•ç¤ºéƒ¨åˆ†ä»£ç ï¼šæ¯å¯¹â€œéƒ¨é—¨â€è¿›è¡Œæ“ä½œå°±ä¼šäº§ç”Ÿä¸€æ¡æ“ä½œæ—¥å¿—å­˜å…¥æ•°æ®åº“ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/system/dept&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptController</span> <span class="keyword">extends</span> <span class="title class_">BaseController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">prefix</span> <span class="operator">=</span> <span class="string">&quot;system/dept&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IDeptService deptService;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢ä¿å­˜éƒ¨é—¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Log(title = &quot;éƒ¨é—¨ç®¡ç†&quot;, businessType = BusinessType.INSERT)</span></span><br><span class="line">    <span class="meta">@RequiresPermissions(&quot;system:dept:add&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">addSave</span><span class="params">(<span class="meta">@Validated</span> Dept dept)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (UserConstants.DEPT_NAME_NOT_UNIQUE.equals(deptService.checkDeptNameUnique(dept))) &#123;</span><br><span class="line">            <span class="keyword">return</span> error(<span class="string">&quot;æ–°å¢éƒ¨é—¨&#x27;&quot;</span> + dept.getDeptName() + <span class="string">&quot;&#x27;å¤±è´¥ï¼Œéƒ¨é—¨åç§°å·²å­˜åœ¨&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> toAjax(deptService.insertDept(dept));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿å­˜</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Log(title = &quot;éƒ¨é—¨ç®¡ç†&quot;, businessType = BusinessType.UPDATE)</span></span><br><span class="line">    <span class="meta">@RequiresPermissions(&quot;system:dept:edit&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/edit&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">editSave</span><span class="params">(<span class="meta">@Validated</span> Dept dept)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (UserConstants.DEPT_NAME_NOT_UNIQUE.equals(deptService.checkDeptNameUnique(dept))) &#123;</span><br><span class="line">            <span class="keyword">return</span> error(<span class="string">&quot;ä¿®æ”¹éƒ¨é—¨&#x27;&quot;</span> + dept.getDeptName() + <span class="string">&quot;&#x27;å¤±è´¥ï¼Œéƒ¨é—¨åç§°å·²å­˜åœ¨&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(dept.getParentId().equals(dept.getDeptId())) &#123;</span><br><span class="line">            <span class="keyword">return</span> error(<span class="string">&quot;ä¿®æ”¹éƒ¨é—¨&#x27;&quot;</span> + dept.getDeptName() + <span class="string">&quot;&#x27;å¤±è´¥ï¼Œä¸Šçº§éƒ¨é—¨ä¸èƒ½æ˜¯è‡ªå·±&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> toAjax(deptService.updateDept(dept));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Log(title = &quot;éƒ¨é—¨ç®¡ç†&quot;, businessType = BusinessType.DELETE)</span></span><br><span class="line">    <span class="meta">@RequiresPermissions(&quot;system:dept:remove&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/remove/&#123;deptId&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">remove</span><span class="params">(<span class="meta">@PathVariable(&quot;deptId&quot;)</span> Long deptId)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (deptService.selectDeptCount(deptId) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.warn(<span class="string">&quot;å­˜åœ¨ä¸‹çº§éƒ¨é—¨,ä¸å…è®¸åˆ é™¤&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (deptService.checkDeptExistUser(deptId)) &#123;</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.warn(<span class="string">&quot;éƒ¨é—¨å­˜åœ¨ç”¨æˆ·,ä¸å…è®¸åˆ é™¤&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> toAjax(deptService.deleteDeptById(deptId));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åŒæ ·çš„ï¼Œä½ ä¹Ÿå¯ä»¥çœ‹åˆ°æƒé™ç®¡ç†ä¹Ÿæ˜¯é€šè¿‡ç±»ä¼¼çš„æ³¨è§£ï¼ˆ<code>@RequiresPermissions</code>ï¼‰æœºåˆ¶æ¥å®ç°çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡æ³¨è§£+AOPæœ€ç»ˆçš„ç›®æ ‡æ˜¯ä¸ºäº†å®ç°æ¨¡å—çš„è§£è€¦ã€‚</p></blockquote><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/%E6%B3%A8%E8%A7%A3%E7%AE%80%E4%BB%8B.svg" alt="æ³¨è§£ç®€ä»‹"></p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/%E5%86%85%E7%BD%AE%E6%B3%A8%E8%A7%A3.svg" alt="å†…ç½®æ³¨è§£"></p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/%E5%85%83%E6%B3%A8%E8%A7%A3.svg" alt="å…ƒæ³¨è§£"></p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3.svg" alt="è‡ªå®šä¹‰æ³¨è§£"></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ³¨è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDKåŠ¨æ€ä»£ç†å’ŒCglibåŠ¨æ€ä»£ç†</title>
      <link href="/posts/spring_aop.html"/>
      <url>/posts/spring_aop.html</url>
      
        <content type="html"><![CDATA[<p><strong>ä»£ç†æ¨¡å¼</strong>æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œèƒ½å¤Ÿä½¿å¾—åœ¨ä¸ä¿®æ”¹æºç›®æ ‡çš„å‰æä¸‹ï¼Œé¢å¤–æ‰©å±•æºç›®æ ‡çš„åŠŸèƒ½ã€‚å³é€šè¿‡è®¿é—®æºç›®æ ‡çš„ä»£ç†ç±»ï¼Œå†ç”±ä»£ç†ç±»å»è®¿é—®æºç›®æ ‡ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¦æ‰©å±•åŠŸèƒ½ï¼Œå°±æ— éœ€ä¿®æ”¹æºç›®æ ‡çš„ä»£ç äº†ã€‚åªéœ€è¦åœ¨ä»£ç†ç±»ä¸Šå¢åŠ å°±å¯ä»¥äº†ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/2244490621-6140109245c01_fix732.png" alt="2244490621-6140109245c01_fix732"></p><p>åœ¨Javaä¸­ï¼Œä»£ç†åˆåˆ†é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†2ç§ï¼Œå…¶ä¸­åŠ¨æ€ä»£ç†æ ¹æ®ä¸åŒå®ç°åˆåŒºåˆ†åŸºäºæ¥å£çš„çš„åŠ¨æ€ä»£ç†å’ŒåŸºäºå­ç±»çš„åŠ¨æ€ä»£ç†ã€‚</p><p>ä»£ç†ç±»å®Œæˆçš„åŠŸèƒ½ï¼š</p><ul><li>è°ƒç”¨ç›®æ ‡æ–¹æ³•ï¼Œæ‰§è¡Œç›®æ ‡æ–¹æ³•çš„åŠŸèƒ½ã€‚</li><li>åŠŸèƒ½å¢å¼ºï¼Œåœ¨ç›®æ ‡æ–¹æ³•è°ƒç”¨æ—¶ï¼Œå¢åŠ åŠŸèƒ½ã€‚</li></ul><h2 id="é™æ€ä»£ç†"><a href="#é™æ€ä»£ç†" class="headerlink" title="é™æ€ä»£ç†"></a>é™æ€ä»£ç†</h2><p>æ‰€è°“é™æ€ä»£ç†ï¼Œå°±æ˜¯é€šè¿‡<strong>å£°æ˜ä¸€ä¸ªæ˜ç¡®çš„ä»£ç†ç±»</strong>æ¥è®¿é—®æºå¯¹è±¡ã€‚</p><p>æˆ‘ä»¬æœ‰2ä¸ªæ¥å£ï¼ŒPersonå’ŒAnimalã€‚æ¯ä¸ªæ¥å£å„æœ‰2ä¸ªå®ç°ç±»ï¼ŒUMLå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/43042188-6140109a1cbc8.png" alt="43042188-6140109a1cbc8"></p><p>æ¯ä¸ªå®ç°ç±»ä¸­ä»£ç éƒ½å·®ä¸å¤šä¸€è‡´ï¼Œç”¨Studentæ¥ä¸¾ä¾‹ï¼ˆå…¶ä»–ç±»å’Œè¿™ä¸ªå‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">implements</span> <span class="title class_">Person</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">wakeup</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å­¦ç”Ÿ&quot;</span> + name + <span class="string">&quot;æ—©æ™¨é†’æ¥å•¦&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sleep</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å­¦ç”Ÿ&quot;</span> + name + <span class="string">&quot;æ™šä¸Šç¡è§‰å•¦&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡è®¾æˆ‘ä»¬ç°åœ¨è¦åšä¸€ä»¶äº‹ï¼Œå°±æ˜¯åœ¨æ‰€æœ‰çš„å®ç°ç±»è°ƒç”¨<code>wakeup()</code>å‰å¢åŠ ä¸€è¡Œè¾“å‡º<code>æ—©å®‰~</code>ï¼Œè°ƒç”¨<code>sleep()</code>å‰å¢åŠ ä¸€è¡Œè¾“å‡º<code>æ™šå®‰~</code>ã€‚é‚£æˆ‘ä»¬åªéœ€è¦ç¼–å†™2ä¸ªä»£ç†ç±»<code>PersonProxy</code>å’Œ<code>AnimalProxy</code>ï¼š</p><p><strong>PersonProxy:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonProxy</span> <span class="keyword">implements</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Person person;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PersonProxy</span><span class="params">(Person person)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.person = person;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">wakeup</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ—©å®‰~&quot;</span>);</span><br><span class="line">        person.wakeup();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sleep</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ™šå®‰~&quot;</span>);</span><br><span class="line">        person.sleep();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>AnimalProxy:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnimalProxy</span> <span class="keyword">implements</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Animal animal;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AnimalProxy</span><span class="params">(Animal animal)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.animal = animal;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">wakeup</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ—©å®‰~&quot;</span>);</span><br><span class="line">        animal.wakeup();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sleep</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ™šå®‰~&quot;</span>);</span><br><span class="line">        animal.sleep();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æœ€ç»ˆæ‰§è¡Œä»£ç ä¸ºï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">    <span class="type">PersonProxy</span> <span class="variable">studentProxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PersonProxy</span>(student);</span><br><span class="line">    studentProxy.wakeup();</span><br><span class="line">    studentProxy.sleep();</span><br><span class="line"></span><br><span class="line">    <span class="type">Person</span> <span class="variable">doctor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Doctor</span>(<span class="string">&quot;ç‹æ•™æˆ&quot;</span>);</span><br><span class="line">    <span class="type">PersonProxy</span> <span class="variable">doctorProxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PersonProxy</span>(doctor);</span><br><span class="line">    doctorProxy.wakeup();</span><br><span class="line">    doctorProxy.sleep();</span><br><span class="line"></span><br><span class="line">    <span class="type">Animal</span> <span class="variable">dog</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&quot;æ—ºæ—º&quot;</span>);</span><br><span class="line">    <span class="type">AnimalProxy</span> <span class="variable">dogProxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnimalProxy</span>(dog);</span><br><span class="line">    dogProxy.wakeup();</span><br><span class="line">    dogProxy.sleep();</span><br><span class="line"></span><br><span class="line">    <span class="type">Animal</span> <span class="variable">cat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="string">&quot;å’ªå’ª&quot;</span>);</span><br><span class="line">    <span class="type">AnimalProxy</span> <span class="variable">catProxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnimalProxy</span>(cat);</span><br><span class="line">    catProxy.wakeup();</span><br><span class="line">    catProxy.sleep();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">æ—©å®‰~</span><br><span class="line">å­¦ç”Ÿ[å¼ ä¸‰]æ—©æ™¨é†’æ¥å•¦</span><br><span class="line">æ™šå®‰~</span><br><span class="line">å­¦ç”Ÿ[å¼ ä¸‰]æ™šä¸Šç¡è§‰å•¦</span><br><span class="line">æ—©å®‰~</span><br><span class="line">åŒ»ç”Ÿ[ç‹æ•™æˆ]æ—©æ™¨é†’æ¥å•¦</span><br><span class="line">æ™šå®‰~</span><br><span class="line">åŒ»ç”Ÿ[ç‹æ•™æˆ]æ™šä¸Šç¡è§‰å•¦</span><br><span class="line">æ—©å®‰~~</span><br><span class="line">å°ç‹—[æ—ºæ—º]æ—©æ™¨é†’æ¥å•¦</span><br><span class="line">æ™šå®‰~~</span><br><span class="line">å°ç‹—[æ—ºæ—º]æ™šä¸Šç¡è§‰å•¦</span><br><span class="line">æ—©å®‰~~</span><br><span class="line">å°çŒ«[å’ªå’ª]æ—©æ™¨é†’æ¥å•¦</span><br><span class="line">æ™šå®‰~~</span><br><span class="line">å°çŒ«[å’ªå’ª]æ™šä¸Šç¡è§‰å•¦</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨äº†2ä¸ªä»£ç†ç±»ï¼Œåˆ†åˆ«ä»£ç†äº†<code>Person</code>å’Œ<code>Animal</code>æ¥å£ã€‚</p><p>è¿™ç§æ¨¡å¼è™½ç„¶å¥½ç†è§£ï¼Œä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼š</p><ul><li>ä¼šå­˜åœ¨å¤§é‡çš„å†—ä½™çš„ä»£ç†ç±»ï¼Œè¿™é‡Œæ¼”ç¤ºäº†2ä¸ªæ¥å£ï¼Œå¦‚æœæœ‰10ä¸ªæ¥å£ï¼Œå°±å¿…é¡»å®šä¹‰10ä¸ªä»£ç†ç±»ã€‚</li><li>ä¸æ˜“ç»´æŠ¤ï¼Œä¸€æ—¦æ¥å£æ›´æ”¹ï¼Œä»£ç†ç±»å’Œç›®æ ‡ç±»éƒ½éœ€è¦æ›´æ”¹ã€‚</li><li>è‹¥ç±»æ–¹æ³•æ•°é‡è¶Šæ¥è¶Šå¤šçš„æ—¶å€™ï¼Œä»£ç†ç±»çš„ä»£ç é‡ååˆ†åºå¤§çš„ã€‚</li></ul><h2 id="JDKåŠ¨æ€ä»£ç†"><a href="#JDKåŠ¨æ€ä»£ç†" class="headerlink" title="JDKåŠ¨æ€ä»£ç†"></a>JDKåŠ¨æ€ä»£ç†</h2><p>åœ¨ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨JDKçš„åå°„æœºåˆ¶ï¼Œåˆ›å»ºä»£ç†ç±»å¯¹è±¡ï¼Œå¹¶åŠ¨æ€åœ°æŒ‡å®šè¦ä»£ç†çš„ç›®æ ‡ç±»ã€‚</p><p>JDKåŠ¨æ€ä»£ç†çš„å®ç°ä¸»è¦ä¾é ä¸‰ä¸ªç±»ï¼šInvocationHandlerï¼ŒMethodï¼ŒProxyã€‚</p><ul><li><strong>InvocationHandlerï¼ˆè°ƒç”¨å¤„ç†å™¨ï¼‰æ¥å£</strong>ï¼šé‡Œé¢åªæœ‰ä¸€ä¸ªInvoke() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¡¨ç¤ºä»£ç†å¯¹è±¡è¦æ‰§è¡Œçš„åŠŸèƒ½ä»£ç ã€‚ä»£ç†ç±»è¦å®Œæˆçš„åŠŸèƒ½å°±å†™åœ¨invoke() æ–¹æ³•ä¸­ã€‚æ–¹æ³•åŸå‹å¦‚ä¸‹ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>Object proxy</code> è¡¨ç¤ºJDKåˆ›å»ºçš„ä»£ç†å¯¹è±¡ï¼Œæ— éœ€èµ‹å€¼ã€‚<code>Method method</code> è¡¨ç¤ºç›®æ ‡ç±»ä¸­çš„æ–¹æ³•ï¼ŒJDKæä¾›methodå¯¹è±¡ã€‚<code>Object[] args</code> è¡¨ç¤ºç›®æ ‡ç±»ä¸­æ–¹æ³•çš„å‚æ•°ï¼ŒJDKæä¾›çš„ã€‚</p><p>InvocationHandleræ¥å£ï¼šè¡¨ç¤ºä½ çš„ä»£ç†è¦å¹²ä»€ä¹ˆã€‚</p><p><strong>ç”¨æ³•ï¼š</strong>1.åˆ›å»ºç±»å®ç°<code>InvocationHandler</code>æ¥å£ 2.é‡å†™i<code>nvoke()</code> æ–¹æ³•ï¼ŒæŠŠåŸæ¥é™æ€ä»£ç†ç±»è¦å®Œæˆçš„åŠŸèƒ½ï¼Œå†™åœ¨è¿™é‡Œã€‚</p><ul><li><strong>Methodç±»</strong>ï¼š è¡¨ç¤ºæ–¹æ³•ï¼Œç¡®åˆ‡çš„è¯´æ˜¯ç›®æ ‡ç±»ä¸­çš„æ–¹æ³•ã€‚</li></ul><p>ä½œç”¨ï¼šé€šè¿‡Methodå¯ä»¥æ‰§è¡ŒæŸä¸ªç›®æ ‡ç±»çš„æ–¹æ³•ï¼Œ<code>Method.invoke();</code> </p><p><code>method.invoke(ç›®æ ‡å¯¹è±¡ï¼Œæ–¹æ³•çš„å‚æ•°);</code></p><ul><li><strong>Proxyç±»</strong>ï¼šæ ¸å¿ƒçš„å¯¹è±¡ï¼Œç”¨æ¥åˆ›å»ºä»£ç†å¯¹è±¡ã€‚ä¹‹å‰çš„é™æ€ä»£ç†ä¸­éƒ½æ˜¯newç±»çš„æ„é€ æ–¹æ³•ï¼Œç°åœ¨æˆ‘ä»¬æ˜¯ä½¿ç”¨Proxyç±»çš„æ–¹æ³•ï¼Œä»£æ›¿newçš„ä½¿ ç”¨ã€‚</li></ul><p>æ–¹æ³•ï¼šé™æ€æ–¹æ³•<code>newProxyInstance()</code>;</p><p>ä½œç”¨ï¼šåˆ›å»ºä»£ç†å¯¹è±¡ï¼Œç­‰åŒäºé™æ€ä»£ç†ä¸­çš„ç”¨newåˆ›å»ºä»£ç†å¯¹è±¡ã€‚</p><p>æ–¹æ³•åŸå‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">newProxyInstance</span><span class="params">(ClassLoader loader,</span></span><br><span class="line"><span class="params">                                          Class&lt;?&gt;[] interfaces,</span></span><br><span class="line"><span class="params">                                          InvocationHandler h)</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>ClassLoader loader</code> è¡¨ç¤ºç±»åŠ è½½å™¨ï¼Œè´Ÿè´£å‘å†…å­˜ä¸­åŠ è½½å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨åå°„è·å–å¯¹è±¡çš„ClassLoaderã€‚ä¾‹å¦‚ç±»a, <code>a.getClass().getClassLoader()</code>, è¿™é‡Œè¡¨ç¤ºç›®æ ‡å¯¹è±¡çš„ç±»åŠ è½½å™¨ã€‚</p><p><code>Class&lt;?&gt;[] interfaces</code> : æ¥å£ï¼Œç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£ï¼Œä¹Ÿæ˜¯åå°„è·å–çš„ã€‚</p><p><code>InvocationHandler h</code> ï¼š æˆ‘ä»¬è‡ªå·±å†™çš„ï¼Œä»£ç†ç±»è¦å®Œæˆçš„åŠŸèƒ½ã€‚</p><p>è¿”å›å€¼<code>Object</code> ï¼š å°±æ˜¯ç”Ÿæˆçš„ä»£ç†å¯¹è±¡ã€‚</p><p>è¿˜æ˜¯å‰é¢é‚£ä¸ªä¾‹å­ï¼Œç”¨JDKåŠ¨æ€ä»£ç†ç±»å»å®ç°çš„ä»£ç å¦‚ä¸‹ï¼š</p><p><strong>åˆ›å»ºä¸€ä¸ªJdkProxyç±»ï¼Œç”¨äºç»Ÿä¸€ä»£ç†ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdkProxy</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object bean;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">JdkProxy</span><span class="params">(Object bean)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bean = bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> method.getName();</span><br><span class="line">        <span class="keyword">if</span> (methodName.equals(<span class="string">&quot;wakeup&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ—©å®‰~~~&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(methodName.equals(<span class="string">&quot;sleep&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ™šå®‰~~~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> method.invoke(bean, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œä»£ç ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">JdkProxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JdkProxy</span>(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>));</span><br><span class="line">    <span class="comment">// studentæ˜¯ä»£ç†å¯¹è±¡ï¼Œæ˜¯com.sun.proxy.$Proxyç±»å‹çš„</span></span><br><span class="line">    <span class="type">Person</span> <span class="variable">student</span> <span class="operator">=</span> (Person) Proxy.newProxyInstance(proxy.getClass().getClassLoader(), <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Person.class&#125;, proxy);</span><br><span class="line">    <span class="comment">// é€šè¿‡ä»£ç†å¯¹è±¡æ‰§è¡Œæ–¹æ³•è°ƒç”¨ï¼Œæ‰§è¡Œhandlerï¼Œstudent.wakeup(),æ­¤æ—¶æ‰§è¡Œçš„æ˜¯proxyå¯¹è±¡ä¸­çš„invoke()æ–¹æ³•</span></span><br><span class="line">    student.wakeup();</span><br><span class="line">    student.sleep();</span><br><span class="line"></span><br><span class="line">    proxy = <span class="keyword">new</span> <span class="title class_">JdkProxy</span>(<span class="keyword">new</span> <span class="title class_">Doctor</span>(<span class="string">&quot;ç‹æ•™æˆ&quot;</span>));</span><br><span class="line">    <span class="type">Person</span> <span class="variable">doctor</span> <span class="operator">=</span> (Person) Proxy.newProxyInstance(proxy.getClass().getClassLoader(), <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Person.class&#125;, proxy);</span><br><span class="line">    doctor.wakeup();</span><br><span class="line">    doctor.sleep();</span><br><span class="line"></span><br><span class="line">    proxy = <span class="keyword">new</span> <span class="title class_">JdkProxy</span>(<span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&quot;æ—ºæ—º&quot;</span>));</span><br><span class="line">    <span class="type">Animal</span> <span class="variable">dog</span> <span class="operator">=</span> (Animal) Proxy.newProxyInstance(proxy.getClass().getClassLoader(), <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Animal.class&#125;, proxy);</span><br><span class="line">    dog.wakeup();</span><br><span class="line">    dog.sleep();</span><br><span class="line"></span><br><span class="line">    proxy = <span class="keyword">new</span> <span class="title class_">JdkProxy</span>(<span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="string">&quot;å’ªå’ª&quot;</span>));</span><br><span class="line">    <span class="type">Animal</span> <span class="variable">cat</span> <span class="operator">=</span> (Animal) Proxy.newProxyInstance(proxy.getClass().getClassLoader(), <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Animal.class&#125;, proxy);</span><br><span class="line">    cat.wakeup();</span><br><span class="line">    cat.sleep();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œç›¸å¯¹äºé™æ€ä»£ç†ç±»æ¥è¯´ï¼Œæ— è®ºæœ‰å¤šå°‘æ¥å£ï¼Œè¿™é‡Œåªéœ€è¦ä¸€ä¸ªä»£ç†ç±»ã€‚æ ¸å¿ƒä»£ç ä¹Ÿå¾ˆç®€å•ã€‚å”¯ä¸€éœ€è¦æ³¨æ„çš„ç‚¹æœ‰ä»¥ä¸‹2ç‚¹ï¼š</p><ul><li>JDKåŠ¨æ€ä»£ç†æ˜¯éœ€è¦å£°æ˜æ¥å£çš„ï¼Œåˆ›å»ºä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»å¿…é¡»å¾—ç»™è¿™ä¸ªâ€è™šæ‹Ÿâ€œçš„ç±»ä¸€ä¸ªæ¥å£ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ—¶å€™ç»åŠ¨æ€ä»£ç†ç±»åˆ›é€ ä¹‹åçš„æ¯ä¸ªbeanå·²ç»ä¸æ˜¯åŸæ¥é‚£ä¸ªå¯¹è±¡äº†ã€‚</li></ul><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/2796530636-614010da5d63f_fix732.png" alt="2796530636-614010da5d63f_fix732"></p><ul><li>ä¸ºä»€ä¹ˆè¿™é‡Œ<code>JdkProxy</code>è¿˜éœ€è¦æ„é€ ä¼ å…¥åŸæœ‰çš„beanå‘¢ï¼Ÿå› ä¸ºå¤„ç†å®Œé™„åŠ çš„åŠŸèƒ½å¤–ï¼Œéœ€è¦æ‰§è¡ŒåŸæœ‰beançš„æ–¹æ³•ï¼Œä»¥å®Œæˆ<code>ä»£ç†</code>çš„èŒè´£ã€‚</li></ul><p>è¿™é‡Œ<code>JdkProxy</code>æœ€æ ¸å¿ƒçš„æ–¹æ³•å°±æ˜¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable</span><br></pre></td></tr></table></figure><p>å…¶ä¸­proxyä¸ºä»£ç†è¿‡ä¹‹åçš„å¯¹è±¡(å¹¶ä¸æ˜¯ç›®æ ‡å¯¹è±¡)ï¼Œmethodä¸ºè¢«ä»£ç†çš„æ–¹æ³•ï¼Œargsä¸ºæ–¹æ³•çš„å‚æ•°ã€‚</p><p>å¦‚æœä½ ä¸ä¼ åŸæœ‰çš„beanï¼Œç›´æ¥ç”¨<code>method.invoke(proxy, args)</code>çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šé™·å…¥ä¸€ä¸ªæ­»å¾ªç¯ã€‚</p><h3 id="å¯ä»¥ä»£ç†ä»€ä¹ˆï¼Ÿ"><a href="#å¯ä»¥ä»£ç†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="å¯ä»¥ä»£ç†ä»€ä¹ˆï¼Ÿ"></a>å¯ä»¥ä»£ç†ä»€ä¹ˆï¼Ÿ</h3><p>JDKçš„åŠ¨æ€ä»£ç†æ˜¯ä¹Ÿå¹³æ—¶å¤§å®¶ä½¿ç”¨çš„æœ€å¤šçš„ä¸€ç§ä»£ç†æ–¹å¼ã€‚ä¹Ÿå«åšæ¥å£ä»£ç†ã€‚</p><p>JDKåŠ¨æ€ä»£ç†è¯´ç™½äº†åªæ˜¯æ ¹æ®æ¥å£â€å‡­ç©ºâ€œæ¥ç”Ÿæˆç±»ï¼Œè‡³äºå…·ä½“çš„æ‰§è¡Œï¼Œéƒ½è¢«ä»£ç†åˆ°äº†<code>InvocationHandler</code> çš„å®ç°ç±»é‡Œã€‚ä¸Šè¿°ä¾‹å­æˆ‘æ˜¯éœ€è¦ç»§ç»­æ‰§è¡ŒåŸæœ‰beançš„é€»è¾‘ï¼Œæ‰å°†åŸæœ‰çš„beanæ„é€ è¿›æ¥ã€‚åªè¦ä½ éœ€è¦ï¼Œä½ å¯ä»¥æ„é€ è¿›ä»»ä½•å¯¹è±¡åˆ°è¿™ä¸ªä»£ç†å®ç°ç±»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥ä¼ å…¥å¤šä¸ªå¯¹è±¡ï¼Œæˆ–è€…è¯´ä½ ä»€ä¹ˆç±»éƒ½ä¸ä»£ç†ã€‚åªæ˜¯ä¸ºæŸä¸€ä¸ªæ¥å£â€å‡­ç©ºâ€œçš„ç”Ÿæˆå¤šä¸ªä»£ç†å®ä¾‹ï¼Œè¿™å¤šä¸ªä»£ç†å®ä¾‹æœ€ç»ˆéƒ½ä¼šè¿›å…¥<code>InvocationHandler</code>çš„å®ç°ç±»æ¥æ‰§è¡ŒæŸä¸€ä¸ªæ®µå…±åŒçš„ä»£ç ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨ä»¥å¾€çš„é¡¹ç›®ä¸­çš„ä¸€ä¸ªå®é™…åœºæ™¯å°±æ˜¯ï¼Œæˆ‘æœ‰å¤šä¸ªä»¥y amlå®šä¹‰çš„è§„åˆ™æ–‡ä»¶ï¼Œé€šè¿‡å¯¹yamlæ–‡ä»¶çš„æ‰«æï¼Œæ¥ä¸ºæ¯ä¸ªyamlè§„åˆ™æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»ã€‚è€Œå®ç°è¿™ä¸ªï¼Œæˆ‘åªéœ€è¦äº‹å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œå’Œå®šä¹‰<code>InvocationHandler</code>çš„å®ç°ç±»å°±å¯ä»¥äº†ï¼ŒåŒæ—¶æŠŠyamlè§£æè¿‡çš„å¯¹è±¡ä¼ å…¥ã€‚æœ€ç»ˆè¿™äº›åŠ¨æ€ä»£ç†ç±»éƒ½ä¼šè¿›å…¥<code>invoke</code>æ–¹æ³•æ¥æ‰§è¡ŒæŸä¸ªå…±åŒçš„é€»è¾‘ã€‚</p><h3 id="ä»£ç†å¯¹è±¡ç”±è°äº§ç”Ÿï¼Ÿ"><a href="#ä»£ç†å¯¹è±¡ç”±è°äº§ç”Ÿï¼Ÿ" class="headerlink" title="ä»£ç†å¯¹è±¡ç”±è°äº§ç”Ÿï¼Ÿ"></a>ä»£ç†å¯¹è±¡ç”±è°äº§ç”Ÿï¼Ÿ</h3><p>JVMï¼Œä¸åƒé™æ€ä»£ç†ï¼Œæˆ‘ä»¬å¾—è‡ªå·±newä¸ªä»£ç†å¯¹è±¡ã€‚</p><h3 id="ä»£ç†å¯¹è±¡å®ç°äº†ä»€ä¹ˆæ¥å£ï¼Ÿ"><a href="#ä»£ç†å¯¹è±¡å®ç°äº†ä»€ä¹ˆæ¥å£ï¼Ÿ" class="headerlink" title="ä»£ç†å¯¹è±¡å®ç°äº†ä»€ä¹ˆæ¥å£ï¼Ÿ"></a>ä»£ç†å¯¹è±¡å®ç°äº†ä»€ä¹ˆæ¥å£ï¼Ÿ</h3><p>å®ç°çš„æ¥å£æ˜¯ç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£ã€‚ åŒé™æ€ä»£ç†ä¸­ä»£ç†å¯¹è±¡å®ç°çš„æ¥å£ã€‚é‚£ä¸ªç»§æ‰¿å…³ç³»å›¾è¿˜æ˜¯ç›¸åŒçš„ã€‚ ä»£ç†å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡éƒ½å®ç°ä¸€ä¸ªå…±åŒçš„æ¥å£ã€‚å°±æ˜¯è¿™ä¸ªæ¥å£ã€‚ æ‰€ä»¥Proxy.newProxyInstance()æ–¹æ³•è¿”å›çš„ç±»å‹å°±æ˜¯è¿™ä¸ªæ¥å£ç±»å‹ã€‚</p><h3 id="ä»£ç†å¯¹è±¡çš„æ–¹æ³•ä½“æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä»£ç†å¯¹è±¡çš„æ–¹æ³•ä½“æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä»£ç†å¯¹è±¡çš„æ–¹æ³•ä½“æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ä»£ç†å¯¹è±¡çš„æ–¹æ³•ä½“æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ä»£ç†å¯¹è±¡çš„æ–¹æ³•ä½“ä¸­çš„å†…å®¹å°±æ˜¯æ‹¦æˆªå™¨ä¸­invokeæ–¹æ³•ä¸­çš„å†…å®¹ã€‚</p><p>æ‰€æœ‰ä»£ç†å¯¹è±¡çš„å¤„ç†é€»è¾‘ï¼Œæ§åˆ¶æ˜¯å¦æ‰§è¡Œç›®æ ‡å¯¹è±¡çš„ç›®æ ‡æ–¹æ³•ã€‚éƒ½æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢å¤„ç†çš„ã€‚</p><h3 id="æ‹¦æˆªå™¨ä¸­çš„invokeæ–¹æ³•ä¸­çš„methodå‚æ•°æ˜¯åœ¨ä»€ä¹ˆæ—¶å€™èµ‹å€¼çš„"><a href="#æ‹¦æˆªå™¨ä¸­çš„invokeæ–¹æ³•ä¸­çš„methodå‚æ•°æ˜¯åœ¨ä»€ä¹ˆæ—¶å€™èµ‹å€¼çš„" class="headerlink" title="æ‹¦æˆªå™¨ä¸­çš„invokeæ–¹æ³•ä¸­çš„methodå‚æ•°æ˜¯åœ¨ä»€ä¹ˆæ—¶å€™èµ‹å€¼çš„?"></a>æ‹¦æˆªå™¨ä¸­çš„invokeæ–¹æ³•ä¸­çš„methodå‚æ•°æ˜¯åœ¨ä»€ä¹ˆæ—¶å€™èµ‹å€¼çš„?</h3><p>åœ¨å®¢æˆ·ç«¯ï¼Œä»£ç†å¯¹è±¡è°ƒç”¨ç›®æ ‡æ–¹æ³•çš„æ—¶å€™ï¼Œæ­¤å®ä¾‹ä¸­ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">student.wakeup();</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šè¿›å…¥çš„æ˜¯æ‹¦æˆªå™¨ä¸­çš„invokeæ–¹æ³•ï¼Œè¿™æ—¶æ‹¦æˆªå™¨ä¸­çš„invokeæ–¹æ³•ä¸­çš„methodå‚æ•°ä¼šè¢«èµ‹å€¼ã€‚</p><h3 id="ä¸ºä»€ä¹ˆå«JDKåŠ¨æ€ä»£ç†ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå«JDKåŠ¨æ€ä»£ç†ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå«JDKåŠ¨æ€ä»£ç†ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå«JDKåŠ¨æ€ä»£ç†ï¼Ÿ</h3><h2 id="CGLibåŠ¨æ€ä»£ç†"><a href="#CGLibåŠ¨æ€ä»£ç†" class="headerlink" title="CGLibåŠ¨æ€ä»£ç†"></a>CGLibåŠ¨æ€ä»£ç†</h2><p>CGLIB(Code Generation Library) æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ã€‚æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ã€é«˜æ€§èƒ½ã€é«˜è´¨é‡çš„Codeç”Ÿæˆç±»åº“ï¼Œå®ƒå¯ä»¥åœ¨è¿è¡ŒæœŸæ‹“å±•Javaç±»ä¸å®ç°Javaæ¥å£ã€‚å®ƒå¹¿æ³›åœ°è¢«è®¸å¤šAOPæ¡†æ¶ä½¿ç”¨ï¼Œä¾‹å¦‚Spring AOPã€‚</p><p>ä½¿ç”¨JDKçš„Proxyå®ç°ä»£ç†ï¼Œè¦æ±‚ç›®æ ‡ç±»ä¸ä»£ç†ç±»å®ç°ç›¸åŒçš„æ¥å£ã€‚è‹¥ç›®æ ‡ç±»ä¸å­˜åœ¨æ¥å£ï¼Œåˆ™æ— æ³•ä½¿ç”¨è¯¥æ–¹å¼å®ç°ã€‚</p><p>ä½†å¯¹äºæ— æ¥å£çš„ç±»ï¼Œè¦ä¸ºæœŸåˆ›å»ºåŠ¨æ€ä»£ç†ï¼Œå°±è¦ä½¿ç”¨CGLIBæ¥å®ç°ã€‚CGLIBä»£ç†çš„ç”ŸæˆåŸç†æ˜¯ç”Ÿæˆç›®æ ‡ç±»çš„å­ç±»ï¼Œé€šè¿‡å­ç±»å¯¹ç›®æ ‡ç±»çš„å¢å¼ºã€‚è¿™ä¸ªå­ç±»å°±æ˜¯ä»£ç†å¯¹è±¡ã€‚æ‰€ä»¥ï¼Œä½¿ç”¨CGLIBç”ŸæˆåŠ¨æ€ä»£ç†ï¼Œè¦æ±‚ç›®æ ‡ç±»å¿…é¡»èƒ½è¢«ç»§æ‰¿ï¼Œå³ä¸èƒ½æ˜¯finalä¿®é¥°çš„ç±»ã€‚</p><p>CGLIBç»å¸¸è¢«åº”ç”¨åœ¨æ¡†æ¶ä¸­ï¼Œä¾‹å¦‚Spring,Hibernateç­‰ã€‚Cglibçš„ä»£ç†æ•ˆç‡é«˜äºJDKã€‚å¯¹äºCglibä¸€èˆ¬çš„å¼€å‘ä¸­å¹¶ä¸ä½¿ç”¨ã€‚</p><p>Springåœ¨5.Xä¹‹å‰é»˜è®¤çš„åŠ¨æ€ä»£ç†å®ç°ä¸€ç›´æ˜¯jdkåŠ¨æ€ä»£ç†ã€‚ä½†æ˜¯ä»5.Xå¼€å§‹ï¼Œspringå°±å¼€å§‹é»˜è®¤ä½¿ç”¨Cglibæ¥ä½œä¸ºåŠ¨æ€ä»£ç†å®ç°ã€‚å¹¶ä¸”springbootä»2.Xå¼€å§‹ä¹Ÿè½¬å‘äº†CglibåŠ¨æ€ä»£ç†å®ç°ã€‚</p><p>æ˜¯ä»€ä¹ˆå¯¼è‡´äº†springä½“ç³»æ•´ä½“è½¬æŠ•Cglibå‘¢ï¼ŒjdkåŠ¨æ€ä»£ç†åˆæœ‰ä»€ä¹ˆç¼ºç‚¹å‘¢ï¼Ÿ</p><p>é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å°±è¦æ¥è¯´ä¸‹Cglibçš„åŠ¨æ€ä»£ç†ã€‚</p><p>Cglibæ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå®ƒçš„åº•å±‚æ˜¯å­—èŠ‚ç å¤„ç†æ¡†æ¶ASMï¼ŒCglibæä¾›äº†æ¯”jdkæ›´ä¸ºå¼ºå¤§çš„åŠ¨æ€ä»£ç†ã€‚ä¸»è¦ç›¸æ¯”jdkåŠ¨æ€ä»£ç†çš„ä¼˜åŠ¿æœ‰ï¼š</p><ul><li>jdkåŠ¨æ€ä»£ç†åªèƒ½åŸºäºæ¥å£ï¼Œä»£ç†ç”Ÿæˆçš„å¯¹è±¡åªèƒ½èµ‹å€¼ç»™æ¥å£å˜é‡ï¼Œè€ŒCglibå°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼ŒCglibæ˜¯é€šè¿‡ç”Ÿæˆå­ç±»æ¥å®ç°çš„ï¼Œä»£ç†å¯¹è±¡æ—¢å¯ä»¥èµ‹å€¼ç»™å®ç°ç±»ï¼Œåˆå¯ä»¥èµ‹å€¼ç»™æ¥å£ã€‚</li><li>Cglibé€Ÿåº¦æ¯”jdkåŠ¨æ€ä»£ç†æ›´å¿«ï¼Œæ€§èƒ½æ›´å¥½ã€‚</li></ul><p>é‚£ä½•è°“é€šè¿‡å­ç±»æ¥å®ç°å‘¢ï¼Ÿ</p><p>è¿˜æ˜¯å‰é¢é‚£ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è¦å®ç°ç›¸åŒçš„æ•ˆæœã€‚ä»£ç å¦‚ä¸‹</p><p><strong>åˆ›å»ºCglibProxyç±»ï¼Œç”¨äºç»Ÿä¸€ä»£ç†ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.cglib.proxy.Enhancer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cglib.proxy.MethodInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cglib.proxy.MethodProxy;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CglibProxy</span> <span class="keyword">implements</span> <span class="title class_">MethodInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Enhancer</span> <span class="variable">enhancer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Enhancer</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object bean;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CglibProxy</span><span class="params">(Object bean)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bean = bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//è®¾ç½®éœ€è¦åˆ›å»ºå­ç±»çš„ç±»</span></span><br><span class="line">        enhancer.setSuperclass(bean.getClass());</span><br><span class="line">        enhancer.setCallback(<span class="built_in">this</span>);</span><br><span class="line">        <span class="comment">//é€šè¿‡å­—èŠ‚ç æŠ€æœ¯åŠ¨æ€åˆ›å»ºå­ç±»å®ä¾‹</span></span><br><span class="line">        <span class="keyword">return</span> enhancer.create();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®ç°MethodInterceptoræ¥å£æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Object obj, Method method, Object[] args, MethodProxy proxy)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> method.getName();</span><br><span class="line">        <span class="keyword">if</span> (methodName.equals(<span class="string">&quot;wakeup&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ—©å®‰~~~&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(methodName.equals(<span class="string">&quot;sleep&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ™šå®‰~~~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è°ƒç”¨åŸbeançš„æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">return</span> method.invoke(bean,args);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œä»£ç ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">CglibProxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CglibProxy</span>(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>));</span><br><span class="line">    <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> (Student) proxy.getProxy();</span><br><span class="line">    student.wakeup();</span><br><span class="line">    student.sleep();</span><br><span class="line"></span><br><span class="line">    proxy = <span class="keyword">new</span> <span class="title class_">CglibProxy</span>(<span class="keyword">new</span> <span class="title class_">Doctor</span>(<span class="string">&quot;ç‹æ•™æˆ&quot;</span>));</span><br><span class="line">    <span class="type">Doctor</span> <span class="variable">doctor</span> <span class="operator">=</span> (Doctor) proxy.getProxy();</span><br><span class="line">    doctor.wakeup();</span><br><span class="line">    doctor.sleep();</span><br><span class="line"></span><br><span class="line">    proxy = <span class="keyword">new</span> <span class="title class_">CglibProxy</span>(<span class="keyword">new</span> <span class="title class_">Dog</span>(<span class="string">&quot;æ—ºæ—º&quot;</span>));</span><br><span class="line">    <span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> (Dog) proxy.getProxy();</span><br><span class="line">    dog.wakeup();</span><br><span class="line">    dog.sleep();</span><br><span class="line"></span><br><span class="line">    proxy = <span class="keyword">new</span> <span class="title class_">CglibProxy</span>(<span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="string">&quot;å’ªå’ª&quot;</span>));</span><br><span class="line">    <span class="type">Cat</span> <span class="variable">cat</span> <span class="operator">=</span> (Cat) proxy.getProxy();</span><br><span class="line">    cat.wakeup();</span><br><span class="line">    cat.sleep();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œç”¨Cglibä½œä¸ºä»£ç†ï¼Œå…¶æ€è·¯å’ŒjdkåŠ¨æ€ä»£ç†å·®ä¸å¤šã€‚ä¹Ÿéœ€è¦æŠŠåŸå§‹beanæ„é€ ä¼ å…¥ã€‚</p><p>å…³é”®çš„ä»£ç åœ¨è¿™é‡Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è®¾ç½®éœ€è¦åˆ›å»ºå­ç±»çš„ç±»</span></span><br><span class="line">enhancer.setSuperclass(bean.getClass());</span><br><span class="line">enhancer.setCallback(<span class="built_in">this</span>);</span><br><span class="line"><span class="comment">//é€šè¿‡å­—èŠ‚ç æŠ€æœ¯åŠ¨æ€åˆ›å»ºå­ç±»å®ä¾‹</span></span><br><span class="line"><span class="keyword">return</span> enhancer.create();</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒCglibâ€å‡­ç©ºâ€çš„åˆ›é€ äº†ä¸€ä¸ªåŸbeançš„å­ç±»ï¼Œå¹¶æŠŠCallbackæŒ‡å‘äº†thisï¼Œä¹Ÿå°±æ˜¯å½“å‰å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªproxyå¯¹è±¡ã€‚ä»è€Œä¼šè°ƒç”¨<code>intercept</code>æ–¹æ³•ã€‚è€Œåœ¨<code>intercept</code>æ–¹æ³•é‡Œï¼Œè¿›è¡Œäº†é™„åŠ åŠŸèƒ½çš„æ‰§è¡Œï¼Œæœ€åè¿˜æ˜¯è°ƒç”¨äº†åŸå§‹beançš„ç›¸åº”æ–¹æ³•ã€‚</p><p>åœ¨debugè¿™ä¸ªç”Ÿæˆçš„ä»£ç†å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½çœ‹åˆ°ï¼ŒCglibæ˜¯å‡­ç©ºç”Ÿæˆäº†åŸå§‹beançš„å­ç±»ï¼š</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1853665691-614010e6b05ac_fix732.png" alt="1853665691-614010e6b05ac_fix732"></p>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äº‹åŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BTCä¸­çš„æ•°æ®ç»“æ„</title>
      <link href="/posts/ds_btc.html"/>
      <url>/posts/ds_btc.html</url>
      
        <content type="html"><![CDATA[<h3 id="Hash-Pointer"><a href="#Hash-Pointer" class="headerlink" title="Hash Pointer"></a>Hash Pointer</h3><p>åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œéœ€è¦ç”¨åˆ°æ•°æ®ã€‚æœ€ç®€å•çš„æ˜¯ç›´æ¥è·å–æ•°æ®ï¼Œä½†å½“æ•°æ®æœ¬èº«è¾ƒå¤§ï¼Œéœ€è¦å ç”¨è¾ƒå¤§ç©ºé—´æ—¶ï¼Œæ˜æ˜¾ä¼šé€ æˆä¸€å®šéº»çƒ¦ã€‚å› æ­¤ï¼Œå¯ä»¥å¼•å…¥æŒ‡é’ˆè¿™ä¸€æ¦‚å¿µã€‚å½“éœ€è¦è·å–æ•°æ®æ—¶ï¼Œåªéœ€è¦æŒ‰ç…§æŒ‡é’ˆæ‰€ç»™çš„åœ°å€ï¼Œå»å¯¹åº”çš„ä½ç½®è¯»å–æ•°æ®å³å¯ï¼Œè¿™æ ·å¤§å¤§èŠ‚çœäº†å†…å­˜ç©ºé—´ã€‚åœ¨å®é™…ä¸­ï¼Œä¸ºäº†ä¾¿äºç¨‹åºç§»æ¤æ€§ç­‰åŸå› ï¼ŒæŒ‡é’ˆå®é™…ä¸Šå­˜å‚¨çš„æ˜¯é€»è¾‘åœ°å€è€Œéç‰©ç†åœ°å€ã€‚<br>åŒºå—é“¾ç»“æ„æœ¬èº«ä¸ºä¸€æ¡é“¾è¡¨ï¼ŒèŠ‚ç‚¹ä¸ºåŒºå—ã€‚è€Œä¼ ç»Ÿé“¾è¡¨å®ç°ï¼Œä¾¿æ˜¯é€šè¿‡æŒ‡é’ˆå°†å„ä¸ªèŠ‚ç‚¹ä¸²è”èµ·æ¥è€Œç§°ä¸ºæœ€ç»ˆçš„é“¾ã€‚å¦‚ä¸‹ä¾¿æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ä¸€ä¸ªé“¾è¡¨ï¼š</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/20200214173054674.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä½†åœ¨åŒºå—é“¾ç³»ç»Ÿä¸­ï¼Œå¹¶æœªé‡‡ç”¨æŒ‡é’ˆï¼Œè€Œæ˜¯ä½¿ç”¨äº†<strong>å“ˆå¸ŒæŒ‡é’ˆ</strong>ã€‚<br>å¦‚ä¸‹å›¾å¯¹äºè¯¥èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘è¿™ä¸ªèŠ‚ç‚¹ï¼ˆå®é™…ä¸Šä¸ºä¸€ä¸ªï¼‰ï¼Œå…¶ä¸­Pä¸ºè¯¥èŠ‚ç‚¹çš„åœ°å€ï¼ŒH()ä¸ºè¯¥èŠ‚ç‚¹çš„å“ˆå¸Œå€¼ï¼Œè¯¥å€¼ä¸èŠ‚ç‚¹ä¸­å†…å®¹æœ‰å…³ã€‚å½“èŠ‚ç‚¹ï¼ˆåŒºå—ï¼‰ä¸­å†…å®¹å‘ç”Ÿæ”¹å˜ï¼Œè¯¥å“ˆå¸Œå€¼ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜ï¼Œä»è€Œä¿è¯äº†åŒºå—å†…å®¹ä¸èƒ½è¢«ç¯¡æ”¹ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/20200214173157391.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åœ¨æ¯”ç‰¹å¸ä¸­ï¼Œå…¶æœ€åŸºæœ¬çš„æ•°æ®ç»“æ„ä¾¿æ˜¯ä¸€ä¸ªä¸ªåŒºå—å½¢æˆçš„åŒºå—é“¾ã€‚</p><p><strong>åŒºå—é“¾ä¸é“¾è¡¨åŒºåˆ«ï¼š</strong>å“ˆå¸ŒæŒ‡é’ˆä»£æ›¿æ™®é€šæŒ‡é’ˆ<br>å¦‚å›¾ä¸ºä¸€ä¸ªç®€å•çš„åŒºå—é“¾ã€‚å…¶ä¸­ï¼Œæ¯ä¸ªåŒºå—æ ¹æ®è‡ªå·±çš„åŒºå—å†…å®¹ç”Ÿæˆè‡ªå·±çš„å“ˆå¸Œå€¼ï¼Œæ­¤å¤–ï¼Œæ¯ä¸ªåŒºå—ï¼ˆé™¤åˆ›ä¸–çºªå—ï¼‰éƒ½ä¿å­˜æœ‰å‰ä¸€ä¸ªåŒºå—çš„å“ˆå¸Œå€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ¬åŒºå—å“ˆå¸Œç”Ÿæˆä¾èµ–äºæœ¬åŒºå—å†…å®¹ï¼Œè€Œæœ¬åŒºå—å†…å®¹ä¸­åˆåŒ…å«æœ‰å‰ä¸€ä¸ªåŒºå—çš„å“ˆå¸Œå€¼ã€‚ä»è€Œä¿è¯äº†åŒºå—å†…å®¹ä¸è¢«ç¯¡æ”¹ã€‚<br>å¦‚å›¾ä¸­æ‰€ç¤ºï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ç ´ååŒºå—é“¾å®Œæ•´æ€§ã€‚ç¯¡æ”¹Bçš„å†…å®¹ï¼Œè€ŒCä¸­ä¿å­˜æœ‰Bçš„å“ˆå¸Œå€¼ï¼Œæ‰€ä»¥Cä¹Ÿå¾—è¿›è¡Œä¿®æ”¹ã€‚è€ŒåŒæ ·CååŒºå—ä¹Ÿå¾—ä¿®æ”¹ã€‚è€Œç”¨æˆ·åªéœ€è¦è®°ä½æœ€åä¸€ä¸ªåŒºå—é“¾çš„å“ˆå¸Œåœ°å€ï¼Œå°±å¯ä»¥æ£€æµ‹åŒºå—é“¾ä¸Šå†…å®¹æ˜¯å¦è¢«ç¯¡æ”¹ã€‚<br>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸€æ•´æ¡é“¾å¯èƒ½ä¼šè¢«åˆ‡æ–­åˆ†å¼€ä¿å­˜åœ¨å¤šä¸ªåœ°æ–¹ã€‚è‹¥ç”¨æˆ·ä»…ä»…å…·æœ‰å…¶ä¸­ä¸€æ®µï¼Œå½“ç”¨åˆ°å‰é¢éƒ¨åˆ†åŒºå—æ•°æ®æ—¶ï¼Œç›´æ¥é—®ç³»ç»Ÿä¸­å…¶ä»–èŠ‚ç‚¹è¦å³å¯ï¼Œå½“è¦åˆ°ä¹‹åï¼Œä»…ä»…é€šè¿‡è®¡ç®—è¦åˆ°çš„æœ€åä¸€ä¸ªå“ˆå¸Œå€¼å’Œè‡ªå·±ä¿å­˜å“ˆå¸Œå€¼æ˜¯å¦ä¸€è‡´å¯ä»¥åˆ¤æ–­æ‰€ç»™å†…å®¹æ˜¯å¦ç¡®å®ä¸ºåŒºå—é“¾ä¸ŠçœŸå®çš„å†…å®¹ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/20200214173245117.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="Merkle-Tree"><a href="#Merkle-Tree" class="headerlink" title="Merkle Tree"></a>Merkle Tree</h3><p>Merkle Treeå¯ä»¥ç”¨äºæä¾›Merkle Proofã€‚æ¯”ç‰¹å¸ä¸­èŠ‚ç‚¹åˆ†ä¸º<strong>è½»èŠ‚ç‚¹</strong>å’Œ<strong>å…¨èŠ‚ç‚¹</strong>ã€‚å…¨èŠ‚ç‚¹ä¿å­˜æ•´ä¸ªåŒºå—çš„æ‰€æœ‰å†…å®¹ï¼Œè€Œè½»èŠ‚ç‚¹ä»…ä»…ä¿å­˜åŒºå—çš„å—å¤´ä¿¡æ¯ã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆè¦åˆ†è½»èŠ‚ç‚¹å’Œå…¨èŠ‚ç‚¹ï¼Ÿ<br>å› ä¸ºç¡¬ä»¶çš„å±€é™ã€‚ä¸€ä¸ªåŒºå—å¤§å°ä¸º1MBï¼Œå¯¹äºç§»åŠ¨ä¾¿æºè®¾å¤‡æ¥è¯´ï¼Œå¦‚æœå­˜å‚¨åŒºå—çš„æ‰€æœ‰å†…å®¹ï¼Œåˆ™æ‰€éœ€ç©ºé—´è¿‡å¤§ï¼Œè€Œè¿™æ˜¯ä¸ç°å®çš„ã€‚æ‰€ä»¥è½»èŠ‚ç‚¹åªéœ€è¦å­˜å‚¨åŒºå—å—å¤´ä¿¡æ¯ï¼Œå…¨èŠ‚ç‚¹å­˜å‚¨åŒºå—æ‰€æœ‰å†…å®¹å³å¯ã€‚</p></blockquote><p>å½“éœ€è¦å‘è½»èŠ‚ç‚¹è¯æ˜æŸæ¡äº¤æ˜“æ˜¯å¦è¢«å†™å…¥åŒºå—é“¾ï¼Œä¾¿éœ€è¦ç”¨åˆ°Merkle proofã€‚æˆ‘ä»¬å°†äº¤æ˜“åˆ°æ ¹èŠ‚ç‚¹è¿™ä¸€æ¡è·¯å¾„ç§°ä¸ºMerkle proofï¼Œå…¨èŠ‚ç‚¹å°†æ•´ä¸ªMerkle proofå‘é€ç»™è½»èŠ‚ç‚¹ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œè½»èŠ‚ç‚¹å³å¯æ ¹æ®å…¶ç®—å‡ºæ ¹å“ˆå¸Œå€¼ï¼Œå’Œè‡ªå·±ä¿å­˜çš„å¯¹æ¯”ï¼Œä»è€ŒéªŒè¯è¯¥äº¤æ˜“æ˜¯å¦è¢«å†™å…¥åŒºå—é“¾ã€‚åªè¦æ²¿ç€è¯¥è·¯å¾„ï¼Œæ‰€æœ‰å“ˆå¸Œå€¼éƒ½æ­£ç¡®ï¼Œè¯´æ˜å†…å®¹æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20221125150306565.png" alt="image-20221125150306565"></p><p>ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œè¦éªŒè¯é»„è‰²çš„äº¤æ˜“æ˜¯å¦è¢«å†™åˆ°åŒºå—ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè¦è¯·æ±‚ç¬¬ä¸‰å±‚çš„çº¢è‰²çš„å“ˆå¸Œå€¼ï¼Œç„¶åæ ¹æ®é»„è‰²çš„äº¤æ˜“æ±‚å‡ºç¬¬ä¸‰å±‚çš„ç»¿è‰²å“ˆå¸Œå€¼ï¼Œç„¶åé€šè¿‡è¿™ä¸¤ä¸ªå·²çŸ¥çš„å“ˆå¸Œå€¼æ±‚å‡ºç¬¬äºŒå±‚çš„ç»¿è‰²å“ˆå¸Œå€¼ï¼Œå†è¯·æ±‚ç¬¬äºŒå±‚çš„çº¢è‰²å“ˆå¸Œå€¼ï¼Œä»¥æ­¤ç±»æ¨æœ€ç»ˆæ±‚å¾—æ ¹å“ˆå¸Œå€¼ï¼Œç„¶åä¸å­˜å‚¨åœ¨è‡ªèº«ç»“ç‚¹ä¸­çš„æ ¹å“ˆå¸Œå€¼æ¯”è¾ƒï¼Œè‹¥ç›¸åŒåˆ™è¯æ˜äº¤æ˜“å·²ç»å†™å…¥åˆ°äº†åŒºå—ä¸­ã€‚</p><p>ä¸Šé¢çš„éªŒè¯æ˜¯proof of membership æ—¶é—´å¤æ‚åº¦ä¸ºO(logn)<br>å…³äºproof of non-membershipéªŒè¯ï¼Œå¦‚æœäº¤æ˜“æ˜¯æ— åºçš„ï¼Œæˆ‘ä»¬åªèƒ½è¯æ˜æ¯ä¸ªç»“ç‚¹éƒ½æ˜¯å¯¹çš„ï¼Œè¯´æ˜æ²¡æœ‰è¯¥èŠ‚ç‚¹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)<br>å¦‚æœäº¤æ˜“æ˜¯æŒ‰hashå€¼ä»å°åˆ°å¤§æ’åºï¼Œæˆ‘ä»¬å¯¹è¦æ£€éªŒçš„äº¤æ˜“å–hashï¼Œåˆ¤æ–­å®ƒåº”å¤„çš„ä½ç½®ï¼Œç„¶åè®¡ç®—ä»–å‰åçš„ä¸¤ä¸ªç»“ç‚¹çš„hashï¼Œè‹¥è¿™ä¸¤ä¸ªç»“ç‚¹ç¡®å®ç›¸é‚»ï¼ˆmerkle proofï¼‰ï¼Œåˆ™è¯æ˜æˆ‘ä»¬è¦æ‰¾çš„ç»“ç‚¹ä¸å­˜åœ¨ï¼ˆè‹¥å­˜åœ¨åˆ™ä¼šåœ¨è¿™ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´ï¼Œè¿™ä¸¤ä¸ªç»“ç‚¹ä¸ä¼šç›¸é‚»ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(logn)ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åŒºå—é“¾ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BTC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼“å­˜å‡»ç©¿é—®é¢˜åŠè§£å†³æ–¹æ³•</title>
      <link href="/posts/cachebreakdown.html"/>
      <url>/posts/cachebreakdown.html</url>
      
        <content type="html"><![CDATA[<p>ç¼“å­˜å‡»ç©¿é—®é¢˜ä¹Ÿå«çƒ­ç‚¹Keyé—®é¢˜ï¼Œå°±æ˜¯ä¸€ä¸ªè¢«é«˜å¹¶å‘è®¿é—®å¹¶ä¸”ç¼“å­˜é‡å»ºä¸šåŠ¡è¾ƒå¤æ‚çš„keyçªç„¶å¤±æ•ˆäº†ï¼Œæ— æ•°çš„è¯·æ±‚è®¿é—®ä¼šåœ¨ç¬é—´ç»™æ•°æ®åº“å¸¦æ¥å·¨å¤§çš„å†²å‡»ã€‚</p><p>å¸¸è§çš„è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼š</p><ul><li>äº’æ–¥é”</li><li>é€»è¾‘è¿‡æœŸ</li></ul><p>é€»è¾‘åˆ†æï¼šå‡è®¾çº¿ç¨‹1åœ¨æŸ¥è¯¢ç¼“å­˜ä¹‹åï¼Œæœ¬æ¥åº”è¯¥å»æŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åæŠŠè¿™ä¸ªæ•°æ®é‡æ–°åŠ è½½åˆ°ç¼“å­˜çš„ï¼Œæ­¤æ—¶åªè¦çº¿ç¨‹1èµ°å®Œè¿™ä¸ªé€»è¾‘ï¼Œå…¶ä»–çº¿ç¨‹å°±éƒ½èƒ½ä»ç¼“å­˜ä¸­åŠ è½½è¿™äº›æ•°æ®äº†ï¼Œä½†æ˜¯å‡è®¾åœ¨çº¿ç¨‹1æ²¡æœ‰èµ°å®Œçš„æ—¶å€™ï¼Œåç»­çš„çº¿ç¨‹2ï¼Œçº¿ç¨‹3ï¼Œçº¿ç¨‹4åŒæ—¶è¿‡æ¥è®¿é—®å½“å‰è¿™ä¸ªæ–¹æ³•ï¼Œ é‚£ä¹ˆè¿™äº›çº¿ç¨‹éƒ½ä¸èƒ½ä»ç¼“å­˜ä¸­æŸ¥è¯¢åˆ°æ•°æ®ï¼Œé‚£ä¹ˆä»–ä»¬å°±ä¼šåŒä¸€æ—¶åˆ»æ¥è®¿é—®æŸ¥è¯¢ç¼“å­˜ï¼Œéƒ½æ²¡æŸ¥åˆ°ï¼Œæ¥ç€åŒä¸€æ—¶é—´å»è®¿é—®æ•°æ®åº“ï¼ŒåŒæ—¶çš„å»æ‰§è¡Œæ•°æ®åº“ä»£ç ï¼Œå¯¹æ•°æ®åº“è®¿é—®å‹åŠ›è¿‡å¤§</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20221117180656666.png" alt="image-20221117180656666"></p><p>è§£å†³æ–¹æ¡ˆä¸€ã€ä½¿ç”¨é”æ¥è§£å†³ï¼š</p><p>å› ä¸ºé”èƒ½å®ç°äº’æ–¥æ€§ã€‚å‡è®¾çº¿ç¨‹è¿‡æ¥ï¼Œåªèƒ½ä¸€ä¸ªäººä¸€ä¸ªäººçš„æ¥è®¿é—®æ•°æ®åº“ï¼Œä»è€Œé¿å…å¯¹äºæ•°æ®åº“è®¿é—®å‹åŠ›è¿‡å¤§ï¼Œä½†è¿™ä¹Ÿä¼šå½±å“æŸ¥è¯¢çš„æ€§èƒ½ï¼Œå› ä¸ºæ­¤æ—¶ä¼šè®©æŸ¥è¯¢çš„æ€§èƒ½ä»å¹¶è¡Œå˜æˆäº†ä¸²è¡Œï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨tryLockæ–¹æ³• + double checkæ¥è§£å†³è¿™æ ·çš„é—®é¢˜ã€‚</p><p>å‡è®¾ç°åœ¨çº¿ç¨‹1è¿‡æ¥è®¿é—®ï¼Œä»–æŸ¥è¯¢ç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œä½†æ˜¯æ­¤æ—¶ä»–è·å¾—åˆ°äº†é”çš„èµ„æºï¼Œé‚£ä¹ˆçº¿ç¨‹1å°±ä¼šä¸€ä¸ªäººå»æ‰§è¡Œé€»è¾‘ï¼Œå‡è®¾ç°åœ¨çº¿ç¨‹2è¿‡æ¥ï¼Œçº¿ç¨‹2åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¹¶æ²¡æœ‰è·å¾—åˆ°é”ï¼Œé‚£ä¹ˆçº¿ç¨‹2å°±å¯ä»¥è¿›è¡Œåˆ°ä¼‘çœ ï¼Œç›´åˆ°çº¿ç¨‹1æŠŠé”é‡Šæ”¾åï¼Œçº¿ç¨‹2è·å¾—åˆ°é”ï¼Œç„¶åå†æ¥æ‰§è¡Œé€»è¾‘ï¼Œæ­¤æ—¶å°±èƒ½å¤Ÿä»ç¼“å­˜ä¸­æ‹¿åˆ°æ•°æ®äº†ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20221117180718900.png" alt="image-20221117180718900"></p><p>è§£å†³æ–¹æ¡ˆäºŒã€é€»è¾‘è¿‡æœŸæ–¹æ¡ˆ</p><p>æ–¹æ¡ˆåˆ†æï¼šæˆ‘ä»¬ä¹‹æ‰€ä»¥ä¼šå‡ºç°è¿™ä¸ªç¼“å­˜å‡»ç©¿é—®é¢˜ï¼Œä¸»è¦åŸå› æ˜¯åœ¨äºæˆ‘ä»¬å¯¹keyè®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œå‡è®¾æˆ‘ä»¬ä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå…¶å®å°±ä¸ä¼šæœ‰ç¼“å­˜å‡»ç©¿çš„é—®é¢˜ï¼Œä½†æ˜¯ä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿™æ ·æ•°æ®ä¸å°±ä¸€ç›´å ç”¨æˆ‘ä»¬å†…å­˜äº†å—ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨é€»è¾‘è¿‡æœŸæ–¹æ¡ˆã€‚</p><p>æˆ‘ä»¬æŠŠè¿‡æœŸæ—¶é—´è®¾ç½®åœ¨ redisçš„valueä¸­ï¼Œæ³¨æ„ï¼šè¿™ä¸ªè¿‡æœŸæ—¶é—´å¹¶ä¸ä¼šç›´æ¥ä½œç”¨äºredisï¼Œè€Œæ˜¯æˆ‘ä»¬åç»­é€šè¿‡é€»è¾‘å»å¤„ç†ã€‚å‡è®¾çº¿ç¨‹1å»æŸ¥è¯¢ç¼“å­˜ï¼Œç„¶åä»valueä¸­åˆ¤æ–­å‡ºæ¥å½“å‰çš„æ•°æ®å·²ç»è¿‡æœŸäº†ï¼Œæ­¤æ—¶çº¿ç¨‹1å»è·å¾—äº’æ–¥é”ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹ä¼šè¿›è¡Œé˜»å¡ï¼Œè·å¾—äº†é”çš„çº¿ç¨‹ä»–ä¼šå¼€å¯ä¸€ä¸ª çº¿ç¨‹å»è¿›è¡Œ ä»¥å‰çš„é‡æ„æ•°æ®çš„é€»è¾‘ï¼Œç›´åˆ°æ–°å¼€çš„çº¿ç¨‹å®Œæˆè¿™ä¸ªé€»è¾‘åï¼Œæ‰é‡Šæ”¾é”ï¼Œ è€Œçº¿ç¨‹1ç›´æ¥è¿›è¡Œè¿”å›ï¼Œå‡è®¾ç°åœ¨çº¿ç¨‹3è¿‡æ¥è®¿é—®ï¼Œç”±äºçº¿ç¨‹çº¿ç¨‹2æŒæœ‰ç€é”ï¼Œæ‰€ä»¥çº¿ç¨‹3æ— æ³•è·å¾—é”ï¼Œçº¿ç¨‹3ä¹Ÿç›´æ¥è¿”å›æ•°æ®ï¼Œåªæœ‰ç­‰åˆ°æ–°å¼€çš„çº¿ç¨‹2æŠŠé‡å»ºæ•°æ®æ„å»ºå®Œåï¼Œå…¶ä»–çº¿ç¨‹æ‰èƒ½èµ°è¿”å›æ­£ç¡®çš„æ•°æ®ã€‚</p><p>è¿™ç§æ–¹æ¡ˆå·§å¦™åœ¨äºï¼Œå¼‚æ­¥çš„æ„å»ºç¼“å­˜ï¼Œç¼ºç‚¹åœ¨äºåœ¨æ„å»ºå®Œç¼“å­˜ä¹‹å‰ï¼Œè¿”å›çš„éƒ½æ˜¯è„æ•°æ®ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20221117180749105.png" alt="image-20221117180749105"></p><p>è¿›è¡Œå¯¹æ¯”</p><p><strong>äº’æ–¥é”æ–¹æ¡ˆï¼š</strong>ç”±äºä¿è¯äº†äº’æ–¥æ€§ï¼Œæ‰€ä»¥æ•°æ®ä¸€è‡´ï¼Œä¸”å®ç°ç®€å•ï¼Œå› ä¸ºä»…ä»…åªéœ€è¦åŠ ä¸€æŠŠé”è€Œå·²ï¼Œä¹Ÿæ²¡å…¶ä»–çš„äº‹æƒ…éœ€è¦æ“å¿ƒï¼Œæ‰€ä»¥æ²¡æœ‰é¢å¤–çš„å†…å­˜æ¶ˆè€—ï¼Œç¼ºç‚¹åœ¨äºæœ‰é”å°±æœ‰æ­»é”é—®é¢˜çš„å‘ç”Ÿï¼Œä¸”åªèƒ½ä¸²è¡Œæ‰§è¡Œæ€§èƒ½è‚¯å®šå—åˆ°å½±å“</p><p><strong>é€»è¾‘è¿‡æœŸæ–¹æ¡ˆï¼š</strong> çº¿ç¨‹è¯»å–è¿‡ç¨‹ä¸­ä¸éœ€è¦ç­‰å¾…ï¼Œæ€§èƒ½å¥½ï¼Œæœ‰ä¸€ä¸ªé¢å¤–çš„çº¿ç¨‹æŒæœ‰é”å»è¿›è¡Œé‡æ„æ•°æ®ï¼Œä½†æ˜¯åœ¨é‡æ„æ•°æ®å®Œæˆå‰ï¼Œå…¶ä»–çš„çº¿ç¨‹åªèƒ½è¿”å›ä¹‹å‰çš„æ•°æ®ï¼Œä¸”å®ç°èµ·æ¥éº»çƒ¦</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1653357522914.png" alt="1653357522914"></p>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rediså¸¸ç”¨å‘½ä»¤</title>
      <link href="/posts/commandsForRedis.html"/>
      <url>/posts/commandsForRedis.html</url>
      
        <content type="html"><![CDATA[<p>Redis æ‰€æœ‰çš„ keyï¼ˆé”®ï¼‰éƒ½æ˜¯å­—ç¬¦ä¸²ã€‚åœ¨è°ˆåŸºç¡€æ•°æ®ç»“æ„æ—¶ï¼Œæˆ‘ä»¬è®¨è®ºçš„æ˜¯å­˜å‚¨å€¼çš„æ•°æ®ç±»å‹ï¼Œä¸»è¦åŒ…æ‹¬å¸¸è§çš„ 5 ç§æ•°æ®ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ï¼šStringã€Listã€Setã€Zsetã€Hashã€‚</p><h3 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h3><p>Redis æ˜¯ä¸€ä¸ª key-value çš„æ•°æ®åº“ï¼Œkey æ˜¯ä¸€èˆ¬çš„ Stringï¼Œä¸è¿‡ value å´æ˜¯å¤šç§å¤šæ ·çš„ï¼š</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1658728198413.png" alt="1658728198413"></p><div class="table-container"><table><thead><tr><th>ç»“æ„ç±»å‹</th><th>ç»“æ„å­˜å‚¨çš„å€¼</th><th>ç»“æ„çš„è¯»å†™èƒ½åŠ›</th></tr></thead><tbody><tr><td>Stringå­—ç¬¦ä¸²</td><td>å¯ä»¥æ˜¯å­—ç¬¦ã€æ•´æ•°æˆ–æµ®ç‚¹æ•°</td><td>å¯¹æ•´ä¸ªå­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ“ä½œï¼›å¯¹æ•´æ•°æˆ–æµ®ç‚¹æ•°è¿›è¡Œè‡ªå¢æˆ–è‡ªå‡æ“ä½œï¼›</td></tr><tr><td>Liståˆ—è¡¨</td><td>ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²</td><td>å¯¹é“¾è¡¨çš„ä¸¤ç«¯è¿›è¡Œ push å’Œ pop æ“ä½œï¼Œè¯»å–å•ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼›æ ¹æ®å€¼æŸ¥æ‰¾æˆ–åˆ é™¤å…ƒç´ ï¼›</td></tr><tr><td>Seté›†åˆ</td><td>åŒ…å«å­—ç¬¦ä¸²çš„æ— åºé›†åˆ</td><td>å­—ç¬¦ä¸²çš„é›†åˆï¼ŒåŒ…å«åŸºç¡€çš„æ–¹æ³•æœ‰ï¼šçœ‹æ˜¯å¦å­˜åœ¨æ·»åŠ ã€è·å–ã€åˆ é™¤ï¼›è¿˜åŒ…å«è®¡ç®—äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰ï¼›</td></tr><tr><td>Hashæ•£åˆ—</td><td>åŒ…å«é”®å€¼å¯¹çš„æ— åºæ•£åˆ—è¡¨</td><td>åŒ…å«æ–¹æ³•æœ‰æ·»åŠ ã€è·å–ã€åˆ é™¤å•ä¸ªå…ƒç´ </td></tr><tr><td>Zset æœ‰åºé›†åˆ</td><td>å’Œæ•£åˆ—ä¸€æ ·ï¼Œç”¨äºå­˜å‚¨é”®å€¼å¯¹</td><td>å­—ç¬¦ä¸²æˆå‘˜ä¸æµ®ç‚¹æ•°åˆ†æ•°ä¹‹é—´çš„æœ‰åºæ˜ å°„ï¼›å…ƒç´ çš„æ’åˆ—é¡ºåºç”±åˆ†æ•°çš„å¤§å°å†³å®šï¼›åŒ…å«æ–¹æ³•æœ‰æ·»åŠ ã€è·å–ã€åˆ é™¤å•ä¸ªå…ƒç´ ä»¥åŠæ ¹æ®åˆ†å€¼èŒƒå›´æˆ–æˆå‘˜æ¥è·å–å…ƒç´ ï¼›</td></tr></tbody></table></div><h3 id="é€šç”¨å‘½ä»¤"><a href="#é€šç”¨å‘½ä»¤" class="headerlink" title="é€šç”¨å‘½ä»¤"></a>é€šç”¨å‘½ä»¤</h3><ul><li><p>KEYS patternï¼šæŸ¥çœ‹ç¬¦åˆæ¨¡ç‰ˆçš„æ‰€æœ‰ keys, ä¸å»ºè®®åœ¨ç”Ÿäº§åå¢ƒä¸‹ä½¿ç”¨ï¼Œå› ä¸ºå½“Redisä¸­çš„æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œæ‰§è¡Œæ¨¡ç³ŠæŸ¥è¯¢ä¼šé˜»å¡å…¶ä»–è¯·æ±‚ã€‚</p></li><li><p>DEL keyï¼šåˆ é™¤ä¸€ä¸ªæŒ‡å®šçš„ key</p></li><li><p>EXISTS keyï¼šåˆ¤æ–­ key æ˜¯å¦å­˜åœ¨</p></li><li><p>EXPIRE key secondsï¼šç»™ä¸€ä¸ª key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå•ä½æ˜¯ç§’ï¼Œæœ‰æ•ˆæœŸåˆ°æœŸæ—¶è¯¥keyä¼šè¢«è‡ªåŠ¨åˆ é™¤</p></li><li><p>TTL keyï¼šæŸ¥çœ‹æŒ‡å®š key çš„å‰©ä½™æœ‰æ•ˆæ—¶é—´ ã€‚-1 è¡¨ç¤ºå½“å‰ key æ²¡æœ‰è®¾ç½®æœ‰æ•ˆæ—¶é—´ ï¼Œ-2 è¡¨ç¤ºå½“å‰ key ä¸å­˜åœ¨</p></li><li><p>PERSIST keyï¼šæŒä¹…åŒ–æŒ‡å®š key</p></li><li><p>TYPE keyï¼šæŸ¥çœ‹æŒ‡å®š key çš„ç±»å‹</p></li><li><p>MOVE key numï¼šç§»åŠ¨æŒ‡å®š key åˆ°æŒ‡å®šæ•°æ®åº“</p></li><li><p>RANDOMKEYï¼šéšå³è¿”å›åº“ä¸­çš„ä¸€ä¸ª key</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; select <span class="number">0</span></span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; set k1 v1</span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; get k1</span><br><span class="line"><span class="string">&quot;v1&quot;</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; exists <span class="title function_">k1</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; exists <span class="title function_">k2</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">0</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; expire k1 <span class="number">10</span></span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; ttl <span class="title function_">k1</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">7</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; persist <span class="title function_">k1</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; ttl <span class="title function_">k1</span></span><br><span class="line"><span class="params">(integer)</span> -<span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; type k1</span><br><span class="line">string</span><br></pre></td></tr></table></figure><h3 id="String-å­—ç¬¦ä¸²å‘½ä»¤"><a href="#String-å­—ç¬¦ä¸²å‘½ä»¤" class="headerlink" title="String å­—ç¬¦ä¸²å‘½ä»¤"></a>String å­—ç¬¦ä¸²å‘½ä»¤</h3><blockquote><p>Stringç±»å‹æ˜¯RedisåŸºæœ¬ç±»å‹ï¼Œä¸€ä¸ªé”®æœ€å¤§èƒ½å­˜å‚¨512MBä¸”æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚æ„æ€æ˜¯ redis çš„ String ç±»å‹å¯ä»¥å­˜å‚¨ä»»ä½•æ•°æ®ï¼Œå¦‚æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œjpgå›¾ç‰‡æˆ–è€…åºåˆ—åŒ–çš„å¯¹è±¡ã€‚</p></blockquote><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>redisä¸­çš„Stringæ˜¯åŠ¨æ€å­—ç¬¦ä¸²ï¼Œå†…éƒ¨ç»“æ„ç±»ä¼¼ArrayListã€‚é‡‡ç”¨é¢„åˆ†é…å†—ä½™ç©ºé—´çš„æ–¹å¼å‡å°‘å†…å­˜çš„é¢‘ç¹åˆ†é…ã€‚</p><blockquote><p>å†…éƒ¨ä¸ºå­—ç¬¦ä¸²åˆ†é…çš„å®é™…ç©ºé—´ä¸€èˆ¬é«˜äºå­—ç¬¦ä¸²é•¿åº¦ï¼Œå½“å­—ç¬¦ä¸²é•¿åº¦<1MBæ—¶ï¼Œæ‰©å®¹æ–¹å¼æ˜¯åŠ å€ ä¹Ÿå°±æ˜¯åŸæ¥çš„ä¸¤å€ã€‚å½“å­—ç¬¦ä¸²é•¿åº¦>1MBæ—¶ï¼Œä¸€æ¬¡æ‰©å®¹1MBï¼Œç›´åˆ°æœ€å¤§512MB.</p></blockquote><p>Stringç±»å‹ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ˜¯Redisä¸­æœ€ç®€å•çš„å­˜å‚¨ç±»å‹ã€‚</p><p>å…¶valueæ˜¯å­—ç¬¦ä¸²ï¼Œä¸è¿‡æ ¹æ®å­—ç¬¦ä¸²çš„æ ¼å¼ä¸åŒï¼Œåˆå¯ä»¥åˆ†ä¸º3ç±»ï¼š</p><ul><li>stringï¼šæ™®é€šå­—ç¬¦ä¸²</li><li>intï¼šæ•´æ•°ç±»å‹ï¼Œå¯ä»¥åšè‡ªå¢.è‡ªå‡æ“ä½œ</li><li>floatï¼šæµ®ç‚¹ç±»å‹ï¼Œå¯ä»¥åšè‡ªå¢.è‡ªå‡æ“ä½œ</li></ul><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1652890121291.png" alt="1652890121291"></p><h4 id="å¸¸è§å‘½ä»¤"><a href="#å¸¸è§å‘½ä»¤" class="headerlink" title="å¸¸è§å‘½ä»¤"></a>å¸¸è§å‘½ä»¤</h4><p>Stringçš„å¸¸è§å‘½ä»¤æœ‰ï¼š</p><ul><li>SETï¼šæ·»åŠ æˆ–è€…ä¿®æ”¹å·²ç»å­˜åœ¨çš„ä¸€ä¸ªStringç±»å‹çš„é”®å€¼å¯¹</li><li>GETï¼šæ ¹æ®keyè·å–Stringç±»å‹çš„value</li><li>MSETï¼šæ‰¹é‡æ·»åŠ å¤šä¸ªStringç±»å‹çš„é”®å€¼å¯¹</li><li>MGETï¼šæ ¹æ®å¤šä¸ªkeyè·å–å¤šä¸ªStringç±»å‹çš„value</li><li>INCRï¼šè®©ä¸€ä¸ªæ•´å‹çš„keyè‡ªå¢1</li><li>INCRBY:è®©ä¸€ä¸ªæ•´å‹çš„keyè‡ªå¢å¹¶æŒ‡å®šæ­¥é•¿ï¼Œä¾‹å¦‚ï¼šincrby num 2 è®©numå€¼è‡ªå¢2</li><li>INCRBYFLOATï¼šè®©ä¸€ä¸ªæµ®ç‚¹ç±»å‹çš„æ•°å­—è‡ªå¢å¹¶æŒ‡å®šæ­¥é•¿</li><li>SETNXï¼šæ·»åŠ ä¸€ä¸ªStringç±»å‹çš„é”®å€¼å¯¹ï¼Œå‰ææ˜¯è¿™ä¸ªkeyä¸å­˜åœ¨ï¼Œå¦åˆ™ä¸æ‰§è¡Œ</li><li>SETEXï¼šæ·»åŠ ä¸€ä¸ªStringç±»å‹çš„é”®å€¼å¯¹ï¼Œå¹¶ä¸”æŒ‡å®šæœ‰æ•ˆæœŸ</li></ul><p><strong>è´´å¿ƒå°æç¤º</strong>ï¼šä»¥ä¸Šå‘½ä»¤é™¤äº†INCRBYFLOAT éƒ½æ˜¯å¸¸ç”¨å‘½ä»¤</p><ul><li>SET å’ŒGET: å¦‚æœkeyä¸å­˜åœ¨åˆ™æ˜¯æ–°å¢ï¼Œå¦‚æœå­˜åœ¨åˆ™æ˜¯ä¿®æ”¹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; set name Rose  <span class="comment">//åŸæ¥ä¸å­˜åœ¨</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; get name </span><br><span class="line"><span class="string">&quot;Rose&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; set name Jack <span class="comment">//åŸæ¥å­˜åœ¨ï¼Œå°±æ˜¯ä¿®æ”¹</span></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; get name</span><br><span class="line"><span class="string">&quot;Jack&quot;</span></span><br></pre></td></tr></table></figure><ul><li>MSETå’ŒMGET</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; MSET k1 v1 k2 v2 k3 v3</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; MGET name age k1 k2 k3</span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;Jack&quot;</span> <span class="comment">//ä¹‹å‰å­˜åœ¨çš„name</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;10&quot;</span>   <span class="comment">//ä¹‹å‰å­˜åœ¨çš„age</span></span><br><span class="line"><span class="number">3</span>) <span class="string">&quot;v1&quot;</span></span><br><span class="line"><span class="number">4</span>) <span class="string">&quot;v2&quot;</span></span><br><span class="line"><span class="number">5</span>) <span class="string">&quot;v3&quot;</span></span><br></pre></td></tr></table></figure><ul><li>INCRå’ŒINCRBYå’ŒDECY</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; get age </span><br><span class="line"><span class="string">&quot;10&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; incr age <span class="comment">//å¢åŠ 1</span></span><br><span class="line">(integer) <span class="number">11</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; get age <span class="comment">//è·å¾—age</span></span><br><span class="line"><span class="string">&quot;11&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; incrby age <span class="number">2</span> <span class="comment">//ä¸€æ¬¡å¢åŠ 2</span></span><br><span class="line">(integer) <span class="number">13</span> <span class="comment">//è¿”å›ç›®å‰çš„ageçš„å€¼</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; incrby age <span class="number">2</span></span><br><span class="line">(integer) <span class="number">15</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; incrby age -<span class="number">1</span> <span class="comment">//ä¹Ÿå¯ä»¥å¢åŠ è´Ÿæ•°ï¼Œç›¸å½“äºå‡</span></span><br><span class="line">(integer) <span class="number">14</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; incrby age -<span class="number">2</span> <span class="comment">//ä¸€æ¬¡å‡å°‘2ä¸ª</span></span><br><span class="line">(integer) <span class="number">12</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; DECR age <span class="comment">//ç›¸å½“äº incr è´Ÿæ•°ï¼Œå‡å°‘æ­£å¸¸ç”¨æ³•</span></span><br><span class="line">(integer) <span class="number">11</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; get age </span><br><span class="line"><span class="string">&quot;11&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>SETNX</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; help setnx</span><br><span class="line"></span><br><span class="line">  SETNX key value</span><br><span class="line">  summary: Set the value of a key, only <span class="keyword">if</span> the key does not exist</span><br><span class="line">  since: <span class="number">1.0</span><span class="number">.0</span></span><br><span class="line">  group: string</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; set name Jack  <span class="comment">//è®¾ç½®åç§°</span></span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; setnx name lisi <span class="comment">//å¦‚æœkeyä¸å­˜åœ¨ï¼Œåˆ™æ·»åŠ æˆåŠŸ</span></span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; get name <span class="comment">//ç”±äºnameå·²ç»å­˜åœ¨ï¼Œæ‰€ä»¥lisiçš„æ“ä½œå¤±è´¥</span></span><br><span class="line"><span class="string">&quot;Jack&quot;</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; setnx name2 lisi <span class="comment">//name2 ä¸å­˜åœ¨ï¼Œæ‰€ä»¥æ“ä½œæˆåŠŸ</span></span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; get name2 </span><br><span class="line"><span class="string">&quot;lisi&quot;</span></span><br></pre></td></tr></table></figure><ul><li>SETEX</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; setex name <span class="number">10</span> jack</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; ttl <span class="title function_">name</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; ttl <span class="title function_">name</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; ttl <span class="title function_">name</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">5</span></span><br></pre></td></tr></table></figure><h4 id="Rediså‘½ä»¤-Keyçš„å±‚çº§ç»“æ„"><a href="#Rediså‘½ä»¤-Keyçš„å±‚çº§ç»“æ„" class="headerlink" title="Rediså‘½ä»¤-Keyçš„å±‚çº§ç»“æ„"></a>Rediså‘½ä»¤-Keyçš„å±‚çº§ç»“æ„</h4><p>Redisæ²¡æœ‰ç±»ä¼¼MySQLä¸­çš„Tableçš„æ¦‚å¿µï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•åŒºåˆ†ä¸åŒç±»å‹çš„keyå‘¢ï¼Ÿ</p><p>ä¾‹å¦‚ï¼Œéœ€è¦å­˜å‚¨ç”¨æˆ·.å•†å“ä¿¡æ¯åˆ°redisï¼Œæœ‰ä¸€ä¸ªç”¨æˆ·idæ˜¯1ï¼Œæœ‰ä¸€ä¸ªå•†å“idæ°å¥½ä¹Ÿæ˜¯1ï¼Œæ­¤æ—¶å¦‚æœä½¿ç”¨idä½œä¸ºkeyï¼Œé‚£å°±ä¼šå†²çªäº†ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™keyæ·»åŠ å‰ç¼€åŠ ä»¥åŒºåˆ†ï¼Œä¸è¿‡è¿™ä¸ªå‰ç¼€ä¸æ˜¯éšä¾¿åŠ çš„ï¼Œæœ‰ä¸€å®šçš„è§„èŒƒï¼š</p><p>Redisçš„keyå…è®¸æœ‰å¤šä¸ªå•è¯å½¢æˆå±‚çº§ç»“æ„ï¼Œå¤šä¸ªå•è¯ä¹‹é—´ç”¨â€™:â€™éš”å¼€ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1652941631682.png" alt="1652941631682"></p><p>è¿™ä¸ªæ ¼å¼å¹¶éå›ºå®šï¼Œä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥åˆ é™¤æˆ–æ·»åŠ è¯æ¡ã€‚</p><p>ä¾‹å¦‚æˆ‘ä»¬çš„é¡¹ç›®åç§°å« heimaï¼Œæœ‰userå’Œproductä¸¤ç§ä¸åŒç±»å‹çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰keyï¼š</p><ul><li><p>userç›¸å…³çš„keyï¼š<strong>heima:user:1</strong></p></li><li><p>productç›¸å…³çš„keyï¼š<strong>heima:product:1</strong></p></li></ul><p>å¦‚æœValueæ˜¯ä¸€ä¸ªJavaå¯¹è±¡ï¼Œä¾‹å¦‚ä¸€ä¸ªUserå¯¹è±¡ï¼Œåˆ™å¯ä»¥å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²åå­˜å‚¨ï¼š</p><div class="table-container"><table><thead><tr><th><strong>KEY</strong></th><th><strong>VALUE</strong></th></tr></thead><tbody><tr><td>heima:user:1</td><td>{â€œidâ€:1, â€œnameâ€: â€œJackâ€, â€œageâ€: 21}</td></tr><tr><td>heima:product:1</td><td>{â€œidâ€:1, â€œnameâ€: â€œå°ç±³11â€, â€œpriceâ€: 4999}</td></tr></tbody></table></div><p>ä¸€æ—¦æˆ‘ä»¬å‘redisé‡‡ç”¨è¿™æ ·çš„æ–¹å¼å­˜å‚¨ï¼Œé‚£ä¹ˆåœ¨å¯è§†åŒ–ç•Œé¢ä¸­ï¼Œredisä¼šä»¥å±‚çº§ç»“æ„æ¥è¿›è¡Œå­˜å‚¨ï¼Œå½¢æˆç±»ä¼¼äºè¿™æ ·çš„ç»“æ„ï¼Œæ›´åŠ æ–¹ä¾¿Redisè·å–æ•°æ®</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1652941883537.png" alt="1652941883537"></p><h3 id="Hashå‘½ä»¤"><a href="#Hashå‘½ä»¤" class="headerlink" title="Hashå‘½ä»¤"></a>Hashå‘½ä»¤</h3><p>Hashç±»å‹ï¼Œä¹Ÿå«æ•£åˆ—ï¼Œå…¶valueæ˜¯ä¸€ä¸ªæ— åºå­—å…¸ï¼Œç±»ä¼¼äºJavaä¸­çš„HashMapç»“æ„ã€‚</p><p>Stringç»“æ„æ˜¯å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²åå­˜å‚¨ï¼Œå½“éœ€è¦ä¿®æ”¹å¯¹è±¡æŸä¸ªå­—æ®µæ—¶å¾ˆä¸æ–¹ä¾¿ï¼š</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1652941995945.png" alt="1652941995945"></p><p>Hashç»“æ„å¯ä»¥å°†å¯¹è±¡ä¸­çš„æ¯ä¸ªå­—æ®µç‹¬ç«‹å­˜å‚¨ï¼Œå¯ä»¥é’ˆå¯¹å•ä¸ªå­—æ®µåšCRUDï¼š</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1652942027719.png" alt="1652942027719"></p><p><strong>Hashç±»å‹çš„å¸¸è§å‘½ä»¤</strong></p><ul><li><p>HSET key field valueï¼šæ·»åŠ æˆ–è€…ä¿®æ”¹hashç±»å‹keyçš„fieldçš„å€¼</p></li><li><p>HGET key fieldï¼šè·å–ä¸€ä¸ªhashç±»å‹keyçš„fieldçš„å€¼</p></li><li><p>HMSETï¼šæ‰¹é‡æ·»åŠ å¤šä¸ªhashç±»å‹keyçš„fieldçš„å€¼</p></li><li><p>HMGETï¼šæ‰¹é‡è·å–å¤šä¸ªhashç±»å‹keyçš„fieldçš„å€¼</p></li><li><p>HGETALLï¼šè·å–ä¸€ä¸ªhashç±»å‹çš„keyä¸­çš„æ‰€æœ‰çš„fieldå’Œvalue</p></li><li>HKEYSï¼šè·å–ä¸€ä¸ªhashç±»å‹çš„keyä¸­çš„æ‰€æœ‰çš„field</li><li>HINCRBY:è®©ä¸€ä¸ªhashç±»å‹keyçš„å­—æ®µå€¼è‡ªå¢å¹¶æŒ‡å®šæ­¥é•¿</li><li>HSETNXï¼šæ·»åŠ ä¸€ä¸ªhashç±»å‹çš„keyçš„fieldå€¼ï¼Œå‰ææ˜¯è¿™ä¸ªfieldä¸å­˜åœ¨ï¼Œå¦åˆ™ä¸æ‰§è¡Œ</li></ul><ul><li>HSETå’ŒHGET</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HSET heima:user:<span class="number">3</span> name Lucy<span class="comment">//å¤§keyæ˜¯ heima:user:3 å°keyæ˜¯nameï¼Œå°valueæ˜¯Lucy</span></span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HSET heima:user:<span class="number">3</span> age <span class="number">21</span><span class="comment">// å¦‚æœæ“ä½œä¸å­˜åœ¨çš„æ•°æ®ï¼Œåˆ™æ˜¯æ–°å¢</span></span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HSET heima:user:<span class="number">3</span> age <span class="number">17</span> <span class="comment">//å¦‚æœæ“ä½œå­˜åœ¨çš„æ•°æ®ï¼Œåˆ™æ˜¯ä¿®æ”¹</span></span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HGET heima:user:<span class="number">3</span> name </span><br><span class="line"><span class="string">&quot;Lucy&quot;</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HGET heima:user:<span class="number">3</span> age</span><br><span class="line"><span class="string">&quot;17&quot;</span></span><br></pre></td></tr></table></figure><ul><li>HMSETå’ŒHMGET</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HMSET heima:user:<span class="number">4</span> name HanMeiMei</span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HMSET heima:user:<span class="number">4</span> name LiLei age <span class="number">20</span> sex man</span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HMGET heima:user:<span class="number">4</span> name age sex</span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;LiLei&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;20&quot;</span></span><br><span class="line"><span class="number">3</span>) <span class="string">&quot;man&quot;</span></span><br></pre></td></tr></table></figure><ul><li>HGETALL</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HGETALL heima:user:<span class="number">4</span></span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;name&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;LiLei&quot;</span></span><br><span class="line"><span class="number">3</span>) <span class="string">&quot;age&quot;</span></span><br><span class="line"><span class="number">4</span>) <span class="string">&quot;20&quot;</span></span><br><span class="line"><span class="number">5</span>) <span class="string">&quot;sex&quot;</span></span><br><span class="line"><span class="number">6</span>) <span class="string">&quot;man&quot;</span></span><br></pre></td></tr></table></figure><ul><li>HKEYSå’ŒHVALS</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HKEYS heima:user:<span class="number">4</span></span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;name&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;age&quot;</span></span><br><span class="line"><span class="number">3</span>) <span class="string">&quot;sex&quot;</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HVALS heima:user:<span class="number">4</span></span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;LiLei&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;20&quot;</span></span><br><span class="line"><span class="number">3</span>) <span class="string">&quot;man&quot;</span></span><br></pre></td></tr></table></figure><ul><li>HINCRBY</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HINCRBY  heima:user:<span class="number">4</span> age <span class="number">2</span></span><br><span class="line">(integer) <span class="number">22</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HVALS heima:user:<span class="number">4</span></span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;LiLei&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;22&quot;</span></span><br><span class="line"><span class="number">3</span>) <span class="string">&quot;man&quot;</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HINCRBY  heima:user:<span class="number">4</span> age -<span class="number">2</span></span><br><span class="line">(integer) <span class="number">20</span></span><br></pre></td></tr></table></figure><ul><li>HSETNX</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HSETNX heima:user4 sex <span class="title function_">woman</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HGETALL heima:user:<span class="number">3</span></span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;name&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;Lucy&quot;</span></span><br><span class="line"><span class="number">3</span>) <span class="string">&quot;age&quot;</span></span><br><span class="line"><span class="number">4</span>) <span class="string">&quot;17&quot;</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HSETNX heima:user:<span class="number">3</span> sex <span class="title function_">woman</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; HGETALL heima:user:<span class="number">3</span></span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;name&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;Lucy&quot;</span></span><br><span class="line"><span class="number">3</span>) <span class="string">&quot;age&quot;</span></span><br><span class="line"><span class="number">4</span>) <span class="string">&quot;17&quot;</span></span><br><span class="line"><span class="number">5</span>) <span class="string">&quot;sex&quot;</span></span><br><span class="line"><span class="number">6</span>) <span class="string">&quot;woman&quot;</span></span><br></pre></td></tr></table></figure><h3 id="Listå‘½ä»¤"><a href="#Listå‘½ä»¤" class="headerlink" title="Listå‘½ä»¤"></a>Listå‘½ä»¤</h3><p>Redisä¸­çš„Listç±»å‹ä¸Javaä¸­çš„LinkedListç±»ä¼¼ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ç»“æ„ã€‚æ—¢å¯ä»¥æ”¯æŒæ­£å‘æ£€ç´¢å’Œä¹Ÿå¯ä»¥æ”¯æŒåå‘æ£€ç´¢ã€‚</p><p>ç‰¹å¾ä¹Ÿä¸LinkedListç±»ä¼¼ï¼š</p><ul><li>æœ‰åº</li><li>å…ƒç´ å¯ä»¥é‡å¤</li><li>æ’å…¥å’Œåˆ é™¤å¿«</li><li>æŸ¥è¯¢é€Ÿåº¦ä¸€èˆ¬</li></ul><p>å¸¸ç”¨æ¥å­˜å‚¨ä¸€ä¸ªæœ‰åºæ•°æ®ï¼Œä¾‹å¦‚ï¼šæœ‹å‹åœˆç‚¹èµåˆ—è¡¨ï¼Œè¯„è®ºåˆ—è¡¨ç­‰ã€‚</p><p><strong>Listçš„å¸¸è§å‘½ä»¤æœ‰ï¼š</strong></p><ul><li>LPUSH key element â€¦ ï¼šå‘åˆ—è¡¨å·¦ä¾§æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </li><li>LPOP keyï¼šç§»é™¤å¹¶è¿”å›åˆ—è¡¨å·¦ä¾§çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰åˆ™è¿”å›nil</li><li>RPUSH key element â€¦ ï¼šå‘åˆ—è¡¨å³ä¾§æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </li><li>RPOP keyï¼šç§»é™¤å¹¶è¿”å›åˆ—è¡¨å³ä¾§çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>LRANGE key star endï¼šè¿”å›ä¸€æ®µè§’æ ‡èŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ </li><li>BLPOPå’ŒBRPOPï¼šä¸LPOPå’ŒRPOPç±»ä¼¼ï¼Œåªä¸è¿‡åœ¨æ²¡æœ‰å…ƒç´ æ—¶ç­‰å¾…æŒ‡å®šæ—¶é—´ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›nil</li></ul><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1652943604992.png" alt="1652943604992"></p><ul><li>LPUSHå’ŒRPUSH</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; LPUSH users <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">(integer) <span class="number">3</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; RPUSH users <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></span><br><span class="line">(integer) <span class="number">6</span></span><br></pre></td></tr></table></figure><ul><li>LPOPå’ŒRPOP</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; LPOP users</span><br><span class="line"><span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; RPOP users</span><br><span class="line"><span class="string">&quot;6&quot;</span></span><br></pre></td></tr></table></figure><ul><li>LRANGE</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; LRANGE users <span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;4&quot;</span></span><br></pre></td></tr></table></figure><h3 id="Setå‘½ä»¤"><a href="#Setå‘½ä»¤" class="headerlink" title="Setå‘½ä»¤"></a>Setå‘½ä»¤</h3><p>Redisçš„Setç»“æ„ä¸Javaä¸­çš„HashSetç±»ä¼¼ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªvalueä¸ºnullçš„HashMapã€‚å› ä¸ºä¹Ÿæ˜¯ä¸€ä¸ªhashè¡¨ï¼Œå› æ­¤å…·å¤‡ä¸HashSetç±»ä¼¼çš„ç‰¹å¾ï¼š</p><ul><li>æ— åº</li><li>å…ƒç´ ä¸å¯é‡å¤</li><li>æŸ¥æ‰¾å¿«</li><li>æ”¯æŒäº¤é›†.å¹¶é›†.å·®é›†ç­‰åŠŸèƒ½</li></ul><p><strong>Setç±»å‹çš„å¸¸è§å‘½ä»¤</strong></p><ul><li>SADD key member â€¦ ï¼šå‘setä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </li><li>SREM key member â€¦ : ç§»é™¤setä¸­çš„æŒ‡å®šå…ƒç´ </li><li>SCARD keyï¼š è¿”å›setä¸­å…ƒç´ çš„ä¸ªæ•°</li><li>SISMEMBER key memberï¼šåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºsetä¸­</li><li>SMEMBERSï¼šè·å–setä¸­çš„æ‰€æœ‰å…ƒç´ </li><li>SINTER key1 key2 â€¦ ï¼šæ±‚key1ä¸key2çš„äº¤é›†</li><li>SDIFF key1 key2 â€¦ ï¼šæ±‚key1ä¸key2çš„å·®é›†</li><li>SUNION key1 key2 ..ï¼šæ±‚key1å’Œkey2çš„å¹¶é›†</li></ul><p>ä¾‹å¦‚ä¸¤ä¸ªé›†åˆï¼šs1å’Œs2:</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20221114142002049.png" alt="image-20221114142002049"></p><p>æ±‚äº¤é›†ï¼šSINTER s1 s2</p><p>æ±‚s1ä¸s2çš„ä¸åŒï¼šSDIFF s1 s2</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20221114142018642.png" alt="image-20221114142018642"></p><p><strong>å…·ä½“å‘½ä»¤</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; sadd s1 a b <span class="title function_">c</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">3</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; smembers s1</span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;c&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;b&quot;</span></span><br><span class="line"><span class="number">3</span>) <span class="string">&quot;a&quot;</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; srem s1 <span class="title function_">a</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">1</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SISMEMBER s1 <span class="title function_">a</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SISMEMBER s1 <span class="title function_">b</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">1</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SCARD <span class="title function_">s1</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p><strong>æ¡ˆä¾‹</strong></p><ul><li>å°†ä¸‹åˆ—æ•°æ®ç”¨Redisçš„Seté›†åˆæ¥å­˜å‚¨ï¼š</li><li>å¼ ä¸‰çš„å¥½å‹æœ‰ï¼šæå››.ç‹äº”.èµµå…­</li><li>æå››çš„å¥½å‹æœ‰ï¼šç‹äº”.éº»å­.äºŒç‹—</li><li>åˆ©ç”¨Setçš„å‘½ä»¤å®ç°ä¸‹åˆ—åŠŸèƒ½ï¼š</li><li>è®¡ç®—å¼ ä¸‰çš„å¥½å‹æœ‰å‡ äºº</li><li>è®¡ç®—å¼ ä¸‰å’Œæå››æœ‰å“ªäº›å…±åŒå¥½å‹</li><li>æŸ¥è¯¢å“ªäº›äººæ˜¯å¼ ä¸‰çš„å¥½å‹å´ä¸æ˜¯æå››çš„å¥½å‹</li><li>æŸ¥è¯¢å¼ ä¸‰å’Œæå››çš„å¥½å‹æ€»å…±æœ‰å“ªäº›äºº</li><li>åˆ¤æ–­æå››æ˜¯å¦æ˜¯å¼ ä¸‰çš„å¥½å‹</li><li>åˆ¤æ–­å¼ ä¸‰æ˜¯å¦æ˜¯æå››çš„å¥½å‹</li><li>å°†æå››ä»å¼ ä¸‰çš„å¥½å‹åˆ—è¡¨ä¸­ç§»é™¤</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SADD zs lisi wangwu <span class="title function_">zhaoliu</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">3</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SADD ls wangwu mazi <span class="title function_">ergou</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">3</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SCARD <span class="title function_">zs</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">3</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SINTER zs ls</span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;wangwu&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SDIFF zs ls</span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;zhaoliu&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;lisi&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SUNION zs ls</span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;wangwu&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;zhaoliu&quot;</span></span><br><span class="line"><span class="number">3</span>) <span class="string">&quot;lisi&quot;</span></span><br><span class="line"><span class="number">4</span>) <span class="string">&quot;mazi&quot;</span></span><br><span class="line"><span class="number">5</span>) <span class="string">&quot;ergou&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SISMEMBER zs <span class="title function_">lisi</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">1</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SISMEMBER ls <span class="title function_">zhangsan</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SREM zs <span class="title function_">lisi</span></span><br><span class="line"><span class="params">(integer)</span> <span class="number">1</span></span><br><span class="line">    </span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SMEMBERS zs</span><br><span class="line"><span class="number">1</span>) <span class="string">&quot;zhaoliu&quot;</span></span><br><span class="line"><span class="number">2</span>) <span class="string">&quot;wangwu&quot;</span></span><br></pre></td></tr></table></figure><h3 id="SortedSetç±»å‹"><a href="#SortedSetç±»å‹" class="headerlink" title="SortedSetç±»å‹"></a>SortedSetç±»å‹</h3><p>Redisçš„SortedSetæ˜¯ä¸€ä¸ªå¯æ’åºçš„seté›†åˆï¼Œä¸Javaä¸­çš„TreeSetæœ‰äº›ç±»ä¼¼ï¼Œä½†åº•å±‚æ•°æ®ç»“æ„å´å·®åˆ«å¾ˆå¤§ã€‚SortedSetä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¸¦æœ‰ä¸€ä¸ªscoreå±æ€§ï¼Œå¯ä»¥åŸºäºscoreå±æ€§å¯¹å…ƒç´ æ’åºï¼Œåº•å±‚çš„å®ç°æ˜¯ä¸€ä¸ªè·³è¡¨ï¼ˆSkipListï¼‰åŠ  hashè¡¨ã€‚</p><p>SortedSetå…·å¤‡ä¸‹åˆ—ç‰¹æ€§ï¼š</p><ul><li>å¯æ’åº</li><li>å…ƒç´ ä¸é‡å¤</li><li>æŸ¥è¯¢é€Ÿåº¦å¿«</li></ul><p>å› ä¸ºSortedSetçš„å¯æ’åºç‰¹æ€§ï¼Œç»å¸¸è¢«ç”¨æ¥å®ç°æ’è¡Œæ¦œè¿™æ ·çš„åŠŸèƒ½ã€‚</p><p>SortedSetçš„å¸¸è§å‘½ä»¤æœ‰ï¼š</p><ul><li>ZADD key score memberï¼šæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ åˆ°sorted set ï¼Œå¦‚æœå·²ç»å­˜åœ¨åˆ™æ›´æ–°å…¶scoreå€¼</li><li>ZREM key memberï¼šåˆ é™¤sorted setä¸­çš„ä¸€ä¸ªæŒ‡å®šå…ƒç´ </li><li>ZSCORE key member : è·å–sorted setä¸­çš„æŒ‡å®šå…ƒç´ çš„scoreå€¼</li><li>ZRANK key memberï¼šè·å–sorted set ä¸­çš„æŒ‡å®šå…ƒç´ çš„æ’å</li><li>ZCARD keyï¼šè·å–sorted setä¸­çš„å…ƒç´ ä¸ªæ•°</li><li>ZCOUNT key min maxï¼šç»Ÿè®¡scoreå€¼åœ¨ç»™å®šèŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ çš„ä¸ªæ•°</li><li>ZINCRBY key increment memberï¼šè®©sorted setä¸­çš„æŒ‡å®šå…ƒç´ è‡ªå¢ï¼Œæ­¥é•¿ä¸ºæŒ‡å®šçš„incrementå€¼</li><li>ZRANGE key min maxï¼šæŒ‰ç…§scoreæ’åºåï¼Œè·å–æŒ‡å®šæ’åèŒƒå›´å†…çš„å…ƒç´ </li><li>ZRANGEBYSCORE key min maxï¼šæŒ‰ç…§scoreæ’åºåï¼Œè·å–æŒ‡å®šscoreèŒƒå›´å†…çš„å…ƒç´ </li><li>ZDIFF.ZINTER.ZUNIONï¼šæ±‚å·®é›†.äº¤é›†.å¹¶é›†</li></ul><p>æ³¨æ„ï¼šæ‰€æœ‰çš„æ’åé»˜è®¤éƒ½æ˜¯å‡åºï¼Œå¦‚æœè¦é™åºåˆ™åœ¨å‘½ä»¤çš„Zåé¢æ·»åŠ REVå³å¯ï¼Œä¾‹å¦‚ï¼š</p><ul><li><strong>å‡åº</strong>è·å–sorted set ä¸­çš„æŒ‡å®šå…ƒç´ çš„æ’åï¼šZRANK key member</li><li><strong>é™åº</strong>è·å–sorted set ä¸­çš„æŒ‡å®šå…ƒç´ çš„æ’åï¼šZREVRANK key memeber</li></ul>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå¤šçº¿ç¨‹é¢è¯•é¢˜</title>
      <link href="/posts/java-juc.html"/>
      <url>/posts/java-juc.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-Javaä¸­æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å®ç°ä¸€ä¸ªçº¿ç¨‹ï¼Ÿç”¨ä»€ä¹ˆå…³é”®å­—ä¿®é¥°åŒæ­¥æ–¹æ³•-stop-å’Œsuspend-æ–¹æ³•ä¸ºä½•ä¸æ¨èä½¿ç”¨ï¼Ÿ"><a href="#1-Javaä¸­æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å®ç°ä¸€ä¸ªçº¿ç¨‹ï¼Ÿç”¨ä»€ä¹ˆå…³é”®å­—ä¿®é¥°åŒæ­¥æ–¹æ³•-stop-å’Œsuspend-æ–¹æ³•ä¸ºä½•ä¸æ¨èä½¿ç”¨ï¼Ÿ" class="headerlink" title="1.Javaä¸­æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å®ç°ä¸€ä¸ªçº¿ç¨‹ï¼Ÿç”¨ä»€ä¹ˆå…³é”®å­—ä¿®é¥°åŒæ­¥æ–¹æ³•? stop()å’Œsuspend()æ–¹æ³•ä¸ºä½•ä¸æ¨èä½¿ç”¨ï¼Ÿ"></a><a href="">1.Javaä¸­æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å®ç°ä¸€ä¸ªçº¿ç¨‹ï¼Ÿç”¨ä»€ä¹ˆå…³é”®å­—ä¿®é¥°åŒæ­¥æ–¹æ³•? stop()å’Œsuspend()æ–¹æ³•ä¸ºä½•ä¸æ¨èä½¿ç”¨ï¼Ÿ</a></h3><p>æœ‰ä¸¤ç§å®ç°æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ç»§æ‰¿Threadç±»ä¸å®ç°Runnableæ¥å£ï¼Œç”¨synchronizedå…³é”®å­—ä¿®é¥°åŒæ­¥æ–¹æ³•ã€‚åå¯¹ä½¿ç”¨stop()ï¼Œæ˜¯å› ä¸ºå®ƒä¸å®‰å…¨ã€‚å®ƒä¼šè§£é™¤ç”±çº¿ç¨‹è·å–çš„æ‰€æœ‰é”å®šï¼Œè€Œä¸”å¦‚æœå¯¹è±¡å¤„äºä¸€ç§ä¸è¿è´¯çŠ¶æ€ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹èƒ½åœ¨é‚£ç§çŠ¶æ€ä¸‹æ£€æŸ¥å’Œä¿®æ”¹å®ƒä»¬ã€‚ç»“æœå¾ˆéš¾æ£€æŸ¥å‡ºçœŸæ­£çš„é—®é¢˜æ‰€åœ¨ã€‚suspend()æ–¹æ³•å®¹æ˜“å‘ç”Ÿæ­»é”ã€‚è°ƒç”¨suspend()çš„æ—¶å€™ï¼Œç›®æ ‡çº¿ç¨‹ä¼šåœä¸‹æ¥ï¼Œä½†å´ä»ç„¶æŒæœ‰åœ¨è¿™ä¹‹å‰è·å¾—çš„é”ã€‚æ­¤æ—¶ï¼Œå…¶ä»–ä»»ä½•çº¿ç¨‹éƒ½ä¸èƒ½è®¿é—®é”å®šçš„èµ„æºï¼Œé™¤éè¢«â€æŒ‚èµ·â€çš„çº¿ç¨‹æ¢å¤è¿è¡Œã€‚å¯¹ä»»ä½•çº¿ç¨‹æ¥è¯´ï¼Œå¦‚æœå®ƒä»¬æƒ³æ¢å¤ç›®æ ‡çº¿ç¨‹ï¼ŒåŒæ—¶åˆè¯•å›¾ä½¿ç”¨ä»»ä½•ä¸€ä¸ªé”å®šçš„èµ„æºï¼Œå°±ä¼šé€ æˆæ­»é”ã€‚æ‰€ä»¥ä¸åº”è¯¥ä½¿ç”¨suspend()ï¼Œè€Œåº”åœ¨è‡ªå·±çš„Threadç±»ä¸­ç½®å…¥ä¸€ä¸ªæ ‡å¿—ï¼ŒæŒ‡å‡ºçº¿ç¨‹åº”è¯¥æ´»åŠ¨è¿˜æ˜¯æŒ‚èµ·ã€‚è‹¥æ ‡å¿—æŒ‡å‡ºçº¿ç¨‹åº”è¯¥æŒ‚èµ·ï¼Œä¾¿ç”¨wait()å‘½å…¶è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚è‹¥æ ‡å¿—æŒ‡å‡ºçº¿ç¨‹åº”å½“æ¢å¤ï¼Œåˆ™ç”¨ä¸€ä¸ªnotify()é‡æ–°å¯åŠ¨çº¿ç¨‹ã€‚</p><h3 id="2-sleep-å’Œ-wait-æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#2-sleep-å’Œ-wait-æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="2.sleep() å’Œ wait() æœ‰ä»€ä¹ˆåŒºåˆ«?"></a><a href="">2.sleep() å’Œ wait() æœ‰ä»€ä¹ˆåŒºåˆ«?</a></h3><p>sleepæ˜¯çº¿ç¨‹ç±»ï¼ˆThreadï¼‰çš„æ–¹æ³•ï¼Œå¯¼è‡´æ­¤çº¿ç¨‹æš‚åœæ‰§è¡ŒæŒ‡å®šæ—¶é—´ï¼Œå°†æ‰§è¡Œæœºä¼šç»™å…¶ä»–çº¿ç¨‹ï¼Œä½†æ˜¯ç›‘æ§çŠ¶æ€ä¾ç„¶ä¿æŒï¼Œåˆ°æ—¶åä¼šè‡ªåŠ¨æ¢å¤ã€‚è°ƒç”¨sleepä¸ä¼šé‡Šæ”¾å¯¹è±¡é”ã€‚ waitæ˜¯Objectç±»çš„æ–¹æ³•ï¼Œå¯¹æ­¤å¯¹è±¡è°ƒç”¨waitæ–¹æ³•å¯¼è‡´æœ¬çº¿ç¨‹æ”¾å¼ƒå¯¹è±¡é”ï¼Œè¿›å…¥ç­‰å¾…æ­¤å¯¹è±¡çš„ç­‰å¾…é”å®šæ± ï¼Œåªæœ‰é’ˆå¯¹æ­¤å¯¹è±¡å‘å‡ºnotifyæ–¹æ³•ï¼ˆæˆ–notifyAllï¼‰åæœ¬çº¿ç¨‹æ‰è¿›å…¥å¯¹è±¡é”å®šæ± å‡†å¤‡è·å¾—å¯¹è±¡é”è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚</p><p>sleepå°±æ˜¯æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ä¸»åŠ¨è®©å‡ºcpuï¼Œcpuå»æ‰§è¡Œå…¶ä»–çº¿ç¨‹ï¼Œåœ¨sleepæŒ‡å®šçš„æ—¶é—´è¿‡åï¼Œcpuæ‰ä¼šå›åˆ°è¿™ä¸ªçº¿ç¨‹ä¸Šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œå¦‚æœå½“å‰çº¿ç¨‹è¿›å…¥äº†åŒæ­¥é”ï¼Œsleepæ–¹æ³•å¹¶ä¸ä¼šé‡Šæ”¾é”ï¼Œå³ä½¿å½“å‰çº¿ç¨‹ä½¿ç”¨sleepæ–¹æ³•è®©å‡ºäº†cpuï¼Œä½†å…¶ä»–è¢«åŒæ­¥é”æŒ¡ä½äº†çš„çº¿ç¨‹ä¹Ÿæ— æ³•å¾—åˆ°æ‰§è¡Œã€‚waitæ˜¯æŒ‡åœ¨ä¸€ä¸ªå·²ç»è¿›å…¥äº†åŒæ­¥é”çš„çº¿ç¨‹å†…ï¼Œè®©è‡ªå·±æš‚æ—¶è®©å‡ºåŒæ­¥é”ï¼Œä»¥ä¾¿å…¶ä»–æ­£åœ¨ç­‰å¾…æ­¤é”çš„çº¿ç¨‹å¯ä»¥å¾—åˆ°åŒæ­¥é”å¹¶è¿è¡Œï¼Œåªæœ‰å…¶ä»–çº¿ç¨‹è°ƒç”¨äº†notifyæ–¹æ³•ï¼ˆnotifyå¹¶ä¸é‡Šæ”¾é”ï¼Œåªæ˜¯å‘Šè¯‰è°ƒç”¨è¿‡waitæ–¹æ³•çš„çº¿ç¨‹å¯ä»¥å»å‚ä¸è·å¾—é”çš„ç«äº‰äº†ï¼Œä½†ä¸æ˜¯é©¬ä¸Šå¾—åˆ°é”ï¼Œå› ä¸ºé”è¿˜åœ¨åˆ«äººæ‰‹é‡Œï¼Œåˆ«äººè¿˜æ²¡é‡Šæ”¾ï¼‰,è¯¥çº¿ç¨‹æ‰èƒ½å›åˆ°å¯è¿è¡ŒçŠ¶æ€ç­‰å¾…è·å–é”ã€‚</p><h3 id="3-åŒæ­¥å’Œå¼‚æ­¥æœ‰ä½•å¼‚åŒï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹åˆ†åˆ«ä½¿ç”¨ä»–ä»¬ï¼Ÿä¸¾ä¾‹è¯´æ˜ã€‚"><a href="#3-åŒæ­¥å’Œå¼‚æ­¥æœ‰ä½•å¼‚åŒï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹åˆ†åˆ«ä½¿ç”¨ä»–ä»¬ï¼Ÿä¸¾ä¾‹è¯´æ˜ã€‚" class="headerlink" title="3.åŒæ­¥å’Œå¼‚æ­¥æœ‰ä½•å¼‚åŒï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹åˆ†åˆ«ä½¿ç”¨ä»–ä»¬ï¼Ÿä¸¾ä¾‹è¯´æ˜ã€‚"></a><a href="">3.åŒæ­¥å’Œå¼‚æ­¥æœ‰ä½•å¼‚åŒï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹åˆ†åˆ«ä½¿ç”¨ä»–ä»¬ï¼Ÿä¸¾ä¾‹è¯´æ˜ã€‚</a></h3><p>å¦‚æœæ•°æ®å°†åœ¨çº¿ç¨‹é—´å…±äº«ã€‚ä¾‹å¦‚æ­£åœ¨å†™çš„æ•°æ®ä»¥åå¯èƒ½è¢«å¦ä¸€ä¸ªçº¿ç¨‹è¯»åˆ°ï¼Œæˆ–è€…æ­£åœ¨è¯»çš„æ•°æ®å¯èƒ½å·²ç»è¢«å¦ä¸€ä¸ªçº¿ç¨‹å†™è¿‡äº†ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°±æ˜¯å…±äº«æ•°æ®ï¼Œå¿…é¡»è¿›è¡ŒåŒæ­¥å­˜å–ã€‚</p><p>å½“åº”ç”¨ç¨‹åºåœ¨å¯¹è±¡ä¸Šè°ƒç”¨äº†ä¸€ä¸ªéœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ¥æ‰§è¡Œçš„æ–¹æ³•ï¼Œå¹¶ä¸”ä¸å¸Œæœ›è®©ç¨‹åºç­‰å¾…æ–¹æ³•çš„è¿”å›æ—¶ï¼Œå°±åº”è¯¥ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹é‡‡ç”¨å¼‚æ­¥é€”å¾„å¾€å¾€æ›´æœ‰æ•ˆç‡ã€‚</p><h3 id="4-å¤šçº¿ç¨‹æœ‰å‡ ç§å®ç°æ–¹æ³•-åŒæ­¥æœ‰å‡ ç§å®ç°æ–¹æ³•"><a href="#4-å¤šçº¿ç¨‹æœ‰å‡ ç§å®ç°æ–¹æ³•-åŒæ­¥æœ‰å‡ ç§å®ç°æ–¹æ³•" class="headerlink" title="4.å¤šçº¿ç¨‹æœ‰å‡ ç§å®ç°æ–¹æ³•?åŒæ­¥æœ‰å‡ ç§å®ç°æ–¹æ³•?"></a><a href="">4.å¤šçº¿ç¨‹æœ‰å‡ ç§å®ç°æ–¹æ³•?åŒæ­¥æœ‰å‡ ç§å®ç°æ–¹æ³•?</a></h3><p>å¤šçº¿ç¨‹æœ‰ä¸¤ç§å®ç°æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ç»§æ‰¿Threadç±»ä¸å®ç°Runnableæ¥å£ã€‚</p><p>åŒæ­¥çš„å®ç°æ–¹é¢æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯synchronized,waitä¸notifyã€‚</p><p>wait():ä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„lockã€‚</p><p>sleep():ä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•è¦æ•æ‰InterruptedExceptionå¼‚å¸¸ã€‚</p><p>notify():å”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ³¨æ„çš„æ˜¯åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”±JVMç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”ä¸æ˜¯æŒ‰ä¼˜å…ˆçº§ã€‚</p><p>notityAll():å”¤é†’æ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ³¨æ„å¹¶ä¸æ˜¯ç»™æ‰€æœ‰å”¤é†’çº¿ç¨‹ä¸€ä¸ªå¯¹è±¡çš„é”ï¼Œè€Œæ˜¯è®©å®ƒä»¬ç«äº‰ã€‚</p><h3 id="5-ä¸ºä»€ä¹ˆæˆ‘ä»¬è°ƒç”¨-start-æ–¹æ³•æ—¶ä¼šæ‰§è¡Œ-run-æ–¹æ³•ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ç›´æ¥è°ƒç”¨-run-æ–¹æ³•ï¼Ÿ"><a href="#5-ä¸ºä»€ä¹ˆæˆ‘ä»¬è°ƒç”¨-start-æ–¹æ³•æ—¶ä¼šæ‰§è¡Œ-run-æ–¹æ³•ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ç›´æ¥è°ƒç”¨-run-æ–¹æ³•ï¼Ÿ" class="headerlink" title="5.ä¸ºä»€ä¹ˆæˆ‘ä»¬è°ƒç”¨ start() æ–¹æ³•æ—¶ä¼šæ‰§è¡Œ run() æ–¹æ³•ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ç›´æ¥è°ƒç”¨ run() æ–¹æ³•ï¼Ÿ"></a><a href="">5.ä¸ºä»€ä¹ˆæˆ‘ä»¬è°ƒç”¨ start() æ–¹æ³•æ—¶ä¼šæ‰§è¡Œ run() æ–¹æ³•ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ç›´æ¥è°ƒç”¨ run() æ–¹æ³•ï¼Ÿ</a></h3><p>new ä¸€ä¸ª Threadï¼Œçº¿ç¨‹è¿›å…¥äº†æ–°å»ºçŠ¶æ€ã€‚è°ƒç”¨ <code>start()</code>æ–¹æ³•ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥äº†å°±ç»ªçŠ¶æ€ï¼Œå½“åˆ†é…åˆ°æ—¶é—´ç‰‡åå°±å¯ä»¥å¼€å§‹è¿è¡Œäº†ã€‚ <code>start()</code> ä¼šæ‰§è¡Œçº¿ç¨‹çš„ç›¸åº”å‡†å¤‡å·¥ä½œï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œ <code>run()</code> æ–¹æ³•çš„å†…å®¹ï¼Œè¿™æ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹å·¥ä½œã€‚ ä½†æ˜¯ï¼Œç›´æ¥æ‰§è¡Œ <code>run()</code> æ–¹æ³•ï¼Œä¼šæŠŠ <code>run()</code> æ–¹æ³•å½“æˆä¸€ä¸ª main çº¿ç¨‹ä¸‹çš„æ™®é€šæ–¹æ³•å»æ‰§è¡Œï¼Œå¹¶ä¸ä¼šåœ¨æŸä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå®ƒï¼Œæ‰€ä»¥è¿™å¹¶ä¸æ˜¯å¤šçº¿ç¨‹å·¥ä½œã€‚</p><h3 id="6-å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªsynchronizedæ–¹æ³•åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„å…¶å®ƒæ–¹æ³•"><a href="#6-å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªsynchronizedæ–¹æ³•åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„å…¶å®ƒæ–¹æ³•" class="headerlink" title="6.å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªsynchronizedæ–¹æ³•åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„å…¶å®ƒæ–¹æ³•?"></a><a href="">6.å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªsynchronizedæ–¹æ³•åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„å…¶å®ƒæ–¹æ³•?</a></h3><p>åˆ†å‡ ç§æƒ…å†µï¼š</p><p>1ï¼‰å…¶ä»–æ–¹æ³•å‰æ˜¯å¦åŠ äº†synchronizedå…³é”®å­—ï¼Œå¦‚æœæ²¡åŠ ï¼Œåˆ™èƒ½ã€‚</p><p>2ï¼‰å¦‚æœè¿™ä¸ªæ–¹æ³•å†…éƒ¨è°ƒç”¨äº†waitï¼Œåˆ™å¯ä»¥è¿›å…¥å…¶ä»–synchronizedæ–¹æ³•ã€‚</p><p>3ï¼‰å¦‚æœå…¶ä»–ä¸ªæ–¹æ³•éƒ½åŠ äº†synchronizedå…³é”®å­—ï¼Œå¹¶ä¸”å†…éƒ¨æ²¡æœ‰è°ƒç”¨waitï¼Œåˆ™ä¸èƒ½ã€‚</p><p>4ï¼‰å¦‚æœå…¶ä»–æ–¹æ³•æ˜¯staticï¼Œå®ƒç”¨çš„åŒæ­¥é”æ˜¯å½“å‰ç±»çš„å­—èŠ‚ç ï¼Œä¸éé™æ€çš„æ–¹æ³•ä¸èƒ½åŒæ­¥ï¼Œå› ä¸ºéé™æ€çš„æ–¹æ³•ç”¨çš„æ˜¯thisã€‚</p><h3 id="7-çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€çº¿ç¨‹çš„åŸºæœ¬çŠ¶æ€ä»¥åŠçŠ¶æ€ä¹‹é—´çš„å…³ç³»ã€‚"><a href="#7-çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€çº¿ç¨‹çš„åŸºæœ¬çŠ¶æ€ä»¥åŠçŠ¶æ€ä¹‹é—´çš„å…³ç³»ã€‚" class="headerlink" title="7.çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€çº¿ç¨‹çš„åŸºæœ¬çŠ¶æ€ä»¥åŠçŠ¶æ€ä¹‹é—´çš„å…³ç³»ã€‚"></a><a href="">7.çº¿ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€çº¿ç¨‹çš„åŸºæœ¬çŠ¶æ€ä»¥åŠçŠ¶æ€ä¹‹é—´çš„å…³ç³»ã€‚</a></h3><p>ä¸€ä¸ªç¨‹åºä¸­å¯ä»¥æœ‰å¤šæ¡æ‰§è¡Œçº¿ç´¢åŒæ—¶æ‰§è¡Œï¼Œä¸€ä¸ªçº¿ç¨‹å°±æ˜¯ç¨‹åºä¸­çš„ä¸€æ¡æ‰§è¡Œçº¿ç´¢ï¼Œæ¯ä¸ªçº¿ç¨‹ä¸Šéƒ½å…³è”æœ‰è¦æ‰§è¡Œçš„ä»£ç ï¼Œå³å¯ä»¥æœ‰å¤šæ®µç¨‹åºä»£ç åŒæ—¶è¿è¡Œï¼Œæ¯ä¸ªç¨‹åºè‡³å°‘éƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå³mainæ–¹æ³•æ‰§è¡Œçš„é‚£ä¸ªçº¿ç¨‹ã€‚å¦‚æœåªæ˜¯ä¸€ä¸ªcpuï¼Œä»å®è§‚ä¸Šæ¥çœ‹ï¼Œcpuä¸€ä¼šæ‰§è¡Œaçº¿ç¨‹ï¼Œä¸€ä¼šæ‰§è¡Œbçº¿ç¨‹ï¼Œåˆ‡æ¢æ—¶é—´å¾ˆå¿«ï¼Œç»™äººçš„æ„Ÿè§‰æ˜¯a,båœ¨åŒæ—¶æ‰§è¡Œã€‚</p><p>çŠ¶æ€ï¼šå°±ç»ªï¼Œè¿è¡Œï¼Œsynchronizeé˜»å¡ï¼Œwaitå’ŒsleepæŒ‚èµ·ï¼Œç»“æŸã€‚waitå¿…é¡»åœ¨synchronizedå†…éƒ¨è°ƒç”¨ã€‚</p><p>è°ƒç”¨çº¿ç¨‹çš„startæ–¹æ³•åçº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œçº¿ç¨‹è°ƒåº¦ç³»ç»Ÿå°†å°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è½¬ä¸ºè¿è¡ŒçŠ¶æ€ï¼Œé‡åˆ°synchronizedè¯­å¥æ—¶ï¼Œç”±è¿è¡ŒçŠ¶æ€è½¬ä¸ºé˜»å¡ï¼Œå½“synchronizedè·å¾—é”åï¼Œç”±é˜»å¡è½¬ä¸ºè¿è¡Œï¼Œåœ¨è¿™ç§æƒ…å†µå¯ä»¥è°ƒç”¨waitæ–¹æ³•è½¬ä¸ºæŒ‚èµ·çŠ¶æ€ï¼Œå½“çº¿ç¨‹å…³è”çš„ä»£ç æ‰§è¡Œå®Œåï¼Œçº¿ç¨‹å˜ä¸ºç»“æŸçŠ¶æ€ã€‚</p><h3 id="8-ç®€è¿°synchronizedå’Œjava-util-concurrent-locks-Lockçš„å¼‚åŒ-ï¼Ÿ"><a href="#8-ç®€è¿°synchronizedå’Œjava-util-concurrent-locks-Lockçš„å¼‚åŒ-ï¼Ÿ" class="headerlink" title="8.ç®€è¿°synchronizedå’Œjava.util.concurrent.locks.Lockçš„å¼‚åŒ ï¼Ÿ"></a><a href="">8.ç®€è¿°synchronizedå’Œjava.util.concurrent.locks.Lockçš„å¼‚åŒ ï¼Ÿ</a></h3><p>ä¸»è¦ç›¸åŒç‚¹ï¼šLockèƒ½å®Œæˆsynchronizedæ‰€å®ç°çš„æ‰€æœ‰åŠŸèƒ½ã€‚</p><p>ä¸»è¦ä¸åŒç‚¹ï¼šLockæœ‰æ¯”synchronizedæ›´ç²¾ç¡®çš„çº¿ç¨‹è¯­ä¹‰å’Œæ›´å¥½çš„æ€§èƒ½ã€‚synchronizedä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œè€ŒLockä¸€å®šè¦æ±‚ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾ï¼Œå¹¶ä¸”å¿…é¡»åœ¨finallyä»å¥ä¸­é‡Šæ”¾ã€‚Lockè¿˜æœ‰æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼Œå®ƒçš„tryLockæ–¹æ³•å¯ä»¥éé˜»å¡æ–¹å¼å»è·å¾—é”ã€‚</p><h3 id="9-Javaå¤šçº¿ç¨‹ç¼–ç¨‹æ—¶æœ‰å“ªå‡ ç§çº¿ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿï¼ˆè·Ÿè°å­¦ï¼‰"><a href="#9-Javaå¤šçº¿ç¨‹ç¼–ç¨‹æ—¶æœ‰å“ªå‡ ç§çº¿ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿï¼ˆè·Ÿè°å­¦ï¼‰" class="headerlink" title="9.Javaå¤šçº¿ç¨‹ç¼–ç¨‹æ—¶æœ‰å“ªå‡ ç§çº¿ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿï¼ˆè·Ÿè°å­¦ï¼‰"></a><a href="">9.Javaå¤šçº¿ç¨‹ç¼–ç¨‹æ—¶æœ‰å“ªå‡ ç§çº¿ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Ÿï¼ˆè·Ÿè°å­¦ï¼‰</a></h3><ol><li><p><strong>å…±äº«å†…å­˜æ³•</strong></p><p>volatileï¼Œsynchronized</p></li><li><p><strong>wait/notifyæœºåˆ¶</strong></p><p>æ¥è‡ªObjectç±»çš„æ–¹æ³•ã€‚å½“æ»¡è¶³æŸç§æƒ…å†µæ—¶Açº¿ç¨‹è°ƒç”¨wait()æ–¹æ³•æ”¾å¼ƒCPUæ—¶é—´ç‰‡ï¼Œå¹¶è¿›å…¥é˜»å¡çŠ¶æ€ã€‚å½“æ»¡è¶³æŸç§æ¡ä»¶æ—¶ï¼ŒBçº¿ç¨‹è°ƒç”¨notify()æ–¹æ³•é€šçŸ¥Açº¿ç¨‹ã€‚å”¤é†’Açº¿ç¨‹ï¼Œå¹¶è®©å®ƒè¿›å…¥å¯è¿è¡ŒçŠ¶æ€ã€‚</p></li><li><p><strong>Lock/Conditionæœºåˆ¶</strong></p><p>Conditionæ˜¯Javaæä¾›æ¥å®ç°<strong>ç­‰å¾…/é€šçŸ¥</strong>çš„ç±»ï¼ŒConditionç±»è¿˜æä¾›æ¯”wait/notifyæ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼ŒConditionå¯¹è±¡æ˜¯ç”±lockå¯¹è±¡æ‰€åˆ›å»ºçš„ã€‚ä½†æ˜¯åŒä¸€ä¸ªé”å¯ä»¥åˆ›å»ºå¤šä¸ªConditionçš„å¯¹è±¡ï¼Œå³åˆ›å»ºå¤šä¸ªå¯¹è±¡ç›‘è§†å™¨ã€‚è¿™æ ·çš„å¥½å¤„å°±æ˜¯å¯ä»¥æŒ‡å®šå”¤é†’çº¿ç¨‹ã€‚notifyå”¤é†’çš„çº¿ç¨‹æ˜¯éšæœºå”¤é†’ä¸€ä¸ªã€‚</p></li></ol><h3 id="10-volatileå¦‚ä½•å®ç°å†…å­˜å¯è§æ€§ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰"><a href="#10-volatileå¦‚ä½•å®ç°å†…å­˜å¯è§æ€§ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰" class="headerlink" title="10.volatileå¦‚ä½•å®ç°å†…å­˜å¯è§æ€§ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰"></a><a href="">10.volatileå¦‚ä½•å®ç°å†…å­˜å¯è§æ€§ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰</a></h3><p><strong>volatileä¸ºä»€ä¹ˆä¼šå‡ºç°ï¼š</strong>ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰</p><p>é¦–å…ˆå…ˆåˆ†æä¸€ä¸‹æ²¡æœ‰volatileçš„æƒ…å†µä¸‹çº¿ç¨‹åœ¨è‡ªå·±çš„ç§æœ‰å†…å­˜ä¸­å¯¹å…±äº«å˜é‡åšå‡ºäº†æ”¹å˜ä¹‹åæ— æ³•åŠæ—¶å‘ŠçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œè¿™å°±æ˜¯volatileçš„ä½œç”¨ï¼Œè§£å†³å†…å­˜å¯è§æ€§é—®é¢˜ã€‚è¿™ç§é—®é¢˜ç”¨synchronizedå…³é”®å­—å¯ä»¥è§£å†³ã€‚ä½†æ˜¯ä¸€ä¸ªé—®é¢˜æ˜¯synchronizedæ˜¯é‡é‡çº§é”ï¼ŒåŒä¸€æ—¶é—´å†…åªå…è®¸ä¸€ä¸ªçº¿ç¨‹å»æ“ä½œå…±äº«å˜é‡ã€‚æ“ä½œå®Œæˆä¹‹åå†å°†æ”¹å˜åçš„å˜é‡å€¼åˆ·æ–°å›å…±äº«å†…å­˜ç©ºé—´ä¸­ã€‚è¿™æ ·ä¸€æ¥çš„è¯å¹¶å‘æ€§å°±æ²¡æœ‰äº†ã€‚è€Œä¸”<strong>synchronizedå…³é”®è¯çš„ä½¿ç”¨åŸºäºæ“ä½œç³»ç»Ÿå®ç°</strong>ï¼Œä¼šä½¿å¾—çº¿ç¨‹ä»ç”¨æˆ·æ€é™·å…¥å†…æ ¸æ€ã€‚è¿™ä¸€æ­¥æ˜¯å¾ˆè€—æ—¶é—´çš„ã€‚äºä½¿volatileåº”è¿è€Œç”Ÿã€‚å®ƒæ˜¯ä¸€ä¸ªè½»é‡çº§çš„synchronizedã€‚åªæ˜¯ç”¨æ¥è§£å†³å†…å­˜å¯è§æ€§é—®é¢˜çš„ã€‚</p><p><strong>1ã€volatileå¯è§æ€§å®ç°åŸç†ï¼š</strong>ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰</p><p>å˜é‡è¢«volatileå…³é”®å­—ä¿®é¥°åï¼Œåº•å±‚<strong>æ±‡ç¼–æŒ‡ä»¤</strong>ä¸­ä¼šå‡ºç°ä¸€ä¸ª<strong>lockå‰ç¼€æŒ‡ä»¤</strong>ã€‚ä¼šå¯¼è‡´ä»¥ä¸‹ä¸¤ç§äº‹æƒ…çš„å‘ç”Ÿï¼š</p><ol><li>ä¿®æ”¹volatileå˜é‡æ—¶ä¼š<strong>å¼ºåˆ¶</strong>å°†ä¿®æ”¹åçš„å€¼åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­ã€‚</li><li>ä¿®æ”¹volatileå˜é‡åä¼šå¯¼è‡´å…¶ä»–çº¿ç¨‹å·¥ä½œå†…å­˜ä¸­å¯¹åº”çš„å˜é‡å€¼å¤±æ•ˆã€‚å› æ­¤ï¼Œå†è¯»å–è¯¥å˜é‡å€¼çš„æ—¶å€™å°±éœ€è¦é‡æ–°è¯»å–ä¸»å†…å­˜ä¸­çš„å€¼ã€‚</li></ol><p><strong>2ã€volatileæœ‰åºæ€§å®ç°åŸç†ï¼š</strong>ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰</p><p><strong>æŒ‡ä»¤é‡æ’åºï¼š</strong>ç¼–è¯‘å™¨åœ¨ä¸æ”¹å˜å•çº¿ç¨‹ç¨‹åºè¯­ä¹‰çš„å‰æä¸‹ï¼Œä¼šé‡æ–°å®‰æ’è¯­å¥çš„æ‰§è¡Œé¡ºåºï¼ŒæŒ‡ä»¤é‡æ’åºåœ¨å•çº¿ç¨‹ä¸‹ä¸ä¼šæœ‰é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚</p><p>volatileæœ‰åºæ€§çš„ä¿è¯å°±æ˜¯é€šè¿‡<strong>ç¦æ­¢æŒ‡ä»¤é‡æ’åº</strong>æ¥å®ç°çš„ã€‚æŒ‡ä»¤é‡æ’åºåŒ…æ‹¬ç¼–è¯‘å™¨å’Œå¤„ç†å™¨é‡æ’åºï¼ŒJMMä¼šåˆ†åˆ«é™åˆ¶è¿™ä¸¤ç§æŒ‡ä»¤é‡æ’åºã€‚ç¦æ­¢æŒ‡ä»¤é‡æ’åºåˆæ˜¯é€šè¿‡åŠ <strong>å†…å­˜å±éšœ</strong>å®ç°çš„ã€‚</p><blockquote><p>å†…å­˜å±éšœï¼ˆmemory barriersï¼‰ï¼šä¸€ç»„å¤„ç†å™¨æŒ‡ä»¤ï¼Œç”¨äºå®ç°å¯¹å†…å­˜æ“ä½œçš„é¡ºåºé™åˆ¶ã€‚</p></blockquote><p>æ·»åŠ äº†volatileå…³é”®å­—å¯ä»¥é¿å…åŠåˆå§‹åŒ–çš„æŒ‡ä»¤é‡æ’ã€‚</p><h3 id="11-volatileä¸ºä»€ä¹ˆä¸ä¿è¯åŸå­æ€§ï¼Ÿ"><a href="#11-volatileä¸ºä»€ä¹ˆä¸ä¿è¯åŸå­æ€§ï¼Ÿ" class="headerlink" title="11.volatileä¸ºä»€ä¹ˆä¸ä¿è¯åŸå­æ€§ï¼Ÿ"></a><a href="">11.volatileä¸ºä»€ä¹ˆä¸ä¿è¯åŸå­æ€§ï¼Ÿ</a></h3><p>Javaä¸­åªæœ‰å¯¹å˜é‡çš„èµ‹å€¼å’Œè¯»å–æ˜¯åŸå­æ€§çš„ï¼Œå…¶ä»–çš„æ“ä½œéƒ½ä¸æ˜¯åŸå­æ€§çš„ã€‚æ‰€ä»¥å³ä½¿volatileå³ä½¿èƒ½ä¿è¯è¢«ä¿®é¥°çš„å˜é‡å…·æœ‰å¯è§æ€§ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯åŸå­æ€§ã€‚</p><h3 id="12-äº†è§£CountDownLatchå—ï¼Ÿ"><a href="#12-äº†è§£CountDownLatchå—ï¼Ÿ" class="headerlink" title="12.äº†è§£CountDownLatchå—ï¼Ÿ"></a><a href="">12.äº†è§£CountDownLatchå—ï¼Ÿ</a></h3><p><strong>é—­é”</strong>å¯ä»¥ç”¨æ¥ç¡®ä¿æŸäº›æ´»åŠ¨ç›´åˆ°å…¶ä»–æ´»åŠ¨å…¨éƒ¨ç»“æŸä¹‹åæ‰è¿›è¡Œï¼›</p><p>ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯<code>countDown()</code>ï¼Œä¸€ä¸ªæ˜¯<code>await()</code>;ä»¥åŠä¸€ä¸ªè®¡æ•°å™¨å˜é‡<code>cnt</code>ã€‚<code>countDown()</code> æ–¹æ³•ç”¨æ¥ç»™è®¡æ•°å™¨<code>cnt</code>å‡ä¸€ï¼› <code>await()</code> æ–¹æ³•æ˜¯ç”¨æ¥é˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°è®¡æ•°å™¨ä¸º0çš„æ—¶å€™å†å”¤é†’çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼›</p><h3 id="13-äº†è§£Semaphoreå—"><a href="#13-äº†è§£Semaphoreå—" class="headerlink" title="13.äº†è§£Semaphoreå—?"></a><a href="">13.äº†è§£Semaphoreå—?</a></h3><p>ä¿¡å·é‡ï¼Œç”¨äºå¤šä¸ªå…±äº«èµ„æºçš„äº’æ–¥ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥<strong>ç”¨æ¥æ§åˆ¶çº¿ç¨‹çš„å¹¶å‘é‡</strong>ï¼Œç±»ä¼¼äºçº¿ç¨‹æ± çš„ä½œç”¨ã€‚</p><p>å¯ä»¥ç”¨äºé™åˆ¶çº¿ç¨‹çš„å¹¶å‘æ•°ã€‚</p><h3 id="14-Thread-Local-ä½œç”¨ã€åŸç†ã€å†…å­˜æ³„æ¼é—®é¢˜ï¼Ÿï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰ï¼ˆæ»´æ»´ï¼‰"><a href="#14-Thread-Local-ä½œç”¨ã€åŸç†ã€å†…å­˜æ³„æ¼é—®é¢˜ï¼Ÿï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰ï¼ˆæ»´æ»´ï¼‰" class="headerlink" title="14.Thread Local ä½œç”¨ã€åŸç†ã€å†…å­˜æ³„æ¼é—®é¢˜ï¼Ÿï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰ï¼ˆæ»´æ»´ï¼‰"></a><a href="">14.Thread Local ä½œç”¨ã€åŸç†ã€å†…å­˜æ³„æ¼é—®é¢˜ï¼Ÿï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰ï¼ˆæ»´æ»´ï¼‰</a></h3><p><strong>ä½œç”¨ï¼š</strong></p><p><code>ThreadLocal</code>ä¸ºè§£å†³å¤šçº¿ç¨‹ä¸‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜æä¾›äº†ä¸€ä¸ªæ–°æ€è·¯ï¼Œå®ƒé€šè¿‡ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›ä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬è§£å†³äº†çº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«å˜é‡å‡ºç°çš„å®‰å…¨é—®é¢˜ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹<code>ThreadLocal</code>æ¯”ç›´æ¥ä½¿ç”¨synchronizedåŒæ­¥æœºåˆ¶è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜æ›´åŠ æ–¹ä¾¿ã€ç®€æ´ã€‚ä¸”æ‹¥æœ‰æ›´åŠ é«˜çš„å¹¶å‘æ€§ã€‚</p><p><strong>åŸç†ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> T <span class="title function_">get</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(T value)</span> &#123; &#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">()</span> &#123; &#125;</span><br><span class="line"><span class="keyword">protected</span> T <span class="title function_">initialValue</span><span class="params">()</span> &#123; &#125;</span><br></pre></td></tr></table></figure><ol><li>åœ¨æ¯ä¸ªçº¿ç¨‹Threadå†…éƒ¨æœ‰ä¸€ä¸ª<code>ThreadLocal.ThreadLocalMap</code>ç±»å‹çš„æˆå‘˜å˜é‡<code>threadLocals</code>ï¼Œè¿™ä¸ª<code>threadLocals</code>å°±æ˜¯ç”¨æ¥<strong>å­˜å‚¨å®é™…çš„å˜é‡å‰¯æœ¬</strong>çš„ï¼Œé”®å€¼ä¸ºå½“å‰<code>ThreadLocal</code>çš„å¼•ç”¨ï¼Œvalueä¸ºå˜é‡å‰¯æœ¬ï¼ˆå³Tç±»å‹çš„å˜é‡ï¼‰ã€‚</li><li>åˆå§‹æ—¶ï¼Œåœ¨Threadé‡Œé¢ï¼Œ<code>threadLocals</code>ä¸ºç©ºï¼Œå½“é€šè¿‡<code>ThreadLocal</code>å˜é‡è°ƒç”¨get()æ–¹æ³•æˆ–è€…set()æ–¹æ³•ï¼Œå°±ä¼šå¯¹Threadç±»ä¸­çš„<code>threadLocals</code>è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶ä¸”ä»¥å½“å‰<code>ThreadLocal</code>å¯¹è±¡å¼•ç”¨ä¸ºé”®å€¼ï¼Œä»¥<code>ThreadLocal</code>è¦ä¿å­˜çš„å‰¯æœ¬å˜é‡ä¸ºvalueï¼Œå­˜åˆ°<code>threadLocals</code>ã€‚</li><li>ç„¶ååœ¨å½“å‰çº¿ç¨‹é‡Œé¢ï¼Œå¦‚æœè¦ä½¿ç”¨å‰¯æœ¬å˜é‡ï¼Œå°±å¯ä»¥é€šè¿‡get()æ–¹æ³•åœ¨<code>threadLocals</code>é‡Œé¢æŸ¥æ‰¾ã€‚</li></ol><p><strong><code>ThreadLocal</code>å†…å­˜æ³„æ¼</strong></p><p>ç”±äº<code>ThreadLocalMap</code>çš„keyæ˜¯å¼±å¼•ç”¨ï¼Œè€Œ<code>Value</code>æ˜¯å¼ºå¼•ç”¨ã€‚è¿™å°±å¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜ï¼Œ<code>ThreadLocal</code>åœ¨æ²¡æœ‰å¤–éƒ¨å¯¹è±¡å¼ºå¼•ç”¨æ—¶ï¼Œå‘ç”ŸGCæ—¶ï¼ˆæ— è®ºæ˜¯å¦OOMï¼‰å¼±å¼•ç”¨Keyä¼šè¢«å›æ”¶ã€‚è¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°Entryä¸­Keyå·²ç»è¢«å›æ”¶ï¼Œå‡ºç°ä¸€ä¸ª<code>null Key</code>çš„æƒ…å†µï¼Œå¤–éƒ¨è¯»å–<code>ThreadLocalMap</code>ä¸­çš„å…ƒç´ æ˜¯æ— æ³•é€šè¿‡null Keyæ¥æ‰¾åˆ°Valueçš„ã€‚å› æ­¤å¦‚æœå½“å‰çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå¾ˆé•¿ï¼Œä¸€ç›´å­˜åœ¨ï¼Œé‚£ä¹ˆå…¶å†…éƒ¨çš„<code>ThreadLocalMap</code>å¯¹è±¡ä¹Ÿä¸€ç›´ç”Ÿå­˜ä¸‹æ¥ï¼Œè¿™äº›null keyå°±å­˜åœ¨ä¸€æ¡å¼ºå¼•ç”¨é“¾çš„å…³ç³»ä¸€ç›´å­˜åœ¨ï¼š<code>Thread --&gt; ThreadLocalMap--&gt;Entry--&gt;Value</code>ï¼Œè¿™æ¡å¼ºå¼•ç”¨é“¾ä¼šå¯¼è‡´<code>Entry</code>ä¸ä¼šå›æ”¶ï¼Œ <code>Value</code>ä¹Ÿä¸ä¼šå›æ”¶ï¼Œä½†Entryä¸­çš„Keyå´å·²ç»è¢«å›æ”¶çš„æƒ…å†µï¼Œé€ æˆ<strong>å†…å­˜æ³„æ¼</strong>ã€‚</p><p><strong>è§£å†³åŠæ³•ï¼š</strong>æ¯æ¬¡ä½¿ç”¨å®Œ<code>ThreadLocal</code>ï¼Œéƒ½è°ƒç”¨å®ƒçš„<code>remove()</code>æ–¹æ³•ï¼Œæ¸…é™¤æ•°æ®ã€‚</p><p><strong><code>ThreadLocal</code>åº”ç”¨åœºæ™¯</strong></p><p>æœ€å¸¸è§çš„<code>ThreadLocal</code>ä½¿ç”¨åœºæ™¯ä¸º ç”¨æ¥è§£å†³ æ•°æ®åº“è¿æ¥ã€Sessionç®¡ç†ç­‰ã€‚</p><h3 id="15-AQSå†…éƒ¨å¦‚ä½•æ§åˆ¶å¹¶å‘ï¼Ÿï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰"><a href="#15-AQSå†…éƒ¨å¦‚ä½•æ§åˆ¶å¹¶å‘ï¼Ÿï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰" class="headerlink" title="15.AQSå†…éƒ¨å¦‚ä½•æ§åˆ¶å¹¶å‘ï¼Ÿï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰"></a><a href="">15.AQSå†…éƒ¨å¦‚ä½•æ§åˆ¶å¹¶å‘ï¼Ÿï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰</a></h3><p><code>AQSï¼ˆAbstractQueuedSynchronizerï¼‰</code>æ˜¯<code>J.U.C</code>åŒ…ä¸‹<strong>lock</strong>å®ç°çš„æ ¸å¿ƒã€‚ä¸»è¦æ˜¯å…¶æä¾›çš„ä¸€ä¸ªFIFOçš„é˜Ÿåˆ—æ¥ç»´æŠ¤è·å–é”å¤±è´¥è€Œè¿›å…¥é˜»å¡çš„çº¿ç¨‹ï¼Œä»¥åŠä¸€ä¸ªvolatileå…³é”®å­—ä¿®é¥°çš„stateå˜é‡è¡¨ç¤ºå½“å‰åŒæ­¥çŠ¶æ€ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è·å–åˆ°åŒæ­¥çŠ¶æ€ï¼ˆä¿®æ”¹state=1ï¼‰ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹ä¾¿æ— æ³•è·å–ï¼Œè½¬è€Œè¢«æ„é€ æˆèŠ‚ç‚¹å¹¶åŠ å…¥åŒæ­¥é˜Ÿåˆ—ä¸­ã€‚<strong>åŠ å…¥é˜Ÿåˆ—çš„è¿‡ç¨‹åŸºäºCASç®—æ³•ã€‚å³æ¯”è¾ƒå½“å‰çº¿ç¨‹è®¤ä¸ºçš„å°¾èŠ‚ç‚¹ä¸å½“å‰èŠ‚ç‚¹ï¼Œæ¯”è¾ƒæˆåŠŸåæ‰èƒ½æ­£å¼åŠ å…¥é˜Ÿåˆ—å°¾éƒ¨ã€‚</strong>é˜Ÿåˆ—å¤´èŠ‚ç‚¹è¡¨ç¤ºçš„ä¸ºå½“å‰æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹æ‰§è¡Œç»“æŸåä¼šæ¿€æ´»å®ƒä¸‹é¢çš„ä¸€ä¸ªçº¿ç¨‹è¿›å…¥æ‰§è¡ŒçŠ¶æ€ã€‚</p><p>FIFOåŒæ­¥é˜Ÿåˆ—æ§åˆ¶å¹¶å‘ã€‚</p><h3 id="16-DCLå•ä¾‹ä¸ºä»€ä¹ˆéœ€è¦åŠ volatile-ï¼ˆåŠåˆå§‹åŒ–çš„æŒ‡ä»¤é‡æ’ï¼‰ï¼Ÿï¼ˆæ»´æ»´ï¼‰ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰"><a href="#16-DCLå•ä¾‹ä¸ºä»€ä¹ˆéœ€è¦åŠ volatile-ï¼ˆåŠåˆå§‹åŒ–çš„æŒ‡ä»¤é‡æ’ï¼‰ï¼Ÿï¼ˆæ»´æ»´ï¼‰ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰" class="headerlink" title="16.DCLå•ä¾‹ä¸ºä»€ä¹ˆéœ€è¦åŠ volatile ï¼ˆåŠåˆå§‹åŒ–çš„æŒ‡ä»¤é‡æ’ï¼‰ï¼Ÿï¼ˆæ»´æ»´ï¼‰ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰"></a><a href="">16.DCLå•ä¾‹ä¸ºä»€ä¹ˆéœ€è¦åŠ volatile ï¼ˆåŠåˆå§‹åŒ–çš„æŒ‡ä»¤é‡æ’ï¼‰ï¼Ÿï¼ˆæ»´æ»´ï¼‰ï¼ˆå­—èŠ‚è·³åŠ¨ï¼‰</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton uniqueInstance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  <span class="keyword">static</span> Singleton <span class="title function_">getUniqueInstance</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">//å…ˆåˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»å®ä¾‹è¿‡ï¼Œæ²¡æœ‰å®ä¾‹åŒ–è¿‡æ‰è¿›å…¥åŠ é”ä»£ç </span></span><br><span class="line">        <span class="keyword">if</span> (uniqueInstance == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">//ç±»å¯¹è±¡åŠ é”</span></span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (uniqueInstance == <span class="literal">null</span>) &#123;</span><br><span class="line">                    uniqueInstance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> uniqueInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>uniqueInstance = new Singleton();</code> è¿™æ®µä»£ç å…¶å®æ˜¯åˆ†ä¸ºä¸‰æ­¥æ‰§è¡Œï¼š</p><ol><li>ä¸º <code>uniqueInstance</code> åˆ†é…å†…å­˜ç©ºé—´</li><li>åˆå§‹åŒ– <code>uniqueInstance</code></li><li>å°† <code>uniqueInstance</code> æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€</li></ol><p>ä½†æ˜¯ç”±äº JVM å…·æœ‰æŒ‡ä»¤é‡æ’çš„ç‰¹æ€§ï¼Œæ‰§è¡Œé¡ºåºæœ‰å¯èƒ½å˜æˆ 1-&gt;3-&gt;2ã€‚æŒ‡ä»¤é‡æ’åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹è·å¾—è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹ T1 æ‰§è¡Œäº† 1 å’Œ 3ï¼Œæ­¤æ—¶ T2 è°ƒç”¨ <code>getUniqueInstance</code>() åå‘ç° <code>uniqueInstance</code> ä¸ä¸ºç©ºï¼Œå› æ­¤è¿”å› <code>uniqueInstance</code>ï¼Œä½†æ­¤æ—¶ <code>uniqueInstance</code> è¿˜æœªè¢«åˆå§‹åŒ–ã€‚ ä½¿ç”¨ <code>volatile</code> å¯ä»¥ç¦æ­¢ JVM çš„æŒ‡ä»¤é‡æ’ï¼Œä¿è¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œã€‚</p><p>volatileä¸¤ä¸ªä½œç”¨ï¼šä¿æŒçº¿ç¨‹å¯è§æ€§ï¼›<strong>ç¦æ­¢æŒ‡ä»¤é‡æ’åº</strong>ã€‚</p><p><strong>DCLå•ä¾‹éœ€è¦åŠ volatileï¼Œæ¥ç¦æ­¢æŒ‡ä»¤é‡æ’ã€‚</strong></p><p>ç”±äºjavaç¼–è¯‘å™¨å…è®¸å¤„ç†å™¨ä¹±åºæ‰§è¡Œï¼ˆä»¥è·å¾—æœ€ä¼˜çš„æ€§èƒ½ï¼‰ï¼Œnewå¯¹è±¡çš„æ“ä½œä¸æ˜¯åŸå­æ€§çš„ã€‚è¿™å¥ä»£ç æœ€ç»ˆä¼šè¢«ç¼–è¯‘æˆå¤šæ¡æ±‡ç¼–æŒ‡ä»¤ã€‚æ‰€ä»¥éœ€è¦volatileå…³é”®å­—æ¥ç¦æ­¢æŒ‡ä»¤é‡æ’ã€‚</p><p><strong>åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„è¿‡ç¨‹ä¸­ä¸€æ—¦å‡ºç°äº†æŒ‡ä»¤é‡æ’ï¼Œå¯èƒ½å°±ä¼šè·å¾—åŠåˆå§‹åŒ–çš„å¯¹è±¡ï¼Œ</strong>å³è¿˜æ²¡æ¥å¾—åŠèµ‹å€¼å°±å…ˆå»ºç«‹äº†å¼•ç”¨å…³ç³»ã€‚è¦é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿå°±è¦ä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°å®åˆ—å˜é‡ã€‚</p><p><strong>ç¬¬ä¸€æ¬¡åˆ¤æ–­singletonæ˜¯å¦ä¸ºnull</strong><br>â€ƒâ€ƒç¬¬ä¸€æ¬¡åˆ¤æ–­æ˜¯åœ¨SynchronizedåŒæ­¥ä»£ç å—å¤–è¿›è¡Œåˆ¤æ–­ï¼Œç”±äºå•ä¾‹æ¨¡å¼åªä¼šåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¹¶é€šè¿‡getInstanceæ–¹æ³•è¿”å›singletonå¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œæ˜¯ä¸ºäº†åœ¨singletonå¯¹è±¡å·²ç»åˆ›å»ºçš„æƒ…å†µä¸‹ï¼Œé¿å…è¿›å…¥åŒæ­¥ä»£ç å—ï¼Œæå‡æ•ˆç‡ã€‚</p><p><strong>ç¬¬äºŒæ¬¡åˆ¤æ–­singletonæ˜¯å¦ä¸ºnull</strong><br>â€ƒâ€ƒç¬¬äºŒæ¬¡åˆ¤æ–­æ˜¯ä¸ºäº†é¿å…ä»¥ä¸‹æƒ…å†µçš„å‘ç”Ÿã€‚<br>â€ƒâ€ƒ(1)å‡è®¾ï¼šçº¿ç¨‹Aå·²ç»ç»è¿‡ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œåˆ¤æ–­singleton=nullï¼Œå‡†å¤‡è¿›å…¥åŒæ­¥ä»£ç å—.<br>â€ƒâ€ƒ(2)æ­¤æ—¶çº¿ç¨‹Bè·å¾—æ—¶é—´ç‰‡ï¼Œç”±äºçº¿ç¨‹Aå¹¶æ²¡æœ‰åˆ›å»ºå®ä¾‹ï¼Œæ‰€ä»¥ï¼Œåˆ¤æ–­singletonä»ç„¶=nullï¼Œæ‰€ä»¥çº¿ç¨‹Båˆ›å»ºäº†å®ä¾‹singletonã€‚<br>â€ƒâ€ƒ(3)æ­¤æ—¶ï¼Œçº¿ç¨‹Aå†æ¬¡è·å¾—æ—¶é—´ç‰‡ï¼Œç”±äºåˆšåˆšç»è¿‡ç¬¬ä¸€æ¬¡åˆ¤æ–­singleton=null(ä¸ä¼šé‡å¤åˆ¤æ–­)ï¼Œè¿›å…¥åŒæ­¥ä»£ç å—ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¦‚æœä¸åŠ å…¥ç¬¬äºŒæ¬¡åˆ¤æ–­çš„è¯ï¼Œé‚£ä¹ˆçº¿ç¨‹Aåˆä¼šåˆ›é€ ä¸€ä¸ªå®ä¾‹singletonï¼Œå°±ä¸æ»¡è¶³æˆ‘ä»¬çš„å•ä¾‹æ¨¡å¼çš„è¦æ±‚ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡åˆ¤æ–­æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p><h3 id="17-Javaçš„çº¿ç¨‹æ¨¡å‹"><a href="#17-Javaçš„çº¿ç¨‹æ¨¡å‹" class="headerlink" title="17.Javaçš„çº¿ç¨‹æ¨¡å‹"></a><a href="">17.Javaçš„çº¿ç¨‹æ¨¡å‹</a></h3><p>1.ç”¨æˆ·çº¿ç¨‹ä¸å†…æ ¸çº§çº¿ç¨‹</p><p>çº¿ç¨‹çš„å®ç°å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šç”¨æˆ·çº§çº¿ç¨‹(User-LevelThread, ULT)å’Œå†…æ ¸çº§çº¿ç¨‹(Kemel-LevelThread, KLT)ã€‚ç”¨æˆ·çº¿ç¨‹ç”±ç”¨æˆ·ä»£ç æ”¯æŒï¼Œå†…æ ¸çº¿ç¨‹ç”±æ“ä½œç³»ç»Ÿå†…æ ¸æ”¯æŒã€‚</p><p>2.å¹¶å‘ä¸å¹¶è¡Œ</p><p><strong>å¹¶å‘ï¼š</strong>ä¸€ä¸ªæ—¶é—´æ®µå†…æœ‰å¾ˆå¤šçš„çº¿ç¨‹æˆ–è¿›ç¨‹åœ¨æ‰§è¡Œï¼Œä½†ä»»ä½•æ—¶é—´ç‚¹ä¸Šéƒ½åªæœ‰ä¸€ä¸ªåœ¨æ‰§è¡Œï¼Œå¤šä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹äº‰æŠ¢æ—¶é—´ç‰‡è½®æµæ‰§è¡Œã€‚<br><strong>å¹¶è¡Œï¼š</strong>ä¸€ä¸ªæ—¶é—´æ®µå’Œæ—¶é—´ç‚¹ä¸Šéƒ½æœ‰å¤šä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹åœ¨æ‰§è¡Œã€‚</p><p>3.å¤šçº¿ç¨‹æ¨¡å‹</p><p>å¤šçº¿ç¨‹æ¨¡å‹å³ç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹çš„ä¸åŒè¿æ¥æ–¹å¼ï¼Œçº¿ç¨‹æ¨¡å‹å½±å“ç€å¹¶å‘è§„æ¨¡åŠæ“ä½œæˆæœ¬(å¼€é”€)ã€‚</p><h3 id="18-çº¿ç¨‹ä¸è¿›ç¨‹åŒºåˆ«ï¼Ÿ"><a href="#18-çº¿ç¨‹ä¸è¿›ç¨‹åŒºåˆ«ï¼Ÿ" class="headerlink" title="18.çº¿ç¨‹ä¸è¿›ç¨‹åŒºåˆ«ï¼Ÿ"></a><a href="">18.<strong>çº¿ç¨‹ä¸è¿›ç¨‹åŒºåˆ«ï¼Ÿ</strong></a></h3><p>è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œæ˜¯ç³»ç»Ÿè¿è¡Œç¨‹åºçš„åŸºæœ¬å•ä½ï¼Œå› æ­¤è¿›ç¨‹æ˜¯åŠ¨æ€çš„ã€‚ç³»ç»Ÿè¿è¡Œä¸€ä¸ªç¨‹åºå³æ˜¯ä¸€ä¸ªè¿›ç¨‹ä»åˆ›å»ºï¼Œè¿è¡Œåˆ°æ¶ˆäº¡çš„è¿‡ç¨‹ã€‚</p><p>çº¿ç¨‹ä¸è¿›ç¨‹ç›¸ä¼¼ï¼Œä½†çº¿ç¨‹æ˜¯ä¸€ä¸ªæ¯”è¿›ç¨‹æ›´å°çš„æ‰§è¡Œå•ä½ã€‚ä¸€ä¸ªè¿›ç¨‹åœ¨å…¶æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å¯ä»¥äº§ç”Ÿå¤šä¸ªçº¿ç¨‹ã€‚ä¸è¿›ç¨‹ä¸åŒçš„æ˜¯åŒç±»çš„å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„<strong>å †</strong>å’Œ<strong>æ–¹æ³•åŒº</strong>èµ„æºï¼Œä½†æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„<strong>ç¨‹åºè®¡æ•°å™¨</strong>ã€<strong>è™šæ‹Ÿæœºæ ˆ</strong>å’Œ<strong>æœ¬åœ°æ–¹æ³•æ ˆ</strong>ï¼Œæ‰€ä»¥ç³»ç»Ÿåœ¨äº§ç”Ÿä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ–æ˜¯åœ¨å„ä¸ªçº¿ç¨‹ä¹‹é—´ä½œåˆ‡æ¢å·¥ä½œæ—¶ï¼Œè´Ÿæ‹…è¦æ¯”è¿›ç¨‹å°å¾—å¤šï¼Œä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œçº¿ç¨‹ä¹Ÿè¢«ç§°ä¸ºè½»é‡çº§è¿›ç¨‹ã€‚</p><p><strong>çº¿ç¨‹æ˜¯è¿›ç¨‹åˆ’åˆ†æˆçš„æ›´å°çš„è¿è¡Œå•ä½ã€‚çº¿ç¨‹å’Œè¿›ç¨‹æœ€å¤§çš„ä¸åŒåœ¨äºåŸºæœ¬ä¸Šå„è¿›ç¨‹æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œå„çº¿ç¨‹åˆ™ä¸ä¸€å®šï¼Œå› ä¸ºåŒä¸€è¿›ç¨‹ä¸­çš„çº¿ç¨‹ææœ‰å¯èƒ½ä¼šç›¸äº’å½±å“ã€‚çº¿ç¨‹æ‰§è¡Œå¼€é”€å°ï¼Œä½†ä¸åˆ©äºèµ„æºçš„ç®¡ç†å’Œä¿æŠ¤ï¼›è€Œè¿›ç¨‹æ­£ç›¸åã€‚</strong></p><h3 id="19-è°ˆä¸€ä¸‹AQSï¼Œä¸ºä»€ä¹ˆåº•å±‚ä½¿ç”¨CASå’Œvolatileï¼Ÿ-å­—èŠ‚è·³åŠ¨"><a href="#19-è°ˆä¸€ä¸‹AQSï¼Œä¸ºä»€ä¹ˆåº•å±‚ä½¿ç”¨CASå’Œvolatileï¼Ÿ-å­—èŠ‚è·³åŠ¨" class="headerlink" title="19.è°ˆä¸€ä¸‹AQSï¼Œä¸ºä»€ä¹ˆåº•å±‚ä½¿ç”¨CASå’Œvolatileï¼Ÿ(å­—èŠ‚è·³åŠ¨)"></a><a href="">19.è°ˆä¸€ä¸‹AQSï¼Œä¸ºä»€ä¹ˆåº•å±‚ä½¿ç”¨CASå’Œvolatileï¼Ÿ(å­—èŠ‚è·³åŠ¨)</a></h3><ol><li>AQSæºç ä¸­<code>state</code>çŠ¶æ€å€¼ä½¿ç”¨<code>volatile</code>ä¿®é¥°ä¿è¯å†…å­˜çš„å¯è§æ€§ã€‚å› ä¸ºæ¶‰åŠåˆ°å¤šçº¿ç¨‹å¯¹stateçš„ä¿®æ”¹ï¼Œå¿…é¡»ä¿è¯å…¶å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§ã€‚</li><li>CASæ“ä½œä¸»è¦ç”¨äºå¯¹stateå€¼çš„ä¿®æ”¹ã€‚</li></ol><h3 id="20-Synchronizedä¸ReentrantLockçš„åŒºåˆ«ï¼Ÿï¼ˆå¤ªå¤šäº†ï¼‰ï¼ˆç¾å›¢ï¼‰"><a href="#20-Synchronizedä¸ReentrantLockçš„åŒºåˆ«ï¼Ÿï¼ˆå¤ªå¤šäº†ï¼‰ï¼ˆç¾å›¢ï¼‰" class="headerlink" title="20.Synchronizedä¸ReentrantLockçš„åŒºåˆ«ï¼Ÿï¼ˆå¤ªå¤šäº†ï¼‰ï¼ˆç¾å›¢ï¼‰"></a><a href="">20.Synchronizedä¸ReentrantLockçš„åŒºåˆ«ï¼Ÿï¼ˆå¤ªå¤šäº†ï¼‰ï¼ˆç¾å›¢ï¼‰</a></h3><p><strong>å®ç°åŸç†ä¸Š:</strong></p><p><code>synchronized</code>æ˜¯ä¾é <code>jvm</code>ä»¥åŠé…åˆæ“ä½œç³»ç»Ÿæ¥å®ç°ï¼Œæ˜¯ä¸€ä¸ª<strong>å…³é”®å­—</strong>ã€‚<code>reentrantLock</code>æ˜¯<code>jdk1.5</code>ä¹‹åæä¾›çš„<strong>APIå±‚é¢</strong>çš„äº’æ–¥é”ã€‚</p><p><strong>ä½¿ç”¨ä¾¿åˆ©æ€§ä¸Šï¼š</strong></p><p><code>synchronized</code>åªéœ€è¦æ·»åŠ ä¸Šç›¸å…³å…³é”®å­—å³å¯ï¼ŒåŠ é”ä¸é‡Šæ”¾è¿‡ç¨‹ç”±æ“ä½œç³»ç»Ÿå®Œæˆã€‚<code>reentrantLock</code>åˆ™éœ€è¦æ‰‹åŠ¨åŠ é”ä¸é‡Šæ”¾é”ã€‚</p><p><strong>é”ç²’åº¦ä¸çµæ´»åº¦ï¼š</strong></p><p>reentrantLock<code>è¦å¼ºäº</code>synchronized</p><p><code>reentrantLock</code>æä¾›äº†<strong>ä¸‰ä¸ªé«˜çº§åŠŸèƒ½</strong>:</p><ol><li><strong>ç­‰å¾…å¯ä¸­æ–­</strong>ï¼ŒæŒæœ‰é”çš„çº¿ç¨‹é•¿æœŸä¸é‡Šæ”¾çš„æ—¶å€™ï¼Œæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å¯ä»¥é€‰æ‹©æ”¾å¼ƒç­‰å¾…ï¼Œè¿™ç›¸å¯¹äºSynchronizedæ¥è¯´å¯ä»¥é¿å…å‡ºç°æ­»é”çš„æƒ…å†µã€‚é€šè¿‡<code>lock.lockInterruptibly()</code>æ¥å®ç°è¿™ä¸ªæœºåˆ¶ã€‚</li><li>å¤šä¸ªçº¿ç¨‹ç­‰å¾…åŒä¸€ä¸ªé”æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ç”³è¯·é”çš„æ—¶é—´é¡ºåºè·å¾—é”ï¼ŒSynchronizedé”æ˜¯éå…¬å¹³é”ï¼Œ<code>ReentrantLock</code>é»˜è®¤çš„æ„é€ å‡½æ•°æ˜¯åˆ›å»ºçš„éå…¬å¹³é”ï¼Œå¯ä»¥é€šè¿‡å‚æ•°trueè®¾ä¸ºå…¬å¹³é”ï¼Œä½†å…¬å¹³é”è¡¨ç°çš„æ€§èƒ½ä¸æ˜¯å¾ˆå¥½ã€‚</li><li>ä¸€ä¸ª<code>ReentrantLock</code>å¯¹è±¡å¯ä»¥åŒæ—¶ç»‘å®šå¤šä¸ªå¯¹è±¡ã€‚<code>ReenTrantLock</code>æä¾›äº†ä¸€ä¸ªConditionï¼ˆæ¡ä»¶ï¼‰ç±»ï¼Œç”¨æ¥å®ç°åˆ†ç»„å”¤é†’éœ€è¦å”¤é†’çš„çº¿ç¨‹ä»¬ï¼Œè€Œä¸æ˜¯åƒsynchronizedè¦ä¹ˆéšæœºå”¤é†’ä¸€ä¸ªçº¿ç¨‹è¦ä¹ˆå”¤é†’å…¨éƒ¨çº¿ç¨‹ã€‚</li></ol><p><strong>æ€§èƒ½åŒºåˆ«ï¼š</strong></p><p><code>synchronized</code>ä¼˜åŒ–ä¹‹åæ€§èƒ½ä¸<code>reentrantLock</code>å·²ç»ä¸ç›¸ä¸Šä¸‹äº†ï¼Œå®˜æ–¹ç”šè‡³æ›´å»ºè®®ä½¿ç”¨<code>synchronized</code>å…³é”®å­—ã€‚</p><h3 id="21-Synchronizedå®ç°åŸç†ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆå­—èŠ‚ï¼‰ï¼ˆæ»´æ»´ï¼‰-å¾…å®Œå–„"><a href="#21-Synchronizedå®ç°åŸç†ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆå­—èŠ‚ï¼‰ï¼ˆæ»´æ»´ï¼‰-å¾…å®Œå–„" class="headerlink" title="21.Synchronizedå®ç°åŸç†ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆå­—èŠ‚ï¼‰ï¼ˆæ»´æ»´ï¼‰(å¾…å®Œå–„)"></a><a href="">21.Synchronizedå®ç°åŸç†ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆå­—èŠ‚ï¼‰ï¼ˆæ»´æ»´ï¼‰<code>(å¾…å®Œå–„)</code></a></h3><p><strong><code>synchronized</code> å…³é”®å­—è§£å†³çš„æ˜¯å¤šä¸ªçº¿ç¨‹ä¹‹é—´è®¿é—®èµ„æºçš„åŒæ­¥æ€§ï¼Œ<code>synchronized</code>å…³é”®å­—å¯ä»¥ä¿è¯è¢«å®ƒä¿®é¥°çš„æ–¹æ³•æˆ–è€…ä»£ç å—åœ¨ä»»æ„æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</strong></p><p>æ¯ä¸ªå¯¹è±¡ï¼ˆåœ¨å¯¹è±¡å¤´ä¸­ï¼‰æœ‰ä¸€ä¸ª<strong>ç›‘è§†å™¨é”</strong><code>ï¼ˆmonitorï¼‰</code>ï¼Œå½“monitorè¢«å ç”¨æ—¶å°±å¤„äºé”å®šçŠ¶æ€ã€‚çº¿ç¨‹æ‰§è¡Œ<code>monitorenter</code>ï¼ˆæ±‡ç¼–æŒ‡ä»¤ï¼‰å°è¯•è·å–monitorçš„æ‰€æœ‰æƒã€‚</p><ol><li>å¦‚æœmonitorè®¡æ•°å™¨å½“å‰å€¼ä¸º0ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹è¿›å…¥monitorå¹¶å°†è®¡æ•°å™¨åŠ 1ï¼Œ</li><li>å¦‚æœå½“å‰monitorè®¡æ•°å™¨å€¼ä¸ä¸º0ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹é˜»å¡å¹¶è¿›å…¥ï¼ˆOSç»´æŠ¤çš„ï¼‰é˜Ÿåˆ—ç­‰å¾…ï¼Œç­‰åˆ°OSçš„è°ƒåº¦ã€‚</li></ol><p>åº•å±‚å­—èŠ‚ç è¢«ç¼–è¯‘æˆ<code>monitorenter</code>å’Œ<code>monitorexit</code>ä¸¤ä¸ªæŒ‡ä»¤ã€‚çº¿ç¨‹æ‰§è¡Œ<code>monitorexit</code>æŒ‡ä»¤ï¼Œmonitorè®¡æ•°å™¨å‡1ï¼Œå¦‚æœå‡åˆ°0äº†ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹ä¸å†æ‹¥æœ‰è¯¥ç›‘è§†å™¨é”ã€‚ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹æœ‰æœºä¼šè·å¾—é”èµ„æºã€‚</p><p>åœ¨synchronizedå¤§ï¼ˆä¼˜åŒ–ï¼‰å‡çº§ä¹‹å‰ï¼Œæ˜¯é‡é‡çº§é”ï¼Œé”æ“ä½œéƒ½è¦ç»è¿‡OSã€‚å‘OSå†…æ ¸å»ç”³è¯·ã€‚ï¼ˆ<code>jdk1.5ä¹‹å</code>ï¼‰åˆ°ç°åœ¨çš„synchronizedæ˜¯æœ‰ä¸€ä¸ªå¤æ‚çš„é”å‡çº§è¿‡ç¨‹ã€‚</p><p><strong>æ— é” -&gt; åå‘é” -&gt; è‡ªæ—‹é”ï¼ˆè½»é‡çº§é”ï¼‰ -&gt; ï¼ˆé‡é‡çº§é”ï¼‰æ‚²è§‚é”ã€‚</strong></p><p>ä»¥ä¸Šçš„å‡çº§çŠ¶æ€éƒ½è®°å½•åœ¨å¯¹è±¡å¤´ä¸­ã€‚</p><p><strong>åå‘é”ï¼š</strong>hotspotè™šæ‹Ÿæœºè®¤ä¸ºå¤§å¤šæ•°æ—¶é—´æ˜¯ä¸å­˜åœ¨é”ç«äº‰çš„ï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½ä¼šæŠŠé”åˆ†é…ç»™ä¸Šä¸€æ¬¡è·å¾—é”çš„çº¿ç¨‹ï¼Œç›´åˆ°å‡ºç°äº†é”ç«äº‰ã€‚</p><p><strong>è‡ªæ—‹é”ï¼š</strong>çº¿ç¨‹ä¹‹é—´ä»¥CASçš„æ–¹å¼è¿›è¡Œé”èµ„æºçš„äº‰æŠ¢ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è‡ªæ—‹è¶…è¿‡äº†10æ¬¡æˆ–è€…å½“å‰è‡ªæ—‹ç­‰å¾…çš„çº¿ç¨‹è¶…è¿‡äº†CPUæ ¸æ•°çš„1/2ï¼ˆå‡çº§åä¼˜åŒ–ä¸ºè‡ªé€‚åº”è‡ªæ—‹ï¼‰ï¼Œä¼šè¿›è¡Œé”å‡çº§ã€‚</p><p><strong>synchronizedï¼š</strong> å‘OSç”³è¯·èµ„æºï¼Œä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ã€‚çº¿ç¨‹æŒ‚èµ·è¿›å…¥<strong>ç­‰å¾…é˜Ÿåˆ—</strong>ï¼Œç­‰å¾…OSçš„è°ƒåº¦ã€‚ç„¶åå†æ˜ å°„å›ç”¨æˆ·ç©ºé—´ã€‚</p><h3 id="22-è¿½é—®ï¼Œä½ åˆšæ‰æåˆ°è·å–å¯¹è±¡çš„é”ï¼Œè¿™ä¸ªâ€œé”â€åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ç¡®å®šå¯¹è±¡çš„é”ï¼Ÿï¼ˆå­—èŠ‚ï¼‰"><a href="#22-è¿½é—®ï¼Œä½ åˆšæ‰æåˆ°è·å–å¯¹è±¡çš„é”ï¼Œè¿™ä¸ªâ€œé”â€åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ç¡®å®šå¯¹è±¡çš„é”ï¼Ÿï¼ˆå­—èŠ‚ï¼‰" class="headerlink" title="22.è¿½é—®ï¼Œä½ åˆšæ‰æåˆ°è·å–å¯¹è±¡çš„é”ï¼Œè¿™ä¸ªâ€œé”â€åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ç¡®å®šå¯¹è±¡çš„é”ï¼Ÿï¼ˆå­—èŠ‚ï¼‰"></a><a href="">22.è¿½é—®ï¼Œä½ åˆšæ‰æåˆ°è·å–å¯¹è±¡çš„é”ï¼Œè¿™ä¸ªâ€œé”â€åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ç¡®å®šå¯¹è±¡çš„é”ï¼Ÿï¼ˆå­—èŠ‚ï¼‰</a></h3><p><code>synchronized</code> åŒæ­¥è¯­å¥å—çš„å®ç°ä½¿ç”¨çš„æ˜¯ <code>monitorenter</code> å’Œ <code>monitorexit</code> æŒ‡ä»¤ï¼Œå…¶ä¸­ <code>monitorenter</code> æŒ‡ä»¤æŒ‡å‘åŒæ­¥ä»£ç å—çš„å¼€å§‹ä½ç½®ï¼Œ<code>monitorexit</code> æŒ‡ä»¤åˆ™æŒ‡æ˜åŒæ­¥ä»£ç å—çš„ç»“æŸä½ç½®ã€‚å½“æ‰§è¡Œ <code>monitorenter</code> æŒ‡ä»¤æ—¶ï¼Œçº¿ç¨‹è¯•å›¾è·å–é”ä¹Ÿå°±æ˜¯è·å– <strong>å¯¹è±¡ç›‘è§†å™¨ <code>monitor</code></strong> çš„æŒæœ‰æƒã€‚</p><p>åœ¨ Java è™šæ‹Ÿæœº(HotSpot)ä¸­ï¼ŒMonitor æ˜¯åŸºäº C++å®ç°çš„ï¼Œç”±ObjectMonitor å®ç°çš„ã€‚æ¯ä¸ªå¯¹è±¡ä¸­éƒ½å†…ç½®äº†ä¸€ä¸ª <code>ObjectMonitor</code>å¯¹è±¡ã€‚</p><p>å¦å¤–ï¼Œ<code>wait/notify</code>ç­‰æ–¹æ³•ä¹Ÿä¾èµ–äº<code>monitor</code>å¯¹è±¡ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåªæœ‰åœ¨åŒæ­¥çš„å—æˆ–è€…æ–¹æ³•ä¸­æ‰èƒ½è°ƒç”¨<code>wait/notify</code>ç­‰æ–¹æ³•ï¼Œå¦åˆ™ä¼šæŠ›å‡º<code>java.lang.IllegalMonitorStateException</code>çš„å¼‚å¸¸çš„åŸå› ã€‚</p><p>åœ¨æ‰§è¡Œ<code>monitorenter</code>æ—¶ï¼Œä¼šå°è¯•è·å–å¯¹è±¡çš„é”ï¼Œå¦‚æœé”çš„è®¡æ•°å™¨ä¸º 0 åˆ™è¡¨ç¤ºé”å¯ä»¥è¢«è·å–ï¼Œè·å–åå°†é”è®¡æ•°å™¨è®¾ä¸º 1 ä¹Ÿå°±æ˜¯åŠ  1ã€‚å¯¹è±¡é”çš„çš„æ‹¥æœ‰è€…çº¿ç¨‹æ‰å¯ä»¥æ‰§è¡Œ <code>monitorexit</code> æŒ‡ä»¤æ¥é‡Šæ”¾é”ã€‚åœ¨æ‰§è¡Œ <code>monitorexit</code> æŒ‡ä»¤åï¼Œå°†é”è®¡æ•°å™¨è®¾ä¸º 0ï¼Œè¡¨æ˜é”è¢«é‡Šæ”¾ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥å°è¯•è·å–é”ã€‚å¦‚æœè·å–å¯¹è±¡é”å¤±è´¥ï¼Œé‚£å½“å‰çº¿ç¨‹å°±è¦é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°é”è¢«å¦å¤–ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾ä¸ºæ­¢ã€‚</p><h3 id="23-è¿½é—®ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥æ€§ï¼Œä¸ºä»€ä¹ˆè¯´-Synchronized-æ˜¯å¯é‡å…¥é”ï¼Ÿï¼ˆå­—èŠ‚ï¼‰"><a href="#23-è¿½é—®ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥æ€§ï¼Œä¸ºä»€ä¹ˆè¯´-Synchronized-æ˜¯å¯é‡å…¥é”ï¼Ÿï¼ˆå­—èŠ‚ï¼‰" class="headerlink" title="23.è¿½é—®ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥æ€§ï¼Œä¸ºä»€ä¹ˆè¯´ Synchronized æ˜¯å¯é‡å…¥é”ï¼Ÿï¼ˆå­—èŠ‚ï¼‰"></a><a href="">23.è¿½é—®ï¼Œä»€ä¹ˆæ˜¯å¯é‡å…¥æ€§ï¼Œä¸ºä»€ä¹ˆè¯´ Synchronized æ˜¯å¯é‡å…¥é”ï¼Ÿï¼ˆå­—èŠ‚ï¼‰</a></h3><p><strong>â€œå¯é‡å…¥é”â€</strong> æŒ‡çš„æ˜¯è‡ªå·±å¯ä»¥å†æ¬¡è·å–è‡ªå·±çš„å†…éƒ¨é”ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹è·å¾—äº†æŸä¸ªå¯¹è±¡çš„é”ï¼Œæ­¤æ—¶è¿™ä¸ªå¯¹è±¡é”è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå½“å…¶å†æ¬¡æƒ³è¦è·å–è¿™ä¸ªå¯¹è±¡çš„é”çš„æ—¶å€™è¿˜æ˜¯å¯ä»¥è·å–çš„ï¼Œå¦‚æœä¸å¯é”é‡å…¥çš„è¯ï¼Œå°±ä¼šé€ æˆæ­»é”ã€‚åŒä¸€ä¸ªçº¿ç¨‹æ¯æ¬¡è·å–é”ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢ 1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º 0 æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20220309201446490.png" alt="image-20220309201446490"></p><h3 id="24-synchronizedå¯é‡å…¥é”çš„å®ç°ï¼Ÿ"><a href="#24-synchronizedå¯é‡å…¥é”çš„å®ç°ï¼Ÿ" class="headerlink" title="24.synchronizedå¯é‡å…¥é”çš„å®ç°ï¼Ÿ"></a><a href="">24.synchronizedå¯é‡å…¥é”çš„å®ç°ï¼Ÿ</a></h3><p>é‡å…¥é”å®ç°å¯é‡å…¥æ€§åŸç†æˆ–æœºåˆ¶æ˜¯ï¼šæ¯ä¸€ä¸ªé”å…³è”ä¸€ä¸ªçº¿ç¨‹æŒæœ‰è€…å’Œè®¡æ•°å™¨ï¼Œå½“è®¡æ•°å™¨ä¸º 0 æ—¶è¡¨ç¤ºè¯¥é”æ²¡æœ‰è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰ï¼Œé‚£ä¹ˆä»»ä½•çº¿ç¨‹éƒ½å¯èƒ½è·å¾—è¯¥é”è€Œè°ƒç”¨ç›¸åº”çš„æ–¹æ³•ï¼›å½“æŸä¸€çº¿ç¨‹è¯·æ±‚æˆåŠŸåï¼ŒJVMä¼šè®°ä¸‹é”çš„æŒæœ‰çº¿ç¨‹ï¼Œå¹¶ä¸”å°†è®¡æ•°å™¨ç½®ä¸º 1ï¼›æ­¤æ—¶å…¶å®ƒçº¿ç¨‹è¯·æ±‚è¯¥é”ï¼Œåˆ™å¿…é¡»ç­‰å¾…ï¼›è€Œè¯¥æŒæœ‰é”çš„çº¿ç¨‹å¦‚æœå†æ¬¡è¯·æ±‚è¿™ä¸ªé”ï¼Œå°±å¯ä»¥å†æ¬¡æ‹¿åˆ°è¿™ä¸ªé”ï¼ŒåŒæ—¶è®¡æ•°å™¨ä¼šé€’å¢ï¼›å½“çº¿ç¨‹é€€å‡ºåŒæ­¥ä»£ç å—æ—¶ï¼Œè®¡æ•°å™¨ä¼šé€’å‡ï¼Œå¦‚æœè®¡æ•°å™¨ä¸º 0ï¼Œåˆ™é‡Šæ”¾è¯¥é”ã€‚</p><h3 id="25-è¿½é—®ï¼Œä¸ºä»€ä¹ˆè¯´-Synchronized-æ˜¯éå…¬å¹³é”"><a href="#25-è¿½é—®ï¼Œä¸ºä»€ä¹ˆè¯´-Synchronized-æ˜¯éå…¬å¹³é”" class="headerlink" title="25.è¿½é—®ï¼Œä¸ºä»€ä¹ˆè¯´ Synchronized æ˜¯éå…¬å¹³é”?"></a><a href="">25.è¿½é—®ï¼Œä¸ºä»€ä¹ˆè¯´ Synchronized æ˜¯éå…¬å¹³é”?</a></h3><p>Synchronizedåº•å±‚æ˜¯è°ƒç”¨mutexé”çš„ï¼Œå†…æ ¸æä¾›çš„è¿™ä¸ªé”å¹¶ä¸ä¿è¯å…¬å¹³ã€‚è€ŒJavaæ‰€æä¾›çš„å…¬å¹³é”Lockå®é™…ä¸Šæ˜¯ç”±Javaçš„APIæ”¯æŒçš„ï¼ˆå³å¯¹AQSçš„å®ç°ï¼‰</p><p>éå…¬å¹³æ˜¯æŒ‡åœ¨è·å–é”çš„è¡Œä¸ºä¸Šï¼Œå¹¶ä¸æ˜¯æŒ‰ç…§çº¿ç¨‹ç”³è¯·é¡ºåºè¿›è¡Œåˆ†é…çš„ï¼Œå½“é”è¢«é‡Šæ”¾åï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½æœ‰æœºä¼šè·å–åˆ°é”ï¼Œè¿™æ ·æé«˜äº†æ€§èƒ½ï¼Œä½†æ˜¯å¯èƒ½ä¼šå‡ºç°æŸäº›çº¿ç¨‹é¥¥é¥¿çš„æƒ…å†µã€‚</p><h3 id="26-ä¸ºä»€ä¹ˆè¯´-Synchronized-æ˜¯ä¸€ä¸ªæ‚²è§‚é”ï¼Ÿä¹è§‚é”çš„å®ç°åŸç†åˆæ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯-CASï¼Œå®ƒæœ‰ä»€ä¹ˆç‰¹æ€§ï¼Ÿ"><a href="#26-ä¸ºä»€ä¹ˆè¯´-Synchronized-æ˜¯ä¸€ä¸ªæ‚²è§‚é”ï¼Ÿä¹è§‚é”çš„å®ç°åŸç†åˆæ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯-CASï¼Œå®ƒæœ‰ä»€ä¹ˆç‰¹æ€§ï¼Ÿ" class="headerlink" title="26.ä¸ºä»€ä¹ˆè¯´ Synchronized æ˜¯ä¸€ä¸ªæ‚²è§‚é”ï¼Ÿä¹è§‚é”çš„å®ç°åŸç†åˆæ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯ CASï¼Œå®ƒæœ‰ä»€ä¹ˆç‰¹æ€§ï¼Ÿ"></a><a href="">26.ä¸ºä»€ä¹ˆè¯´ Synchronized æ˜¯ä¸€ä¸ªæ‚²è§‚é”ï¼Ÿä¹è§‚é”çš„å®ç°åŸç†åˆæ˜¯ä»€ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯ CASï¼Œå®ƒæœ‰ä»€ä¹ˆç‰¹æ€§ï¼Ÿ</a></h3><p>å½“ Synchronizedå‡çº§ä¸ºé‡é‡çº§é”æ—¶ï¼Œä»–æ˜¯ä¸€ä¸ªæ‚²è§‚é”ã€‚<strong>è·å–ä¸åˆ°é”èµ„æºçš„çº¿ç¨‹ç”±OSç»Ÿä¸€ç®¡ç†</strong>ï¼Œæ¶‰åŠåˆ°ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢ã€‚</p><p>ä¹è§‚é”å°±æ˜¯ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æƒ³è¦å¯¹å˜é‡è¿›è¡Œæ“ä½œæ—¶ï¼Œå…ˆè¯»å–å˜é‡å€¼ï¼Œç„¶åçœŸæ­£æ›´æ”¹æ—¶ä¼šå†æ¬¡å¯¹æ¯”å½“å‰å€¼ä¸è‡ªå·±ä¹‹å‰è¯»å–çš„å€¼æ˜¯å¦ç›¸åŒï¼Œç›¸åŒæ‰ä¼šè¿›è¡Œæ›´æ”¹ï¼Œä¸ç›¸åŒçš„è¯å°±ä¼šå†æ¬¡è¯»å–ï¼Œç„¶ååœ¨è¿›è¡Œå¯¹æ¯”æ›´æ”¹ã€‚ä¸»è¦æ˜¯åŸºäºCASå®ç°ã€‚</p><p>CAS(compare and swap) ï¼šå®ƒæ¶‰åŠåˆ°3ä¸ªæ“ä½œæ•°:1.å†…å­˜å€¼,é¢„æœŸå€¼, æ–°å€¼,åªæœ‰å½“å†…å­˜å€¼å’Œé¢„æœŸå€¼ç›¸ç­‰çš„æ—¶å€™(è¯æ˜æ²¡æœ‰å…¶ä»–çº¿ç¨‹åœ¨ä½¿ç”¨),æ‰ä¼šå°†å†…å­˜å€¼è®¾ç½®ä¸ºæ–°å€¼ã€‚</p><p>CASå…·æœ‰åŸå­æ€§,ä»–çš„åŸå­æ€§ç”±CPUä¿è¯,ç”±JNIè°ƒç”¨c++ç¡¬ä»¶ä»£ç å®ç°,<code>jdk</code>ä¸­æä¾›äº†unsafeæ¥è¿›è¡Œè¿™äº›æ“ä½œã€‚</p><h3 id="27-ä»€ä¹ˆæ˜¯é”æ¶ˆé™¤å’Œé”ç²—åŒ–ï¼Ÿ"><a href="#27-ä»€ä¹ˆæ˜¯é”æ¶ˆé™¤å’Œé”ç²—åŒ–ï¼Ÿ" class="headerlink" title="27.ä»€ä¹ˆæ˜¯é”æ¶ˆé™¤å’Œé”ç²—åŒ–ï¼Ÿ"></a><a href="">27.ä»€ä¹ˆæ˜¯é”æ¶ˆé™¤å’Œé”ç²—åŒ–ï¼Ÿ</a></h3><p>é”æ¶ˆé™¤å³åˆ é™¤ä¸å¿…è¦çš„åŠ é”æ“ä½œã€‚JVMåœ¨è¿è¡Œæ—¶ï¼Œå¯¹ä¸€äº›â€œåœ¨ä»£ç ä¸Šè¦æ±‚åŒæ­¥ï¼Œä½†æ˜¯<strong>è¢«æ£€æµ‹åˆ°ä¸å¯èƒ½å­˜åœ¨å…±äº«æ•°æ®ç«äº‰æƒ…å†µâ€çš„é”è¿›è¡Œæ¶ˆé™¤</strong>ã€‚æ ¹æ®ä»£ç é€ƒé€¸æŠ€æœ¯ï¼Œå¦‚æœåˆ¤æ–­åˆ°ä¸€æ®µä»£ç ä¸­ï¼Œ<strong>å †ä¸Šçš„æ•°æ®ä¸ä¼šé€ƒé€¸å‡ºå½“å‰çº¿ç¨‹</strong>ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¤ä¸ºè¿™æ®µä»£ç æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ— éœ€åŠ é”ã€‚</p><p>ä¸‹é¢ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LockClearTest</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">LockClearTest</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LockClearTest</span>();</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++) &#123;</span><br><span class="line">            test.append(<span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">append</span><span class="params">(String str1, String str2)</span> &#123;</span><br><span class="line">   </span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">stringBuffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        stringBuffer.append(str1).append(str2);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>StringBufferçš„appendä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> StringBuffer <span class="title function_">append</span><span class="params">(String str)</span> &#123;</span><br><span class="line">    toStringCache = <span class="literal">null</span>;</span><br><span class="line">    <span class="built_in">super</span>.append(str);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šè¿°ä»£ç çœ‹å‡ºæ¥ï¼ŒStringBufferçš„appendæ˜¯ä¸ªåŒæ­¥æ–¹æ³•ï¼Œä½†æ˜¯LockClearTestä¸­çš„ StringBuffer å±äºä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œä¸å¯èƒ½ä»è¯¥æ–¹æ³•ä¸­é€ƒé€¸å‡ºå»ï¼ˆå³stringBufferçš„å¼•ç”¨æ²¡æœ‰ä¼ é€’åˆ°è¯¥æ–¹æ³•å¤–ï¼Œä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹å¼•ç”¨ï¼‰ï¼Œå› æ­¤å…¶å®è¿™è¿‡ç¨‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥å°†é”æ¶ˆé™¤ã€‚</p><p>å‡è®¾ä¸€ç³»åˆ—çš„è¿ç»­æ“ä½œéƒ½ä¼š<strong>å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”åŠè§£é”</strong>ï¼Œç”šè‡³åŠ é”æ“ä½œæ˜¯å‡ºç°åœ¨å¾ªç¯ä½“ä¸­çš„ï¼Œå³ä½¿æ²¡æœ‰å‡ºç°çº¿ç¨‹ç«äº‰ï¼Œé¢‘ç¹åœ°è¿›è¡Œäº’æ–¥åŒæ­¥æ“ä½œä¹Ÿä¼šå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½æŸè€—ã€‚</p><p>å¦‚æœJVMæ£€æµ‹åˆ°æœ‰ä¸€è¿ä¸²é›¶ç¢çš„æ“ä½œéƒ½æ˜¯å¯¹åŒä¸€å¯¹è±¡çš„åŠ é”ï¼Œå°†ä¼š<strong>æ‰©å¤§åŠ é”åŒæ­¥çš„èŒƒå›´ï¼ˆå³é”ç²—åŒ–ï¼‰åˆ°æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨ã€‚</strong></p><p>ä¸‹é¢ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringBufferTest</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="type">StringBuffer</span> <span class="variable">stringBuffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">append</span><span class="params">()</span>&#123;</span><br><span class="line">        stringBuffer.append(<span class="string">&quot;a&quot;</span>).append(<span class="string">&quot;b&quot;</span>).append(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç æ¯æ¬¡è°ƒç”¨ stringBuffer.append æ–¹æ³•éƒ½éœ€è¦åŠ é”å’Œè§£é”ï¼Œå¦‚æœJVMæ£€æµ‹åˆ°æœ‰ä¸€è¿ä¸²çš„å¯¹åŒä¸€ä¸ªå¯¹è±¡åŠ é”å’Œè§£é”çš„æ“ä½œï¼Œå°±ä¼šå°†å…¶åˆå¹¶æˆä¸€æ¬¡èŒƒå›´æ›´å¤§çš„åŠ é”å’Œè§£é”æ“ä½œï¼Œå³åœ¨ç¬¬ä¸€æ¬¡appendæ–¹æ³•æ—¶è¿›è¡ŒåŠ é”ï¼Œæœ€åä¸€æ¬¡appendæ–¹æ³•ç»“æŸåè¿›è¡Œè§£é”ã€‚</p><h3 id="28-ä¹è§‚é”ä¸€å®šå°±æ˜¯å¥½çš„å—ï¼Ÿ"><a href="#28-ä¹è§‚é”ä¸€å®šå°±æ˜¯å¥½çš„å—ï¼Ÿ" class="headerlink" title="28.ä¹è§‚é”ä¸€å®šå°±æ˜¯å¥½çš„å—ï¼Ÿ"></a><a href="">28.ä¹è§‚é”ä¸€å®šå°±æ˜¯å¥½çš„å—ï¼Ÿ</a></h3><p>ä¸ä¸€å®š</p><ol><li>ä¹è§‚é”çš„æƒ…å†µä¸‹ï¼Œå¦‚æœçº¿ç¨‹å¹¶å‘åº¦ç¡®å®å¾ˆé«˜ï¼Œé‚£ä¹ˆå¤§å¤šæ•°çš„çº¿ç¨‹éƒ½ä¼šå¤„äºè‡ªæ—‹ç­‰å¾…ä»¥è·å–é”å¯¹è±¡çš„çŠ¶æ€ã€‚è¿™æ ·ä¼šå¯¼è‡´CPUå ç”¨è¿‡é«˜ã€‚</li><li>CASå¦ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯ABAé—®é¢˜ã€‚ä¸€ä¸ªå€¼ä»Aæ”¹ä¸ºBåˆæ”¹ä¸ºA,åˆ™CASè®¤ä¸ºæ²¡æœ‰å‘ç”Ÿå˜åŒ–,è§£å†³çš„æ–¹å¼æ˜¯ä½¿ç”¨<strong>ç‰ˆæœ¬å·</strong>æ¥è®°å½•æ“ä½œæ¬¡æ•°ã€‚</li></ol><h3 id="29-ReentrantLockå®ç°åŸç†ï¼Ÿ"><a href="#29-ReentrantLockå®ç°åŸç†ï¼Ÿ" class="headerlink" title="29.ReentrantLockå®ç°åŸç†ï¼Ÿ"></a><a href="">29.ReentrantLockå®ç°åŸç†ï¼Ÿ</a></h3><h3 id="30-AQSåŸç†ï¼Ÿ"><a href="#30-AQSåŸç†ï¼Ÿ" class="headerlink" title="30.AQSåŸç†ï¼Ÿ"></a><a href="">30.AQSåŸç†ï¼Ÿ</a></h3><p>AQSæ¡†æ¶æ˜¯ç”¨æ¥æ„å»ºé”çš„åŒæ­¥å™¨æ¡†æ¶,åŒ…æ‹¬äº†å¸¸ç”¨çš„<code>ReentrantLock</code>,<code>ReadWriteLock</code>,<code>CountDownLatch</code>ç­‰éƒ½æ˜¯åŸºäºAQSæ¡†æ¶æ¥å®ç°çš„ã€‚</p><p>AQS æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä¸”å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºè¢«å ç”¨ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€å¥—çº¿ç¨‹é˜»å¡ç­‰å¾…ä»¥åŠè¢«å”¤é†’æ—¶é”åˆ†é…çš„æœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶ AQS æ˜¯ç”¨ <strong>CLH é˜Ÿåˆ—é”</strong>å®ç°çš„ï¼Œå³å°†æš‚æ—¶è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚</p><p>AQS ä½¿ç”¨ä¸€ä¸ª int æˆå‘˜å˜é‡stateæ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œé€šè¿‡å†…ç½®çš„ FIFO é˜Ÿåˆ—æ¥å®Œæˆè·å–èµ„æºçº¿ç¨‹çš„æ’é˜Ÿå·¥ä½œã€‚AQS ä½¿ç”¨ CAS å¯¹è¯¥åŒæ­¥çŠ¶æ€stateè¿›è¡ŒåŸå­æ“ä½œå®ç°å¯¹å…¶å€¼çš„ä¿®æ”¹ã€‚</p><h3 id="31-ç¨‹åºè®¡æ•°å™¨ä¸ºä»€ä¹ˆçº¿ç¨‹æ˜¯ç§æœ‰çš„"><a href="#31-ç¨‹åºè®¡æ•°å™¨ä¸ºä»€ä¹ˆçº¿ç¨‹æ˜¯ç§æœ‰çš„" class="headerlink" title="31.ç¨‹åºè®¡æ•°å™¨ä¸ºä»€ä¹ˆçº¿ç¨‹æ˜¯ç§æœ‰çš„?"></a><a href="">31.ç¨‹åºè®¡æ•°å™¨ä¸ºä»€ä¹ˆçº¿ç¨‹æ˜¯ç§æœ‰çš„?</a></h3><p>ç¨‹åºè®¡æ•°å™¨ä¸»è¦æœ‰ä¸‹é¢ä¸¤ä¸ªä½œç”¨ï¼š</p><ol><li>å­—èŠ‚ç è§£é‡Šå™¨é€šè¿‡æ”¹å˜ç¨‹åºè®¡æ•°å™¨æ¥ä¾æ¬¡è¯»å–æŒ‡ä»¤ï¼Œä»è€Œå®ç°ä»£ç çš„æµç¨‹æ§åˆ¶ï¼Œå¦‚ï¼šé¡ºåºæ‰§è¡Œã€é€‰æ‹©ã€å¾ªç¯ã€å¼‚å¸¸å¤„ç†ã€‚</li><li>åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œç¨‹åºè®¡æ•°å™¨ç”¨äºè®°å½•å½“å‰çº¿ç¨‹æ‰§è¡Œçš„ä½ç½®ï¼Œä»è€Œå½“çº¿ç¨‹è¢«åˆ‡æ¢å›æ¥çš„æ—¶å€™èƒ½å¤ŸçŸ¥é“è¯¥çº¿ç¨‹ä¸Šæ¬¡è¿è¡Œåˆ°å“ªå„¿äº†ã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ‰§è¡Œçš„æ˜¯ native æ–¹æ³•ï¼Œé‚£ä¹ˆç¨‹åºè®¡æ•°å™¨è®°å½•çš„æ˜¯ undefined åœ°å€ï¼Œåªæœ‰æ‰§è¡Œçš„æ˜¯ Java ä»£ç æ—¶ç¨‹åºè®¡æ•°å™¨è®°å½•çš„æ‰æ˜¯ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚</p><p>æ‰€ä»¥ï¼Œç¨‹åºè®¡æ•°å™¨ç§æœ‰ä¸»è¦æ˜¯ä¸ºäº†<strong>çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®</strong>ã€‚</p><h3 id="32-è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆä¸ºä»€ä¹ˆçº¿ç¨‹æ˜¯ç§æœ‰çš„"><a href="#32-è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆä¸ºä»€ä¹ˆçº¿ç¨‹æ˜¯ç§æœ‰çš„" class="headerlink" title="32.è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆä¸ºä»€ä¹ˆçº¿ç¨‹æ˜¯ç§æœ‰çš„?"></a><a href="">32.è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆä¸ºä»€ä¹ˆçº¿ç¨‹æ˜¯ç§æœ‰çš„?</a></h3><ul><li><strong>è™šæ‹Ÿæœºæ ˆï¼š</strong> æ¯ä¸ª Java æ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€å¸¸é‡æ± å¼•ç”¨ç­‰ä¿¡æ¯ã€‚ä»æ–¹æ³•è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨ Java è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ã€‚</li><li><strong>æœ¬åœ°æ–¹æ³•æ ˆï¼š</strong> å’Œè™šæ‹Ÿæœºæ ˆæ‰€å‘æŒ¥çš„ä½œç”¨éå¸¸ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯ï¼š <strong>è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡Œ Java æ–¹æ³• ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„ Native æ–¹æ³•æœåŠ¡ã€‚</strong> åœ¨ HotSpot è™šæ‹Ÿæœºä¸­å’Œ Java è™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€ã€‚</li></ul><p>æ‰€ä»¥ï¼Œä¸ºäº†<strong>ä¿è¯çº¿ç¨‹ä¸­çš„å±€éƒ¨å˜é‡ä¸è¢«åˆ«çš„çº¿ç¨‹è®¿é—®åˆ°</strong>ï¼Œè™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆæ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚</p><h3 id="33-ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢"><a href="#33-ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢" class="headerlink" title="33.ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢?"></a><a href="">33.ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢?</a></h3><p>çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šæœ‰è‡ªå·±çš„è¿è¡Œæ¡ä»¶å’ŒçŠ¶æ€ï¼ˆä¹Ÿç§°ä¸Šä¸‹æ–‡ï¼‰ï¼Œæ¯”å¦‚ä¸Šæ–‡æ‰€è¯´åˆ°è¿‡çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ ˆä¿¡æ¯ç­‰ã€‚å½“å‡ºç°å¦‚ä¸‹æƒ…å†µçš„æ—¶å€™ï¼Œçº¿ç¨‹ä¼šä»å ç”¨ CPU çŠ¶æ€ä¸­é€€å‡ºã€‚</p><ul><li>ä¸»åŠ¨è®©å‡º CPUï¼Œæ¯”å¦‚è°ƒç”¨äº† <code>sleep()</code>, <code>wait()</code> ç­‰ã€‚</li><li>æ—¶é—´ç‰‡ç”¨å®Œï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿè¦é˜²æ­¢ä¸€ä¸ªçº¿ç¨‹æˆ–è€…è¿›ç¨‹é•¿æ—¶é—´å ç”¨CPUå¯¼è‡´å…¶ä»–çº¿ç¨‹æˆ–è€…è¿›ç¨‹é¥¿æ­»ã€‚</li><li>è°ƒç”¨äº†é˜»å¡ç±»å‹çš„ç³»ç»Ÿä¸­æ–­ï¼Œæ¯”å¦‚è¯·æ±‚ IOï¼Œçº¿ç¨‹è¢«é˜»å¡ã€‚</li><li>è¢«ç»ˆæ­¢æˆ–ç»“æŸè¿è¡Œ</li></ul><p>è¿™å…¶ä¸­å‰ä¸‰ç§éƒ½ä¼šå‘ç”Ÿçº¿ç¨‹åˆ‡æ¢ï¼Œçº¿ç¨‹åˆ‡æ¢æ„å‘³ç€éœ€è¦ä¿å­˜å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ï¼Œç•™å¾…çº¿ç¨‹ä¸‹æ¬¡å ç”¨ CPU çš„æ—¶å€™æ¢å¤ç°åœºã€‚å¹¶åŠ è½½ä¸‹ä¸€ä¸ªå°†è¦å ç”¨ CPU çš„çº¿ç¨‹ä¸Šä¸‹æ–‡ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ <strong>ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>ã€‚</p><p>ä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯ç°ä»£æ“ä½œç³»ç»Ÿçš„åŸºæœ¬åŠŸèƒ½ï¼Œå› å…¶æ¯æ¬¡éœ€è¦ä¿å­˜ä¿¡æ¯æ¢å¤ä¿¡æ¯ï¼Œè¿™å°†ä¼šå ç”¨ CPUï¼Œå†…å­˜ç­‰ç³»ç»Ÿèµ„æºè¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ„å‘³ç€æ•ˆç‡ä¼šæœ‰ä¸€å®šæŸè€—ï¼Œå¦‚æœé¢‘ç¹åˆ‡æ¢å°±ä¼šé€ æˆæ•´ä½“æ•ˆç‡ä½ä¸‹ã€‚</p><h3 id="34-äº§ç”Ÿæ­»é”å¿…é¡»å…·å¤‡ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼šï¼ˆç¾å›¢ï¼‰"><a href="#34-äº§ç”Ÿæ­»é”å¿…é¡»å…·å¤‡ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼šï¼ˆç¾å›¢ï¼‰" class="headerlink" title="34.äº§ç”Ÿæ­»é”å¿…é¡»å…·å¤‡ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼šï¼ˆç¾å›¢ï¼‰"></a><a href="">34.äº§ç”Ÿæ­»é”å¿…é¡»å…·å¤‡ä»¥ä¸‹å››ä¸ªæ¡ä»¶ï¼šï¼ˆç¾å›¢ï¼‰</a></h3><p>äº’æ–¥æ¡ä»¶ï¼šè¯¥èµ„æºä»»æ„ä¸€ä¸ªæ—¶åˆ»åªç”±ä¸€ä¸ªçº¿ç¨‹å ç”¨ã€‚</p><p>è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚</p><p>ä¸å‰¥å¤ºæ¡ä»¶:çº¿ç¨‹å·²è·å¾—çš„èµ„æºåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å¼ºè¡Œå‰¥å¤ºï¼Œåªæœ‰è‡ªå·±ä½¿ç”¨å®Œæ¯•åæ‰é‡Šæ”¾èµ„æºã€‚</p><p>å¾ªç¯ç­‰å¾…æ¡ä»¶:è‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»ã€‚</p><h3 id="35-å¦‚ä½•é¢„é˜²å’Œé¿å…çº¿ç¨‹æ­»é”"><a href="#35-å¦‚ä½•é¢„é˜²å’Œé¿å…çº¿ç¨‹æ­»é”" class="headerlink" title="35.å¦‚ä½•é¢„é˜²å’Œé¿å…çº¿ç¨‹æ­»é”?"></a><a href="">35.å¦‚ä½•é¢„é˜²å’Œé¿å…çº¿ç¨‹æ­»é”?</a></h3><p><a href="https://zhuanlan.zhihu.com/p/61221667">https://zhuanlan.zhihu.com/p/61221667</a></p><p><strong>å¦‚ä½•é¢„é˜²æ­»é”ï¼Ÿ</strong> ç ´åæ­»é”çš„äº§ç”Ÿçš„å¿…è¦æ¡ä»¶å³å¯ï¼š</p><p>â€‹    1.<strong>ç ´åäº’æ–¥æ¡ä»¶</strong>:ä½¿èµ„æºåŒæ—¶è®¿é—®è€Œéäº’æ–¥ä½¿ç”¨ï¼Œå°±æ²¡æœ‰è¿›ç¨‹ä¼šé˜»å¡åœ¨èµ„æºä¸Šï¼Œä»è€Œä¸å‘ç”Ÿæ­»é”ã€‚</p><ol><li><strong>ç ´åè¯·æ±‚ä¸ä¿æŒæ¡ä»¶</strong> ï¼šé‡‡ç”¨é™æ€åˆ†é…çš„æ–¹å¼ï¼Œé™æ€åˆ†é…çš„æ–¹å¼æ˜¯æŒ‡è¿›ç¨‹å¿…é¡»åœ¨æ‰§è¡Œä¹‹å‰å°±ç”³è¯·éœ€è¦çš„å…¨éƒ¨èµ„æºï¼Œä¸”ç›´è‡³æ‰€è¦çš„èµ„æºå…¨éƒ¨å¾—åˆ°æ»¡è¶³åæ‰å¼€å§‹æ‰§è¡Œã€‚</li><li><strong>ç ´åä¸å‰¥å¤ºæ¡ä»¶</strong> ï¼šå ç”¨éƒ¨åˆ†èµ„æºçš„çº¿ç¨‹è¿›ä¸€æ­¥ç”³è¯·å…¶ä»–èµ„æºæ—¶ï¼Œå¦‚æœç”³è¯·ä¸åˆ°ï¼Œå¯ä»¥ä¸»åŠ¨é‡Šæ”¾å®ƒå æœ‰çš„èµ„æºã€‚</li><li><strong>ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶</strong> ï¼šé æŒ‰åºç”³è¯·èµ„æºæ¥é¢„é˜²ã€‚æŒ‰æŸä¸€é¡ºåºç”³è¯·èµ„æºï¼Œé‡Šæ”¾èµ„æºåˆ™ååºé‡Šæ”¾ã€‚</li></ol><p><strong>å¦‚ä½•é¿å…æ­»é”ï¼Ÿ</strong></p><p>é¿å…æ­»é”å°±æ˜¯åœ¨èµ„æºåˆ†é…æ—¶ï¼Œå€ŸåŠ©äºç®—æ³•ï¼ˆæ¯”å¦‚é“¶è¡Œå®¶ç®—æ³•ï¼‰å¯¹èµ„æºåˆ†é…è¿›è¡Œè®¡ç®—è¯„ä¼°ï¼Œä½¿å…¶è¿›å…¥å®‰å…¨çŠ¶æ€ã€‚</p><p> <strong>å®‰å…¨çŠ¶æ€</strong> æŒ‡çš„æ˜¯ç³»ç»Ÿèƒ½å¤ŸæŒ‰ç…§æŸç§è¿›ç¨‹æ¨è¿›é¡ºåºï¼ˆP1ã€P2ã€P3â€¦..Pnï¼‰æ¥ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…æ‰€éœ€èµ„æºï¼Œç›´åˆ°æ»¡è¶³æ¯ä¸ªè¿›ç¨‹å¯¹èµ„æºçš„æœ€å¤§éœ€æ±‚ï¼Œä½¿æ¯ä¸ªè¿›ç¨‹éƒ½å¯é¡ºåˆ©å®Œæˆã€‚ç§°<P1ã€P2ã€P3.....Pn>åºåˆ—ä¸ºå®‰å…¨åºåˆ—ã€‚</p><h3 id="36-è¯´è¯´-synchronized-å…³é”®å­—å’Œ-volatile-å…³é”®å­—çš„åŒºåˆ«"><a href="#36-è¯´è¯´-synchronized-å…³é”®å­—å’Œ-volatile-å…³é”®å­—çš„åŒºåˆ«" class="headerlink" title="36.è¯´è¯´ synchronized å…³é”®å­—å’Œ volatile å…³é”®å­—çš„åŒºåˆ«"></a><a href="">36.è¯´è¯´ synchronized å…³é”®å­—å’Œ volatile å…³é”®å­—çš„åŒºåˆ«</a></h3><p><code>synchronized</code> å…³é”®å­—å’Œ <code>volatile</code> å…³é”®å­—æ˜¯ä¸¤ä¸ªäº’è¡¥çš„å­˜åœ¨ï¼Œè€Œä¸æ˜¯å¯¹ç«‹çš„å­˜åœ¨ï¼</p><ul><li><strong><code>volatile</code> å…³é”®å­—</strong>æ˜¯çº¿ç¨‹åŒæ­¥çš„<strong>è½»é‡çº§å®ç°</strong>ï¼Œæ‰€ä»¥ <strong><code>volatile</code>æ€§èƒ½è‚¯å®šæ¯”<code>synchronized</code>å…³é”®å­—è¦å¥½</strong> ã€‚ä½†æ˜¯ <strong><code>volatile</code> å…³é”®å­—åªèƒ½ç”¨äºå˜é‡è€Œ <code>synchronized</code> å…³é”®å­—å¯ä»¥ä¿®é¥°æ–¹æ³•ä»¥åŠä»£ç å—</strong> ã€‚</li><li><strong><code>volatile</code> å…³é”®å­—èƒ½ä¿è¯æ•°æ®çš„å¯è§æ€§ï¼Œä½†ä¸èƒ½ä¿è¯æ•°æ®çš„åŸå­æ€§ã€‚<code>synchronized</code> å…³é”®å­—ä¸¤è€…éƒ½èƒ½ä¿è¯ã€‚</strong></li><li><strong><code>volatile</code>å…³é”®å­—ä¸»è¦ç”¨äºè§£å†³å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§ï¼Œè€Œ <code>synchronized</code> å…³é”®å­—è§£å†³çš„æ˜¯å¤šä¸ªçº¿ç¨‹ä¹‹é—´è®¿é—®èµ„æºçš„åŒæ­¥æ€§ã€‚</strong></li></ul><h3 id="37-çº¿ç¨‹æ± ä»¥åŠä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„"><a href="#37-çº¿ç¨‹æ± ä»¥åŠä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„" class="headerlink" title="37.çº¿ç¨‹æ± ä»¥åŠä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„"></a><a href="">37.çº¿ç¨‹æ± ä»¥åŠä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„</a></h3><p>çº¿ç¨‹æ± ï¼ˆThread Poolï¼‰æ˜¯ä¸€ç§åŸºäºæ± åŒ–æ€æƒ³ç®¡ç†çº¿ç¨‹çš„å·¥å…·ï¼Œçº¿ç¨‹è¿‡å¤šä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ï¼Œå…¶ä¸­åŒ…æ‹¬åˆ›å»ºé”€æ¯çº¿ç¨‹çš„å¼€é”€ã€è°ƒåº¦çº¿ç¨‹çš„å¼€é”€ç­‰ç­‰ï¼ŒåŒæ—¶ä¹Ÿé™ä½äº†è®¡ç®—æœºçš„æ•´ä½“æ€§èƒ½ã€‚çº¿ç¨‹æ± ç»´æŠ¤å¤šä¸ªçº¿ç¨‹ï¼Œç­‰å¾…ç›‘ç£ç®¡ç†è€…åˆ†é…å¯å¹¶å‘æ‰§è¡Œçš„ä»»åŠ¡ã€‚è¿™ç§åšæ³•ï¼Œä¸€æ–¹é¢é¿å…äº†å¤„ç†ä»»åŠ¡æ—¶åˆ›å»ºé”€æ¯çº¿ç¨‹å¼€é”€çš„ä»£ä»·ï¼Œå¦ä¸€æ–¹é¢é¿å…äº†çº¿ç¨‹æ•°é‡è†¨èƒ€å¯¼è‡´çš„è¿‡åˆ†è°ƒåº¦é—®é¢˜ï¼Œä¿è¯äº†å¯¹å†…æ ¸çš„å……åˆ†åˆ©ç”¨ã€‚</p><p><strong>é™ä½èµ„æºæ¶ˆè€—</strong>ï¼šé€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</p><p><strong>æé«˜å“åº”é€Ÿåº¦</strong>ï¼šå½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</p><p><strong>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§</strong>ï¼šçº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§</p><p><strong>æä¾›æ›´å¤šæ›´å¼ºå¤§çš„åŠŸèƒ½</strong>ï¼šçº¿ç¨‹æ± å…·å¤‡å¯æ‹“å±•æ€§ï¼Œå…è®¸å¼€å‘äººå‘˜å‘å…¶ä¸­å¢åŠ æ›´å¤šçš„åŠŸèƒ½ã€‚æ¯”å¦‚å»¶æ—¶å®šæ—¶çº¿ç¨‹æ± ScheduledThreadPoolExecutorï¼Œå°±å…è®¸ä»»åŠ¡å»¶æœŸæ‰§è¡Œæˆ–å®šæœŸæ‰§è¡Œã€‚</p><h3 id="38-æ‰§è¡Œ-execute-æ–¹æ³•å’Œ-submit-æ–¹æ³•çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ"><a href="#38-æ‰§è¡Œ-execute-æ–¹æ³•å’Œ-submit-æ–¹æ³•çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ" class="headerlink" title="38.æ‰§è¡Œ execute()æ–¹æ³•å’Œ submit()æ–¹æ³•çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ"></a><a href="">38.æ‰§è¡Œ execute()æ–¹æ³•å’Œ submit()æ–¹æ³•çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</a></h3><p><strong><code>execute()</code>æ–¹æ³•ç”¨äºæäº¤ä¸éœ€è¦è¿”å›å€¼çš„ä»»åŠ¡ï¼Œæ‰€ä»¥æ— æ³•åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¢«çº¿ç¨‹æ± æ‰§è¡ŒæˆåŠŸä¸å¦ï¼›</strong></p><p><strong><code>submit()</code>æ–¹æ³•ç”¨äºæäº¤éœ€è¦è¿”å›å€¼çš„ä»»åŠ¡ã€‚çº¿ç¨‹æ± ä¼šè¿”å›ä¸€ä¸ª <code>Future</code> ç±»å‹çš„å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ª <code>Future</code> å¯¹è±¡å¯ä»¥åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æ‰§è¡ŒæˆåŠŸ</strong>ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ <code>Future</code> çš„ <code>get()</code>æ–¹æ³•æ¥è·å–è¿”å›å€¼ï¼Œ<code>get()</code>æ–¹æ³•ä¼šé˜»å¡å½“å‰çº¿ç¨‹ç›´åˆ°ä»»åŠ¡å®Œæˆï¼Œè€Œä½¿ç”¨ <code>get(long timeoutï¼ŒTimeUnit unit)</code>æ–¹æ³•åˆ™ä¼šé˜»å¡å½“å‰çº¿ç¨‹ä¸€æ®µæ—¶é—´åç«‹å³è¿”å›ï¼Œè¿™æ—¶å€™æœ‰å¯èƒ½ä»»åŠ¡æ²¡æœ‰æ‰§è¡Œå®Œã€‚</p><h3 id="39-ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ"><a href="#39-ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ" class="headerlink" title="39.ThreadPoolExecutoræ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ"></a><a href="">39.<code>ThreadPoolExecutor</code>æ„é€ å‡½æ•°é‡è¦å‚æ•°åˆ†æ</a></h3><p><strong><code>ThreadPoolExecutor</code> 3 ä¸ªæœ€é‡è¦çš„å‚æ•°ï¼š</strong></p><ul><li><strong><code>corePoolSize</code> :</strong> æ ¸å¿ƒçº¿ç¨‹æ•°å®šä¹‰äº†æœ€å°å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡ã€‚</li><li><strong><code>maximumPoolSize</code> :</strong> å½“é˜Ÿåˆ—ä¸­å­˜æ”¾çš„ä»»åŠ¡è¾¾åˆ°é˜Ÿåˆ—å®¹é‡çš„æ—¶å€™ï¼Œå½“å‰å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡å˜ä¸ºæœ€å¤§çº¿ç¨‹æ•°ã€‚</li><li><strong><code>workQueue</code>:</strong> å½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œæ–°ä»»åŠ¡å°±ä¼šè¢«å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­ã€‚</li></ul><p><code>ThreadPoolExecutor</code>å…¶ä»–å¸¸è§å‚æ•°:</p><ol><li><strong><code>keepAliveTime</code></strong>:å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äº <code>corePoolSize</code> çš„æ—¶å€™ï¼Œå¦‚æœè¿™æ—¶æ²¡æœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œæ ¸å¿ƒçº¿ç¨‹å¤–çš„çº¿ç¨‹ä¸ä¼šç«‹å³é”€æ¯ï¼Œè€Œæ˜¯ä¼šç­‰å¾…ï¼Œç›´åˆ°ç­‰å¾…çš„æ—¶é—´è¶…è¿‡äº† <code>keepAliveTime</code>æ‰ä¼šè¢«å›æ”¶é”€æ¯ï¼›</li><li><strong><code>unit</code></strong> : <code>keepAliveTime</code> å‚æ•°çš„æ—¶é—´å•ä½ã€‚</li><li><strong><code>threadFactory</code></strong> :çº¿ç¨‹å·¥å‚ã€‚</li><li><strong><code>handler</code></strong> :æ‹’ç»ç­–ç•¥ã€‚</li></ol><p>â€‹         <strong><code>ThreadPoolExecutor</code> é¥±å’Œç­–ç•¥å®šä¹‰:</strong></p><p>å¦‚æœå½“å‰åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡å¹¶ä¸”é˜Ÿåˆ—ä¹Ÿå·²ç»è¢«æ”¾æ»¡äº†ä»»åŠ¡æ—¶ï¼Œ<code>ThreadPoolTaskExecutor</code> å®šä¹‰ä¸€äº›ç­–ç•¥:</p><ul><li><strong><code>ThreadPoolExecutor.AbortPolicy</code>ï¼š</strong> æŠ›å‡º <code>RejectedExecutionException</code>æ¥æ‹’ç»æ–°ä»»åŠ¡çš„å¤„ç†ã€‚</li><li><strong><code>ThreadPoolExecutor.CallerRunsPolicy</code>ï¼š</strong> è°ƒç”¨æ‰§è¡Œè‡ªå·±çš„çº¿ç¨‹è¿è¡Œä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥åœ¨è°ƒç”¨<code>execute</code>æ–¹æ³•çš„çº¿ç¨‹ä¸­è¿è¡Œ(<code>run</code>)è¢«æ‹’ç»çš„ä»»åŠ¡ï¼Œå¦‚æœæ‰§è¡Œç¨‹åºå·²å…³é—­ï¼Œåˆ™ä¼šä¸¢å¼ƒè¯¥ä»»åŠ¡ã€‚å› æ­¤è¿™ç§ç­–ç•¥ä¼šé™ä½å¯¹äºæ–°ä»»åŠ¡æäº¤é€Ÿåº¦ï¼Œå½±å“ç¨‹åºçš„æ•´ä½“æ€§èƒ½ã€‚å¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºå¯ä»¥æ‰¿å—æ­¤å»¶è¿Ÿå¹¶ä¸”ä½ è¦æ±‚ä»»ä½•ä¸€ä¸ªä»»åŠ¡è¯·æ±‚éƒ½è¦è¢«æ‰§è¡Œçš„è¯ï¼Œä½ å¯ä»¥é€‰æ‹©è¿™ä¸ªç­–ç•¥ã€‚</li><li><strong><code>ThreadPoolExecutor.DiscardPolicy</code>ï¼š</strong> ä¸å¤„ç†æ–°ä»»åŠ¡ï¼Œç›´æ¥ä¸¢å¼ƒæ‰ã€‚</li><li><strong><code>ThreadPoolExecutor.DiscardOldestPolicy</code>ï¼š</strong> æ­¤ç­–ç•¥å°†ä¸¢å¼ƒæœ€æ—©çš„æœªå¤„ç†çš„ä»»åŠ¡è¯·æ±‚ï¼Œå°†å·¥ä½œé˜Ÿåˆ—ä¸­ç­‰å¾…åœ¨æœ€å‰é¢çš„ä»»åŠ¡ä¸¢å¼ƒï¼Œç„¶åå°†æ–°æ¥çš„ä»»åŠ¡æ”¾è¿›ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</li></ul><h3 id="40-çº¿ç¨‹æ± çš„å‚æ•°æ€ä¹ˆè®¾ç½®ï¼Ÿ"><a href="#40-çº¿ç¨‹æ± çš„å‚æ•°æ€ä¹ˆè®¾ç½®ï¼Ÿ" class="headerlink" title="40.çº¿ç¨‹æ± çš„å‚æ•°æ€ä¹ˆè®¾ç½®ï¼Ÿ"></a><a href="">40.çº¿ç¨‹æ± çš„å‚æ•°æ€ä¹ˆè®¾ç½®ï¼Ÿ</a></h3><p><strong>å¦‚æœæˆ‘ä»¬è®¾ç½®çš„çº¿ç¨‹æ± æ•°é‡å¤ªå°çš„è¯ï¼Œå¦‚æœåŒä¸€æ—¶é—´æœ‰å¤§é‡ä»»åŠ¡/è¯·æ±‚éœ€è¦å¤„ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¤§é‡çš„è¯·æ±‚/ä»»åŠ¡åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…æ‰§è¡Œï¼Œç”šè‡³ä¼šå‡ºç°ä»»åŠ¡é˜Ÿåˆ—æ»¡äº†ä¹‹åä»»åŠ¡/è¯·æ±‚æ— æ³•å¤„ç†çš„æƒ…å†µï¼Œæˆ–è€…å¤§é‡ä»»åŠ¡å †ç§¯åœ¨ä»»åŠ¡é˜Ÿåˆ—å¯¼è‡´ OOMã€‚è¿™æ ·å¾ˆæ˜æ˜¾æ˜¯æœ‰é—®é¢˜çš„ï¼ CPU æ ¹æœ¬æ²¡æœ‰å¾—åˆ°å……åˆ†åˆ©ç”¨ã€‚</strong></p><p><strong>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®çº¿ç¨‹æ•°é‡å¤ªå¤§ï¼Œå¤§é‡çº¿ç¨‹å¯èƒ½ä¼šåŒæ—¶åœ¨äº‰å– CPU èµ„æºï¼Œè¿™æ ·ä¼šå¯¼è‡´å¤§é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»è€Œå¢åŠ çº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´ï¼Œå½±å“äº†æ•´ä½“æ‰§è¡Œæ•ˆç‡ã€‚</strong></p><p>æœ‰ä¸€ä¸ªç®€å•å¹¶ä¸”é€‚ç”¨é¢æ¯”è¾ƒå¹¿çš„å…¬å¼ï¼š</p><ul><li><strong>CPU å¯†é›†å‹ä»»åŠ¡(N+1)ï¼š</strong> è¿™ç§ä»»åŠ¡æ¶ˆè€—çš„ä¸»è¦æ˜¯ CPU èµ„æºï¼Œå¯ä»¥å°†çº¿ç¨‹æ•°è®¾ç½®ä¸º Nï¼ˆCPU æ ¸å¿ƒæ•°ï¼‰+1ï¼Œæ¯” CPU æ ¸å¿ƒæ•°å¤šå‡ºæ¥çš„ä¸€ä¸ªçº¿ç¨‹æ˜¯ä¸ºäº†é˜²æ­¢çº¿ç¨‹å¶å‘çš„ç¼ºé¡µä¸­æ–­ï¼Œæˆ–è€…å…¶å®ƒåŸå› å¯¼è‡´çš„ä»»åŠ¡æš‚åœè€Œå¸¦æ¥çš„å½±å“ã€‚ä¸€æ—¦ä»»åŠ¡æš‚åœï¼ŒCPU å°±ä¼šå¤„äºç©ºé—²çŠ¶æ€ï¼Œè€Œåœ¨è¿™ç§æƒ…å†µä¸‹å¤šå‡ºæ¥çš„ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥å……åˆ†åˆ©ç”¨ CPU çš„ç©ºé—²æ—¶é—´ã€‚</li><li><strong>I/O å¯†é›†å‹ä»»åŠ¡(2N)ï¼š</strong> è¿™ç§ä»»åŠ¡åº”ç”¨èµ·æ¥ï¼Œç³»ç»Ÿä¼šç”¨å¤§éƒ¨åˆ†çš„æ—¶é—´æ¥å¤„ç† I/O äº¤äº’ï¼Œè€Œçº¿ç¨‹åœ¨å¤„ç† I/O çš„æ—¶é—´æ®µå†…ä¸ä¼šå ç”¨ CPU æ¥å¤„ç†ï¼Œè¿™æ—¶å°±å¯ä»¥å°† CPU äº¤å‡ºç»™å…¶å®ƒçº¿ç¨‹ä½¿ç”¨ã€‚å› æ­¤åœ¨ I/O å¯†é›†å‹ä»»åŠ¡çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¤šé…ç½®ä¸€äº›çº¿ç¨‹ï¼Œå…·ä½“çš„è®¡ç®—æ–¹æ³•æ˜¯ 2Nã€‚</li></ul><p><strong>å¦‚ä½•åˆ¤æ–­æ˜¯ CPU å¯†é›†ä»»åŠ¡è¿˜æ˜¯ IO å¯†é›†ä»»åŠ¡ï¼Ÿ</strong></p><p>CPU å¯†é›†å‹ç®€å•ç†è§£å°±æ˜¯åˆ©ç”¨ CPU è®¡ç®—èƒ½åŠ›çš„ä»»åŠ¡æ¯”å¦‚ä½ åœ¨å†…å­˜ä¸­å¯¹å¤§é‡æ•°æ®è¿›è¡Œæ’åºã€‚ä½†å‡¡æ¶‰åŠåˆ°ç½‘ç»œè¯»å–ï¼Œæ–‡ä»¶è¯»å–è¿™ç±»éƒ½æ˜¯ IO å¯†é›†å‹ï¼Œè¿™ç±»ä»»åŠ¡çš„ç‰¹ç‚¹æ˜¯ CPU è®¡ç®—è€—è´¹æ—¶é—´ç›¸æ¯”äºç­‰å¾… IO æ“ä½œå®Œæˆçš„æ—¶é—´æ¥è¯´å¾ˆå°‘ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨äº†ç­‰å¾… IO æ“ä½œå®Œæˆä¸Šã€‚</p><h3 id="41-æ‚²è§‚é”å’Œä¹è§‚é”çš„åŒºåˆ«"><a href="#41-æ‚²è§‚é”å’Œä¹è§‚é”çš„åŒºåˆ«" class="headerlink" title="41.æ‚²è§‚é”å’Œä¹è§‚é”çš„åŒºåˆ«"></a><a href="">41.æ‚²è§‚é”å’Œä¹è§‚é”çš„åŒºåˆ«</a></h3><p><a href="https://www.cnblogs.com/kismetv/p/10787228.html#:~:text=%E4%B9%90%E8%A7%82%E9%94%81%EF%BC%9A%E4%B9%90%E8%A7%82%E9%94%81%E5%9C%A8,%E5%88%AB%E4%BA%BA%E4%BC%9A%E5%90%8C%E6%97%B6%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E3%80%82">https://www.cnblogs.com/kismetv/p/10787228.html#:~:text=%E4%B9%90%E8%A7%82%E9%94%81%EF%BC%9A%E4%B9%90%E8%A7%82%E9%94%81%E5%9C%A8,%E5%88%AB%E4%BA%BA%E4%BC%9A%E5%90%8C%E6%97%B6%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E3%80%82</a></p><p>ä¹è§‚é”å’Œæ‚²è§‚é”æ˜¯ä¸¤ç§æ€æƒ³ï¼Œç”¨äºè§£å†³å¹¶å‘åœºæ™¯ä¸‹çš„æ•°æ®ç«äº‰é—®é¢˜ã€‚</p><ul><li>ä¹è§‚é”ï¼šä¹è§‚é”åœ¨æ“ä½œæ•°æ®æ—¶éå¸¸ä¹è§‚ï¼Œè®¤ä¸ºåˆ«äººä¸ä¼šåŒæ—¶ä¿®æ”¹æ•°æ®ã€‚å› æ­¤ä¹è§‚é”ä¸ä¼šä¸Šé”ï¼Œåªæ˜¯åœ¨æ‰§è¡Œæ›´æ–°çš„æ—¶å€™åˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæ˜¯å¦ä¿®æ”¹äº†æ•°æ®ï¼šå¦‚æœåˆ«äººä¿®æ”¹äº†æ•°æ®åˆ™æ”¾å¼ƒæ“ä½œï¼Œå¦åˆ™æ‰§è¡Œæ“ä½œã€‚</li><li>æ‚²è§‚é”ï¼šæ‚²è§‚é”åœ¨æ“ä½œæ•°æ®æ—¶æ¯”è¾ƒæ‚²è§‚ï¼Œè®¤ä¸ºåˆ«äººä¼šåŒæ—¶ä¿®æ”¹æ•°æ®ã€‚å› æ­¤æ“ä½œæ•°æ®æ—¶ç›´æ¥æŠŠæ•°æ®é”ä½ï¼Œç›´åˆ°æ“ä½œå®Œæˆåæ‰ä¼šé‡Šæ”¾é”ï¼›ä¸Šé”æœŸé—´å…¶ä»–äººä¸èƒ½ä¿®æ”¹æ•°æ®ã€‚</li></ul><h3 id="42-MySQLå¦‚ä½•å®ç°ä¹è§‚é”ï¼Ÿ"><a href="#42-MySQLå¦‚ä½•å®ç°ä¹è§‚é”ï¼Ÿ" class="headerlink" title="42.MySQLå¦‚ä½•å®ç°ä¹è§‚é”ï¼Ÿ"></a><a href="">42.MySQLå¦‚ä½•å®ç°ä¹è§‚é”ï¼Ÿ</a></h3><p>ä¹è§‚é”è®¤ä¸ºæ•°æ®ä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼šé€ æˆå†²çªï¼Œåªæœ‰å½“æ•°æ®å»æ‰§è¡Œä¿®æ”¹æƒ…å†µæ—¶ï¼Œæ‰ä¼šé’ˆå¯¹æ•°æ®å†²çªåšå¤„ç†ã€‚è¿™é‡Œæ˜¯å¦‚ä½•å‘ç°å†²çªäº†å‘¢ï¼Ÿå¸¸è§„çš„æ–¹å¼ï¼Œéƒ½æ˜¯åœ¨æ•°æ®è¡Œä¸ŠåŠ ä¸€ä¸ªç‰ˆæœ¬å·æˆ–è€…æ—¶é—´æˆ³ç­‰å­—æ®µã€‚(æœ¬æ–‡ä½¿ç”¨versionä½œä¸ºç‰ˆæœ¬å·æ–¹å¼ï¼Œä½¿ç”¨æ—¶é—´æˆ³æ–¹å¼åŒç†)</p><p>ä¹è§‚é”çš„å®ç°åŸç†ï¼š</p><ol><li>ä¸€ä¸ªäº‹åŠ¡åœ¨è¯»å–æ•°æ®æ—¶ï¼Œå°†å¯¹åº”çš„ç‰ˆæœ¬å·å­—æ®µè¯»å–å‡ºæ¥ï¼Œå‡è®¾æ­¤æ—¶çš„ç‰ˆæœ¬å·æ˜¯1ã€‚</li><li>å¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¹Ÿæ˜¯æ‰§è¡ŒåŒæ ·çš„è¯»å–æ“ä½œã€‚å½“äº‹åŠ¡ä¸€æäº¤æ—¶ï¼Œå¯¹ç‰ˆæœ¬å·æ‰§è¡Œ+1ï¼Œæ­¤æ—¶è¯¥æ•°æ®è¡Œçš„ç‰ˆæœ¬å·å°±æ˜¯2ã€‚</li><li>ç¬¬äºŒä¸ªäº‹åŠ¡æ‰§è¡Œä¿®æ”¹æ“ä½œæ—¶ï¼Œé’ˆå¯¹ä¸šåŠ¡æ•°æ®åšæ¡ä»¶ï¼Œå¹¶é»˜è®¤å¢åŠ ä¸€ä¸ªç‰ˆæœ¬å·ä½œä¸ºwhereæ¡ä»¶ã€‚æ­¤æ—¶ä¿®æ”¹è¯­å¥ä¸­çš„ç‰ˆæœ¬å·å­—æ®µæ˜¯ä¸æ»¡è¶³whereæ¡ä»¶ï¼Œè¯¥äº‹åŠ¡æ‰§è¡Œå¤±è´¥ã€‚é€šè¿‡è¿™ç§æ–¹å¼æ¥è¾¾åˆ°é”çš„åŠŸèƒ½ã€‚</li></ol><p>æ‚²è§‚é”ï¼šæ¯”è¾ƒé€‚åˆå†™å…¥æ“ä½œæ¯”è¾ƒé¢‘ç¹çš„åœºæ™¯ï¼Œå¦‚æœå‡ºç°å¤§é‡çš„è¯»å–æ“ä½œï¼Œæ¯æ¬¡è¯»å–çš„æ—¶å€™éƒ½ä¼šè¿›è¡ŒåŠ é”ï¼Œè¿™æ ·ä¼šå¢åŠ å¤§é‡çš„é”çš„å¼€é”€ï¼Œé™ä½äº†ç³»ç»Ÿçš„ååé‡ã€‚</p><p>ä¹è§‚é”ï¼šæ¯”è¾ƒé€‚åˆè¯»å–æ“ä½œæ¯”è¾ƒé¢‘ç¹çš„åœºæ™¯ï¼Œå¦‚æœå‡ºç°å¤§é‡çš„å†™å…¥æ“ä½œï¼Œæ•°æ®å‘ç”Ÿå†²çªçš„å¯èƒ½æ€§å°±ä¼šå¢å¤§ï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œåº”ç”¨å±‚éœ€è¦ä¸æ–­çš„é‡æ–°è·å–æ•°æ®ï¼Œè¿™æ ·ä¼šå¢åŠ å¤§é‡çš„æŸ¥è¯¢æ“ä½œï¼Œé™ä½äº†ç³»ç»Ÿçš„ååé‡ã€‚</p><h3 id="43-å¤šçº¿ç¨‹æ“ä½œ-static-å˜é‡ä¼šæœ‰å½±å“å—ï¼Ÿ"><a href="#43-å¤šçº¿ç¨‹æ“ä½œ-static-å˜é‡ä¼šæœ‰å½±å“å—ï¼Ÿ" class="headerlink" title="43.å¤šçº¿ç¨‹æ“ä½œ static å˜é‡ä¼šæœ‰å½±å“å—ï¼Ÿ"></a><a href="">43.å¤šçº¿ç¨‹æ“ä½œ static å˜é‡ä¼šæœ‰å½±å“å—ï¼Ÿ</a></h3><p>å½“å¤šä¸ªçº¿ç¨‹æ‰§è¡ŒåŒä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸”æ–¹æ³•ä¸­ä½¿ç”¨äº†é™æ€å˜é‡çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°å®‰å…¨é—®é¢˜ï¼Œ å› ä¸ºé™æ€æˆå‘˜ï¼ˆstatic memberï¼‰ä½œä¸ºå…¬å…±å˜é‡ï¼Œæ˜¯æ”¾åœ¨å…±äº«å†…å­˜åŒºåŸŸçš„ã€‚ å¤šä¸ªçº¿ç¨‹å…±äº«ä¸€å—å†…å­˜åŒºåŸŸï¼Œåœ¨ä¸åŠ ä»»ä½•ä¿æŠ¤æƒ…å†µä¸‹å¯¹å…¶æ“ä½œå°±ä¼šå‡ºç°å¼‚å¸¸ç»“æœã€‚</p><p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p><p>ä¸ä½¿ç”¨å…±äº«å†…å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹å†…å­˜ç©ºé—´ç›¸äº’ç‹¬ç«‹ï¼›<br>å¤šçº¿ç¨‹å…±äº«ä¸€å—å†…å­˜åŒºåŸŸï¼Œä½†æ˜¯å¯¹è¿™å—å…±äº«åŒºåŸŸåŠ é”è®¿é—®ã€‚å¯¹è°ƒç”¨staticå˜é‡çš„æ–¹æ³•ä½¿ç”¨lockæˆ–synchronized</p><h3 id="44-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹"><a href="#44-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹" class="headerlink" title="44.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹?"></a><a href="">44.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹?</a></h3><p>ä»ç³»ç»Ÿåº”ç”¨ä¸Šæ¥æ€è€ƒï¼š</p><ul><li>çº¿ç¨‹å¯ä»¥æ¯”ä½œæ˜¯è½»é‡çº§çš„è¿›ç¨‹ï¼Œæ˜¯ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ï¼Œçº¿ç¨‹é—´åˆ‡æ¢å’Œè°ƒåº¦çš„æˆæœ¬è¿œè¿œå°äºè¿›ç¨‹ã€‚å¦å¤–ï¼Œå¤šæ ¸ CPU æ—¶ä»£ï¼Œæ„å‘³ç€å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è¿è¡Œï¼Œè¿™å‡å°‘äº†çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼›</li><li>å¦‚ä»Šçš„ç³»ç»Ÿï¼ŒåŠ¨ä¸åŠ¨å°±è¦æ±‚ç™¾ä¸‡çº§ç”šè‡³äº¿ä¸‡çº§çš„å¹¶å‘é‡ï¼Œè€Œå¤šçº¿ç¨‹å¹¶å‘ç¼–ç¨‹ï¼Œæ­£æ˜¯å¼€å‘é«˜å¹¶å‘ç³»ç»Ÿçš„åŸºç¡€ï¼Œåˆ©ç”¨å¥½å¤šçº¿ç¨‹æœºåˆ¶ï¼Œå¯ä»¥å¤§å¤§æé«˜ç³»ç»Ÿæ•´ä½“çš„å¹¶å‘èƒ½åŠ›ä»¥åŠæ€§èƒ½ã€‚</li></ul><p>ä»è®¡ç®—æœºèƒŒåæ¥æ¢è®¨ï¼š</p><p><strong>å•æ ¸æ—¶ä»£ï¼š</strong> åœ¨å•æ ¸æ—¶ä»£ï¼Œå¤šçº¿ç¨‹ä¸»è¦æ˜¯ä¸ºäº†æé«˜ CPU å’Œ IO è®¾å¤‡çš„ç»¼åˆåˆ©ç”¨ç‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå½“åªæœ‰ä¸€ä¸ªçº¿ç¨‹å·¥ä½œçš„æ—¶å€™ï¼Œä¼šå¯¼è‡´ CPU è®¡ç®—æ—¶ï¼ŒIO è®¾å¤‡ç©ºé—²ï¼›è¿›è¡Œ IO æ“ä½œæ—¶ï¼ŒCPU ç©ºé—²ã€‚å¯ä»¥ç®€å•åœ°ç†è§£æˆï¼Œè¿™ä¸¤è€…çš„åˆ©ç”¨ç‡æœ€é«˜éƒ½æ˜¯ 50%å·¦å³ã€‚ä½†æ˜¯å½“æœ‰ä¸¤ä¸ªçº¿ç¨‹çš„æ—¶å€™å°±ä¸ä¸€æ ·äº†ï¼Œä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ CPU è®¡ç®—æ—¶ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥è¿›è¡Œ IO æ“ä½œï¼Œè¿™æ · CPU å’Œ IO è®¾å¤‡ä¸¤ä¸ªçš„åˆ©ç”¨ç‡å°±å¯ä»¥åœ¨ç†æƒ³æƒ…å†µä¸‹è¾¾åˆ° 100%ï¼›</p><p><strong>å¤šæ ¸æ—¶ä»£ï¼š</strong> å¤šæ ¸æ—¶ä»£å¤šçº¿ç¨‹ä¸»è¦æ˜¯ä¸ºäº†æé«˜ CPU åˆ©ç”¨ç‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‡å¦‚æˆ‘ä»¬è¦è®¡ç®—ä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬åªç”¨ä¸€ä¸ªçº¿ç¨‹çš„è¯ï¼ŒCPU åªæœ‰ä¸€ä¸ª CPU æ ¸å¿ƒè¢«åˆ©ç”¨åˆ°ï¼Œè€Œåˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼Œå°±å¯ä»¥è®©å¤šä¸ª CPU æ ¸å¿ƒè¢«åˆ©ç”¨åˆ°ï¼Œè¿™æ ·å°±æé«˜äº† CPU çš„åˆ©ç”¨ç‡ã€‚</p><p><strong>å¤šçº¿ç¨‹ç›¸æ¯”å•çº¿ç¨‹çš„ä¼˜åŠ¿ï¼Œå­˜åœ¨ä»€ä¹ˆé—®é¢˜ï¼Ÿ</strong></p><p>å¤šçº¿ç¨‹é€‚ç”¨åœºæ™¯</p><p>   1ï¼‰å­˜åœ¨éœ€è¦ç­‰å¾…IOã€ç½‘ç»œæˆ–å…¶ä»–å¤–éƒ¨èµ„æºçš„ä»»åŠ¡ã€‚å½“å‰ç­‰å¾…å…¶ä»–èµ„æºå´ä¾æ—§å ç”¨CPUçš„çº¿ç¨‹å¯è®©å‡ºCPUï¼Œè®©å…¶ä»–çº¿ç¨‹æ‰§è¡Œï¼Œå¤§å¤§æé«˜äº†ç¨‹åºæ•ˆç‡ï¼Œå……åˆ†åˆ©ç”¨äº†CPUèµ„æºã€‚</p><p>   2ï¼‰å­˜åœ¨é•¿æ—¶é—´å ç”¨CPUçš„ä»»åŠ¡ã€‚CPUä»¥æ—¶é—´ç‰‡ä¸ºå•ä½åˆ†é…ç»™å„ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªå‘¨æœŸå†…å„ä¸ªçº¿ç¨‹éƒ½å¯ä»¥å¾—åˆ°æ‰§è¡Œï¼Œè€Œéå¡åœ¨ä¸€ä¸ªçº¿ç¨‹ã€‚è€Œä¸”å¤šçº¿ç¨‹æ„å‘³ç€åˆ†é…åˆ°çš„CPUæ—¶é—´ç‰‡ä¹Ÿæ›´å¤šã€‚</p><p>å¤šçº¿ç¨‹å¼Šç«¯</p><p>   1ï¼‰è®¿é—®å…±äº«èµ„æºæ—¶è¦å°å¿ƒï¼Œéœ€è¦æ›´å¤šçš„é”èµ„æºï¼ŒåŒæ­¥æ›´åŠ å¤æ‚ã€‚</p><p>   2ï¼‰<a href="https://so.csdn.net/so/search?q=å†…å­˜&amp;spm=1001.2101.3001.7020">å†…å­˜</a>å ç”¨æ›´å¤šï¼Œèµ„æºå¼€é”€æ›´å¤§ã€‚</p><p>   3ï¼‰éœ€è¦é¢å¤–çš„çº¿ç¨‹è°ƒåº¦å’Œç®¡ç†ã€‚å¦‚éœ€è¦CPUæ—¶é—´æ¥è·Ÿè¸ªçº¿ç¨‹ã€‚</p><h3 id="45-synchronizedä¿®é¥°çš„å¯¹è±¡"><a href="#45-synchronizedä¿®é¥°çš„å¯¹è±¡" class="headerlink" title="45.synchronizedä¿®é¥°çš„å¯¹è±¡"></a><a href="">45.synchronizedä¿®é¥°çš„å¯¹è±¡</a></h3><ul><li>ä¿®é¥°ä¸€ä¸ªç±»ï¼šå…¶ä½œç”¨çš„èŒƒå›´æ˜¯synchronizedåé¢æ‹¬å·æ‹¬èµ·æ¥çš„éƒ¨åˆ†ï¼Œ<strong>ä½œç”¨çš„å¯¹è±¡æ˜¯è¿™ä¸ªç±»çš„æ‰€æœ‰å¯¹è±¡</strong>ï¼›</li><li>ä¿®é¥°ä¸€ä¸ªæ–¹æ³•ï¼šè¢«ä¿®é¥°çš„æ–¹æ³•ç§°ä¸ºåŒæ­¥æ–¹æ³•ï¼Œå…¶ä½œç”¨çš„èŒƒå›´æ˜¯æ•´ä¸ªæ–¹æ³•ï¼Œ<strong>ä½œç”¨çš„å¯¹è±¡æ˜¯è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡</strong>ï¼›</li><li>ä¿®é¥°ä¸€ä¸ªé™æ€çš„æ–¹æ³•ï¼šå…¶ä½œç”¨çš„èŒƒå›´æ˜¯æ•´ä¸ªæ–¹æ³•ï¼Œ<strong>ä½œç”¨çš„å¯¹è±¡æ˜¯è¿™ä¸ªç±»çš„æ‰€æœ‰å¯¹è±¡</strong>ï¼›</li><li>ä¿®é¥°ä¸€ä¸ªä»£ç å—ï¼šè¢«ä¿®é¥°çš„ä»£ç å—ç§°ä¸ºåŒæ­¥è¯­å¥å—ï¼Œå…¶ä½œç”¨èŒƒå›´æ˜¯å¤§æ‹¬å·{}æ‹¬èµ·æ¥çš„ä»£ç å—ï¼Œ<strong>ä½œç”¨çš„å¯¹è±¡æ˜¯è°ƒç”¨è¿™ä¸ªä»£ç å—çš„å¯¹è±¡</strong>ï¼›</li></ul><h3 id="46-BIO-NIO-AIO"><a href="#46-BIO-NIO-AIO" class="headerlink" title="46.BIO/NIO/AIO"></a><a href="">46.BIO/NIO/AIO</a></h3><h4 id="Javaä¸­çš„IOåŸç†"><a href="#Javaä¸­çš„IOåŸç†" class="headerlink" title="Javaä¸­çš„IOåŸç†"></a>Javaä¸­çš„IOåŸç†</h4><p>é¦–å…ˆJavaä¸­çš„IOéƒ½æ˜¯ä¾èµ–æ“ä½œç³»ç»Ÿå†…æ ¸è¿›è¡Œçš„ï¼Œæˆ‘ä»¬ç¨‹åºä¸­çš„IOè¯»å†™å…¶å®è°ƒç”¨çš„æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­çš„read&amp;writeä¸¤å¤§ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>é‚£å†…æ ¸æ˜¯å¦‚ä½•è¿›è¡ŒIOäº¤äº’çš„å‘¢ï¼Ÿ</p><ol><li>ç½‘å¡æ”¶åˆ°ç»è¿‡ç½‘çº¿ä¼ æ¥çš„ç½‘ç»œæ•°æ®ï¼Œå¹¶å°†ç½‘ç»œæ•°æ®å†™åˆ°å†…å­˜ä¸­ã€‚</li><li>å½“ç½‘å¡æŠŠæ•°æ®å†™å…¥åˆ°å†…å­˜åï¼Œç½‘å¡å‘cpuå‘å‡ºä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œæ“ä½œç³»ç»Ÿä¾¿èƒ½å¾—çŸ¥æœ‰æ–°æ•°æ®åˆ°æ¥ï¼Œå†é€šè¿‡ç½‘å¡ä¸­æ–­ç¨‹åºå»å¤„ç†æ•°æ®ã€‚</li><li>å°†å†…å­˜ä¸­çš„ç½‘ç»œæ•°æ®å†™å…¥åˆ°å¯¹åº”socketçš„æ¥æ”¶ç¼“å†²åŒºä¸­ã€‚</li><li>å½“æ¥æ”¶ç¼“å†²åŒºçš„æ•°æ®å†™å¥½ä¹‹åï¼Œåº”ç”¨ç¨‹åºå¼€å§‹è¿›è¡Œæ•°æ®å¤„ç†ã€‚</li></ol><p>å¯¹åº”æŠ½è±¡åˆ°javaçš„socketä»£ç ç®€å•ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SocketServer</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">// ç›‘å¬æŒ‡å®šçš„ç«¯å£</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">8080</span>;</span><br><span class="line">    <span class="type">ServerSocket</span> <span class="variable">server</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(port);</span><br><span class="line">    <span class="comment">// serverå°†ä¸€ç›´ç­‰å¾…è¿æ¥çš„åˆ°æ¥</span></span><br><span class="line">    <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> server.accept();</span><br><span class="line">    <span class="comment">// å»ºç«‹å¥½è¿æ¥åï¼Œä»socketä¸­è·å–è¾“å…¥æµï¼Œå¹¶å»ºç«‹ç¼“å†²åŒºè¿›è¡Œè¯»å–</span></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> socket.getInputStream();</span><br><span class="line">    <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">    <span class="type">int</span> len;</span><br><span class="line">    <span class="keyword">while</span> ((len = inputStream.read(bytes)) != -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="comment">//è·å–æ•°æ®è¿›è¡Œå¤„ç†</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(bytes, <span class="number">0</span>, len,<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// socketã€serverï¼Œæµå…³é—­æ“ä½œï¼Œçœç•¥ä¸è¡¨</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªè¿‡ç¨‹å’Œåº•å±‚å†…æ ¸çš„ç½‘ç»œIOå¾ˆç±»ä¼¼ï¼Œä¸»è¦ä½“ç°åœ¨accept()ç­‰å¾…ä»ç½‘ç»œä¸­çš„è¯·æ±‚åˆ°æ¥ç„¶åbytes[]æ•°ç»„ä½œä¸ºç¼“å†²åŒºç­‰å¾…æ•°æ®å¡«æ»¡åè¿›è¡Œå¤„ç†ã€‚è€ŒBIOã€NIOã€AIOä¹‹é—´çš„åŒºåˆ«å°±åœ¨äºè¿™äº›æ“ä½œæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Œé˜»å¡è¿˜æ˜¯éé˜»å¡ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¼•å‡ºåŒæ­¥å¼‚æ­¥ï¼Œé˜»å¡ä¸éé˜»å¡çš„æ¦‚å¿µã€‚</p><h4 id="åŒæ­¥ä¸å¼‚æ­¥"><a href="#åŒæ­¥ä¸å¼‚æ­¥" class="headerlink" title="åŒæ­¥ä¸å¼‚æ­¥"></a>åŒæ­¥ä¸å¼‚æ­¥</h4><p>åŒæ­¥å’Œå¼‚æ­¥æŒ‡çš„æ˜¯ä¸€ä¸ªæ‰§è¡Œæµç¨‹ä¸­æ¯ä¸ªæ–¹æ³•æ˜¯å¦å¿…é¡»ä¾èµ–å‰ä¸€ä¸ªæ–¹æ³•å®Œæˆåæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚å‡è®¾æˆ‘ä»¬çš„æ‰§è¡Œæµç¨‹ä¸­ï¼šä¾æ¬¡æ˜¯æ–¹æ³•ä¸€å’Œæ–¹æ³•äºŒã€‚</p><p>åŒæ­¥æŒ‡çš„æ˜¯è°ƒç”¨ä¸€æ—¦å¼€å§‹ï¼Œè°ƒç”¨è€…å¿…é¡»ç­‰åˆ°æ–¹æ³•è°ƒç”¨è¿”å›åï¼Œæ‰èƒ½ç»§ç»­åç»­çš„è¡Œä¸ºã€‚å³æ–¹æ³•äºŒä¸€å®šè¦ç­‰åˆ°æ–¹æ³•ä¸€æ‰§è¡Œå®Œæˆåæ‰å¯ä»¥æ‰§è¡Œã€‚</p><p>å¼‚æ­¥æŒ‡çš„æ˜¯è°ƒç”¨ç«‹åˆ»è¿”å›ï¼Œè°ƒç”¨è€…ä¸å¿…ç­‰å¾…æ–¹æ³•å†…çš„ä»£ç æ‰§è¡Œç»“æŸï¼Œå°±å¯ä»¥ç»§ç»­åç»­çš„è¡Œä¸ºã€‚ï¼ˆå…·ä½“æ–¹æ³•å†…çš„ä»£ç äº¤ç”±å¦å¤–çš„çº¿ç¨‹æ‰§è¡Œå®Œæˆåï¼Œå¯èƒ½ä¼šè¿›è¡Œå›è°ƒï¼‰ã€‚å³æ‰§è¡Œæ–¹æ³•ä¸€çš„æ—¶å€™ï¼Œç›´æ¥äº¤ç»™å…¶ä»–çº¿ç¨‹æ‰§è¡Œï¼Œä¸ç”±ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œä¹Ÿå°±ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œæ‰€ä»¥æ–¹æ³•äºŒä¸å¿…ç­‰åˆ°æ–¹æ³•ä¸€å®Œæˆå³å¯å¼€å§‹æ‰§è¡Œã€‚</p><p>åŒæ­¥ä¸å¼‚æ­¥å…³æ³¨çš„æ˜¯æ–¹æ³•çš„æ‰§è¡Œæ–¹æ˜¯ä¸»çº¿ç¨‹è¿˜æ˜¯å…¶ä»–çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹çš„è¯éœ€è¦ç­‰å¾…æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œå…¶ä»–çº¿ç¨‹çš„è¯æ— éœ€ç­‰å¾…ç«‹åˆ»è¿”å›æ–¹æ³•è°ƒç”¨ï¼Œä¸»çº¿ç¨‹å¯ä»¥ç›´æ¥æ‰§è¡Œæ¥ä¸‹æ¥çš„ä»£ç ã€‚</p><p>åŒæ­¥ä¸å¼‚æ­¥æ˜¯ä»å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„åè°ƒæ¥å®ç°æ•ˆç‡å·®å¼‚ã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆéœ€è¦å¼‚æ­¥å‘¢ï¼Ÿç¬”è€…è®¤ä¸ºå¼‚æ­¥çš„æœ¬è´¨å°±æ˜¯ä¸ºäº†è§£å†³ä¸»çº¿ç¨‹çš„é˜»å¡ï¼Œæ‰€ä»¥ç½‘ä¸Šå¾ˆå¤šè®¨è®ºæŠŠåŒæ­¥å¼‚æ­¥ã€é˜»å¡éé˜»å¡è¿›è¡Œäº†å››ç§ç»„åˆï¼Œå…¶ä¸­ä¸€ç§å°±æœ‰å¼‚æ­¥é˜»å¡è¿™ä¸€æƒ…å½¢ï¼Œå¦‚æœå¼‚æ­¥ä¹Ÿæ˜¯é˜»å¡çš„ï¼Ÿé‚£ä¸ºä»€ä¹ˆè¦ç‰¹åœ°è¿›è¡Œå¼‚æ­¥æ“ä½œå‘¢ï¼Ÿ</p></blockquote><h4 id="é˜»å¡ä¸éé˜»å¡"><a href="#é˜»å¡ä¸éé˜»å¡" class="headerlink" title="é˜»å¡ä¸éé˜»å¡"></a>é˜»å¡ä¸éé˜»å¡</h4><p>é˜»å¡ä¸éé˜»å¡æŒ‡çš„æ˜¯å•ä¸ªçº¿ç¨‹å†…é‡åˆ°åŒæ­¥ç­‰å¾…æ—¶ï¼Œæ˜¯å¦åœ¨åŸåœ°ä¸åšä»»ä½•æ“ä½œã€‚</p><p>é˜»å¡æŒ‡çš„æ˜¯é‡åˆ°åŒæ­¥ç­‰å¾…åï¼Œä¸€ç›´åœ¨åŸåœ°ç­‰å¾…åŒæ­¥æ–¹æ³•å¤„ç†å®Œæˆã€‚</p><p>éé˜»å¡æŒ‡çš„æ˜¯é‡åˆ°åŒæ­¥ç­‰å¾…ï¼Œä¸åœ¨åŸåœ°ç­‰å¾…ï¼Œå…ˆå»åšå…¶ä»–çš„æ“ä½œï¼Œéš”æ–­æ—¶é—´å†æ¥è§‚å¯ŸåŒæ­¥æ–¹æ³•æ˜¯å¦å®Œæˆã€‚</p><p>é˜»å¡ä¸éé˜»å¡å…³æ³¨çš„æ˜¯çº¿ç¨‹æ˜¯å¦åœ¨åŸåœ°ç­‰å¾…ã€‚</p><blockquote><p>ç¬”è€…è®¤ä¸ºé˜»å¡å’Œéé˜»å¡ä»…èƒ½ä¸åŒæ­¥è¿›è¡Œç»„åˆã€‚è€Œå¼‚æ­¥å¤©ç„¶å°±æ˜¯éé˜»å¡çš„ï¼Œè€Œè¿™ä¸ªéé˜»å¡æ˜¯å¯¹ä¸»çº¿ç¨‹è€Œè¨€ã€‚ï¼ˆå¯èƒ½æœ‰äººè®¤ä¸ºå¼‚æ­¥æ–¹æ³•é‡Œé¢æ”¾å…¥é˜»å¡æ“ä½œçš„è¯å°±æ˜¯å¼‚æ­¥é˜»å¡ï¼Œä½†æ˜¯æ€è€ƒä¸€ä¸‹ï¼Œæ­£æ˜¯å› ä¸ºæ˜¯é˜»å¡æ“ä½œæ‰€ä»¥æ‰ä¼šå°†å®ƒæ”¾å…¥å¼‚æ­¥æ–¹æ³•ä¸­ï¼Œä¸è¦é˜»å¡ä¸»çº¿ç¨‹ï¼‰</p></blockquote><h4 id="ä¾‹å­è®²è§£"><a href="#ä¾‹å­è®²è§£" class="headerlink" title="ä¾‹å­è®²è§£"></a>ä¾‹å­è®²è§£</h4><blockquote><p>æµ·åº•æå¾ˆå¥½åƒï¼Œä½†æ˜¯ç»å¸¸è¦æ’é˜Ÿã€‚æˆ‘ä»¬å°±ä»¥ç”Ÿæ´»ä¸­çš„è¿™ä¸ªä¾‹å­è¿›è¡Œè®²è§£ã€‚</p></blockquote><ul><li>Aé¡¾å®¢å»åƒæµ·åº•æï¼Œå°±è¿™æ ·å¹²åç€ç­‰äº†ä¸€å°æ—¶ï¼Œç„¶åæ‰å¼€å§‹åƒç«é”…ã€‚(BIO)</li><li>Bé¡¾å®¢å»åƒæµ·åº•æï¼Œä»–ä¸€çœ‹è¦ç­‰æŒºä¹…ï¼Œäºæ˜¯å»é€›å•†åœºï¼Œæ¯æ¬¡é€›ä¸€ä¼šå°±è·‘å›æ¥çœ‹æœ‰æ²¡æœ‰æ’åˆ°ä»–ã€‚äºæ˜¯ä»–æœ€åæ—¢è´­äº†ç‰©ï¼Œåˆåƒä¸Šæµ·åº•æäº†ã€‚ï¼ˆNIOï¼‰</li><li>Cé¡¾å®¢å»åƒæµ·åº•æï¼Œç”±äºä»–æ˜¯é«˜çº§ä¼šå‘˜ï¼Œæ‰€ä»¥åº—é•¿è¯´ï¼Œä½ å»å•†åœºéšä¾¿ç©å§ï¼Œç­‰ä¸‹æœ‰ä½ç½®ï¼Œæˆ‘ç«‹é©¬æ‰“ç”µè¯ç»™ä½ ã€‚äºæ˜¯Cé¡¾å®¢ä¸ç”¨å¹²åç€ç­‰ï¼Œä¹Ÿä¸ç”¨æ¯è¿‡ä¸€ä¼šå„¿å°±è·‘å›æ¥çœ‹æœ‰æ²¡æœ‰ç­‰åˆ°ï¼Œæœ€åä¹Ÿåƒä¸Šäº†æµ·åº•æï¼ˆAIOï¼‰</li></ul><blockquote><p>å“ªç§æ–¹å¼æ›´æœ‰æ•ˆç‡å‘¢ï¼Ÿæ˜¯ä¸æ˜¯ä¸€ç›®äº†ç„¶å‘¢ï¼Ÿ</p></blockquote><h4 id="BIO"><a href="#BIO" class="headerlink" title="BIO"></a>BIO</h4><p>BIOå…¨ç§°æ˜¯Blocking IOï¼Œæ˜¯JDK1.4ä¹‹å‰çš„ä¼ ç»ŸIOæ¨¡å‹ï¼Œæœ¬èº«æ˜¯åŒæ­¥é˜»å¡æ¨¡å¼ã€‚ çº¿ç¨‹å‘èµ·IOè¯·æ±‚åï¼Œä¸€ç›´é˜»å¡IOï¼Œç›´åˆ°ç¼“å†²åŒºæ•°æ®å°±ç»ªåï¼Œå†è¿›å…¥ä¸‹ä¸€æ­¥æ“ä½œã€‚é’ˆå¯¹ç½‘ç»œé€šä¿¡éƒ½æ˜¯ä¸€è¯·æ±‚ä¸€åº”ç­”çš„æ–¹å¼ï¼Œè™½ç„¶ç®€åŒ–äº†ä¸Šå±‚çš„åº”ç”¨å¼€å‘ï¼Œä½†åœ¨æ€§èƒ½å’Œå¯é æ€§æ–¹é¢å­˜åœ¨ç€å·¨å¤§ç“¶é¢ˆï¼Œè¯•æƒ³ä¸€ä¸‹å¦‚æœæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥ä¸“é—¨å¤„ç†ï¼Œé‚£ä¹ˆåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œæœºå™¨èµ„æºå¾ˆå¿«å°±ä¼šè¢«è€—å°½ã€‚</p><h4 id="NIO"><a href="#NIO" class="headerlink" title="NIO"></a>NIO</h4><p>NIOä¹Ÿå«Non-Blocking IO æ˜¯åŒæ­¥éé˜»å¡çš„IOæ¨¡å‹ã€‚çº¿ç¨‹å‘èµ·ioè¯·æ±‚åï¼Œç«‹å³è¿”å›ï¼ˆéé˜»å¡ioï¼‰ã€‚åŒæ­¥æŒ‡çš„æ˜¯å¿…é¡»ç­‰å¾…IOç¼“å†²åŒºå†…çš„æ•°æ®å°±ç»ªï¼Œè€Œéé˜»å¡æŒ‡çš„æ˜¯ï¼Œç”¨æˆ·çº¿ç¨‹ä¸åŸåœ°ç­‰å¾…IOç¼“å†²åŒºï¼Œå¯ä»¥å…ˆåšä¸€äº›å…¶ä»–æ“ä½œï¼Œä½†æ˜¯è¦å®šæ—¶è½®è¯¢æ£€æŸ¥IOç¼“å†²åŒºæ•°æ®æ˜¯å¦å°±ç»ªã€‚Javaä¸­çš„NIO æ˜¯new IOçš„æ„æ€ã€‚å…¶å®æ˜¯NIOåŠ ä¸ŠIOå¤šè·¯å¤ç”¨æŠ€æœ¯ã€‚æ™®é€šçš„NIOæ˜¯çº¿ç¨‹è½®è¯¢æŸ¥çœ‹ä¸€ä¸ªIOç¼“å†²åŒºæ˜¯å¦å°±ç»ªï¼Œè€ŒJavaä¸­çš„new IOæŒ‡çš„æ˜¯çº¿ç¨‹è½®è¯¢åœ°å»æŸ¥çœ‹ä¸€å †IOç¼“å†²åŒºä¸­å“ªäº›å°±ç»ªï¼Œè¿™æ˜¯ä¸€ç§IOå¤šè·¯å¤ç”¨çš„æ€æƒ³ã€‚IOå¤šè·¯å¤ç”¨æ¨¡å‹ä¸­ï¼Œå°†æ£€æŸ¥IOæ•°æ®æ˜¯å¦å°±ç»ªçš„ä»»åŠ¡ï¼Œäº¤ç»™ç³»ç»Ÿçº§åˆ«çš„selectæˆ–epollæ¨¡å‹ï¼Œç”±ç³»ç»Ÿè¿›è¡Œç›‘æ§ï¼Œå‡è½»ç”¨æˆ·çº¿ç¨‹è´Ÿæ‹…ã€‚</p><p>NIOä¸»è¦æœ‰bufferã€channelã€selectorä¸‰ç§æŠ€æœ¯çš„æ•´åˆï¼Œé€šè¿‡é›¶æ‹·è´çš„bufferå–å¾—æ•°æ®ï¼Œæ¯ä¸€ä¸ªå®¢æˆ·ç«¯é€šè¿‡channelåœ¨selectorï¼ˆå¤šè·¯å¤ç”¨å™¨ï¼‰ä¸Šè¿›è¡Œæ³¨å†Œã€‚æœåŠ¡ç«¯ä¸æ–­è½®è¯¢channelæ¥è·å–å®¢æˆ·ç«¯çš„ä¿¡æ¯ã€‚channelä¸Šæœ‰connect,acceptï¼ˆé˜»å¡ï¼‰ã€readï¼ˆå¯è¯»ï¼‰ã€write(å¯å†™)å››ç§çŠ¶æ€æ ‡è¯†ã€‚æ ¹æ®æ ‡è¯†æ¥è¿›è¡Œåç»­æ“ä½œã€‚æ‰€ä»¥ä¸€ä¸ªæœåŠ¡ç«¯å¯æ¥æ”¶æ— é™å¤šçš„channelã€‚ä¸éœ€è¦æ–°å¼€ä¸€ä¸ªçº¿ç¨‹ã€‚å¤§å¤§æå‡äº†æ€§èƒ½ã€‚</p><h4 id="AIO"><a href="#AIO" class="headerlink" title="AIO"></a>AIO</h4><p>AIOæ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„å¼‚æ­¥éé˜»å¡IOæ¨¡å‹ã€‚ ä¸Šè¿°NIOå®ç°ä¸­ï¼Œéœ€è¦ç”¨æˆ·çº¿ç¨‹å®šæ—¶è½®è¯¢ï¼Œå»æ£€æŸ¥IOç¼“å†²åŒºæ•°æ®æ˜¯å¦å°±ç»ªï¼Œå ç”¨åº”ç”¨ç¨‹åºçº¿ç¨‹èµ„æºï¼Œå…¶å®è½®è¯¢ç›¸å½“äºè¿˜æ˜¯é˜»å¡çš„ï¼Œå¹¶éçœŸæ­£è§£æ”¾å½“å‰çº¿ç¨‹ï¼Œå› ä¸ºå®ƒè¿˜æ˜¯éœ€è¦å»æŸ¥è¯¢å“ªäº›IOå°±ç»ªã€‚è€ŒçœŸæ­£çš„ç†æƒ³çš„å¼‚æ­¥éé˜»å¡IOåº”è¯¥è®©å†…æ ¸ç³»ç»Ÿå®Œæˆï¼Œç”¨æˆ·çº¿ç¨‹åªéœ€è¦å‘Šè¯‰å†…æ ¸ï¼Œå½“ç¼“å†²åŒºå°±ç»ªåï¼Œé€šçŸ¥æˆ‘æˆ–è€…æ‰§è¡Œæˆ‘äº¤ç»™ä½ çš„å›è°ƒå‡½æ•°ã€‚</p><p>AIOå¯ä»¥åšåˆ°çœŸæ­£çš„å¼‚æ­¥çš„æ“ä½œï¼Œä½†å®ç°èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œæ”¯æŒçº¯å¼‚æ­¥IOçš„æ“ä½œç³»ç»Ÿéå¸¸å°‘ï¼Œç›®å‰ä¹Ÿå°±windowsæ˜¯IOCPæŠ€æœ¯å®ç°äº†ï¼Œè€Œåœ¨Linuxä¸Šï¼Œåº•å±‚è¿˜æ˜¯æ˜¯ä½¿ç”¨çš„epollå®ç°çš„ã€‚</p><h3 id="47-æ­»é”çš„äº§ç”Ÿã€é˜²æ­¢ã€é¿å…ã€æ£€æµ‹å’Œè§£é™¤"><a href="#47-æ­»é”çš„äº§ç”Ÿã€é˜²æ­¢ã€é¿å…ã€æ£€æµ‹å’Œè§£é™¤" class="headerlink" title="47.æ­»é”çš„äº§ç”Ÿã€é˜²æ­¢ã€é¿å…ã€æ£€æµ‹å’Œè§£é™¤"></a><a href="">47.æ­»é”çš„äº§ç”Ÿã€é˜²æ­¢ã€é¿å…ã€æ£€æµ‹å’Œè§£é™¤</a></h3><p><a href="https://zhuanlan.zhihu.com/p/61221667">https://zhuanlan.zhihu.com/p/61221667</a></p><h3 id="48-çº¿ç¨‹å®‰å…¨æœ‰å“ªäº›å®ç°æ€è·¯"><a href="#48-çº¿ç¨‹å®‰å…¨æœ‰å“ªäº›å®ç°æ€è·¯" class="headerlink" title=" 48.  çº¿ç¨‹å®‰å…¨æœ‰å“ªäº›å®ç°æ€è·¯?"></a><a href=""> 48.  çº¿ç¨‹å®‰å…¨æœ‰å“ªäº›å®ç°æ€è·¯?</a></h3><ol><li><strong>äº’æ–¥åŒæ­¥</strong></li></ol><p>synchronized å’Œ ReentrantLockã€‚</p><ol><li><strong>éé˜»å¡åŒæ­¥</strong></li></ol><p>äº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯çº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤è¿™ç§åŒæ­¥ä¹Ÿç§°ä¸ºé˜»å¡åŒæ­¥ã€‚</p><p>äº’æ–¥åŒæ­¥å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ï¼Œæ€»æ˜¯è®¤ä¸ºåªè¦ä¸å»åšæ­£ç¡®çš„åŒæ­¥æªæ–½ï¼Œé‚£å°±è‚¯å®šä¼šå‡ºç°é—®é¢˜ã€‚æ— è®ºå…±äº«æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰ï¼Œå®ƒéƒ½è¦è¿›è¡ŒåŠ é”(è¿™é‡Œè®¨è®ºçš„æ˜¯æ¦‚å¿µæ¨¡å‹ï¼Œå®é™…ä¸Šè™šæ‹Ÿæœºä¼šä¼˜åŒ–æ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„åŠ é”)ã€ç”¨æˆ·æ€æ ¸å¿ƒæ€è½¬æ¢ã€ç»´æŠ¤é”è®¡æ•°å™¨å’Œæ£€æŸ¥æ˜¯å¦æœ‰è¢«é˜»å¡çš„çº¿ç¨‹éœ€è¦å”¤é†’ç­‰æ“ä½œã€‚</p><ul><li><code>CAS</code></li></ul><p>éšç€ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚å¹¶å‘ç­–ç•¥: å…ˆè¿›è¡Œæ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶å®ƒçº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®ï¼Œé‚£æ“ä½œå°±æˆåŠŸäº†ï¼Œå¦åˆ™é‡‡å–è¡¥å¿æªæ–½(ä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢)ã€‚è¿™ç§ä¹è§‚çš„å¹¶å‘ç­–ç•¥çš„è®¸å¤šå®ç°éƒ½ä¸éœ€è¦å°†çº¿ç¨‹é˜»å¡ï¼Œå› æ­¤è¿™ç§åŒæ­¥æ“ä½œç§°ä¸ºéé˜»å¡åŒæ­¥ã€‚</p><p>ä¹è§‚é”éœ€è¦æ“ä½œå’Œå†²çªæ£€æµ‹è¿™ä¸¤ä¸ªæ­¥éª¤å…·å¤‡åŸå­æ€§ï¼Œè¿™é‡Œå°±ä¸èƒ½å†ä½¿ç”¨äº’æ–¥åŒæ­¥æ¥ä¿è¯äº†ï¼Œåªèƒ½é ç¡¬ä»¶æ¥å®Œæˆã€‚ç¡¬ä»¶æ”¯æŒçš„åŸå­æ€§æ“ä½œæœ€å…¸å‹çš„æ˜¯: æ¯”è¾ƒå¹¶äº¤æ¢(Compare-and-Swapï¼Œ<code>CAS</code>)ã€‚<code>CAS</code> æŒ‡ä»¤éœ€è¦æœ‰ 3 ä¸ªæ“ä½œæ•°ï¼Œåˆ†åˆ«æ˜¯å†…å­˜åœ°å€ Vã€æ—§çš„é¢„æœŸå€¼ A å’Œæ–°å€¼ Bã€‚å½“æ‰§è¡Œæ“ä½œæ—¶ï¼Œåªæœ‰å½“ V çš„å€¼ç­‰äº Aï¼Œæ‰å°† V çš„å€¼æ›´æ–°ä¸º Bã€‚</p><ul><li><code>AtomicInteger</code></li></ul><p><code>J.U.C</code> åŒ…é‡Œé¢çš„æ•´æ•°åŸå­ç±» <code>AtomicInteger</code>ï¼Œå…¶ä¸­çš„ <code>compareAndSet()</code> å’Œ <code>getAndIncrement()</code> ç­‰æ–¹æ³•éƒ½ä½¿ç”¨äº† Unsafe ç±»çš„ <code>CAS</code> æ“ä½œã€‚</p><ol><li><strong>æ— åŒæ­¥æ–¹æ¡ˆ</strong></li></ol><p>è¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸æ˜¯ä¸€å®šå°±è¦è¿›è¡ŒåŒæ­¥ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•æœ¬æ¥å°±ä¸æ¶‰åŠå…±äº«æ•°æ®ï¼Œé‚£å®ƒè‡ªç„¶å°±æ— é¡»ä»»ä½•åŒæ­¥æªæ–½å»ä¿è¯æ­£ç¡®æ€§ã€‚</p><ul><li>æ ˆå°é—­</li></ul><p>å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªæ–¹æ³•çš„å±€éƒ¨å˜é‡æ—¶ï¼Œä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå› ä¸ºå±€éƒ¨å˜é‡å­˜å‚¨åœ¨è™šæ‹Ÿæœºæ ˆä¸­ï¼Œå±äºçº¿ç¨‹ç§æœ‰çš„ã€‚</p><ul><li>çº¿ç¨‹æœ¬åœ°å­˜å‚¨(Thread Local Storage)</li></ul><p>å¦‚æœä¸€æ®µä»£ç ä¸­æ‰€éœ€è¦çš„æ•°æ®å¿…é¡»ä¸å…¶ä»–ä»£ç å…±äº«ï¼Œé‚£å°±çœ‹çœ‹è¿™äº›å…±äº«æ•°æ®çš„ä»£ç æ˜¯å¦èƒ½ä¿è¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œã€‚å¦‚æœèƒ½ä¿è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…±äº«æ•°æ®çš„å¯è§èŒƒå›´é™åˆ¶åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ï¼Œè¿™æ ·ï¼Œæ— é¡»åŒæ­¥ä¹Ÿèƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´ä¸å‡ºç°æ•°æ®äº‰ç”¨çš„é—®é¢˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…«è‚¡æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaé›†åˆé¢è¯•é¢˜</title>
      <link href="/posts/java-collection.html"/>
      <url>/posts/java-collection.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/java-collection-hierarchy.71519bdb.png" alt=""></p><h3 id="2-ArrayListå’ŒVectorçš„åŒºåˆ«"><a href="#2-ArrayListå’ŒVectorçš„åŒºåˆ«" class="headerlink" title="2.ArrayListå’ŒVectorçš„åŒºåˆ«"></a><a href="">2.ArrayListå’ŒVectorçš„åŒºåˆ«</a></h3><p>è¿™ä¸¤ä¸ªç±»éƒ½å®ç°äº†Listæ¥å£ï¼ˆListæ¥å£ç»§æ‰¿äº†Collectionæ¥å£ï¼‰ï¼Œä»–ä»¬éƒ½æ˜¯æœ‰åºé›†åˆï¼Œå³å­˜å‚¨åœ¨è¿™ä¸¤ä¸ªé›†åˆä¸­çš„å…ƒç´ çš„ä½ç½®éƒ½æ˜¯æœ‰é¡ºåºçš„ï¼Œç›¸å½“äºä¸€ç§åŠ¨æ€çš„æ•°ç»„ï¼Œæˆ‘ä»¬ä»¥åå¯ä»¥æŒ‰ä½ç½®ç´¢å¼•å·å–å‡ºæŸä¸ªå…ƒç´ ï¼Œå¹¶ä¸”å…¶ä¸­çš„æ•°æ®æ˜¯å…è®¸é‡å¤çš„ï¼Œè¿™æ˜¯HashSetä¹‹ç±»çš„é›†åˆçš„æœ€å¤§ä¸åŒå¤„ï¼ŒHashSetä¹‹ç±»çš„é›†åˆä¸å¯ä»¥æŒ‰ç´¢å¼•å·å»æ£€ç´¢å…¶ä¸­çš„å…ƒç´ ï¼Œä¹Ÿä¸å…è®¸æœ‰é‡å¤çš„å…ƒç´ ã€‚</p><p>ArrayListä¸Vectorçš„åŒºåˆ«ï¼Œè¿™ä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªæ–¹é¢ï¼š</p><p>ï¼ˆ1ï¼‰åŒæ­¥æ€§ï¼š</p><p>Vectoræ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯å®ƒçš„æ–¹æ³•ä¹‹é—´æ˜¯çº¿ç¨‹åŒæ­¥çš„ï¼Œè€ŒArrayListæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå®ƒçš„æ–¹æ³•ä¹‹é—´æ˜¯çº¿ç¨‹ä¸åŒæ­¥çš„ã€‚å¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šè®¿é—®åˆ°é›†åˆï¼Œé‚£æœ€å¥½æ˜¯ä½¿ç”¨ArrayListï¼Œå› ä¸ºå®ƒä¸è€ƒè™‘çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡ä¼šé«˜äº›ï¼›å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹ä¼šè®¿é—®åˆ°é›†åˆï¼Œé‚£æœ€å¥½æ˜¯ä½¿ç”¨Vectorï¼Œå› ä¸ºä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å†å»è€ƒè™‘å’Œç¼–å†™çº¿ç¨‹å®‰å…¨çš„ä»£ç ã€‚</p><p>ï¼ˆ2ï¼‰æ•°æ®å¢é•¿ï¼š</p><p>ArrayListä¸Vectoréƒ½æœ‰ä¸€ä¸ªåˆå§‹çš„å®¹é‡å¤§å°ï¼Œå½“å­˜å‚¨è¿›å®ƒä»¬é‡Œé¢çš„å…ƒç´ çš„ä¸ªæ•°è¶…è¿‡äº†å®¹é‡æ—¶ï¼Œå°±éœ€è¦å¢åŠ ArrayListä¸Vectorçš„å­˜å‚¨ç©ºé—´ï¼Œæ¯æ¬¡è¦å¢åŠ å­˜å‚¨ç©ºé—´æ—¶ï¼Œä¸æ˜¯åªå¢åŠ ä¸€ä¸ªå­˜å‚¨å•å…ƒï¼Œè€Œæ˜¯å¢åŠ å¤šä¸ªå­˜å‚¨å•å…ƒï¼Œæ¯æ¬¡å¢åŠ çš„å­˜å‚¨å•å…ƒçš„ä¸ªæ•°åœ¨å†…å­˜ç©ºé—´åˆ©ç”¨ä¸ç¨‹åºæ•ˆç‡ä¹‹é—´è¦å–å¾—ä¸€å®šçš„å¹³è¡¡ã€‚Vectoré»˜è®¤å¢é•¿ä¸ºåŸæ¥ä¸¤å€ï¼Œè€ŒArrayListçš„å¢é•¿ç­–ç•¥åœ¨æ–‡æ¡£ä¸­æ²¡æœ‰æ˜ç¡®è§„å®šï¼ˆä»æºä»£ç çœ‹åˆ°çš„æ˜¯å¢é•¿ä¸ºåŸæ¥çš„1.5å€ï¼‰ã€‚ArrayListä¸Vectoréƒ½å¯ä»¥è®¾ç½®åˆå§‹çš„ç©ºé—´å¤§å°ï¼ŒVectorè¿˜å¯ä»¥è®¾ç½®å¢é•¿çš„ç©ºé—´å¤§å°ï¼Œè€ŒArrayListæ²¡æœ‰æä¾›è®¾ç½®å¢é•¿ç©ºé—´çš„æ–¹æ³•ã€‚</p><p>æ€»ç»“ï¼šå³Vectorå¢é•¿åŸæ¥çš„ä¸€å€ï¼ŒArrayListå¢åŠ åŸæ¥çš„0.5å€ã€‚</p><h3 id="3-HashMapå’ŒHashtableçš„åŒºåˆ«"><a href="#3-HashMapå’ŒHashtableçš„åŒºåˆ«" class="headerlink" title="3.HashMapå’ŒHashtableçš„åŒºåˆ«"></a><a href="">3.HashMapå’ŒHashtableçš„åŒºåˆ«</a></h3><p><strong>çº¿ç¨‹æ˜¯å¦å®‰å…¨ï¼š</strong> <code>HashMap</code> æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œ<code>Hashtable</code> æ˜¯çº¿ç¨‹å®‰å…¨çš„,å› ä¸º <code>Hashtable</code> å†…éƒ¨çš„æ–¹æ³•åŸºæœ¬éƒ½ç»è¿‡<code>synchronized</code> ä¿®é¥°ã€‚ï¼ˆå¦‚æœä½ è¦ä¿è¯çº¿ç¨‹å®‰å…¨çš„è¯å°±ä½¿ç”¨ <code>ConcurrentHashMap</code> å§ï¼ï¼‰ï¼›</p><p><strong>æ•ˆç‡ï¼š</strong> å› ä¸ºçº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼Œ<code>HashMap</code> è¦æ¯” <code>Hashtable</code> æ•ˆç‡é«˜ä¸€ç‚¹ã€‚å¦å¤–ï¼Œ<code>Hashtable</code> åŸºæœ¬è¢«æ·˜æ±°ï¼Œä¸è¦åœ¨ä»£ç ä¸­ä½¿ç”¨å®ƒï¼›</p><p><strong>å¯¹ Null key å’Œ Null value çš„æ”¯æŒï¼š</strong> <code>HashMap</code> å¯ä»¥å­˜å‚¨ null çš„ key å’Œ valueï¼Œä½† null ä½œä¸ºé”®åªèƒ½æœ‰ä¸€ä¸ªï¼Œnull ä½œä¸ºå€¼å¯ä»¥æœ‰å¤šä¸ªï¼›Hashtable ä¸å…è®¸æœ‰ null é”®å’Œ null å€¼ï¼Œå¦åˆ™ä¼šæŠ›å‡º <code>NullPointerException</code>ã€‚</p><p><strong>åˆå§‹å®¹é‡å¤§å°å’Œæ¯æ¬¡æ‰©å……å®¹é‡å¤§å°çš„ä¸åŒ ï¼š</strong> â‘  åˆ›å»ºæ—¶å¦‚æœä¸æŒ‡å®šå®¹é‡åˆå§‹å€¼ï¼Œ<code>Hashtable</code> é»˜è®¤çš„åˆå§‹å¤§å°ä¸º 11ï¼Œä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2n+1ã€‚<code>HashMap</code> é»˜è®¤çš„åˆå§‹åŒ–å¤§å°ä¸º 16ã€‚ä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€ã€‚â‘¡ åˆ›å»ºæ—¶å¦‚æœç»™å®šäº†å®¹é‡åˆå§‹å€¼ï¼Œé‚£ä¹ˆ Hashtable ä¼šç›´æ¥ä½¿ç”¨ä½ ç»™å®šçš„å¤§å°ï¼Œè€Œ <code>HashMap</code> ä¼šå°†å…¶æ‰©å……ä¸º 2 çš„å¹‚æ¬¡æ–¹å¤§å°ï¼ˆ<code>HashMap</code> ä¸­çš„<code>tableSizeFor()</code>æ–¹æ³•ä¿è¯ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ <code>HashMap</code> æ€»æ˜¯ä½¿ç”¨ 2 çš„å¹‚ä½œä¸ºå“ˆå¸Œè¡¨çš„å¤§å°.</p><p><strong>åº•å±‚æ•°æ®ç»“æ„ï¼š</strong> JDK1.8 ä»¥åçš„ <code>HashMap</code> åœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼ˆå°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘å‰ä¼šåˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº 64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©å…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚Hashtable æ²¡æœ‰è¿™æ ·çš„æœºåˆ¶ã€‚</p><h3 id="4-List-å’Œ-Map-åŒºåˆ«"><a href="#4-List-å’Œ-Map-åŒºåˆ«" class="headerlink" title="4.List å’Œ Map åŒºåˆ«?"></a><a href="">4.List å’Œ Map åŒºåˆ«?</a></h3><p>ä¸€ä¸ªæ˜¯å­˜å‚¨å•åˆ—æ•°æ®çš„é›†åˆï¼Œå¦ä¸€ä¸ªæ˜¯å­˜å‚¨é”®å’Œå€¼è¿™æ ·çš„åŒåˆ—æ•°æ®çš„é›†åˆï¼ŒListä¸­å­˜å‚¨çš„æ•°æ®æ˜¯æœ‰é¡ºåºï¼Œå¹¶ä¸”å…è®¸é‡å¤ï¼›Mapä¸­å­˜å‚¨çš„æ•°æ®æ˜¯æ²¡æœ‰é¡ºåºçš„ï¼Œå…¶é”®æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œå®ƒçš„å€¼æ˜¯å¯ä»¥æœ‰é‡å¤çš„ã€‚</p><h3 id="6-Listã€Mapã€Setä¸‰ä¸ªæ¥å£ï¼Œå­˜å–å…ƒç´ æ—¶ï¼Œå„æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ"><a href="#6-Listã€Mapã€Setä¸‰ä¸ªæ¥å£ï¼Œå­˜å–å…ƒç´ æ—¶ï¼Œå„æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ" class="headerlink" title="6.Listã€Mapã€Setä¸‰ä¸ªæ¥å£ï¼Œå­˜å–å…ƒç´ æ—¶ï¼Œå„æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ"></a><a href="">6.Listã€Mapã€Setä¸‰ä¸ªæ¥å£ï¼Œå­˜å–å…ƒç´ æ—¶ï¼Œå„æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</a></h3><p>é¦–å…ˆï¼ŒListä¸Setå…·æœ‰ç›¸ä¼¼æ€§ï¼Œå®ƒä»¬éƒ½æ˜¯å•åˆ—å…ƒç´ çš„é›†åˆï¼Œæ‰€ä»¥ï¼Œå®ƒä»¬æœ‰ä¸€ä¸ªå…±åŒçš„çˆ¶æ¥å£ï¼Œå«Collectionã€‚Seté‡Œé¢ä¸å…è®¸æœ‰é‡å¤çš„å…ƒç´ ï¼Œæ‰€è°“é‡å¤ï¼Œå³ä¸èƒ½æœ‰ä¸¤ä¸ªç›¸ç­‰ï¼ˆæ³¨æ„ï¼Œä¸æ˜¯ä»…ä»…æ˜¯ç›¸åŒï¼‰çš„å¯¹è±¡ ï¼Œå³å‡è®¾Seté›†åˆä¸­æœ‰äº†ä¸€ä¸ªAå¯¹è±¡ï¼Œç°åœ¨æˆ‘è¦å‘Seté›†åˆå†å­˜å…¥ä¸€ä¸ªBå¯¹è±¡ï¼Œä½†Bå¯¹è±¡ä¸Aå¯¹è±¡equalsç›¸ç­‰ï¼Œåˆ™Bå¯¹è±¡å­˜å‚¨ä¸è¿›å»ï¼Œæ‰€ä»¥ï¼ŒSeté›†åˆçš„addæ–¹æ³•æœ‰ä¸€ä¸ªbooleançš„è¿”å›å€¼ï¼Œå½“é›†åˆä¸­æ²¡æœ‰æŸä¸ªå…ƒç´ ï¼Œæ­¤æ—¶addæ–¹æ³•å¯æˆåŠŸåŠ å…¥è¯¥å…ƒç´ æ—¶ï¼Œåˆ™è¿”å›trueï¼Œå½“é›†åˆå«æœ‰ä¸æŸä¸ªå…ƒç´ equalsç›¸ç­‰çš„å…ƒç´ æ—¶ï¼Œæ­¤æ—¶addæ–¹æ³•æ— æ³•åŠ å…¥è¯¥å…ƒç´ ï¼Œè¿”å›ç»“æœä¸ºfalseã€‚Setå–å…ƒç´ æ—¶ï¼Œæ²¡æ³•è¯´å–ç¬¬å‡ ä¸ªï¼Œåªèƒ½ä»¥Iteratoræ¥å£å–å¾—æ‰€æœ‰çš„å…ƒç´ ï¼Œå†é€ä¸€éå†å„ä¸ªå…ƒç´ ã€‚</p><p>Listè¡¨ç¤ºæœ‰å…ˆåé¡ºåºçš„é›†åˆã€‚å½“æˆ‘ä»¬å¤šæ¬¡è°ƒç”¨add(Obj e)æ–¹æ³•æ—¶ï¼Œæ¯æ¬¡åŠ å…¥çš„å¯¹è±¡æŒ‰å…ˆæ¥ååˆ°çš„é¡ºåºæ’åºã€‚æœ‰æ—¶å€™ï¼Œä¹Ÿå¯ä»¥æ’é˜Ÿï¼Œå³è°ƒç”¨add(int index,Obj e)æ–¹æ³•ï¼Œå°±å¯ä»¥æŒ‡å®šå½“å‰å¯¹è±¡åœ¨é›†åˆä¸­çš„å­˜æ”¾ä½ç½®ã€‚ä¸€ä¸ªå¯¹è±¡å¯ä»¥è¢«åå¤å­˜å‚¨è¿›Listä¸­ï¼Œæ¯è°ƒç”¨ä¸€æ¬¡addæ–¹æ³•ï¼Œè¿™ä¸ªå¯¹è±¡å°±è¢«æ’å…¥è¿›é›†åˆä¸­ä¸€æ¬¡ï¼Œå…¶å®ï¼Œå¹¶ä¸æ˜¯æŠŠè¿™ä¸ªå¯¹è±¡æœ¬èº«å­˜å‚¨è¿›äº†é›†åˆä¸­ï¼Œè€Œæ˜¯åœ¨é›†åˆä¸­ç”¨ä¸€ä¸ªç´¢å¼•å˜é‡æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œå½“è¿™ä¸ªå¯¹è±¡è¢«addå¤šæ¬¡æ—¶ï¼Œå³ç›¸å½“äºé›†åˆä¸­æœ‰å¤šä¸ªç´¢å¼•æŒ‡å‘äº†è¿™ä¸ªå¯¹è±¡ã€‚Listé™¤äº†å¯ä»¥ä»¥Iteratoræ¥å£å–å¾—æ‰€æœ‰çš„å…ƒç´ ï¼Œå†é€ä¸€éå†å„ä¸ªå…ƒç´ ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è°ƒç”¨get(index i)æ¥æ˜ç¡®è¯´æ˜å–ç¬¬å‡ ä¸ªã€‚</p><p>Mapä¸Listå’ŒSetä¸åŒï¼Œå®ƒæ˜¯åŒåˆ—çš„é›†åˆï¼Œå…¶ä¸­æœ‰putæ–¹æ³•ï¼Œå®šä¹‰å¦‚ä¸‹ï¼šput(obj key,obj value)ï¼Œæ¯æ¬¡å­˜å‚¨æ—¶ï¼Œè¦å­˜å‚¨ä¸€å¯¹key/valueï¼Œä¸èƒ½å­˜å‚¨é‡å¤çš„keyï¼Œè¿™ä¸ªé‡å¤çš„è§„åˆ™ä¹Ÿæ˜¯æŒ‰equalsæ¯”è¾ƒç›¸ç­‰ã€‚å–åˆ™å¯ä»¥æ ¹æ®keyè·å¾—ç›¸åº”çš„valueï¼Œå³get(Object key)è¿”å›å€¼ä¸ºkey æ‰€å¯¹åº”çš„valueã€‚å¦å¤–ï¼Œä¹Ÿå¯ä»¥è·å¾—æ‰€æœ‰çš„keyçš„é›†åˆï¼Œè¿˜å¯ä»¥è·å¾—æ‰€æœ‰çš„valueçš„é›†åˆï¼Œè¿˜å¯ä»¥è·å¾—keyå’Œvalueç»„åˆæˆçš„Map.Entryå¯¹è±¡çš„é›†åˆã€‚</p><h3 id="7-è¯´å‡ºArrayList-Vector-LinkedListçš„å­˜å‚¨æ€§èƒ½å’Œç‰¹æ€§"><a href="#7-è¯´å‡ºArrayList-Vector-LinkedListçš„å­˜å‚¨æ€§èƒ½å’Œç‰¹æ€§" class="headerlink" title="7.è¯´å‡ºArrayList,Vector, LinkedListçš„å­˜å‚¨æ€§èƒ½å’Œç‰¹æ€§"></a><a href="">7.è¯´å‡ºArrayList,Vector, LinkedListçš„å­˜å‚¨æ€§èƒ½å’Œç‰¹æ€§</a></h3><p>ArrayListå’ŒVectoréƒ½æ˜¯ä½¿ç”¨æ•°ç»„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œæ­¤æ•°ç»„å…ƒç´ æ•°å¤§äºå®é™…å­˜å‚¨çš„æ•°æ®ä»¥ä¾¿å¢åŠ å’Œæ’å…¥å…ƒç´ ï¼Œå®ƒä»¬éƒ½å…è®¸ç›´æ¥æŒ‰åºå·ç´¢å¼•å…ƒç´ ï¼Œä½†æ˜¯æ’å…¥å…ƒç´ è¦æ¶‰åŠæ•°ç»„å…ƒç´ ç§»åŠ¨ç­‰å†…å­˜æ“ä½œï¼Œæ‰€ä»¥ç´¢å¼•æ•°æ®å¿«è€Œæ’å…¥æ•°æ®æ…¢ï¼ŒVectorç”±äºä½¿ç”¨äº†synchronizedæ–¹æ³•ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ï¼Œé€šå¸¸æ€§èƒ½ä¸Šè¾ƒArrayListå·®ï¼Œè€ŒLinkedListä½¿ç”¨åŒå‘é“¾è¡¨å®ç°å­˜å‚¨ï¼ŒæŒ‰åºå·ç´¢å¼•æ•°æ®éœ€è¦è¿›è¡Œå‰å‘æˆ–åå‘éå†ï¼Œä½†æ˜¯æ’å…¥æ•°æ®æ—¶åªéœ€è¦è®°å½•æœ¬é¡¹çš„å‰åé¡¹å³å¯ï¼Œæ‰€ä»¥æ’å…¥é€Ÿåº¦è¾ƒå¿«ã€‚</p><p>LinkedListä¹Ÿæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼ŒLinkedListæä¾›äº†ä¸€äº›æ–¹æ³•ï¼Œä½¿å¾—LinkedListå¯ä»¥è¢«å½“ä½œå †æ ˆå’Œé˜Ÿåˆ—æ¥ä½¿ç”¨ã€‚</p><h3 id="9-Collection-å’Œ-Collectionsçš„åŒºåˆ«ã€‚"><a href="#9-Collection-å’Œ-Collectionsçš„åŒºåˆ«ã€‚" class="headerlink" title="9.Collection å’Œ Collectionsçš„åŒºåˆ«ã€‚"></a><a href="">9.Collection å’Œ Collectionsçš„åŒºåˆ«ã€‚</a></h3><p>Collectionæ˜¯é›†åˆç±»çš„ä¸Šçº§æ¥å£ï¼Œç»§æ‰¿ä»–çš„æ¥å£ä¸»è¦æœ‰Set å’ŒListå’ŒQueueã€‚</p><p>Collectionsæ˜¯é’ˆå¯¹é›†åˆç±»çš„ä¸€ä¸ªå¸®åŠ©ç±»ï¼Œä»–æä¾›ä¸€ç³»åˆ—é™æ€æ–¹æ³•å®ç°å¯¹å„ç§é›†åˆçš„æœç´¢ã€æ’åºã€çº¿ç¨‹å®‰å…¨åŒ–ç­‰æ“ä½œã€‚</p><h3 id="10-Seté‡Œçš„å…ƒç´ æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œé‚£ä¹ˆç”¨ä»€ä¹ˆæ–¹æ³•æ¥åŒºåˆ†é‡å¤ä¸å¦å‘¢-æ˜¯ç”¨-è¿˜æ˜¯equals-å®ƒä»¬æœ‰ä½•åŒºåˆ«"><a href="#10-Seté‡Œçš„å…ƒç´ æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œé‚£ä¹ˆç”¨ä»€ä¹ˆæ–¹æ³•æ¥åŒºåˆ†é‡å¤ä¸å¦å‘¢-æ˜¯ç”¨-è¿˜æ˜¯equals-å®ƒä»¬æœ‰ä½•åŒºåˆ«" class="headerlink" title="10.Seté‡Œçš„å…ƒç´ æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œé‚£ä¹ˆç”¨ä»€ä¹ˆæ–¹æ³•æ¥åŒºåˆ†é‡å¤ä¸å¦å‘¢? æ˜¯ç”¨==è¿˜æ˜¯equals()? å®ƒä»¬æœ‰ä½•åŒºåˆ«?"></a><a href="">10.Seté‡Œçš„å…ƒç´ æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œé‚£ä¹ˆç”¨ä»€ä¹ˆæ–¹æ³•æ¥åŒºåˆ†é‡å¤ä¸å¦å‘¢? æ˜¯ç”¨==è¿˜æ˜¯equals()? å®ƒä»¬æœ‰ä½•åŒºåˆ«?</a></h3><p>Seté‡Œçš„å…ƒç´ æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œå…ƒç´ é‡å¤ä¸å¦æ˜¯ä½¿ç”¨equals()æ–¹æ³•è¿›è¡Œåˆ¤æ–­çš„ã€‚</p><p>equals()å’Œ==æ–¹æ³•å†³å®šå¼•ç”¨å€¼æ˜¯å¦æŒ‡å‘åŒä¸€å¯¹è±¡equals()åœ¨ç±»ä¸­è¢«è¦†ç›–ï¼Œä¸ºçš„æ˜¯å½“ä¸¤ä¸ªåˆ†ç¦»çš„å¯¹è±¡çš„å†…å®¹å’Œç±»å‹ç›¸é…çš„è¯ï¼Œè¿”å›çœŸå€¼ã€‚</p><h3 id="11-ä½ æ‰€çŸ¥é“çš„é›†åˆç±»éƒ½æœ‰å“ªäº›ï¼Ÿä¸»è¦æ–¹æ³•ï¼Ÿ"><a href="#11-ä½ æ‰€çŸ¥é“çš„é›†åˆç±»éƒ½æœ‰å“ªäº›ï¼Ÿä¸»è¦æ–¹æ³•ï¼Ÿ" class="headerlink" title="11.ä½ æ‰€çŸ¥é“çš„é›†åˆç±»éƒ½æœ‰å“ªäº›ï¼Ÿä¸»è¦æ–¹æ³•ï¼Ÿ"></a><a href="">11.ä½ æ‰€çŸ¥é“çš„é›†åˆç±»éƒ½æœ‰å“ªäº›ï¼Ÿä¸»è¦æ–¹æ³•ï¼Ÿ</a></h3><p>æœ€å¸¸ç”¨çš„é›†åˆç±»æ˜¯ List å’Œ Mapã€‚ List çš„å…·ä½“å®ç°åŒ…æ‹¬ ArrayList å’Œ Vectorï¼Œå®ƒä»¬æ˜¯å¯å˜å¤§å°çš„åˆ—è¡¨ï¼Œæ¯”è¾ƒé€‚åˆæ„å»ºã€å­˜å‚¨å’Œæ“ä½œä»»ä½•ç±»å‹å¯¹è±¡çš„å…ƒç´ åˆ—è¡¨ã€‚ List é€‚ç”¨äºæŒ‰æ•°å€¼ç´¢å¼•è®¿é—®å…ƒç´ çš„æƒ…å½¢ã€‚</p><p>Map é›†åˆç±»ç”¨äºå­˜å‚¨é”®å€¼å¯¹ï¼Œå…¶ä¸­æ¯ä¸ªé”®æ˜ å°„åˆ°ä¸€ä¸ªå€¼ã€‚</p><p>è®°çš„ä¸æ˜¯æ–¹æ³•åï¼Œè€Œæ˜¯æ€æƒ³ï¼ŒçŸ¥é“å®ƒä»¬éƒ½æœ‰å¢åˆ æ”¹æŸ¥çš„æ–¹æ³•ï¼Œè®°ä½çš„ä¸€äº›æ€æƒ³å°±æ˜¯Listç±»ä¼šæœ‰get(int index)è¿™æ ·çš„æ–¹æ³•ï¼Œå› ä¸ºå®ƒå¯ä»¥æŒ‰é¡ºåºå–å…ƒç´ ï¼Œè€Œsetç±»ä¸­æ²¡æœ‰get(int index)è¿™æ ·çš„æ–¹æ³•ã€‚Listå’Œsetéƒ½å¯ä»¥è¿­ä»£å‡ºæ‰€æœ‰å…ƒç´ ï¼Œè¿­ä»£æ—¶å…ˆè¦å¾—åˆ°ä¸€ä¸ªiteratorå¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œsetå’Œlistç±»éƒ½æœ‰ä¸€ä¸ªiteratoræ–¹æ³•ï¼Œç”¨äºè¿”å›é‚£ä¸ªiteratorå¯¹è±¡ã€‚mapå¯ä»¥è¿”å›ä¸‰ä¸ªé›†åˆï¼Œä¸€ä¸ªæ˜¯è¿”å›æ‰€æœ‰çš„keyçš„é›†åˆï¼Œå¦å¤–ä¸€ä¸ªè¿”å›çš„æ˜¯æ‰€æœ‰valueçš„é›†åˆï¼Œå†ä¸€ä¸ªè¿”å›çš„keyå’Œvalueç»„åˆæˆçš„EntrySetå¯¹è±¡çš„é›†åˆï¼Œmapä¹Ÿæœ‰getæ–¹æ³•ï¼Œå‚æ•°æ˜¯keyï¼Œè¿”å›å€¼æ˜¯keyå¯¹åº”çš„valueã€‚</p><h3 id="12-ä¸¤ä¸ªå¯¹è±¡å€¼ç›¸åŒ-x-equals-y-true-ï¼Œä½†å´å¯æœ‰ä¸åŒçš„hash-codeï¼Œè¿™å¥è¯å¯¹ä¸å¯¹"><a href="#12-ä¸¤ä¸ªå¯¹è±¡å€¼ç›¸åŒ-x-equals-y-true-ï¼Œä½†å´å¯æœ‰ä¸åŒçš„hash-codeï¼Œè¿™å¥è¯å¯¹ä¸å¯¹" class="headerlink" title="12.ä¸¤ä¸ªå¯¹è±¡å€¼ç›¸åŒ(x.equals(y) == true)ï¼Œä½†å´å¯æœ‰ä¸åŒçš„hash codeï¼Œè¿™å¥è¯å¯¹ä¸å¯¹?"></a><a href="">12.ä¸¤ä¸ªå¯¹è±¡å€¼ç›¸åŒ(x.equals(y) == true)ï¼Œä½†å´å¯æœ‰ä¸åŒçš„hash codeï¼Œè¿™å¥è¯å¯¹ä¸å¯¹?</a></h3><p>å¯¹ã€‚</p><p>å¦‚æœå¯¹è±¡è¦ä¿å­˜åœ¨HashSetæˆ–HashMapä¸­ï¼Œå®ƒä»¬çš„equalsç›¸ç­‰ï¼Œé‚£ä¹ˆï¼Œå®ƒä»¬çš„hashcodeå€¼å°±å¿…é¡»ç›¸ç­‰ã€‚</p><p>å¦‚æœä¸æ˜¯è¦ä¿å­˜åœ¨HashSetæˆ–HashMapï¼Œåˆ™ä¸hashcodeæ²¡æœ‰ä»€ä¹ˆå…³ç³»äº†ï¼Œè¿™æ—¶å€™hashcodeä¸ç­‰æ˜¯å¯ä»¥çš„ï¼Œä¾‹å¦‚arrayListå­˜å‚¨çš„å¯¹è±¡å°±ä¸ç”¨å®ç°hashcodeï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬æ²¡æœ‰ç†ç”±ä¸å®ç°ï¼Œé€šå¸¸éƒ½ä¼šå»å®ç°çš„ã€‚</p><h3 id="13-TreeSeté‡Œé¢æ”¾å¯¹è±¡ï¼Œå¦‚æœåŒæ—¶æ”¾å…¥äº†çˆ¶ç±»å’Œå­ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œé‚£æ¯”è¾ƒæ—¶ä½¿ç”¨çš„æ˜¯çˆ¶ç±»çš„compareToæ–¹æ³•ï¼Œè¿˜æ˜¯ä½¿ç”¨çš„å­ç±»çš„compareToæ–¹æ³•ï¼Œè¿˜æ˜¯æŠ›å¼‚å¸¸ï¼"><a href="#13-TreeSeté‡Œé¢æ”¾å¯¹è±¡ï¼Œå¦‚æœåŒæ—¶æ”¾å…¥äº†çˆ¶ç±»å’Œå­ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œé‚£æ¯”è¾ƒæ—¶ä½¿ç”¨çš„æ˜¯çˆ¶ç±»çš„compareToæ–¹æ³•ï¼Œè¿˜æ˜¯ä½¿ç”¨çš„å­ç±»çš„compareToæ–¹æ³•ï¼Œè¿˜æ˜¯æŠ›å¼‚å¸¸ï¼" class="headerlink" title="13.TreeSeté‡Œé¢æ”¾å¯¹è±¡ï¼Œå¦‚æœåŒæ—¶æ”¾å…¥äº†çˆ¶ç±»å’Œå­ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œé‚£æ¯”è¾ƒæ—¶ä½¿ç”¨çš„æ˜¯çˆ¶ç±»çš„compareToæ–¹æ³•ï¼Œè¿˜æ˜¯ä½¿ç”¨çš„å­ç±»çš„compareToæ–¹æ³•ï¼Œè¿˜æ˜¯æŠ›å¼‚å¸¸ï¼"></a><a href="">13.TreeSeté‡Œé¢æ”¾å¯¹è±¡ï¼Œå¦‚æœåŒæ—¶æ”¾å…¥äº†çˆ¶ç±»å’Œå­ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œé‚£æ¯”è¾ƒæ—¶ä½¿ç”¨çš„æ˜¯çˆ¶ç±»çš„compareToæ–¹æ³•ï¼Œè¿˜æ˜¯ä½¿ç”¨çš„å­ç±»çš„compareToæ–¹æ³•ï¼Œè¿˜æ˜¯æŠ›å¼‚å¸¸ï¼</a></h3><p>å½“å‰çš„addæ–¹æ³•æ”¾å…¥çš„æ˜¯å“ªä¸ªå¯¹è±¡ï¼Œå°±è°ƒç”¨å“ªä¸ªå¯¹è±¡çš„compareToæ–¹æ³•ï¼Œè‡³äºè¿™ä¸ªcompareToæ–¹æ³•æ€ä¹ˆåšï¼Œå°±çœ‹å½“å‰è¿™ä¸ªå¯¹è±¡çš„ç±»ä¸­æ˜¯å¦‚ä½•ç¼–å†™è¿™ä¸ªæ–¹æ³•çš„ã€‚</p><h3 id="14-HashMapä¸­çš„Hashæ–¹æ³•ä¸ºä»€ä¹ˆè¦å³ç§»16ä½å¼‚æˆ–ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆæ»´æ»´ï¼‰"><a href="#14-HashMapä¸­çš„Hashæ–¹æ³•ä¸ºä»€ä¹ˆè¦å³ç§»16ä½å¼‚æˆ–ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆæ»´æ»´ï¼‰" class="headerlink" title="14.HashMapä¸­çš„Hashæ–¹æ³•ä¸ºä»€ä¹ˆè¦å³ç§»16ä½å¼‚æˆ–ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆæ»´æ»´ï¼‰"></a><a href="">14.HashMapä¸­çš„Hashæ–¹æ³•ä¸ºä»€ä¹ˆè¦å³ç§»16ä½å¼‚æˆ–ï¼Ÿï¼ˆç¾å›¢ï¼‰ï¼ˆæ»´æ»´ï¼‰</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">hash</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">  <span class="type">int</span> h;</span><br><span class="line">  <span class="comment">// key.hashCode()ï¼šè¿”å›æ•£åˆ—å€¼ä¹Ÿå°±æ˜¯hashcode</span></span><br><span class="line">  <span class="comment">// ^ ï¼šæŒ‰ä½å¼‚æˆ– // &gt;&gt;&gt;:æ— ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥0è¡¥é½  return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);</span></span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><p> HashMap å°†keyé€šè¿‡hashæ–¹æ³•å¤„ç†è¿‡åå¾—åˆ° hash å€¼ï¼Œç„¶åé€šè¿‡ <code>(n - 1) &amp; hash</code> åˆ¤æ–­å½“å‰å…ƒç´ å­˜æ”¾çš„ä½ç½®ï¼ˆè¿™é‡Œçš„ n æŒ‡çš„æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰ï¼Œå¦‚æœå½“å‰ä½ç½®å­˜åœ¨å…ƒç´ çš„è¯ï¼Œå°±åˆ¤æ–­è¯¥å…ƒç´ ä¸è¦å­˜å…¥çš„å…ƒç´ çš„ hash å€¼ä»¥åŠ key æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒçš„è¯ï¼Œç›´æ¥è¦†ç›–ï¼Œä¸ç›¸åŒå°±é€šè¿‡æ‹‰é“¾æ³•è§£å†³å†²çªã€‚</p><p>é¦–å…ˆè¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼è¿˜æ˜¯ä¸€ä¸ªå“ˆå¸Œå€¼ã€‚ä¸ºä»€ä¹ˆä¸ç›´æ¥è¿”å›<code>key.hashCode()</code>å‘¢ï¼Ÿè¿˜è¦ä¸ (h &gt;&gt;&gt; 16)å¼‚æˆ–ã€‚</p><p>å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">h = key.hashcode() 1111 1101 1101 1111 0101 1101 0010 1111</span><br><span class="line">^</span><br><span class="line">h &gt;&gt;&gt; 16           0000 0000 0000 0000 1111 1101 1101 1111</span><br><span class="line">----------------------------------------------------------</span><br><span class="line">h ^ (h &gt;&gt;&gt; 16)     1111 1101 1101 1111 1010 0000 1111 0000</span><br><span class="line">h = key.hashcode() 1111 1101 1101 1111 0101 1101 0010 1111  </span><br></pre></td></tr></table></figure><p>å¯¹æ¯”<code>h = key.hashcode()</code> ä¸ <code>h ^ (h &gt;&gt;&gt; 16)</code> å‘ç°ï¼Œå°†hæ— ç¬¦å·å³ç§»16ä¸ºç›¸å½“äºå°†é«˜åŒº16ä½ç§»åŠ¨åˆ°äº†ä½åŒºçš„16ä½ï¼Œå†ä¸åŸ<code>hashcode</code>åšå¼‚æˆ–è¿ç®—ï¼Œ<strong>å¯ä»¥å°†é«˜ä½ä½äºŒè¿›åˆ¶ç‰¹å¾æ··åˆèµ·æ¥</strong>ã€‚ä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºé«˜åŒºçš„16ä½å¹¶æ²¡æœ‰å˜åŒ–ã€‚ä½åŒºçš„16ä½å‘ ç”Ÿäº†è¾ƒå¤§çš„å˜åŒ–ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬è®¡ç®—å‡ºçš„hashå€¼åœ¨åé¢ä¼šå‚ä¸åˆ°å…ƒç´ indexçš„è®¡ç®—ä¸­ã€‚è®¡ç®—å…¬å¼ä¸º hash &amp; (length - 1)ã€‚</p><p>ä»”ç»†è§‚å¯Ÿä¸Šæ–‡ä¸éš¾å‘ç°ï¼Œé«˜åŒºçš„16ä½å¾ˆæœ‰å¯èƒ½ä¼šè¢«æ•°ç»„é•¿åº¦çš„äºŒè¿›åˆ¶ç æ‰€å±è”½ï¼Œ<strong>å¦‚æœæˆ‘ä»¬ä¸åšåˆšæ‰ç§»ä½å¼‚æˆ–è¿ç®—ï¼Œé‚£ä¹ˆåœ¨è®¡ç®—indexæ—¶å°†ä¸¢å¤±é«˜åŒºç‰¹å¾ã€‚å¦‚æœ</strong>æ²¡æœ‰ä¸Šé¢è¿™ä¸ªå¼‚æˆ–æ“ä½œï¼Œå‡è®¾é‡Œä¸¤ä¸ªhashå€¼åªæœ‰é«˜ä½ä¸€ç‚¹ç‚¹çš„å·®å¼‚ï¼Œç„¶ååœ¨è®¡ç®—indexè¿‡ç¨‹ä¸­è¿˜ä¸¢å¤±äº†é«˜ä½çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±è®¡ç®—å‡ºåŒä¸€ä¸ªindexã€‚</p><h3 id="15-HashMapä¸­çš„hashæ–¹æ³•ä½¿ç”¨å¼‚æˆ–è¿ç®—çš„åŸå› ï¼Ÿï¼ˆç¾å›¢ï¼‰"><a href="#15-HashMapä¸­çš„hashæ–¹æ³•ä½¿ç”¨å¼‚æˆ–è¿ç®—çš„åŸå› ï¼Ÿï¼ˆç¾å›¢ï¼‰" class="headerlink" title="15.HashMapä¸­çš„hashæ–¹æ³•ä½¿ç”¨å¼‚æˆ–è¿ç®—çš„åŸå› ï¼Ÿï¼ˆç¾å›¢ï¼‰"></a><a href="">15.HashMapä¸­çš„hashæ–¹æ³•ä½¿ç”¨å¼‚æˆ–è¿ç®—çš„åŸå› ï¼Ÿï¼ˆç¾å›¢ï¼‰</a></h3><p><strong>å¼‚æˆ–è¿ç®—èƒ½æ›´å¹³å‡çš„ä¿ç•™å„éƒ¨åˆ†çš„ç‰¹å¾</strong>ï¼Œå¦‚æœé‡‡ç”¨<strong>&amp;</strong>è¿ç®—è®¡ç®—å‡ºæ¥çš„å€¼ä¼šå‘1é æ‹¢ï¼Œé‡‡ç”¨<strong>|</strong>è¿ç®—è®¡ç®—å‡ºæ¥çš„å€¼ä¼šå‘0é æ‹¢</p><h3 id="16-ä¸ºä»€ä¹ˆHashMapçš„æ•°ç»„é•¿åº¦å¿…é¡»ä½¿ç”¨2-nï¼Ÿï¼ˆç¾å›¢ï¼‰"><a href="#16-ä¸ºä»€ä¹ˆHashMapçš„æ•°ç»„é•¿åº¦å¿…é¡»ä½¿ç”¨2-nï¼Ÿï¼ˆç¾å›¢ï¼‰" class="headerlink" title="16.ä¸ºä»€ä¹ˆHashMapçš„æ•°ç»„é•¿åº¦å¿…é¡»ä½¿ç”¨2^nï¼Ÿï¼ˆç¾å›¢ï¼‰"></a><a href="">16.ä¸ºä»€ä¹ˆHashMapçš„æ•°ç»„é•¿åº¦å¿…é¡»ä½¿ç”¨2^nï¼Ÿï¼ˆç¾å›¢ï¼‰</a></h3><p>é¦–å…ˆæˆ‘ä»¬è®¡ç®—keyçš„hashå€¼ä¹‹åè¿˜è¦å…ˆåšå¯¹æ•°ç»„çš„é•¿åº¦å–æ¨¡è¿ç®—ï¼Œå¾—åˆ°çš„ä½™æ•°æ‰èƒ½ç”¨æ¥ä½œä¸ºå­˜æ”¾çš„ä½ç½®ä¹Ÿå°±æ˜¯å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ã€‚è¿™ä¸ªæ•°ç»„ä¸‹æ ‡çš„è®¡ç®—æ–¹æ³•æ˜¯<code>(n - 1) &amp; hash</code>ã€‚<strong>å–ä½™(%)æ“ä½œä¸­å¦‚æœé™¤æ•°æ˜¯ 2 çš„å¹‚æ¬¡åˆ™ç­‰ä»·äºä¸å…¶é™¤æ•°å‡ä¸€çš„ä¸(&amp;)æ“ä½œ</strong>ï¼Œ<strong>ä¹Ÿå°±æ˜¯è¯´ hash%length==hash&amp;(length-1)çš„å‰ææ˜¯ length æ˜¯ 2 çš„ n æ¬¡æ–¹ï¼›</strong>å¹¶ä¸” <strong>é‡‡ç”¨äºŒè¿›åˆ¶ä½æ“ä½œ &amp;ï¼Œç›¸å¯¹äº%èƒ½å¤Ÿæé«˜è¿ç®—æ•ˆç‡</strong>ã€‚</p><p>å…¶æ¬¡æ˜¯ä¸ºäº†è®©è®¡ç®—å¾—åˆ°çš„å…ƒç´ ç´¢å¼•æ›´åŠ å‡åŒ€ï¼Œå¦‚æœ length = 17 é‚£ä¹ˆ hash &amp; (17 - 1) ã€‚16è½¬åŒ–ä¸ºäºŒè¿›åˆ¶åŒ…å«æ›´å¤šçš„0ï¼Œè¿™æ ·ä¸€æ¥è®¡ç®—ä¼šè¢«æ›´å¤šçš„0å±è”½ã€‚</p><p>æœ€åæ˜¯ä¸ºäº†ä¾¿äºæ‰©å®¹åçš„é‡æ–°è®¡ç®—å…ƒç´ indexã€‚</p><h3 id="17-ä¸ºä»€ä¹ˆHashMapæ‰©å®¹æ—¶æ€»æ˜¯æŠŠcapacityæ‰©å¤§ä¸ºåŸæ¥çš„2å€ï¼Ÿ"><a href="#17-ä¸ºä»€ä¹ˆHashMapæ‰©å®¹æ—¶æ€»æ˜¯æŠŠcapacityæ‰©å¤§ä¸ºåŸæ¥çš„2å€ï¼Ÿ" class="headerlink" title="17.ä¸ºä»€ä¹ˆHashMapæ‰©å®¹æ—¶æ€»æ˜¯æŠŠcapacityæ‰©å¤§ä¸ºåŸæ¥çš„2å€ï¼Ÿ"></a><a href="">17.ä¸ºä»€ä¹ˆHashMapæ‰©å®¹æ—¶æ€»æ˜¯æŠŠcapacityæ‰©å¤§ä¸ºåŸæ¥çš„2å€ï¼Ÿ</a></h3><p>ç”±äºæˆ‘ä»¬è¦ç»´æŠ¤hashmapçš„å¤§å°ä¸º2^nï¼Œè¿™æ ·å°±ä½¿å¾—len-1çš„äºŒè¿›åˆ¶ä¸­å…¨éƒ¨éƒ½æ˜¯1ã€‚è¿›è¡Œä½è¿ç®—æ—¶å¯ä»¥é™ä½hashç¢°æ’çš„å‡ºç°ã€‚</p><h3 id="18-HashMapçš„è´Ÿè½½å› å­ä¸ºä»€ä¹ˆæ˜¯0-75ï¼Ÿï¼ˆç¾å›¢ï¼‰"><a href="#18-HashMapçš„è´Ÿè½½å› å­ä¸ºä»€ä¹ˆæ˜¯0-75ï¼Ÿï¼ˆç¾å›¢ï¼‰" class="headerlink" title="18.HashMapçš„è´Ÿè½½å› å­ä¸ºä»€ä¹ˆæ˜¯0.75ï¼Ÿï¼ˆç¾å›¢ï¼‰"></a><a href="">18.HashMapçš„è´Ÿè½½å› å­ä¸ºä»€ä¹ˆæ˜¯0.75ï¼Ÿï¼ˆç¾å›¢ï¼‰</a></h3><p>è´Ÿè½½å› å­ä¸»è¦ä¸æ‰©å®¹æœ‰å…³ï¼Œå¦‚æœå°†è´Ÿè½½å› å­è®¾ç½®ä¸º1ï¼Œç©ºé—´åˆ©ç”¨çš„å°±æ›´åŠ å……åˆ†äº†ï¼Œä½†æ˜¯è¿™æ ·ä¸€æ¥<strong>ä¼šå¢å¤§hashç¢°æ’</strong>çš„å‡ºç°ï¼Œæœ‰äº›ä½ç½®çš„é“¾è¡¨ä¼šè¿‡é•¿ï¼Œä¸åˆ©äºæŸ¥æ‰¾ã€‚å¦‚æœè®¾ç½®çš„è¿‡å°çš„è¯è™½ç„¶é™ä½äº†hashç¢°æ’çš„å‘ç”Ÿï¼Œä½†æ˜¯ä¼šé¢‘ç¹è§¦å‘æ‰©å®¹æœºåˆ¶ï¼Œä¹Ÿä¼šå¯¼è‡´æ•°ç»„çš„åˆ©ç”¨ç‡è¾ƒä½ã€‚</p><p>æ‰€ä»¥ä¸ºäº†æŠ˜ä¸­ï¼Œå°†è´Ÿè½½å› å­è®¾ç½®ä¸º0.75æ˜¯å¯¹ç©ºé—´ä¸æ—¶é—´çš„å–èˆã€‚</p><h3 id="19-HashMapçš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿï¼ˆæ»´æ»´ï¼‰"><a href="#19-HashMapçš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿï¼ˆæ»´æ»´ï¼‰" class="headerlink" title="19.HashMapçš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿï¼ˆæ»´æ»´ï¼‰"></a><a href="">19.HashMapçš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿï¼ˆæ»´æ»´ï¼‰</a></h3><p>1.å¤šçº¿ç¨‹çš„putæ“ä½œå¯èƒ½å¯¼è‡´å…ƒç´ ä¸¢å¤±</p><p>2.putå’Œgetå¹¶å‘æ—¶å¯èƒ½å¯¼è‡´getä¸ºnull</p><ul><li>çº¿ç¨‹1æ‰§è¡Œputæ—¶ï¼Œå› ä¸ºå…ƒç´ ä¸ªæ•°è¶…å‡ºthresholdè€Œå¯¼è‡´rehashï¼Œçº¿ç¨‹2æ­¤æ—¶æ‰§è¡Œgetï¼Œæœ‰å¯èƒ½å¯¼è‡´è¿™ä¸ªé—®é¢˜ã€‚</li></ul><p>3.jdk 1.7 ä¸­å¹¶å‘putå¯¼è‡´çš„å¾ªç¯é“¾è¡¨å¯¼è‡´getå‡ºç°æ­»å¾ªç¯</p><ul><li>å‘ç”Ÿåœ¨å¤šçº¿ç¨‹å¹¶å‘resizeçš„æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¼è‡´ç¯å½¢é“¾è¡¨çš„å‡ºç°ã€‚</li></ul><h3 id="21-è§£å†³hashå†²çªçš„æ–¹æ³•ï¼Ÿï¼ˆç¾å›¢ï¼‰"><a href="#21-è§£å†³hashå†²çªçš„æ–¹æ³•ï¼Ÿï¼ˆç¾å›¢ï¼‰" class="headerlink" title="21.è§£å†³hashå†²çªçš„æ–¹æ³•ï¼Ÿï¼ˆç¾å›¢ï¼‰"></a><a href="">21.è§£å†³hashå†²çªçš„æ–¹æ³•ï¼Ÿï¼ˆç¾å›¢ï¼‰</a></h3><p><strong>1.æ‹‰é“¾æ³•ï¼ˆé“¾åœ°å€ï¼‰ï¼š</strong></p><p><strong>2.çº¿æ€§æ¢æµ‹æ³•ï¼š</strong>å†²çªå‘ç”Ÿæ—¶ï¼Œé¡ºåºæŸ¥çœ‹è¡¨ä¸­ä¸‹ä¸€å•å…ƒï¼Œç›´åˆ°æ‰¾å‡ºä¸€ä¸ªç©ºå•å…ƒæˆ–æŸ¥éå…¨è¡¨ã€‚</p><p><strong>3.äºŒæ¬¡æ¢æµ‹æ³•ï¼š</strong>å†²çªå‘ç”Ÿæ—¶ï¼Œåœ¨è¡¨çš„å·¦å³è¿›è¡Œè·³è·ƒå¼æ¢æµ‹ï¼Œæ¯”è¾ƒçµæ´»ã€‚</p><h3 id="22-è¯´è¯´-List-Set-Queue-Map-å››è€…çš„åŒºåˆ«ï¼Ÿ"><a href="#22-è¯´è¯´-List-Set-Queue-Map-å››è€…çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="22.è¯´è¯´ List, Set, Queue, Map å››è€…çš„åŒºåˆ«ï¼Ÿ"></a><a href="">22.è¯´è¯´ List, Set, Queue, Map å››è€…çš„åŒºåˆ«ï¼Ÿ</a></h3><p><code>List</code>(å¯¹ä»˜é¡ºåºçš„å¥½å¸®æ‰‹): å­˜å‚¨çš„å…ƒç´ æ˜¯æœ‰åºçš„ã€å¯é‡å¤çš„ã€‚</p><p><code>Set</code>(æ³¨é‡ç‹¬ä¸€æ— äºŒçš„æ€§è´¨): å­˜å‚¨çš„å…ƒç´ æ˜¯æ— åºçš„ã€ä¸å¯é‡å¤çš„ã€‚</p><p><code>Queue</code>(å®ç°æ’é˜ŸåŠŸèƒ½çš„å«å·æœº): æŒ‰ç‰¹å®šçš„æ’é˜Ÿè§„åˆ™æ¥ç¡®å®šå…ˆåé¡ºåºï¼Œå­˜å‚¨çš„å…ƒç´ æ˜¯æœ‰åºçš„ã€å¯é‡å¤çš„ã€‚</p><p><code>Map</code>(ç”¨ key æ¥æœç´¢çš„ä¸“å®¶): ä½¿ç”¨é”®å€¼å¯¹ï¼ˆkey-valueï¼‰å­˜å‚¨ï¼Œkey æ˜¯æ— åºçš„ã€ä¸å¯é‡å¤çš„ï¼Œvalue æ˜¯æ— åºçš„ã€å¯é‡å¤çš„ï¼Œæ¯ä¸ªé”®æœ€å¤šæ˜ å°„åˆ°ä¸€ä¸ªå€¼ã€‚</p><h3 id="23-Arraylist-ä¸-LinkedList-åŒºåˆ«"><a href="#23-Arraylist-ä¸-LinkedList-åŒºåˆ«" class="headerlink" title="23. Arraylist ä¸ LinkedList åŒºåˆ«?"></a><a href="">23. Arraylist ä¸ LinkedList åŒºåˆ«?</a></h3><p><strong>æ˜¯å¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼š</strong> <code>ArrayList</code> å’Œ <code>LinkedList</code> éƒ½æ˜¯ä¸åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯ä¸ä¿è¯çº¿ç¨‹å®‰å…¨ï¼›</p><p><strong>åº•å±‚æ•°æ®ç»“æ„ï¼š</strong> <code>Arraylist</code> åº•å±‚ä½¿ç”¨çš„æ˜¯ <strong><code>Object</code> æ•°ç»„</strong>ï¼›<code>LinkedList</code> åº•å±‚ä½¿ç”¨çš„æ˜¯ <strong>åŒå‘é“¾è¡¨</strong> æ•°æ®ç»“æ„</p><p><strong>æ’å…¥å’Œåˆ é™¤æ˜¯å¦å—å…ƒç´ ä½ç½®çš„å½±å“ï¼š</strong></p><ul><li><code>ArrayList</code> é‡‡ç”¨æ•°ç»„å­˜å‚¨ï¼Œæ‰€ä»¥æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦å—å…ƒç´ ä½ç½®çš„å½±å“ã€‚ æ¯”å¦‚ï¼šæ‰§è¡Œ<code>add(E e)</code>æ–¹æ³•çš„æ—¶å€™ï¼Œ <code>ArrayList</code> ä¼šé»˜è®¤åœ¨å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ï¼Œè¿™ç§æƒ…å†µæ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(1)ã€‚ä½†æ˜¯å¦‚æœè¦åœ¨æŒ‡å®šä½ç½® i æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„è¯ï¼ˆ<code>add(int index, E element)</code>ï¼‰æ—¶é—´å¤æ‚åº¦å°±ä¸º O(n-i)ã€‚å› ä¸ºåœ¨è¿›è¡Œä¸Šè¿°æ“ä½œçš„æ—¶å€™é›†åˆä¸­ç¬¬ i å’Œç¬¬ i ä¸ªå…ƒç´ ä¹‹åçš„(n-i)ä¸ªå…ƒç´ éƒ½è¦æ‰§è¡Œå‘åä½/å‘å‰ç§»ä¸€ä½çš„æ“ä½œã€‚</li><li><code>LinkedList</code> é‡‡ç”¨é“¾è¡¨å­˜å‚¨ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæ˜¯åœ¨å¤´å°¾æ’å…¥æˆ–è€…åˆ é™¤å…ƒç´ ä¸å—å…ƒç´ ä½ç½®çš„å½±å“ï¼ˆ<code>add(E e)</code>ã€<code>addFirst(E e)</code>ã€<code>addLast(E e)</code>ã€<code>removeFirst()</code> ã€ <code>removeLast()</code>ï¼‰ï¼Œè¿‘ä¼¼ O(1)ï¼Œå¦‚æœæ˜¯è¦åœ¨æŒ‡å®šä½ç½® <code>i</code> æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„è¯ï¼ˆ<code>add(int index, E element)</code>ï¼Œ<code>remove(Object o)</code>ï¼‰ æ—¶é—´å¤æ‚åº¦è¿‘ä¼¼ä¸º O(n) ï¼Œå› ä¸ºéœ€è¦å…ˆç§»åŠ¨åˆ°æŒ‡å®šä½ç½®å†æ’å…¥ã€‚</li></ul><p><strong>æ˜¯å¦æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®ï¼š</strong> <code>LinkedList</code> ä¸æ”¯æŒé«˜æ•ˆçš„éšæœºå…ƒç´ è®¿é—®ï¼Œè€Œ <code>ArrayList</code> æ”¯æŒã€‚å¿«é€Ÿéšæœºè®¿é—®å°±æ˜¯é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡(å¯¹åº”äº<code>get(int index)</code>æ–¹æ³•)ã€‚</p><p><strong>å†…å­˜ç©ºé—´å ç”¨ï¼š</strong> ArrayList çš„ç©ºé—´æµªè´¹ä¸»è¦ä½“ç°åœ¨åœ¨ list åˆ—è¡¨çš„ç»“å°¾ä¼šé¢„ç•™ä¸€å®šçš„å®¹é‡ç©ºé—´ï¼Œè€Œ LinkedList çš„ç©ºé—´èŠ±è´¹åˆ™ä½“ç°åœ¨å®ƒçš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½éœ€è¦æ¶ˆè€—æ¯” ArrayList æ›´å¤šçš„ç©ºé—´ï¼ˆå› ä¸ºè¦å­˜æ”¾ç›´æ¥åç»§å’Œç›´æ¥å‰é©±ä»¥åŠæ•°æ®ï¼‰ã€‚</p><h3 id="24-æ— åºæ€§å’Œä¸å¯é‡å¤æ€§çš„å«ä¹‰æ˜¯ä»€ä¹ˆ"><a href="#24-æ— åºæ€§å’Œä¸å¯é‡å¤æ€§çš„å«ä¹‰æ˜¯ä»€ä¹ˆ" class="headerlink" title="24.æ— åºæ€§å’Œä¸å¯é‡å¤æ€§çš„å«ä¹‰æ˜¯ä»€ä¹ˆ"></a><a href="">24.æ— åºæ€§å’Œä¸å¯é‡å¤æ€§çš„å«ä¹‰æ˜¯ä»€ä¹ˆ</a></h3><p>ä»€ä¹ˆæ˜¯æ— åºæ€§ï¼Ÿæ— åºæ€§ä¸ç­‰äºéšæœºæ€§ ï¼Œæ— åºæ€§æ˜¯æŒ‡å­˜å‚¨çš„æ•°æ®åœ¨åº•å±‚æ•°ç»„ä¸­å¹¶éæŒ‰ç…§æ•°ç»„ç´¢å¼•çš„é¡ºåºæ·»åŠ  ï¼Œè€Œæ˜¯æ ¹æ®æ•°æ®çš„å“ˆå¸Œå€¼å†³å®šçš„ã€‚</p><p>ä»€ä¹ˆæ˜¯ä¸å¯é‡å¤æ€§ï¼Ÿä¸å¯é‡å¤æ€§æ˜¯æŒ‡æ·»åŠ çš„å…ƒç´ æŒ‰ç…§ equals()åˆ¤æ–­æ—¶ ï¼Œè¿”å› falseï¼Œéœ€è¦åŒæ—¶é‡å†™ equals()æ–¹æ³•å’Œ HashCode()æ–¹æ³•ã€‚</p><h3 id="25-æ¯”è¾ƒ-HashSetã€LinkedHashSet-å’Œ-TreeSet-ä¸‰è€…çš„å¼‚åŒ"><a href="#25-æ¯”è¾ƒ-HashSetã€LinkedHashSet-å’Œ-TreeSet-ä¸‰è€…çš„å¼‚åŒ" class="headerlink" title="25.æ¯”è¾ƒ HashSetã€LinkedHashSet å’Œ TreeSet ä¸‰è€…çš„å¼‚åŒ"></a><a href="">25.æ¯”è¾ƒ HashSetã€LinkedHashSet å’Œ TreeSet ä¸‰è€…çš„å¼‚åŒ</a></h3><p><code>HashSet</code>ã€<code>LinkedHashSet</code> å’Œ <code>TreeSet</code> éƒ½æ˜¯ <code>Set</code> æ¥å£çš„å®ç°ç±»ï¼Œéƒ½èƒ½ä¿è¯å…ƒç´ å”¯ä¸€ï¼Œå¹¶ä¸”éƒ½ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p><code>HashSet</code>ã€<code>LinkedHashSet</code> å’Œ <code>TreeSet</code> çš„ä¸»è¦åŒºåˆ«åœ¨äºåº•å±‚æ•°æ®ç»“æ„ä¸åŒã€‚<code>HashSet</code> çš„åº•å±‚æ•°æ®ç»“æ„æ˜¯å“ˆå¸Œè¡¨ï¼ˆåŸºäº <code>HashMap</code> å®ç°ï¼‰ã€‚<code>LinkedHashSet</code> çš„åº•å±‚æ•°æ®ç»“æ„æ˜¯é“¾è¡¨å’Œå“ˆå¸Œè¡¨ï¼Œå…ƒç´ çš„æ’å…¥å’Œå–å‡ºé¡ºåºæ»¡è¶³ FIFOã€‚<code>TreeSet</code> åº•å±‚æ•°æ®ç»“æ„æ˜¯çº¢é»‘æ ‘ï¼Œå…ƒç´ æ˜¯æœ‰åºçš„ï¼Œæ’åºçš„æ–¹å¼æœ‰è‡ªç„¶æ’åºå’Œå®šåˆ¶æ’åºã€‚</p><p>åº•å±‚æ•°æ®ç»“æ„ä¸åŒåˆå¯¼è‡´è¿™ä¸‰è€…çš„åº”ç”¨åœºæ™¯ä¸åŒã€‚<code>HashSet</code> ç”¨äºä¸éœ€è¦ä¿è¯å…ƒç´ æ’å…¥å’Œå–å‡ºé¡ºåºçš„åœºæ™¯ï¼Œ<code>LinkedHashSet</code> ç”¨äºä¿è¯å…ƒç´ çš„æ’å…¥å’Œå–å‡ºé¡ºåºæ»¡è¶³ FIFO çš„åœºæ™¯ï¼Œ<code>TreeSet</code> ç”¨äºæ”¯æŒå¯¹å…ƒç´ è‡ªå®šä¹‰æ’åºè§„åˆ™çš„åœºæ™¯ã€‚</p><h3 id="26-ArrayDeque-ä¸-LinkedList-çš„åŒºåˆ«"><a href="#26-ArrayDeque-ä¸-LinkedList-çš„åŒºåˆ«" class="headerlink" title="26.ArrayDeque ä¸ LinkedList çš„åŒºåˆ«"></a><a href="">26.ArrayDeque ä¸ LinkedList çš„åŒºåˆ«</a></h3><p><code>ArrayDeque</code> å’Œ <code>LinkedList</code> éƒ½å®ç°äº† <code>Deque</code> æ¥å£ï¼Œä¸¤è€…éƒ½å…·æœ‰é˜Ÿåˆ—çš„åŠŸèƒ½ï¼Œä½†ä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><ul><li><code>ArrayDeque</code> æ˜¯åŸºäºå¯å˜é•¿çš„æ•°ç»„å’ŒåŒæŒ‡é’ˆæ¥å®ç°ï¼Œè€Œ <code>LinkedList</code> åˆ™é€šè¿‡é“¾è¡¨æ¥å®ç°ã€‚</li><li><code>ArrayDeque</code> ä¸æ”¯æŒå­˜å‚¨ <code>NULL</code> æ•°æ®ï¼Œä½† <code>LinkedList</code> æ”¯æŒã€‚</li><li><code>ArrayDeque</code> æ˜¯åœ¨ JDK1.6 æ‰è¢«å¼•å…¥çš„ï¼Œè€Œ<code>LinkedList</code> æ—©åœ¨ JDK1.2 æ—¶å°±å·²ç»å­˜åœ¨ã€‚</li><li><code>ArrayDeque</code> æ’å…¥æ—¶å¯èƒ½å­˜åœ¨æ‰©å®¹è¿‡ç¨‹, ä¸è¿‡å‡æ‘Šåçš„æ’å…¥æ“ä½œä¾ç„¶ä¸º O(1)ã€‚è™½ç„¶ <code>LinkedList</code> ä¸éœ€è¦æ‰©å®¹ï¼Œä½†æ˜¯æ¯æ¬¡æ’å…¥æ•°æ®æ—¶å‡éœ€è¦ç”³è¯·æ–°çš„å †ç©ºé—´ï¼Œå‡æ‘Šæ€§èƒ½ç›¸æ¯”æ›´æ…¢ã€‚</li></ul><p>ä»æ€§èƒ½çš„è§’åº¦ä¸Šï¼Œé€‰ç”¨ <code>ArrayDeque</code> æ¥å®ç°é˜Ÿåˆ—è¦æ¯” <code>LinkedList</code> æ›´å¥½ã€‚æ­¤å¤–ï¼Œ<code>ArrayDeque</code> ä¹Ÿå¯ä»¥ç”¨äºå®ç°æ ˆã€‚</p><h3 id="27-è¯´ä¸€è¯´-PriorityQueue"><a href="#27-è¯´ä¸€è¯´-PriorityQueue" class="headerlink" title="27.è¯´ä¸€è¯´ PriorityQueue"></a><a href="">27.è¯´ä¸€è¯´ PriorityQueue</a></h3><p><code>PriorityQueue</code> æ˜¯åœ¨ JDK1.5 ä¸­è¢«å¼•å…¥çš„, å…¶ä¸ <code>Queue</code> çš„åŒºåˆ«åœ¨äºå…ƒç´ å‡ºé˜Ÿé¡ºåºæ˜¯ä¸ä¼˜å…ˆçº§ç›¸å…³çš„ï¼Œå³æ€»æ˜¯ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ å…ˆå‡ºé˜Ÿã€‚</p><p>è¿™é‡Œåˆ—ä¸¾å…¶ç›¸å…³çš„ä¸€äº›è¦ç‚¹ï¼š</p><ul><li><code>PriorityQueue</code> åˆ©ç”¨äº†äºŒå‰å †çš„æ•°æ®ç»“æ„æ¥å®ç°çš„ï¼Œåº•å±‚ä½¿ç”¨å¯å˜é•¿çš„æ•°ç»„æ¥å­˜å‚¨æ•°æ®</li><li><code>PriorityQueue</code> é€šè¿‡å †å…ƒç´ çš„ä¸Šæµ®å’Œä¸‹æ²‰ï¼Œå®ç°äº†åœ¨ O(logn) çš„æ—¶é—´å¤æ‚åº¦å†…æ’å…¥å…ƒç´ å’Œåˆ é™¤å †é¡¶å…ƒç´ ã€‚</li><li><code>PriorityQueue</code> æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œä¸”ä¸æ”¯æŒå­˜å‚¨ <code>NULL</code> å’Œ <code>non-comparable</code> çš„å¯¹è±¡ã€‚</li><li><code>PriorityQueue</code> é»˜è®¤æ˜¯å°é¡¶å †ï¼Œä½†å¯ä»¥æ¥æ”¶ä¸€ä¸ª <code>Comparator</code> ä½œä¸ºæ„é€ å‚æ•°ï¼Œä»è€Œæ¥è‡ªå®šä¹‰å…ƒç´ ä¼˜å…ˆçº§çš„å…ˆåã€‚</li></ul><h3 id="28-HashSet-å¦‚ä½•æ£€æŸ¥é‡å¤"><a href="#28-HashSet-å¦‚ä½•æ£€æŸ¥é‡å¤" class="headerlink" title="28.HashSet å¦‚ä½•æ£€æŸ¥é‡å¤"></a><a href="">28.HashSet å¦‚ä½•æ£€æŸ¥é‡å¤</a></h3><p>å½“ä½ æŠŠå¯¹è±¡åŠ å…¥<code>HashSet</code>æ—¶ï¼Œ<code>HashSet</code> ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„<code>hashcode</code>å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸å…¶ä»–åŠ å…¥çš„å¯¹è±¡çš„ <code>hashcode</code> å€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„ <code>hashcode</code>ï¼Œ<code>HashSet</code> ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ <code>hashcode</code> å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨<code>equals()</code>æ–¹æ³•æ¥æ£€æŸ¥ <code>hashcode</code> ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œ<code>HashSet</code> å°±ä¸ä¼šè®©åŠ å…¥æ“ä½œæˆåŠŸã€‚</p><h3 id="29-ConcurrentHashMap-å’Œ-Hashtable-çš„åŒºåˆ«"><a href="#29-ConcurrentHashMap-å’Œ-Hashtable-çš„åŒºåˆ«" class="headerlink" title="29. ConcurrentHashMap å’Œ Hashtable çš„åŒºåˆ«"></a><a href="">29. ConcurrentHashMap å’Œ Hashtable çš„åŒºåˆ«</a></h3><p><code>ConcurrentHashMap</code> å’Œ <code>Hashtable</code> çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ä¸Šä¸åŒã€‚</p><ul><li><strong>åº•å±‚æ•°æ®ç»“æ„ï¼š</strong> JDK1.7 çš„ <code>ConcurrentHashMap</code> åº•å±‚é‡‡ç”¨ <strong>åˆ†æ®µçš„æ•°ç»„+é“¾è¡¨</strong> å®ç°ï¼ŒJDK1.8 é‡‡ç”¨çš„æ•°æ®ç»“æ„è·Ÿ <code>HashMap1.8</code> çš„ç»“æ„ä¸€æ ·ï¼Œæ•°ç»„+é“¾è¡¨/çº¢é»‘äºŒå‰æ ‘ã€‚<code>Hashtable</code> å’Œ JDK1.8 ä¹‹å‰çš„ <code>HashMap</code> çš„åº•å±‚æ•°æ®ç»“æ„ç±»ä¼¼éƒ½æ˜¯é‡‡ç”¨ <strong>æ•°ç»„+é“¾è¡¨</strong> çš„å½¢å¼ï¼Œæ•°ç»„æ˜¯ HashTableçš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼›</li><li><strong>å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼ˆé‡è¦ï¼‰ï¼š</strong> â‘  <strong>åœ¨ JDK1.7 çš„æ—¶å€™ï¼Œ<code>ConcurrentHashMap</code>ï¼ˆåˆ†æ®µé”ï¼‰</strong> å¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µ(<code>Segment</code>)ï¼Œæ¯ä¸€æŠŠé”åªé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œæé«˜å¹¶å‘è®¿é—®ç‡ã€‚ <strong>åˆ°äº† JDK1.8 çš„æ—¶å€™å·²ç»æ‘’å¼ƒäº† <code>Segment</code> çš„æ¦‚å¿µï¼Œè€Œæ˜¯ç›´æ¥ç”¨ <code>Node</code> æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨ <code>synchronized</code> å’Œ CAS æ¥æ“ä½œã€‚â‘¡ </strong><code>Hashtable</code>(åŒä¸€æŠŠé”) :ä½¿ç”¨ <code>synchronized</code> æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡éå¸¸ä½ä¸‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¯èƒ½ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ï¼Œå¦‚ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ getï¼Œç«äº‰ä¼šè¶Šæ¥è¶Šæ¿€çƒˆæ•ˆç‡è¶Šä½ã€‚</li></ul><h3 id="30-ConcurrentHashMap-çº¿ç¨‹å®‰å…¨çš„å…·ä½“å®ç°æ–¹å¼-åº•å±‚å…·ä½“å®ç°"><a href="#30-ConcurrentHashMap-çº¿ç¨‹å®‰å…¨çš„å…·ä½“å®ç°æ–¹å¼-åº•å±‚å…·ä½“å®ç°" class="headerlink" title="30.ConcurrentHashMap çº¿ç¨‹å®‰å…¨çš„å…·ä½“å®ç°æ–¹å¼/åº•å±‚å…·ä½“å®ç°"></a><a href="">30.ConcurrentHashMap çº¿ç¨‹å®‰å…¨çš„å…·ä½“å®ç°æ–¹å¼/åº•å±‚å…·ä½“å®ç°</a></h3><h4 id="JDK1-7"><a href="#JDK1-7" class="headerlink" title="JDK1.7"></a>JDK1.7</h4><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/ConcurrentHashMap%E5%88%86%E6%AE%B5%E9%94%81.jpg" alt=""></p><p>é¦–å…ˆå°†æ•°æ®åˆ†ä¸ºä¸€æ®µä¸€æ®µçš„å­˜å‚¨ï¼Œç„¶åç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å ç”¨é”è®¿é—®å…¶ä¸­ä¸€ä¸ªæ®µæ•°æ®æ—¶ï¼Œå…¶ä»–æ®µçš„æ•°æ®ä¹Ÿèƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚</p><p><strong><code>ConcurrentHashMap</code> æ˜¯ç”± <code>Segment</code> æ•°ç»„ç»“æ„å’Œ <code>HashEntry</code> æ•°ç»„ç»“æ„ç»„æˆ</strong>ã€‚</p><p>Segment ç»§æ‰¿äº† <code>ReentrantLock</code>,æ‰€ä»¥ <code>Segment</code> æ˜¯ä¸€ç§å¯é‡å…¥é”ï¼Œæ‰®æ¼”é”çš„è§’è‰²ã€‚Segment é»˜è®¤ä¸º 16ï¼Œä¹Ÿå°±æ˜¯å¹¶å‘åº¦ä¸º 16ã€‚<code>HashEntry</code> ç”¨äºå­˜å‚¨é”®å€¼å¯¹æ•°æ®ã€‚</p><p>ä¸€ä¸ª <code>ConcurrentHashMap</code> é‡ŒåŒ…å«ä¸€ä¸ª <code>Segment</code> æ•°ç»„ã€‚<code>Segment</code> çš„ç»“æ„å’Œ <code>HashMap</code> ç±»ä¼¼ï¼Œæ˜¯ä¸€ç§æ•°ç»„å’Œé“¾è¡¨ç»“æ„ï¼Œä¸€ä¸ª <code>Segment</code> åŒ…å«ä¸€ä¸ª <code>HashEntry</code> æ•°ç»„ï¼Œæ¯ä¸ª <code>HashEntry</code> æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„çš„å…ƒç´ ï¼Œæ¯ä¸ª <code>Segment</code> å®ˆæŠ¤ç€ä¸€ä¸ª <code>HashEntry</code> æ•°ç»„é‡Œçš„å…ƒç´ ï¼Œå½“å¯¹ <code>HashEntry</code> æ•°ç»„çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¿…é¡»é¦–å…ˆè·å¾—å¯¹åº”çš„ <code>Segment</code> çš„é”ã€‚ </p><h4 id="JDK1-8"><a href="#JDK1-8" class="headerlink" title="JDK1.8"></a>JDK1.8</h4><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20220209165135940.png" alt="image-20220209165135940"></p><p>åœ¨æ•°æ®ç»“æ„ä¸Šï¼Œ JDK1.8 ä¸­çš„ConcurrentHashMap é€‰æ‹©äº†ä¸ HashMap ç›¸åŒçš„Nodeæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ç»“æ„ï¼›åœ¨é”çš„å®ç°ä¸Šï¼ŒæŠ›å¼ƒäº†åŸæœ‰çš„ Segment åˆ†æ®µé”ï¼Œé‡‡ç”¨CAS + synchronizedå®ç°æ›´åŠ ç»†ç²’åº¦çš„é”ã€‚</p><p>å°†é”çš„çº§åˆ«æ§åˆ¶åœ¨äº†æ›´ç»†ç²’åº¦çš„å“ˆå¸Œæ¡¶æ•°ç»„å…ƒç´ çº§åˆ«ï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€è¦é”ä½è¿™ä¸ªé“¾è¡¨å¤´èŠ‚ç‚¹ï¼ˆçº¢é»‘æ ‘çš„æ ¹èŠ‚ç‚¹ï¼‰ï¼Œå°±ä¸ä¼šå½±å“å…¶ä»–çš„å“ˆå¸Œæ¡¶æ•°ç»„å…ƒç´ çš„è¯»å†™ï¼Œå¤§å¤§æé«˜äº†å¹¶å‘åº¦ã€‚</p><p><code>synchronized</code> åªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘äºŒå‰æ ‘çš„é¦–èŠ‚ç‚¹ï¼Œè¿™æ ·åªè¦ hash ä¸å†²çªï¼Œå°±ä¸ä¼šäº§ç”Ÿå¹¶å‘ï¼Œæ•ˆç‡åˆæå‡ N å€ã€‚</p><h3 id="31-Mapæœ‰å“ªäº›å¸¸ç”¨çš„å®ç°ç±»åŠå…¶ä½œç”¨ï¼Ÿ"><a href="#31-Mapæœ‰å“ªäº›å¸¸ç”¨çš„å®ç°ç±»åŠå…¶ä½œç”¨ï¼Ÿ" class="headerlink" title="31.Mapæœ‰å“ªäº›å¸¸ç”¨çš„å®ç°ç±»åŠå…¶ä½œç”¨ï¼Ÿ"></a><a href="">31.<strong>Mapæœ‰å“ªäº›å¸¸ç”¨çš„å®ç°ç±»åŠå…¶ä½œç”¨ï¼Ÿ</strong></a></h3><p><strong>HashMap:</strong>ä¸Šé¢ä¹Ÿè¯´äº†ï¼Œ<strong>HashMapçš„åº•å±‚å®ç°æ˜¯æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„å½¢å¼çš„ï¼Œ</strong>åŒæ—¶å®ƒçš„<strong>æ•°ç»„çš„é»˜è®¤åˆå§‹å®¹é‡æ˜¯16ã€æ‰©å®¹å› å­ä¸º0.75ï¼Œæ¯æ¬¡é‡‡ç”¨2å€çš„æ‰©å®¹ã€‚</strong>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯å½“æˆ‘ä»¬æ•°ç»„ä¸­çš„å­˜å‚¨å®¹é‡è¾¾åˆ°75%çš„æ—¶å€™ï¼Œå°±éœ€è¦å¯¹æ•°ç»„å®¹é‡è¿›è¡Œ2å€çš„æ‰©å®¹ã€‚</p><p><strong>HashTable:</strong>HashTableæ¥å£æ˜¯çº¿ç¨‹å®‰å…¨ï¼Œä½†æ˜¯å¾ˆæ—©ä¹‹å‰æœ‰ä½¿ç”¨ï¼Œç°åœ¨å‡ ä¹å±äºä¸€ä¸ªé—ç•™ç±»äº†ï¼Œ<strong>åœ¨å¼€å‘ä¸­ä¸å»ºè®®ä½¿ç”¨ã€‚</strong></p><p><strong>ConcurrentHashMap:</strong>è¿™æ˜¯ç°é˜¶æ®µä½¿ç”¨ä½¿ç”¨æ¯”è¾ƒå¤šçš„ä¸€ç§çº¿ç¨‹å®‰å…¨çš„Mapå®ç°ç±»ã€‚<strong>åœ¨1.7ä»¥å‰ä½¿ç”¨çš„æ˜¯åˆ†æ®µé”æœºåˆ¶å®ç°çš„çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯åœ¨1.8ä»¥åä½¿ç”¨synchronizedå…³é”®å­—å®ç°çš„çº¿ç¨‹å®‰å…¨ã€‚</strong></p><h3 id="32-è¯·é˜è¿°HashMapçš„putè¿‡ç¨‹ï¼Ÿ"><a href="#32-è¯·é˜è¿°HashMapçš„putè¿‡ç¨‹ï¼Ÿ" class="headerlink" title="32.è¯·é˜è¿°HashMapçš„putè¿‡ç¨‹ï¼Ÿ"></a><a href="">32.<strong>è¯·é˜è¿°HashMapçš„putè¿‡ç¨‹ï¼Ÿ</strong></a></h3><p>åœ¨HashMapä¸­ä½¿ç”¨çš„æ˜¯æ•°ç»„+é“¾è¡¨çš„å®ç°æ–¹å¼ï¼Œ<strong>åœ¨HashMapçš„ä¸Šå±‚ä½¿ç”¨æ•°ç»„çš„å½¢å¼å¯¹â€œç›¸åŒâ€çš„keyè¿›è¡Œå­˜å‚¨ï¼Œä¸‹å±‚å¯¹ç›¸åº”çš„keyå’Œvalueä½¿ç”¨é“¾è¡¨çš„å½¢å¼è¿›è¡Œé“¾æ¥å’Œå­˜å‚¨ã€‚</strong></p><p>HashMapå°†è¦å­˜å‚¨çš„å€¼æŒ‰ç…§keyè®¡ç®—å…¶å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¦‚æœå¯¹åº”çš„æ•°ç»„ä¸‹æ ‡çš„ä½ç½®ä¸Šæ˜¯æ²¡æœ‰å…ƒç´ çš„ï¼Œé‚£ä¹ˆå°±å°†å­˜å‚¨çš„å…ƒç´ å­˜æ”¾ä¸Šå»ï¼Œä½†æ˜¯å¦‚æœè¯¥ä½ç½®ä¸Šå·²ç»å­˜åœ¨å…ƒç´ äº†ï¼Œé‚£ä¹ˆè¿™å°±éœ€è¦ç”¨åˆ°æˆ‘ä»¬ä¸Šé¢æ‰€è¯´çš„é“¾è¡¨å­˜å‚¨äº†ï¼Œå°†æ•°æ®æŒ‰ç…§é“¾è¡¨çš„å­˜å‚¨é¡ºåºä¾æ¬¡å‘ä¸‹å­˜å‚¨å°±å¯ä»¥äº†ã€‚è¿™å°±æ˜¯putçš„ç®€å•è¿‡ç¨‹ï¼Œå­˜å‚¨ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/20210606155342841.jpg" alt=""></p><p>ä½†æ˜¯æˆ‘ä»¬æœ‰æ—¶å€™å­˜å‚¨çš„æ•°æ®ä¼šå¾ˆå¤šï¼Œé‚£ä¹ˆå¦‚æœä¸€ç›´ä½¿ç”¨é“¾è¡¨çš„å½¢å¼è¿›è¡Œæ•°æ®çš„å­˜å‚¨çš„è¯å°±æˆ–é€ æˆæˆ‘ä»¬çš„é“¾è¡¨çš„é•¿åº¦éå¸¸å¤§ï¼Œè¿™æ ·æ— è®ºåœ¨è¿›è¡Œåˆ é™¤è¿˜æ˜¯åœ¨è¿›è¡Œæ’å…¥æ“ä½œéƒ½æ˜¯ååˆ†éº»çƒ¦çš„ï¼Œ<strong>è¿™é‡Œå°±æ¶‰åŠåˆ°äº†ä¸€ä¸ªé“¾è¡¨ä¸­æ•°æ®å­˜å‚¨æ—¶ï¼Œè¿›è¡Œâ€œæ ‘åŒ–â€å’Œâ€œé“¾åŒ–â€çš„ä¸€ä¸ªè¿‡ç¨‹</strong>ã€‚å½“æˆ‘ä»¬åœ¨å¯¹é”®å€¼å¯¹è¿›è¡Œå­˜å‚¨çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬åœ¨åŒä¸€ä¸ªæ•°ç»„ä¸‹æ ‡ä¸‹å­˜å‚¨çš„æ•°æ®è¿‡å¤šçš„è¯ï¼Œå°±ä¼šé€ æˆæˆ‘ä»¬çš„é“¾è¡¨é•¿åº¦è¿‡é•¿ï¼Œå¯¼è‡´è¿›è¡Œåˆ é™¤å’Œæ’å…¥æ“ä½œæ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥åœ¨javaä¸­è§„å®šï¼Œ<strong>å½“é“¾è¡¨é•¿åº¦å¤§äº8æ—¶ï¼Œæˆ‘ä»¬ä¼šå¯¹é“¾è¡¨è¿›è¡Œâ€œæ ‘åŒ–â€æ“ä½œï¼Œ</strong>å°†å…¶è½¬æ¢æˆä¸€é¢—çº¢é»‘æ ‘ï¼ˆä¸€ç§äºŒå‰æ ‘ï¼Œå·¦è¾¹èŠ‚ç‚¹çš„å€¼å°äºæ ¹èŠ‚ç‚¹ï¼Œå³è¾¹èŠ‚ç‚¹çš„å€¼å¤§äºæ ¹èŠ‚ç‚¹ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨å¯¹å…ƒç´ è¿›è¡ŒæŸ¥æ‰¾æ—¶ï¼Œå°±ç±»ä¼¼äºè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾äº†ï¼Œè¿™æ ·çš„æŸ¥æ‰¾æ•ˆç‡å°±ä¼šå¤§å¤§å¢åŠ ã€‚ä½†æ˜¯å½“æˆ‘ä»¬è¿›è¡Œåˆ é™¤æ“ä½œï¼Œå°†å…¶ä¸­çš„æŸäº›èŠ‚ç‚¹åˆ é™¤äº†ä¹‹åï¼Œé“¾è¡¨çš„é•¿åº¦ä¸å†å¤§äº8äº†ï¼Œ<strong>å½“é“¾è¡¨çš„é•¿åº¦å°äº6çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå°†çº¢é»‘æ ‘é‡æ–°è½¬åŒ–ä¸ºé“¾è¡¨ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«åšâ€œé“¾åŒ–â€ã€‚</strong></p><p><strong>é‚£ä¹ˆä¸ºä»€ä¹ˆè¦åœ¨é•¿åº¦8çš„æ—¶å€™è¿›è¡Œâ€œæ ‘åŒ–â€ï¼Œè€Œåœ¨é•¿åº¦å°äº6çš„æ—¶å€™æ‰è¿›è¡Œâ€œé“¾åŒ–â€å‘¢ï¼Ÿä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨é•¿åº¦å°äº8çš„æ—¶å€™å°±è¿›è¡Œâ€œé“¾åŒ–â€ï¼Ÿ</strong></p><p><strong>ä¸»è¦åŸå› æ˜¯å› ä¸ºï¼š</strong>å½“åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œé“¾è¡¨é•¿åº¦å°äº8çš„æ—¶å€™ç›´æ¥è¿›è¡Œâ€œé“¾åŒ–â€ï¼Œè€Œå†å¢åŠ ä¸€ä¸ªå…ƒç´ ï¼Œé•¿åº¦åˆç­‰äº8çš„æ—¶å€™ï¼Œåˆè¦è¿›è¡Œâ€œæ ‘åŒ–â€ï¼Œè¿™æ ·åå¤çš„è¿›è¡Œâ€œé“¾åŒ–â€å’Œâ€œæ ‘åŒ–â€æ“ä½œç‰¹åˆ«çš„æ¶ˆè€—æ—¶é—´ï¼Œè€Œä¸”ä¹Ÿæ¯”è¾ƒéº»çƒ¦ã€‚æ‰€ä»¥ç¨‹åºå°±è§„å®šï¼Œåªæœ‰å½“å½“é“¾è¡¨é•¿åº¦å¤§äºç­‰äº8çš„æ—¶å€™æ‰è¿›è¡Œâ€œæ ‘åŒ–â€ï¼Œè€Œé•¿åº¦å°äº6çš„æ—¶å€™æ‰è¿›è¡Œâ€œé“¾åŒ–â€ï¼Œ<strong>å…¶ä¸­å…³äº8æ ‘åŒ–ã€6é“¾åŒ–è¿™ä¸¤ä¸ªé˜ˆå€¼å¸Œæœ›å¤§å®¶ç‰¢è®°ï¼</strong></p><h3 id="33-HashMapçš„é“¾è¡¨ä¸­æ˜¯æŒ‰ç…§æ€æ ·çš„é¡ºåºå­˜æ”¾æ•°æ®çš„ï¼Ÿ"><a href="#33-HashMapçš„é“¾è¡¨ä¸­æ˜¯æŒ‰ç…§æ€æ ·çš„é¡ºåºå­˜æ”¾æ•°æ®çš„ï¼Ÿ" class="headerlink" title="33.HashMapçš„é“¾è¡¨ä¸­æ˜¯æŒ‰ç…§æ€æ ·çš„é¡ºåºå­˜æ”¾æ•°æ®çš„ï¼Ÿ"></a><a href="">33.HashMapçš„<strong>é“¾è¡¨ä¸­æ˜¯æŒ‰ç…§æ€æ ·çš„é¡ºåºå­˜æ”¾æ•°æ®çš„ï¼Ÿ</strong></a></h3><p>åœ¨JDK1.7ä»¥åŠå‰æ˜¯åœ¨å¤´ç»“ç‚¹æ’å…¥çš„ï¼Œåœ¨JDK1.8ä¹‹åæ˜¯åœ¨å°¾èŠ‚ç‚¹æ’å…¥çš„ã€‚</p><h3 id="34-HashMapæ˜¯å¦‚ä½•æ‰©å®¹çš„ï¼Ÿ"><a href="#34-HashMapæ˜¯å¦‚ä½•æ‰©å®¹çš„ï¼Ÿ" class="headerlink" title="34.HashMapæ˜¯å¦‚ä½•æ‰©å®¹çš„ï¼Ÿ"></a><a href="">34.<strong>HashMapæ˜¯å¦‚ä½•æ‰©å®¹çš„ï¼Ÿ</strong></a></h3><p>HashMapçš„æ•°ç»„çš„åˆå§‹å®¹é‡æ˜¯16ï¼Œä½†æ˜¯å¾ˆæ˜¾ç„¶16ä¸ªå­˜å‚¨ä½æ˜¯æ˜¾ç„¶ä¸å¤Ÿçš„ï¼Œ<strong>åœ¨è¿™é‡Œéœ€è¦ç”¨åˆ°ä¸€ä¸ªå‚æ•°å«â€œæ‰©å®¹å› å­â€ï¼Œåœ¨HashMapä¸­â€œæ‰©å®¹å› å­â€çš„å¤§å°æ˜¯0.75ï¼Œ</strong> <strong>å¯¹äºåˆå§‹é•¿åº¦ä¸º16çš„æ•°ç»„ï¼Œå½“å…¶ä¸­å­˜å‚¨çš„æ•°æ®é•¿åº¦ç­‰äº16*0.75=12æ—¶ã€‚å°±ä¼šå¯¹æ•°ç»„å…ƒç´ è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹é‡æ˜¯åŸæ¥æ•°ç»„å®¹é‡çš„2å€ã€‚</strong></p><h3 id="35-HashMapæ‰©å®¹åå…ƒç´ æ€ä¹ˆå­˜æ”¾çš„ï¼Ÿ"><a href="#35-HashMapæ‰©å®¹åå…ƒç´ æ€ä¹ˆå­˜æ”¾çš„ï¼Ÿ" class="headerlink" title="35.HashMapæ‰©å®¹åå…ƒç´ æ€ä¹ˆå­˜æ”¾çš„ï¼Ÿ"></a><a href="">35.HashMap<strong>æ‰©å®¹åå…ƒç´ æ€ä¹ˆå­˜æ”¾çš„ï¼Ÿ</strong></a></h3><p>æˆ‘ä»¬çŸ¥é“HashMapçš„æ•°ç»„åœ¨è¿›è¡Œæ‰©å®¹ä¹‹åï¼Œæ•°ç»„é•¿åº¦æ˜¯å¢åŠ çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œåé¢æ–°æ‰©å®¹çš„éƒ¨åˆ†å°±æ˜¯ç©ºçš„ã€‚è¿™æ ·ä¼šé€ æˆå†…å­˜çš„å¾ˆå¤§æµªè´¹ã€‚<strong>å› æ­¤åœ¨HashMapçš„æ•°ç»„æ‰©å®¹ä¹‹åï¼ŒåŸå…ˆHashMapæ•°ç»„ä¸­å­˜æ”¾çš„æ•°æ®å…ƒç´ ä¼šè¿›è¡Œé‡æ–°çš„ä½ç½®åˆ†é…ï¼Œé‡æ–°å°†å…ƒç´ åœ¨æ–°æ•°ç»„ä¸­è¿›è¡Œå­˜å‚¨ã€‚ä»¥å……åˆ†åˆ©ç”¨æ•°ç»„ç©ºé—´ã€‚</strong></p><h3 id="36-JDK1-8-ä¸­ConCurrentHashMapä¸ºä»€ä¹ˆä½¿ç”¨å†…ç½®é”-synchronizedæ›¿æ¢-å¯é‡å…¥é”-ReentrantLockï¼Ÿ"><a href="#36-JDK1-8-ä¸­ConCurrentHashMapä¸ºä»€ä¹ˆä½¿ç”¨å†…ç½®é”-synchronizedæ›¿æ¢-å¯é‡å…¥é”-ReentrantLockï¼Ÿ" class="headerlink" title="36.JDK1.8 ä¸­ConCurrentHashMapä¸ºä»€ä¹ˆä½¿ç”¨å†…ç½®é” synchronizedæ›¿æ¢ å¯é‡å…¥é” ReentrantLockï¼Ÿ"></a><a href="">36.JDK1.8 ä¸­ConCurrentHashMapä¸ºä»€ä¹ˆä½¿ç”¨å†…ç½®é” synchronizedæ›¿æ¢ å¯é‡å…¥é” ReentrantLockï¼Ÿ</a></h3><p>åœ¨ JDK1.6 ä¸­ï¼Œå¯¹ synchronized é”çš„å®ç°å¼•å…¥äº†å¤§é‡çš„ä¼˜åŒ–ï¼Œå¹¶ä¸” synchronized æœ‰å¤šç§é”çŠ¶æ€ï¼Œä¼šä»æ— é” -&gt; åå‘é” -&gt; è½»é‡çº§é” -&gt; é‡é‡çº§é”ä¸€æ­¥æ­¥å‡çº§ã€‚</p><p>å‡å°‘å†…å­˜å¼€é”€ ã€‚å‡è®¾ä½¿ç”¨å¯é‡å…¥é”æ¥è·å¾—åŒæ­¥æ”¯æŒï¼Œé‚£ä¹ˆæ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦é€šè¿‡ç»§æ‰¿ AQS æ¥è·å¾—åŒæ­¥æ”¯æŒã€‚ä½†å¹¶ä¸æ˜¯æ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦è·å¾—åŒæ­¥æ”¯æŒçš„ï¼Œåªæœ‰é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼ˆçº¢é»‘æ ‘çš„æ ¹èŠ‚ç‚¹ï¼‰éœ€è¦åŒæ­¥ï¼Œè¿™æ— ç–‘å¸¦æ¥äº†å·¨å¤§å†…å­˜æµªè´¹ã€‚</p><h3 id="37-ConcurrentHashMap-çš„-put-æ–¹æ³•æ‰§è¡Œé€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#37-ConcurrentHashMap-çš„-put-æ–¹æ³•æ‰§è¡Œé€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="37.ConcurrentHashMap çš„ put æ–¹æ³•æ‰§è¡Œé€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿ"></a><a href="">37.ConcurrentHashMap çš„ put æ–¹æ³•æ‰§è¡Œé€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿ</a></h3><p>æ•´ä½“æµç¨‹è·ŸHashMapæ¯”è¾ƒç±»ä¼¼ï¼Œå¤§è‡´æ˜¯ä»¥ä¸‹å‡ æ­¥ï¼š</p><p>ï¼ˆ1ï¼‰å¦‚æœæ¡¶æ•°ç»„æœªåˆå§‹åŒ–ï¼Œåˆ™åˆå§‹åŒ–ï¼›</p><p>ï¼ˆ2ï¼‰å¦‚æœå¾…æ’å…¥çš„å…ƒç´ æ‰€åœ¨çš„æ¡¶ä¸ºç©ºï¼Œåˆ™å°è¯•æŠŠæ­¤å…ƒç´ ç›´æ¥æ’å…¥åˆ°æ¡¶çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼›</p><p>ï¼ˆ3ï¼‰å¦‚æœæ­£åœ¨æ‰©å®¹ï¼Œåˆ™å½“å‰çº¿ç¨‹ä¸€èµ·åŠ å…¥åˆ°æ‰©å®¹çš„è¿‡ç¨‹ä¸­ï¼›</p><p>ï¼ˆ4ï¼‰å¦‚æœå¾…æ’å…¥çš„å…ƒç´ æ‰€åœ¨çš„æ¡¶ä¸ä¸ºç©ºä¸”ä¸åœ¨è¿ç§»å…ƒç´ ï¼Œåˆ™é”ä½è¿™ä¸ªæ¡¶ï¼ˆåˆ†æ®µé”ï¼‰ï¼›</p><p>ï¼ˆ5ï¼‰å¦‚æœå½“å‰æ¡¶ä¸­å…ƒç´ ä»¥é“¾è¡¨æ–¹å¼å­˜å‚¨ï¼Œåˆ™åœ¨é“¾è¡¨ä¸­å¯»æ‰¾è¯¥å…ƒç´ æˆ–è€…æ’å…¥å…ƒç´ ï¼›</p><p>ï¼ˆ6ï¼‰å¦‚æœå½“å‰æ¡¶ä¸­å…ƒç´ ä»¥çº¢é»‘æ ‘æ–¹å¼å­˜å‚¨ï¼Œåˆ™åœ¨çº¢é»‘æ ‘ä¸­å¯»æ‰¾è¯¥å…ƒç´ æˆ–è€…æ’å…¥å…ƒç´ ï¼›</p><p>ï¼ˆ7ï¼‰å¦‚æœå…ƒç´ å­˜åœ¨ï¼Œåˆ™è¿”å›æ—§å€¼ï¼›</p><p>ï¼ˆ8ï¼‰å¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œæ•´ä¸ªMapçš„å…ƒç´ ä¸ªæ•°åŠ 1ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹ï¼›</p><p>æ·»åŠ å…ƒç´ æ“ä½œä¸­ä½¿ç”¨çš„é”ä¸»è¦æœ‰ï¼ˆè‡ªæ—‹é” + CAS + synchronized + åˆ†æ®µé”ï¼‰ã€‚</p><h3 id="38-æ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ«-ã€ä½¿ç”¨åœºæ™¯"><a href="#38-æ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ«-ã€ä½¿ç”¨åœºæ™¯" class="headerlink" title="38.æ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ« ã€ä½¿ç”¨åœºæ™¯"></a><a href="">38.æ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ« ã€ä½¿ç”¨åœºæ™¯</a></h3><p><strong>æ•°ç»„å’Œé“¾è¡¨çš„åŒºåˆ«</strong><br><strong>æ•°ç»„</strong>æ˜¯å°†å…ƒç´ åœ¨å†…å­˜ä¸­è¿ç»­å­˜å‚¨çš„ï¼›å®ƒçš„ä¼˜ç‚¹ï¼šå› ä¸ºæ•°æ®æ˜¯è¿ç»­å­˜å‚¨çš„ï¼Œå†…å­˜åœ°å€è¿ç»­ï¼Œæ‰€ä»¥åœ¨æŸ¥æ‰¾æ•°æ®çš„æ—¶å€™æ•ˆ<br>ç‡æ¯”è¾ƒé«˜ï¼›å®ƒçš„ç¼ºç‚¹ï¼šåœ¨å­˜å‚¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç”³è¯·ä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”åœ¨ç¼–è¯‘çš„æ—¶å€™å°±å¿…é¡»ç¡®å®šå¥½å®ƒçš„ç©ºé—´çš„å¤§<br>å°ã€‚åœ¨è¿è¡Œçš„æ—¶å€™ç©ºé—´çš„å¤§å°æ˜¯æ— æ³•éšç€ä½ çš„éœ€è¦è¿›è¡Œå¢åŠ å’Œå‡å°‘è€Œæ”¹å˜çš„ï¼Œå½“æ•°æ®ä¸¤æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°<br>è¶Šç•Œçš„æƒ…å†µï¼Œæ•°æ®æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œåˆæœ‰å¯èƒ½ä¼šæµªè´¹æ‰å†…å­˜ç©ºé—´ã€‚åœ¨æ”¹å˜æ•°æ®ä¸ªæ•°æ—¶ï¼Œå¢åŠ ã€æ’å…¥ã€åˆ é™¤æ•°æ®æ•ˆç‡æ¯”è¾ƒä½<br><strong>é“¾è¡¨</strong>æ˜¯åŠ¨æ€ç”³è¯·å†…å­˜ç©ºé—´ï¼Œä¸éœ€è¦åƒæ•°ç»„éœ€è¦æå‰ç”³è¯·å¥½å†…å­˜çš„å¤§å°ï¼Œé“¾è¡¨åªéœ€åœ¨ç”¨çš„æ—¶å€™ç”³è¯·å°±å¯ä»¥ï¼Œæ ¹æ®éœ€<br>è¦æ¥åŠ¨æ€ç”³è¯·æˆ–è€…åˆ é™¤å†…å­˜ç©ºé—´ï¼Œå¯¹äºæ•°æ®å¢åŠ å’Œåˆ é™¤ä»¥åŠæ’å…¥æ¯”æ•°ç»„çµæ´»ã€‚è¿˜æœ‰å°±æ˜¯é“¾è¡¨ä¸­æ•°æ®åœ¨å†…å­˜ä¸­å¯ä»¥åœ¨ä»»<br>æ„çš„ä½ç½®ï¼Œé€šè¿‡åº”ç”¨æ¥å…³è”æ•°æ®ï¼ˆå°±æ˜¯é€šè¿‡å­˜åœ¨å…ƒç´ çš„æŒ‡é’ˆæ¥è”ç³»ï¼‰<br><strong>é“¾è¡¨å’Œæ•°ç»„ä½¿ç”¨åœºæ™¯</strong><br>æ•°ç»„åº”ç”¨åœºæ™¯ï¼šæ•°æ®æ¯”è¾ƒå°‘ï¼›ç»å¸¸åšçš„è¿ç®—æ˜¯æŒ‰åºå·è®¿é—®æ•°æ®å…ƒç´ ï¼›æ•°ç»„æ›´å®¹æ˜“å®ç°ï¼Œä»»ä½•é«˜çº§è¯­è¨€éƒ½æ”¯æŒï¼›æ„å»º<br>çš„çº¿æ€§è¡¨è¾ƒç¨³å®šã€‚<br>é“¾è¡¨åº”ç”¨åœºæ™¯ï¼šå¯¹çº¿æ€§è¡¨çš„é•¿åº¦æˆ–è€…è§„æ¨¡éš¾ä»¥ä¼°è®¡ï¼›é¢‘ç¹åšæ’å…¥åˆ é™¤æ“ä½œï¼›æ„å»ºåŠ¨æ€æ€§æ¯”è¾ƒå¼ºçš„çº¿æ€§è¡¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…«è‚¡æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaåŸºç¡€</title>
      <link href="/posts/java-basic.html"/>
      <url>/posts/java-basic.html</url>
      
        <content type="html"><![CDATA[<h3 id="1-ä¸€ä¸ªâ€-javaâ€æºæ–‡ä»¶ä¸­æ˜¯å¦å¯ä»¥åŒ…æ‹¬å¤šä¸ªç±»ï¼ˆä¸æ˜¯å†…éƒ¨ç±»ï¼‰ï¼Ÿæœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ"><a href="#1-ä¸€ä¸ªâ€-javaâ€æºæ–‡ä»¶ä¸­æ˜¯å¦å¯ä»¥åŒ…æ‹¬å¤šä¸ªç±»ï¼ˆä¸æ˜¯å†…éƒ¨ç±»ï¼‰ï¼Ÿæœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ" class="headerlink" title="1.ä¸€ä¸ªâ€.javaâ€æºæ–‡ä»¶ä¸­æ˜¯å¦å¯ä»¥åŒ…æ‹¬å¤šä¸ªç±»ï¼ˆä¸æ˜¯å†…éƒ¨ç±»ï¼‰ï¼Ÿæœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ"></a><a href="">1.ä¸€ä¸ªâ€.javaâ€æºæ–‡ä»¶ä¸­æ˜¯å¦å¯ä»¥åŒ…æ‹¬å¤šä¸ªç±»ï¼ˆä¸æ˜¯å†…éƒ¨ç±»ï¼‰ï¼Ÿæœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ</a></h3><p>å¯ä»¥æœ‰å¤šä¸ªç±»ï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªpublicçš„ç±»ï¼Œå¹¶ä¸”publicçš„ç±»åå¿…é¡»ä¸æ–‡ä»¶åç›¸ä¸€è‡´ã€‚</p><h3 id="2-Javaæœ‰æ²¡æœ‰goto"><a href="#2-Javaæœ‰æ²¡æœ‰goto" class="headerlink" title="2.Javaæœ‰æ²¡æœ‰goto?"></a><a href="">2.Javaæœ‰æ²¡æœ‰goto?</a></h3><p>æ²¡æœ‰ï¼Œä½†æ˜¯ goto æ˜¯ java ä¸­çš„ä¿ç•™å­—ã€‚</p><h3 id="3-è¯´è¯´-amp-å’Œ-amp-amp-çš„åŒºåˆ«"><a href="#3-è¯´è¯´-amp-å’Œ-amp-amp-çš„åŒºåˆ«" class="headerlink" title="3.è¯´è¯´&amp;å’Œ&amp;&amp;çš„åŒºåˆ«"></a><a href="">3.è¯´è¯´&amp;å’Œ&amp;&amp;çš„åŒºåˆ«</a></h3><p>&amp;å’Œ&amp;&amp;éƒ½å¯ä»¥ç”¨ä½œé€»è¾‘ä¸çš„è¿ç®—ç¬¦ï¼Œè¡¨ç¤ºé€»è¾‘ä¸ï¼ˆandï¼‰ï¼Œå½“è¿ç®—ç¬¦ä¸¤è¾¹çš„è¡¨è¾¾å¼çš„ç»“æœéƒ½ä¸ºtrueæ—¶ï¼Œæ•´ä¸ªè¿ç®—ç»“æœæ‰ä¸ºtrueï¼Œå¦åˆ™ï¼Œåªè¦æœ‰ä¸€æ–¹ä¸ºfalseï¼Œåˆ™ç»“æœä¸ºfalseã€‚&amp;&amp;è¿˜å…·æœ‰çŸ­è·¯çš„åŠŸèƒ½ï¼Œå³å¦‚æœç¬¬ä¸€ä¸ªè¡¨è¾¾å¼ä¸ºfalseï¼Œåˆ™ä¸å†è®¡ç®—ç¬¬äºŒä¸ªè¡¨è¾¾å¼ã€‚</p><p>&amp;è¿˜å¯ä»¥ç”¨ä½œä½è¿ç®—ç¬¦ï¼Œå½“&amp;æ“ä½œç¬¦ä¸¤è¾¹çš„è¡¨è¾¾å¼ä¸æ˜¯booleanç±»å‹æ—¶ï¼Œ&amp;è¡¨ç¤ºæŒ‰ä½ä¸æ“ä½œï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨0x0fæ¥ä¸ä¸€ä¸ªæ•´æ•°è¿›è¡Œ&amp;è¿ç®—ï¼Œæ¥è·å–è¯¥æ•´æ•°çš„æœ€ä½4ä¸ªbitä½ï¼Œä¾‹å¦‚ï¼Œ0x31 &amp; 0x0fçš„ç»“æœä¸º0x01ã€‚</p><h3 id="4-åœ¨JAVAä¸­å¦‚ä½•è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯ï¼Ÿ-åä¸º"><a href="#4-åœ¨JAVAä¸­å¦‚ä½•è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯ï¼Ÿ-åä¸º" class="headerlink" title="4.åœ¨JAVAä¸­å¦‚ä½•è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯ï¼Ÿ(åä¸º)"></a><a href="">4.åœ¨JAVAä¸­å¦‚ä½•è·³å‡ºå½“å‰çš„å¤šé‡åµŒå¥—å¾ªç¯ï¼Ÿ(åä¸º)</a></h3><p>è®©å¤–å±‚çš„å¾ªç¯æ¡ä»¶è¡¨è¾¾å¼çš„ç»“æœå¯ä»¥å—åˆ°å†…å±‚å¾ªç¯ä½“ä»£ç çš„æ§åˆ¶ï¼Œä¾‹å¦‚ï¼Œè¦åœ¨äºŒç»´æ•°ç»„ä¸­æŸ¥æ‰¾åˆ°æŸä¸ªæ•°å­—ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[][] arr = &#123;&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>&#125;, &#123;<span class="number">9</span>&#125;&#125;;</span><br><span class="line"><span class="type">boolean</span> <span class="variable">found</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length &amp;&amp; !found; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; arr[i].length; j++) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;i = &quot;</span> + i + <span class="string">&quot;, j = &quot;</span> + j);</span><br><span class="line">        <span class="keyword">if</span> (arr[i][j] == <span class="number">5</span>) &#123;</span><br><span class="line">            found = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-switchè¯­å¥èƒ½å¦ä½œç”¨åœ¨byteä¸Šï¼Œèƒ½å¦ä½œç”¨åœ¨longä¸Šï¼Œèƒ½å¦ä½œç”¨åœ¨Stringä¸Š"><a href="#5-switchè¯­å¥èƒ½å¦ä½œç”¨åœ¨byteä¸Šï¼Œèƒ½å¦ä½œç”¨åœ¨longä¸Šï¼Œèƒ½å¦ä½œç”¨åœ¨Stringä¸Š" class="headerlink" title="5.switchè¯­å¥èƒ½å¦ä½œç”¨åœ¨byteä¸Šï¼Œèƒ½å¦ä½œç”¨åœ¨longä¸Šï¼Œèƒ½å¦ä½œç”¨åœ¨Stringä¸Š?"></a><a href="">5.switchè¯­å¥èƒ½å¦ä½œç”¨åœ¨byteä¸Šï¼Œèƒ½å¦ä½œç”¨åœ¨longä¸Šï¼Œèƒ½å¦ä½œç”¨åœ¨Stringä¸Š?</a></h3><p>åœ¨switchï¼ˆexpr1ï¼‰ä¸­ï¼Œexpr1åªèƒ½æ˜¯ä¸€ä¸ªæ•´æ•°è¡¨è¾¾å¼æˆ–è€…æšä¸¾å¸¸é‡ï¼Œæ•´æ•°è¡¨è¾¾å¼å¯ä»¥æ˜¯intåŸºæœ¬ç±»å‹æˆ–IntegeråŒ…è£…ç±»å‹ï¼Œç”±äºbyte,short,charéƒ½å¯ä»¥éšå¼è½¬æ¢ä¸ºintï¼Œæ‰€ä»¥ï¼Œè¿™äº›ç±»å‹ä»¥åŠè¿™äº›ç±»å‹çš„åŒ…è£…ç±»å‹ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p>switch ä¸æ”¯æŒ long ç±»å‹ï¼›ä» java1.7å¼€å§‹ switch å¼€å§‹æ”¯æŒ Stringï¼Œè¿™æ˜¯ Java çš„è¯­æ³•ç³–,å†…éƒ¨å®ç°åœ¨ switch ä¸­ä½¿ç”¨å­—ç¬¦ä¸²çš„ hash codeã€‚</p><h3 id="6-short-s1-1-s1-s1-1-æœ‰ä»€ä¹ˆé”™-short-s1-1-s1-1-æœ‰ä»€ä¹ˆé”™"><a href="#6-short-s1-1-s1-s1-1-æœ‰ä»€ä¹ˆé”™-short-s1-1-s1-1-æœ‰ä»€ä¹ˆé”™" class="headerlink" title="6.short s1 = 1; s1 = s1 + 1;æœ‰ä»€ä¹ˆé”™? short s1 = 1; s1 += 1;æœ‰ä»€ä¹ˆé”™?"></a><a href="">6.short s1 = 1; s1 = s1 + 1;æœ‰ä»€ä¹ˆé”™? short s1 = 1; s1 += 1;æœ‰ä»€ä¹ˆé”™?</a></h3><p>å¯¹äºshort s1 = 1; s1 = s1 + 1; ç”±äºs1+1è¿ç®—æ—¶ä¼šè‡ªåŠ¨æå‡è¡¨è¾¾å¼çš„ç±»å‹ï¼Œæ‰€ä»¥ç»“æœæ˜¯intå‹ï¼Œå†èµ‹å€¼ç»™shortç±»å‹s1æ—¶ï¼Œç¼–è¯‘å™¨å°†æŠ¥å‘Šéœ€è¦å¼ºåˆ¶è½¬æ¢ç±»å‹çš„é”™è¯¯ã€‚</p><p>å¯¹äºshort s1 = 1; s1 += 1;ç”±äº += æ˜¯javaè¯­è¨€è§„å®šçš„è¿ç®—ç¬¦ï¼Œjavaç¼–è¯‘å™¨ä¼šå¯¹å®ƒè¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œå› æ­¤å¯ä»¥æ­£ç¡®ç¼–è¯‘ã€‚</p><h3 id="7-charå‹å˜é‡ä¸­èƒ½ä¸èƒ½å­˜è´®ä¸€ä¸ªä¸­æ–‡æ±‰å­—-ä¸ºä»€ä¹ˆ"><a href="#7-charå‹å˜é‡ä¸­èƒ½ä¸èƒ½å­˜è´®ä¸€ä¸ªä¸­æ–‡æ±‰å­—-ä¸ºä»€ä¹ˆ" class="headerlink" title="7.charå‹å˜é‡ä¸­èƒ½ä¸èƒ½å­˜è´®ä¸€ä¸ªä¸­æ–‡æ±‰å­—?ä¸ºä»€ä¹ˆ?"></a><a href="">7.charå‹å˜é‡ä¸­èƒ½ä¸èƒ½å­˜è´®ä¸€ä¸ªä¸­æ–‡æ±‰å­—?ä¸ºä»€ä¹ˆ?</a></h3><p>charå‹å˜é‡æ˜¯ç”¨æ¥å­˜å‚¨Unicodeç¼–ç çš„å­—ç¬¦çš„ï¼Œunicodeç¼–ç å­—ç¬¦é›†ä¸­åŒ…å«äº†æ±‰å­—ï¼Œæ‰€ä»¥ï¼Œcharå‹å˜é‡ä¸­å½“ç„¶å¯ä»¥å­˜å‚¨æ±‰å­—å•¦ã€‚ä¸è¿‡ï¼Œå¦‚æœæŸä¸ªç‰¹æ®Šçš„æ±‰å­—æ²¡æœ‰è¢«åŒ…å«åœ¨unicodeç¼–ç å­—ç¬¦é›†ä¸­ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªcharå‹å˜é‡ä¸­å°±ä¸èƒ½å­˜å‚¨è¿™ä¸ªç‰¹æ®Šæ±‰å­—ã€‚è¡¥å……è¯´æ˜ï¼šunicodeç¼–ç å ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ï¼Œcharç±»å‹çš„å˜é‡ä¹Ÿæ˜¯å ç”¨ä¸¤ä¸ªå­—èŠ‚ã€‚</p><h3 id="8-ç”¨æœ€æœ‰æ•ˆç‡çš„æ–¹æ³•ç®—å‡º2ä¹˜ä»¥8ç­‰äºå‡ "><a href="#8-ç”¨æœ€æœ‰æ•ˆç‡çš„æ–¹æ³•ç®—å‡º2ä¹˜ä»¥8ç­‰äºå‡ " class="headerlink" title="8.ç”¨æœ€æœ‰æ•ˆç‡çš„æ–¹æ³•ç®—å‡º2ä¹˜ä»¥8ç­‰äºå‡ ?"></a><a href="">8.ç”¨æœ€æœ‰æ•ˆç‡çš„æ–¹æ³•ç®—å‡º2ä¹˜ä»¥8ç­‰äºå‡ ?</a></h3><p>2 &lt;&lt; 3ã€‚å› ä¸ºå°†ä¸€ä¸ªæ•°å·¦ç§»nä½ï¼Œå°±ç›¸å½“äºä¹˜ä»¥äº†2çš„næ¬¡æ–¹ï¼Œé‚£ä¹ˆï¼Œä¸€ä¸ªæ•°ä¹˜ä»¥8åªè¦å°†å…¶å·¦ç§»3ä½å³å¯ï¼Œè€Œä½è¿ç®—æ˜¯cpuç›´æ¥æ”¯æŒçš„ï¼Œæ•ˆç‡æœ€é«˜ï¼Œæ‰€ä»¥ï¼Œ2ä¹˜ä»¥8ç­‰äºå‡ çš„æœ€é«˜æ•ˆçš„æ–¹æ³•æ˜¯2 &lt;&lt; 3ã€‚</p><h3 id="10-ä½¿ç”¨finalå…³é”®å­—ä¿®é¥°ä¸€ä¸ªå˜é‡æ—¶ï¼Œæ˜¯å¼•ç”¨ä¸èƒ½å˜ï¼Œè¿˜æ˜¯å¼•ç”¨çš„å¯¹è±¡ä¸èƒ½å˜ï¼Ÿ"><a href="#10-ä½¿ç”¨finalå…³é”®å­—ä¿®é¥°ä¸€ä¸ªå˜é‡æ—¶ï¼Œæ˜¯å¼•ç”¨ä¸èƒ½å˜ï¼Œè¿˜æ˜¯å¼•ç”¨çš„å¯¹è±¡ä¸èƒ½å˜ï¼Ÿ" class="headerlink" title="10.ä½¿ç”¨finalå…³é”®å­—ä¿®é¥°ä¸€ä¸ªå˜é‡æ—¶ï¼Œæ˜¯å¼•ç”¨ä¸èƒ½å˜ï¼Œè¿˜æ˜¯å¼•ç”¨çš„å¯¹è±¡ä¸èƒ½å˜ï¼Ÿ"></a><a href="">10.ä½¿ç”¨finalå…³é”®å­—ä¿®é¥°ä¸€ä¸ªå˜é‡æ—¶ï¼Œæ˜¯å¼•ç”¨ä¸èƒ½å˜ï¼Œè¿˜æ˜¯å¼•ç”¨çš„å¯¹è±¡ä¸èƒ½å˜ï¼Ÿ</a></h3><p><strong>ä½¿ç”¨finalå…³é”®å­—ä¿®é¥°ä¸€ä¸ªå˜é‡æ—¶ï¼Œæ˜¯æŒ‡å¼•ç”¨å˜é‡ä¸èƒ½å˜ï¼Œå¼•ç”¨å˜é‡æ‰€æŒ‡å‘çš„å¯¹è±¡ä¸­çš„å†…å®¹è¿˜æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚</strong>ä¾‹å¦‚ï¼Œå¯¹äºå¦‚ä¸‹è¯­å¥ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> StringBuffer a=<span class="keyword">new</span> <span class="title class_">StringBuffer</span>(<span class="string">&quot;immutable&quot;</span>);</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå¦‚ä¸‹è¯­å¥å°†æŠ¥å‘Šç¼–è¯‘æœŸé”™è¯¯ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="keyword">new</span> <span class="title class_">StringBuffer</span>(<span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure><br>ä½†æ˜¯ï¼Œæ‰§è¡Œå¦‚ä¸‹è¯­å¥åˆ™å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a.append(<span class="string">&quot; broken!&quot;</span>);</span><br></pre></td></tr></table></figure><br>æœ‰äººåœ¨å®šä¹‰æ–¹æ³•çš„å‚æ•°æ—¶ï¼Œå¯èƒ½æƒ³é‡‡ç”¨å¦‚ä¸‹å½¢å¼æ¥é˜»æ­¢æ–¹æ³•å†…éƒ¨ä¿®æ”¹ä¼ è¿›æ¥çš„å‚æ•°å¯¹è±¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">(<span class="keyword">final</span> StringBuffer param)</span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼Œè¿™æ˜¯åŠä¸åˆ°çš„ï¼Œåœ¨è¯¥æ–¹æ³•å†…éƒ¨ä»ç„¶å¯ä»¥å¢åŠ å¦‚ä¸‹ä»£ç æ¥ä¿®æ”¹å‚æ•°å¯¹è±¡ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">param.append(<span class="string">&quot;a&quot;</span>);</span><br></pre></td></tr></table></figure></p><h3 id="11-â€-â€å’Œequalsæ–¹æ³•ç©¶ç«Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#11-â€-â€å’Œequalsæ–¹æ³•ç©¶ç«Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="11.â€==â€å’Œequalsæ–¹æ³•ç©¶ç«Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a><a href="">11.â€==â€å’Œequalsæ–¹æ³•ç©¶ç«Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></h3><p><code>==</code>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨æ•°æ®ç±»å‹çš„ä½œç”¨æ•ˆæœæ˜¯ä¸åŒçš„ï¼š</p><ul><li>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹æ¥è¯´ï¼Œ<code>==</code> æ¯”è¾ƒçš„æ˜¯å€¼ã€‚</li><li>å¯¹äºå¼•ç”¨æ•°æ®ç±»å‹æ¥è¯´ï¼Œ<code>==</code> æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</li></ul><p>å› ä¸º Java åªæœ‰å€¼ä¼ é€’ï¼Œæ‰€ä»¥ï¼Œå¯¹äº <code>==</code> æ¥è¯´ï¼Œä¸ç®¡æ˜¯æ¯”è¾ƒåŸºæœ¬æ•°æ®ç±»å‹ï¼Œè¿˜æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å˜é‡ï¼Œå…¶æœ¬è´¨æ¯”è¾ƒçš„éƒ½æ˜¯å€¼ï¼Œåªæ˜¯å¼•ç”¨ç±»å‹å˜é‡å­˜çš„å€¼æ˜¯å¯¹è±¡çš„åœ°å€ã€‚</p><p><strong><code>equals()</code></strong> ä¸èƒ½ç”¨äºåˆ¤æ–­åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œåªèƒ½ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚<code>equals()</code>æ–¹æ³•å­˜åœ¨äº<code>Object</code>ç±»ä¸­ï¼Œè€Œ<code>Object</code>ç±»æ˜¯æ‰€æœ‰ç±»çš„ç›´æ¥æˆ–é—´æ¥çˆ¶ç±»ã€‚å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰è‡ªå·±å®šä¹‰equalsæ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒå°†ç»§æ‰¿Objectç±»çš„equalsæ–¹æ³•ï¼ŒObjectç±»çš„equalsæ–¹æ³•çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>==o;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>equals()</code>æ–¹æ³•å­˜åœ¨ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š</p><ul><li><strong>ç±»æ²¡æœ‰è¦†ç›– <code>equals()</code>æ–¹æ³•</strong> ï¼šé€šè¿‡<code>equals()</code>æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œç­‰ä»·äºé€šè¿‡<code>==</code>æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯¹è±¡ï¼Œä½¿ç”¨çš„é»˜è®¤æ˜¯ <code>Object</code>ç±»<code>equals()</code>æ–¹æ³•ã€‚</li><li><strong>ç±»è¦†ç›–äº† <code>equals()</code>æ–¹æ³•</strong> ï¼šä¸€èˆ¬æˆ‘ä»¬éƒ½è¦†ç›– <code>equals()</code>æ–¹æ³•æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ä¸­çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ï¼›è‹¥å®ƒä»¬çš„å†…å®¹ç›¸ç­‰ï¼Œåˆ™è¿”å› true(å³ï¼Œè®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰)ã€‚</li></ul><h3 id="12-é™æ€å˜é‡å’Œæˆå‘˜å˜é‡çš„åŒºåˆ«ï¼Ÿ"><a href="#12-é™æ€å˜é‡å’Œæˆå‘˜å˜é‡çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="12.é™æ€å˜é‡å’Œæˆå‘˜å˜é‡çš„åŒºåˆ«ï¼Ÿ"></a><a href="">12.é™æ€å˜é‡å’Œæˆå‘˜å˜é‡çš„åŒºåˆ«ï¼Ÿ</a></h3><p>åœ¨è¯­æ³•å®šä¹‰ä¸Šçš„åŒºåˆ«ï¼šé™æ€å˜é‡å‰è¦åŠ staticå…³é”®å­—ï¼Œè€Œå®ä¾‹å˜é‡å‰åˆ™ä¸åŠ ã€‚</p><p>åœ¨ç¨‹åºè¿è¡Œæ—¶çš„åŒºåˆ«ï¼šæˆå‘˜å˜é‡æ˜¯å±äºæŸä¸ªå¯¹è±¡çš„å±æ€§ï¼Œå¿…é¡»åˆ›å»ºäº†å®ä¾‹å¯¹è±¡ï¼Œå…¶ä¸­çš„æˆå‘˜å˜é‡æ‰ä¼šè¢«åˆ†é…ç©ºé—´ï¼Œæ‰èƒ½ä½¿ç”¨è¿™ä¸ªæˆå‘˜å˜é‡ã€‚é™æ€å˜é‡ä¸å±äºæŸä¸ªå®ä¾‹å¯¹è±¡ï¼Œè€Œæ˜¯å±äºç±»ï¼Œæ‰€ä»¥ä¹Ÿç§°ä¸ºç±»å˜é‡ï¼Œåªè¦ç¨‹åºåŠ è½½äº†ç±»çš„å­—èŠ‚ç ï¼Œä¸ç”¨åˆ›å»ºä»»ä½•å®ä¾‹å¯¹è±¡ï¼Œé™æ€å˜é‡å°±ä¼šè¢«åˆ†é…ç©ºé—´ï¼Œé™æ€å˜é‡å°±å¯ä»¥è¢«ä½¿ç”¨äº†ã€‚æ€»ä¹‹ï¼Œæˆå‘˜å˜é‡å¿…é¡»åˆ›å»ºå¯¹è±¡åæ‰å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡æ¥ä½¿ç”¨ï¼Œé™æ€å˜é‡åˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨ç±»åæ¥å¼•ç”¨ã€‚</p><h3 id="13-æ˜¯å¦å¯ä»¥ä»ä¸€ä¸ªstaticæ–¹æ³•å†…éƒ¨å‘å‡ºå¯¹éstaticæ–¹æ³•çš„è°ƒç”¨ï¼Ÿ"><a href="#13-æ˜¯å¦å¯ä»¥ä»ä¸€ä¸ªstaticæ–¹æ³•å†…éƒ¨å‘å‡ºå¯¹éstaticæ–¹æ³•çš„è°ƒç”¨ï¼Ÿ" class="headerlink" title="13.æ˜¯å¦å¯ä»¥ä»ä¸€ä¸ªstaticæ–¹æ³•å†…éƒ¨å‘å‡ºå¯¹éstaticæ–¹æ³•çš„è°ƒç”¨ï¼Ÿ"></a><a href="">13.æ˜¯å¦å¯ä»¥ä»ä¸€ä¸ªstaticæ–¹æ³•å†…éƒ¨å‘å‡ºå¯¹éstaticæ–¹æ³•çš„è°ƒç”¨ï¼Ÿ</a></h3><p>ä¸å¯ä»¥ã€‚</p><p>å› ä¸ºéstaticæ–¹æ³•æ˜¯è¦ä¸å¯¹è±¡å…³è”åœ¨ä¸€èµ·çš„ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªå¯¹è±¡åï¼Œæ‰å¯ä»¥åœ¨è¯¥å¯¹è±¡ä¸Šè¿›è¡Œæ–¹æ³•è°ƒç”¨ï¼Œè€Œstaticæ–¹æ³•è°ƒç”¨æ—¶ä¸éœ€è¦åˆ›å»ºå¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸€ä¸ªstaticæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå¯èƒ½è¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•å®ä¾‹å¯¹è±¡ï¼Œå¦‚æœä»ä¸€ä¸ªstaticæ–¹æ³•ä¸­å‘å‡ºå¯¹éstaticæ–¹æ³•çš„è°ƒç”¨ï¼Œé‚£ä¸ªéstaticæ–¹æ³•æ˜¯å…³è”åˆ°å“ªä¸ªå¯¹è±¡ä¸Šçš„å‘¢ï¼Ÿè¿™ä¸ªé€»è¾‘æ— æ³•æˆç«‹ï¼Œæ‰€ä»¥ï¼Œä¸€ä¸ªstaticæ–¹æ³•å†…éƒ¨ä¸å¯ä»¥å‘å‡ºå¯¹éstaticæ–¹æ³•çš„è°ƒç”¨ã€‚</p><h3 id="14-Integerä¸intçš„åŒºåˆ«"><a href="#14-Integerä¸intçš„åŒºåˆ«" class="headerlink" title="14.Integerä¸intçš„åŒºåˆ«"></a><a href="">14.Integerä¸intçš„åŒºåˆ«</a></h3><p>intæ˜¯javaæä¾›çš„8ç§åŸå§‹æ•°æ®ç±»å‹ä¹‹ä¸€ã€‚Javaä¸ºæ¯ä¸ªåŸå§‹ç±»å‹æä¾›äº†å°è£…ç±»ï¼ŒIntegeræ˜¯javaä¸ºintæä¾›çš„å°è£…ç±»ã€‚intçš„é»˜è®¤å€¼ä¸º0ï¼Œè€ŒIntegerçš„é»˜è®¤å€¼ä¸ºnullï¼Œå³Integerå¯ä»¥åŒºåˆ†å‡ºæœªèµ‹å€¼å’Œå€¼ä¸º0çš„åŒºåˆ«ï¼Œintåˆ™æ— æ³•è¡¨è¾¾å‡ºæœªèµ‹å€¼çš„æƒ…å†µï¼Œä¾‹å¦‚ï¼Œè¦æƒ³è¡¨è¾¾å‡ºæ²¡æœ‰å‚åŠ è€ƒè¯•å’Œè€ƒè¯•æˆç»©ä¸º0çš„åŒºåˆ«ï¼Œåˆ™åªèƒ½ä½¿ç”¨Integerã€‚å¦å¤–ï¼ŒIntegeræä¾›äº†å¤šä¸ªä¸æ•´æ•°ç›¸å…³çš„æ“ä½œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°ï¼ŒIntegerä¸­è¿˜å®šä¹‰äº†è¡¨ç¤ºæ•´æ•°çš„æœ€å¤§å€¼å’Œæœ€å°å€¼çš„å¸¸é‡ã€‚</p><h3 id="15-Math-round-11-5-ç­‰äºå¤šå°‘-Math-round-11-5-ç­‰äºå¤šå°‘"><a href="#15-Math-round-11-5-ç­‰äºå¤šå°‘-Math-round-11-5-ç­‰äºå¤šå°‘" class="headerlink" title="15.Math.round(11.5)ç­‰äºå¤šå°‘? Math.round(-11.5)ç­‰äºå¤šå°‘?"></a><a href="">15.Math.round(11.5)ç­‰äºå¤šå°‘? Math.round(-11.5)ç­‰äºå¤šå°‘?</a></h3><p>Mathç±»ä¸­æä¾›äº†ä¸‰ä¸ªä¸å–æ•´æœ‰å…³çš„æ–¹æ³•ï¼šceilã€floorã€roundï¼Œè¿™äº›æ–¹æ³•çš„ä½œç”¨ä¸å®ƒä»¬çš„è‹±æ–‡åç§°çš„å«ä¹‰ç›¸å¯¹åº”ï¼Œä¾‹å¦‚ï¼Œceilçš„è‹±æ–‡æ„ä¹‰æ˜¯å¤©èŠ±æ¿ï¼Œè¯¥æ–¹æ³•å°±è¡¨ç¤ºå‘ä¸Šå–æ•´ï¼ŒMath.ceil(11.3)çš„ç»“æœä¸º12,Math.ceil(-11.3)çš„ç»“æœæ˜¯-11ï¼›floorçš„è‹±æ–‡æ„ä¹‰æ˜¯åœ°æ¿ï¼Œè¯¥æ–¹æ³•å°±è¡¨ç¤ºå‘ä¸‹å–æ•´ï¼ŒMath.floor(11.6)çš„ç»“æœä¸º11,Math.floor(-11.6)çš„ç»“æœæ˜¯-12ï¼›<strong>æœ€éš¾æŒæ¡çš„æ˜¯roundæ–¹æ³•ï¼Œå®ƒè¡¨ç¤ºâ€œå››èˆäº”å…¥â€ï¼Œç®—æ³•ä¸ºMath.floor(x+0.5)ï¼Œå³å°†åŸæ¥çš„æ•°å­—åŠ ä¸Š0.5åå†å‘ä¸‹å–æ•´ï¼Œæ‰€ä»¥ï¼ŒMath.round(11.5)çš„ç»“æœä¸º12ï¼ŒMath.round(-11.5)çš„ç»“æœä¸º-11ã€‚</strong></p><h3 id="16-è¯·è¯´å‡ºä½œç”¨åŸŸpublicï¼Œprivateï¼Œprotectedï¼Œä»¥åŠä¸å†™æ—¶çš„åŒºåˆ«ã€‚"><a href="#16-è¯·è¯´å‡ºä½œç”¨åŸŸpublicï¼Œprivateï¼Œprotectedï¼Œä»¥åŠä¸å†™æ—¶çš„åŒºåˆ«ã€‚" class="headerlink" title="16.è¯·è¯´å‡ºä½œç”¨åŸŸpublicï¼Œprivateï¼Œprotectedï¼Œä»¥åŠä¸å†™æ—¶çš„åŒºåˆ«ã€‚"></a><a href="">16.è¯·è¯´å‡ºä½œç”¨åŸŸpublicï¼Œprivateï¼Œprotectedï¼Œä»¥åŠä¸å†™æ—¶çš„åŒºåˆ«ã€‚</a></h3><p>è¿™å››ä¸ªä½œç”¨åŸŸçš„å¯è§èŒƒå›´å¦‚ä¸‹è¡¨æ‰€ç¤º</p><p>è¯´æ˜ï¼šå¦‚æœåœ¨ä¿®é¥°çš„å…ƒç´ ä¸Šé¢æ²¡æœ‰å†™ä»»ä½•è®¿é—®ä¿®é¥°ç¬¦ï¼Œåˆ™è¡¨ç¤ºfriendlyã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:left">ä½œç”¨åŸŸ</th><th style="text-align:left">å½“å‰ç±»</th><th style="text-align:left">åŒä¸€package</th><th style="text-align:left">å­å­™ç±»</th><th style="text-align:left">å…¶ä»–package</th></tr></thead><tbody><tr><td style="text-align:left">public</td><td style="text-align:left">âˆš</td><td style="text-align:left">âˆš</td><td style="text-align:left">âˆš</td><td style="text-align:left">âˆš</td></tr><tr><td style="text-align:left">protected</td><td style="text-align:left">âˆš</td><td style="text-align:left">âˆš</td><td style="text-align:left">âˆš</td><td style="text-align:left">Ã—</td></tr><tr><td style="text-align:left">friendly</td><td style="text-align:left">âˆš</td><td style="text-align:left">âˆš</td><td style="text-align:left">Ã—</td><td style="text-align:left">Ã—</td></tr><tr><td style="text-align:left">private</td><td style="text-align:left">âˆš</td><td style="text-align:left">Ã—</td><td style="text-align:left">Ã—</td><td style="text-align:left">Ã—</td></tr></tbody></table></div><ul><li><p>publicï¼špublicè¡¨æ˜è¯¥æ•°æ®æˆå‘˜ã€æˆå‘˜å‡½æ•°æ˜¯å¯¹æ‰€æœ‰ç”¨æˆ·å¼€æ”¾çš„ï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥ç›´æ¥è¿›è¡Œè°ƒç”¨</p></li><li><p>privateï¼šprivateè¡¨ç¤ºç§æœ‰ï¼Œç§æœ‰çš„æ„æ€å°±æ˜¯é™¤äº†classè‡ªå·±ä¹‹å¤–ï¼Œä»»ä½•äººéƒ½ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p></li><li><p>protectedï¼šprotectedå¯¹äºå­ç±»ã€æœ‹å‹æ¥è¯´ï¼Œå°±æ˜¯publicçš„ï¼Œå¯ä»¥è‡ªç”±ä½¿ç”¨ï¼Œæ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œè€Œå¯¹äºå…¶ä»–çš„å¤–éƒ¨classï¼Œprotectedå°±å˜æˆprivateã€‚</p></li></ul><h3 id="17-Overload-é‡è½½-å’ŒOverride-é‡å†™-çš„åŒºåˆ«ã€‚Overloadedçš„æ–¹æ³•æ˜¯å¦å¯ä»¥æ”¹å˜è¿”å›å€¼çš„ç±»å‹-ï¼ˆç¾å›¢ï¼‰"><a href="#17-Overload-é‡è½½-å’ŒOverride-é‡å†™-çš„åŒºåˆ«ã€‚Overloadedçš„æ–¹æ³•æ˜¯å¦å¯ä»¥æ”¹å˜è¿”å›å€¼çš„ç±»å‹-ï¼ˆç¾å›¢ï¼‰" class="headerlink" title="17.Overload(é‡è½½)å’ŒOverride(é‡å†™)çš„åŒºåˆ«ã€‚Overloadedçš„æ–¹æ³•æ˜¯å¦å¯ä»¥æ”¹å˜è¿”å›å€¼çš„ç±»å‹?ï¼ˆç¾å›¢ï¼‰"></a><a href="">17.Overload(é‡è½½)å’ŒOverride(é‡å†™)çš„åŒºåˆ«ã€‚Overloadedçš„æ–¹æ³•æ˜¯å¦å¯ä»¥æ”¹å˜è¿”å›å€¼çš„ç±»å‹?ï¼ˆç¾å›¢ï¼‰</a></h3><p>é‡è½½è¡¨ç¤ºåŒä¸€ä¸ªç±»ä¸­å¯ä»¥æœ‰å¤šä¸ªåç§°ç›¸åŒçš„æ–¹æ³•ï¼Œä½†è¿™äº›æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å„ä¸ç›¸åŒï¼ˆå³å‚æ•°ä¸ªæ•°æˆ–ç±»å‹ä¸åŒï¼‰ã€‚</p><p>é‡å†™Overrideè¡¨ç¤ºå­ç±»ä¸­çš„æ–¹æ³•å¯ä»¥ä¸çˆ¶ç±»ä¸­çš„æŸä¸ªæ–¹æ³•çš„åç§°å’Œå‚æ•°å®Œå…¨ç›¸åŒï¼Œé€šè¿‡å­ç±»åˆ›å»ºçš„å®ä¾‹å¯¹è±¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå°†è°ƒç”¨å­ç±»ä¸­çš„å®šä¹‰æ–¹æ³•ï¼Œè¿™ç›¸å½“äºæŠŠçˆ¶ç±»ä¸­å®šä¹‰çš„é‚£ä¸ªå®Œå…¨ç›¸åŒçš„æ–¹æ³•ç»™è¦†ç›–äº†ï¼Œè¿™ä¹Ÿæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„å¤šæ€æ€§çš„ä¸€ç§è¡¨ç°ã€‚å­ç±»è¦†ç›–çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œåªèƒ½æ¯”çˆ¶ç±»æŠ›å‡ºæ›´å°‘çš„å¼‚å¸¸ï¼Œæˆ–è€…æ˜¯æŠ›å‡ºçˆ¶ç±»æŠ›å‡ºçš„å¼‚å¸¸çš„å­å¼‚å¸¸ï¼Œå› ä¸ºå­ç±»å¯ä»¥è§£å†³çˆ¶ç±»çš„ä¸€äº›é—®é¢˜ï¼Œä¸èƒ½æ¯”çˆ¶ç±»æœ‰æ›´å¤šçš„é—®é¢˜ã€‚å­ç±»æ–¹æ³•çš„è®¿é—®æƒé™åªèƒ½æ¯”çˆ¶ç±»çš„æ›´å¤§ï¼Œä¸èƒ½æ›´å°ã€‚<strong>å¦‚æœçˆ¶ç±»çš„æ–¹æ³•æ˜¯privateç±»å‹ï¼Œé‚£ä¹ˆï¼Œå­ç±»åˆ™ä¸å­˜åœ¨è¦†ç›–çš„é™åˆ¶ï¼Œç›¸å½“äºå­ç±»ä¸­å¢åŠ äº†ä¸€ä¸ªå…¨æ–°çš„æ–¹æ³•ã€‚</strong></p><p>å¦‚æœå‡ ä¸ªOverloadedçš„æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸ä¸€æ ·ï¼Œå®ƒä»¬çš„è¿”å›è€…ç±»å‹ä¹Ÿå¯ä»¥ä¸ä¸€æ ·ã€‚</p><p>å¦‚æœä¸¤ä¸ªæ–¹æ³•çš„å‚æ•°åˆ—è¡¨å®Œå…¨ä¸€æ ·ï¼Œåˆ™ä¸å¯ä»¥è®©å®ƒä»¬çš„è¿”å›å€¼ä¸åŒæ¥å®ç°é‡è½½Overloadã€‚æˆ‘ä»¬å¯ä»¥ç”¨åè¯æ³•æ¥è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰æ—¶å€™è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æ—¶ä¹Ÿå¯ä»¥ä¸å®šä¹‰è¿”å›ç»“æœå˜é‡ï¼Œå³ä¸è¦å…³å¿ƒå…¶è¿”å›ç»“æœï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬è°ƒç”¨map.remove(key)æ–¹æ³•æ—¶ï¼Œè™½ç„¶removeæ–¹æ³•æœ‰è¿”å›å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸éƒ½ä¸ä¼šå®šä¹‰æ¥æ”¶è¿”å›ç»“æœçš„å˜é‡ï¼Œè¿™æ—¶å€™<strong>å‡è®¾è¯¥ç±»ä¸­æœ‰ä¸¤ä¸ªåç§°å’Œå‚æ•°åˆ—è¡¨å®Œå…¨ç›¸åŒçš„æ–¹æ³•ï¼Œä»…ä»…æ˜¯è¿”å›ç±»å‹ä¸åŒï¼Œjavaå°±æ— æ³•ç¡®å®šç¼–ç¨‹è€…å€’åº•æ˜¯æƒ³è°ƒç”¨å“ªä¸ªæ–¹æ³•äº†ï¼Œå› ä¸ºå®ƒæ— æ³•é€šè¿‡è¿”å›ç»“æœç±»å‹æ¥åˆ¤æ–­ã€‚</strong></p><p>overrideå¯ä»¥ç¿»è¯‘ä¸ºè¦†ç›–ï¼Œä»å­—é¢å°±å¯ä»¥çŸ¥é“ï¼Œå®ƒæ˜¯è¦†ç›–äº†ä¸€ä¸ªæ–¹æ³•å¹¶ä¸”å¯¹å…¶é‡å†™ï¼Œä»¥æ±‚è¾¾åˆ°ä¸åŒçš„ä½œç”¨ã€‚å¯¹æˆ‘ä»¬æ¥è¯´æœ€ç†Ÿæ‚‰çš„è¦†ç›–å°±æ˜¯å¯¹æ¥å£æ–¹æ³•çš„å®ç°ï¼Œåœ¨æ¥å£ä¸­ä¸€èˆ¬åªæ˜¯å¯¹æ–¹æ³•è¿›è¡Œäº†å£°æ˜ï¼Œè€Œæˆ‘ä»¬åœ¨å®ç°æ—¶ï¼Œå°±éœ€è¦å®ç°æ¥å£å£°æ˜çš„æ‰€æœ‰æ–¹æ³•ã€‚é™¤äº†è¿™ä¸ªå…¸å‹çš„ç”¨æ³•ä»¥å¤–ï¼Œæˆ‘ä»¬åœ¨ç»§æ‰¿ä¸­ä¹Ÿå¯èƒ½ä¼šåœ¨å­ç±»è¦†ç›–çˆ¶ç±»ä¸­çš„æ–¹æ³•ã€‚åœ¨è¦†ç›–è¦æ³¨æ„ä»¥ä¸‹çš„å‡ ç‚¹ï¼š</p><p>1ï¼‰è¦†ç›–çš„æ–¹æ³•çš„æ ‡å¿—å¿…é¡»è¦å’Œè¢«è¦†ç›–çš„æ–¹æ³•çš„æ ‡å¿—å®Œå…¨åŒ¹é…ï¼Œæ‰èƒ½è¾¾åˆ°è¦†ç›–çš„æ•ˆæœï¼›</p><p>2ï¼‰è¦†ç›–çš„æ–¹æ³•çš„è¿”å›å€¼å¿…é¡»å’Œè¢«è¦†ç›–çš„æ–¹æ³•çš„è¿”å›ä¸€è‡´ï¼›</p><p>3ï¼‰è¦†ç›–çš„æ–¹æ³•æ‰€æŠ›å‡ºçš„å¼‚å¸¸å¿…é¡»å’Œè¢«è¦†ç›–æ–¹æ³•çš„æ‰€æŠ›å‡ºçš„å¼‚å¸¸ä¸€è‡´ï¼Œæˆ–è€…æ˜¯å…¶å­ç±»ï¼›</p><p>4ï¼‰è¢«è¦†ç›–çš„æ–¹æ³•ä¸èƒ½ä¸ºprivateï¼Œå¦åˆ™åœ¨å…¶å­ç±»ä¸­åªæ˜¯æ–°å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶æ²¡æœ‰å¯¹å…¶è¿›è¡Œè¦†ç›–ã€‚</p><h3 id="18-æ„é€ æ–¹æ³•æ˜¯å¦å¯ä»¥è¢«override"><a href="#18-æ„é€ æ–¹æ³•æ˜¯å¦å¯ä»¥è¢«override" class="headerlink" title="18.æ„é€ æ–¹æ³•æ˜¯å¦å¯ä»¥è¢«override?"></a><a href="">18.æ„é€ æ–¹æ³•æ˜¯å¦å¯ä»¥è¢«override?</a></h3><p>æ„é€ æ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå› æ­¤ä¸èƒ½é‡å†™Overrideï¼Œä½†å¯ä»¥è¢«é‡è½½Overloadã€‚</p><h3 id="19-æ¥å£æ˜¯å¦å¯ç»§æ‰¿æ¥å£-æŠ½è±¡ç±»æ˜¯å¦å¯å®ç°-implements-æ¥å£-æŠ½è±¡ç±»æ˜¯å¦å¯ç»§æ‰¿å…·ä½“ç±»-concrete-class-æŠ½è±¡ç±»ä¸­æ˜¯å¦å¯ä»¥æœ‰é™æ€çš„mainæ–¹æ³•ï¼Ÿ"><a href="#19-æ¥å£æ˜¯å¦å¯ç»§æ‰¿æ¥å£-æŠ½è±¡ç±»æ˜¯å¦å¯å®ç°-implements-æ¥å£-æŠ½è±¡ç±»æ˜¯å¦å¯ç»§æ‰¿å…·ä½“ç±»-concrete-class-æŠ½è±¡ç±»ä¸­æ˜¯å¦å¯ä»¥æœ‰é™æ€çš„mainæ–¹æ³•ï¼Ÿ" class="headerlink" title="19.æ¥å£æ˜¯å¦å¯ç»§æ‰¿æ¥å£? æŠ½è±¡ç±»æ˜¯å¦å¯å®ç°(implements)æ¥å£? æŠ½è±¡ç±»æ˜¯å¦å¯ç»§æ‰¿å…·ä½“ç±»(concrete class)? æŠ½è±¡ç±»ä¸­æ˜¯å¦å¯ä»¥æœ‰é™æ€çš„mainæ–¹æ³•ï¼Ÿ"></a><a href="">19.æ¥å£æ˜¯å¦å¯ç»§æ‰¿æ¥å£? æŠ½è±¡ç±»æ˜¯å¦å¯å®ç°(implements)æ¥å£? æŠ½è±¡ç±»æ˜¯å¦å¯ç»§æ‰¿å…·ä½“ç±»(concrete class)? æŠ½è±¡ç±»ä¸­æ˜¯å¦å¯ä»¥æœ‰é™æ€çš„mainæ–¹æ³•ï¼Ÿ</a></h3><p>æ¥å£å¯ä»¥ç»§æ‰¿æ¥å£ã€‚æŠ½è±¡ç±»å¯ä»¥å®ç°(implements)æ¥å£ï¼ŒæŠ½è±¡ç±»å¯ä»¥ç»§æ‰¿å…·ä½“ç±»ã€‚æŠ½è±¡ç±»ä¸­å¯ä»¥æœ‰é™æ€çš„mainæ–¹æ³•ã€‚</p><p>æŠ½è±¡ç±»ä¸æ™®é€šç±»çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯ä¸èƒ½åˆ›å»ºå®ä¾‹å¯¹è±¡å’Œå…è®¸æœ‰abstractæ–¹æ³•ã€‚</p><h3 id="20-å†™clone-æ–¹æ³•æ—¶ï¼Œé€šå¸¸éƒ½æœ‰ä¸€è¡Œä»£ç ï¼Œæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#20-å†™clone-æ–¹æ³•æ—¶ï¼Œé€šå¸¸éƒ½æœ‰ä¸€è¡Œä»£ç ï¼Œæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="20.å†™clone()æ–¹æ³•æ—¶ï¼Œé€šå¸¸éƒ½æœ‰ä¸€è¡Œä»£ç ï¼Œæ˜¯ä»€ä¹ˆï¼Ÿ"></a><a href="">20.å†™clone()æ–¹æ³•æ—¶ï¼Œé€šå¸¸éƒ½æœ‰ä¸€è¡Œä»£ç ï¼Œæ˜¯ä»€ä¹ˆï¼Ÿ</a></h3><p>clone æœ‰ç¼ºçœè¡Œä¸ºï¼Œsuper.clone();å› ä¸ºé¦–å…ˆè¦æŠŠçˆ¶ç±»ä¸­çš„æˆå‘˜å¤åˆ¶åˆ°ä½ï¼Œç„¶åæ‰æ˜¯å¤åˆ¶è‡ªå·±çš„æˆå‘˜ã€‚</p><h3 id="21-é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢"><a href="#21-é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢" class="headerlink" title="21.é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢"></a><a href="">21.é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢</a></h3><p>é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€æœ‰<strong>å°è£…ã€ç»§æ‰¿ ã€æŠ½è±¡ã€å¤šæ€</strong>ç­‰4ä¸ªä¸»è¦çš„ç‰¹å¾ã€‚</p><p>1ï¼‰å°è£…ï¼š</p><p>é¢å‘å¯¹è±¡çš„å°è£…å°±æ˜¯æŠŠæè¿°ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å’Œè¡Œä¸ºçš„ä»£ç å°è£…åœ¨ä¸€ä¸ªâ€œæ¨¡å—â€ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç±»ä¸­ï¼Œå±æ€§ç”¨å˜é‡å®šä¹‰ï¼Œè¡Œä¸ºç”¨æ–¹æ³•è¿›è¡Œå®šä¹‰ï¼Œæ–¹æ³•å¯ä»¥ç›´æ¥è®¿é—®åŒä¸€ä¸ªå¯¹è±¡ä¸­çš„å±æ€§ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œåªè¦è®°ä½è®©å˜é‡å’Œè®¿é—®è¿™ä¸ªå˜é‡çš„æ–¹æ³•æ”¾åœ¨ä¸€èµ·ï¼Œå°†ä¸€ä¸ªç±»ä¸­çš„æˆå‘˜å˜é‡å…¨éƒ¨å®šä¹‰æˆç§æœ‰çš„ï¼Œåªæœ‰è¿™ä¸ªç±»è‡ªå·±çš„æ–¹æ³•æ‰å¯ä»¥è®¿é—®åˆ°è¿™äº›æˆå‘˜å˜é‡ï¼Œè¿™å°±åŸºæœ¬ä¸Šå®ç°å¯¹è±¡çš„å°è£…ï¼Œå°±å¾ˆå®¹æ˜“æ‰¾å‡ºè¦åˆ†é…åˆ°è¿™ä¸ªç±»ä¸Šçš„æ–¹æ³•äº†ã€‚</p><p>ä¾‹å¦‚ï¼Œäººè¦åœ¨é»‘æ¿ä¸Šç”»åœ†ï¼Œè¿™ä¸€å…±æ¶‰åŠä¸‰ä¸ªå¯¹è±¡ï¼šäººã€é»‘æ¿ã€åœ†ï¼Œç”»åœ†çš„æ–¹æ³•è¦åˆ†é…ç»™å“ªä¸ªå¯¹è±¡å‘¢ï¼Ÿç”±äºç”»åœ†éœ€è¦ä½¿ç”¨åˆ°åœ†å¿ƒå’ŒåŠå¾„ï¼Œåœ†å¿ƒå’ŒåŠå¾„æ˜¾ç„¶æ˜¯åœ†çš„å±æ€§ï¼Œå¦‚æœå°†å®ƒä»¬åœ¨ç±»ä¸­å®šä¹‰æˆäº†ç§æœ‰çš„æˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆï¼Œç”»åœ†çš„æ–¹æ³•å¿…é¡»åˆ†é…ç»™åœ†ï¼Œå®ƒæ‰èƒ½è®¿é—®åˆ°åœ†å¿ƒå’ŒåŠå¾„è¿™ä¸¤ä¸ªå±æ€§ï¼Œäººä»¥ååªæ˜¯è°ƒç”¨åœ†çš„ç”»åœ†æ–¹æ³•ã€è¡¨ç¤ºç»™åœ†å‘ç»™æ¶ˆæ¯è€Œå·²ï¼Œç”»åœ†è¿™ä¸ªæ–¹æ³•ä¸åº”è¯¥åˆ†é…åœ¨äººè¿™ä¸ªå¯¹è±¡ä¸Šï¼Œè¿™å°±æ˜¯é¢å‘å¯¹è±¡çš„å°è£…æ€§ï¼Œå³å°†å¯¹è±¡å°è£…æˆä¸€ä¸ªé«˜åº¦è‡ªæ²»å’Œç›¸å¯¹å°é—­çš„ä¸ªä½“ï¼Œå¯¹è±¡çŠ¶æ€ï¼ˆå±æ€§ï¼‰ç”±è¿™ä¸ªå¯¹è±¡è‡ªå·±çš„è¡Œä¸ºï¼ˆæ–¹æ³•ï¼‰æ¥è¯»å–å’Œæ”¹å˜ã€‚</p><p>ä¼˜ç‚¹:</p><ul><li>å‡å°‘è€¦åˆ: å¯ä»¥ç‹¬ç«‹åœ°å¼€å‘ã€æµ‹è¯•ã€ä¼˜åŒ–ã€ä½¿ç”¨ã€ç†è§£å’Œä¿®æ”¹</li><li>å‡è½»ç»´æŠ¤çš„è´Ÿæ‹…: å¯ä»¥æ›´å®¹æ˜“è¢«ç¨‹åºå‘˜ç†è§£ï¼Œå¹¶ä¸”åœ¨è°ƒè¯•çš„æ—¶å€™å¯ä»¥ä¸å½±å“å…¶ä»–æ¨¡å—</li><li>æœ‰æ•ˆåœ°è°ƒèŠ‚æ€§èƒ½: å¯ä»¥é€šè¿‡å‰–æç¡®å®šå“ªäº›æ¨¡å—å½±å“äº†ç³»ç»Ÿçš„æ€§èƒ½</li><li>æé«˜è½¯ä»¶çš„å¯é‡ç”¨æ€§</li><li>é™ä½äº†æ„å»ºå¤§å‹ç³»ç»Ÿçš„é£é™©: å³ä½¿æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ï¼Œä½†æ˜¯è¿™äº›ç‹¬ç«‹çš„æ¨¡å—å´æœ‰å¯èƒ½æ˜¯å¯ç”¨çš„</li></ul><p><strong>è¯´åˆ°å°è£…ï¼Œä¸ºä»€ä¹ˆæœ‰äº†ç§æœ‰å±æ€§ï¼Œè¿˜è¦æä¾›å¯¹å¤–è®¿é—®çš„å…¬æœ‰æ–¹æ³•ï¼Œè¿™æ ·å±æ€§ç§æœ‰æœ‰ä»€ä¹ˆæ„ä¹‰</strong>ï¼Ÿ</p><p>å…¶å®è¿™é‡Œä½“ç°çš„å°±æ˜¯å°è£…çš„æ€æƒ³: <strong>å°†æ•°æ®ä¸è¡Œä¸ºè¿›è¡Œåˆ†ç¦»ã€‚</strong></p><p>è¯•æƒ³ï¼Œ å¦‚æœå¤–é¢çš„ç¨‹åºå¯ä»¥éšæ„ä¿®æ”¹ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡ï¼Œä¼šé€ æˆä¸å¯é¢„æ–™çš„ç¨‹åºé”™è¯¯ï¼Œ å°±è±¡ä¸€ä¸ªäººçš„åå­—ï¼Œ<br>ä¸èƒ½è¢«å¤–éƒ¨éšæ„ä¿®æ”¹ï¼Œåªèƒ½é€šè¿‡å„ç§ç»™å®šçš„æ–¹æ³•å»ä¿®æ”¹è¿™ä¸ªå±æ€§ã€‚<br>æ‰€ä»¥æˆ‘ä»¬å°†æˆå‘˜å˜é‡å£°æ˜ä¸ºprivateï¼Œå†é€šè¿‡ publicçš„æ–¹æ³•æ¥å¯¹è¿™ä¸ªå˜é‡è¿›è¡Œè®¿é—®ã€‚</p><p>å¯¹ä¸€ä¸ªå˜é‡çš„æ“ä½œï¼Œä¸€èˆ¬éƒ½æœ‰è¯»å–å’Œèµ‹å€¼æ“ä½œï¼Œæˆ‘ä»¬åˆ†åˆ«å®šä¹‰ä¸¤ä¸ªæ–¹æ³•æ¥å®ç°è¿™ä¸¤ç§æ“ä½œï¼š<br>ä¸€ä¸ªæ˜¯getXxx()ï¼ˆXxx è¡¨ç¤ºè¦è®¿é—®çš„æˆå‘˜å˜é‡çš„åå­—ï¼‰ï¼Œç”¨æ¥è·å–è¿™ä¸ªæˆå‘˜å˜é‡ï¼›<br>å¦å¤–ä¸€ä¸ªæ˜¯ setXxx()ç”¨æ¥å¯¹è¿™ä¸ªæˆå‘˜å˜é‡ä¿®æ”¹ã€‚<strong>æˆ‘ä»¬å¯ä»¥åœ¨setæ–¹æ³•é‡Œåšå˜é‡èµ‹å€¼é€»è¾‘åˆ¤æ–­ï¼Œå¦‚æœå¤–éƒ¨ç±»èµ‹çš„å€¼ä¸ç¬¦åˆè§„åˆ™çš„è¯ï¼Œå°±èµ‹å€¼å¤±è´¥ã€‚</strong></p><p>2ï¼‰ç»§æ‰¿ï¼š</p><p>åœ¨å®šä¹‰å’Œå®ç°ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç±»çš„åŸºç¡€ä¹‹ä¸Šæ¥è¿›è¡Œï¼ŒæŠŠè¿™ä¸ªå·²ç»å­˜åœ¨çš„ç±»æ‰€å®šä¹‰çš„å†…å®¹ä½œä¸ºè‡ªå·±çš„å†…å®¹ï¼Œå¹¶å¯ä»¥åŠ å…¥è‹¥å¹²æ–°çš„å†…å®¹ï¼Œæˆ–ä¿®æ”¹åŸæ¥çš„æ–¹æ³•ä½¿ä¹‹æ›´é€‚åˆç‰¹æ®Šçš„éœ€è¦ï¼Œè¿™å°±æ˜¯ç»§æ‰¿ã€‚ç»§æ‰¿æ˜¯å­ç±»è‡ªåŠ¨å…±äº«çˆ¶ç±»æ•°æ®å’Œæ–¹æ³•çš„æœºåˆ¶ï¼Œè¿™æ˜¯ç±»ä¹‹é—´çš„ä¸€ç§å…³ç³»ï¼Œæé«˜äº†è½¯ä»¶çš„å¯é‡ç”¨æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p><p>3ï¼‰æŠ½è±¡ï¼š</p><p>æŠ½è±¡å°±æ˜¯æ‰¾å‡ºä¸€äº›äº‹ç‰©çš„ç›¸ä¼¼å’Œå…±æ€§ä¹‹å¤„ï¼Œç„¶åå°†è¿™äº›äº‹ç‰©å½’ä¸ºä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»åªè€ƒè™‘è¿™äº›äº‹ç‰©çš„ç›¸ä¼¼å’Œå…±æ€§ä¹‹å¤„ï¼Œå¹¶ä¸”ä¼šå¿½ç•¥ä¸å½“å‰ä¸»é¢˜å’Œç›®æ ‡æ— å…³çš„é‚£äº›æ–¹é¢ï¼Œå°†æ³¨æ„åŠ›é›†ä¸­åœ¨ä¸å½“å‰ç›®æ ‡æœ‰å…³çš„æ–¹é¢ã€‚ä¾‹å¦‚ï¼Œçœ‹åˆ°ä¸€åªèš‚èšå’Œå¤§è±¡ï¼Œä½ èƒ½å¤Ÿæƒ³è±¡å‡ºå®ƒä»¬çš„ç›¸åŒä¹‹å¤„ï¼Œé‚£å°±æ˜¯æŠ½è±¡ã€‚æŠ½è±¡åŒ…æ‹¬è¡Œä¸ºæŠ½è±¡å’ŒçŠ¶æ€æŠ½è±¡ä¸¤ä¸ªæ–¹é¢ã€‚ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªPersonç±»ï¼Œå¦‚ä¸‹ï¼š</p><p>class Person{</p><p>String name;</p><p>int age;</p><p>}</p><p>äººæœ¬æ¥æ˜¯å¾ˆå¤æ‚çš„äº‹ç‰©ï¼Œæœ‰å¾ˆå¤šæ–¹é¢ï¼Œä½†å› ä¸ºå½“å‰ç³»ç»Ÿåªéœ€è¦äº†è§£äººçš„å§“åå’Œå¹´é¾„ï¼Œæ‰€ä»¥ä¸Šé¢å®šä¹‰çš„ç±»ä¸­åªåŒ…å«å§“åå’Œå¹´é¾„è¿™ä¸¤ä¸ªå±æ€§ï¼Œè¿™å°±æ˜¯ä¸€ç§æŠ½åƒï¼Œä½¿ç”¨æŠ½è±¡å¯ä»¥é¿å…è€ƒè™‘ä¸€äº›ä¸ç›®æ ‡æ— å…³çš„ç»†èŠ‚ã€‚æˆ‘å¯¹æŠ½è±¡çš„ç†è§£å°±æ˜¯ä¸è¦ç”¨æ˜¾å¾®é•œå»çœ‹ä¸€ä¸ªäº‹ç‰©çš„æ‰€æœ‰æ–¹é¢ï¼Œè¿™æ ·æ¶‰åŠçš„å†…å®¹å°±å¤ªå¤šäº†ï¼Œè€Œæ˜¯è¦å–„äºåˆ’åˆ†é—®é¢˜çš„è¾¹ç•Œï¼Œå½“å‰ç³»ç»Ÿéœ€è¦ä»€ä¹ˆï¼Œå°±åªè€ƒè™‘ä»€ä¹ˆã€‚</p><p>4ï¼‰å¤šæ€ï¼š</p><p>å¤šæ€åˆ†ä¸ºç¼–è¯‘æ—¶å¤šæ€å’Œè¿è¡Œæ—¶å¤šæ€:</p><ul><li>ç¼–è¯‘æ—¶å¤šæ€ä¸»è¦æŒ‡æ–¹æ³•çš„é‡è½½</li><li>è¿è¡Œæ—¶å¤šæ€æŒ‡ç¨‹åºä¸­å®šä¹‰çš„å¯¹è±¡å¼•ç”¨æ‰€æŒ‡å‘çš„å…·ä½“ç±»å‹åœ¨è¿è¡ŒæœŸé—´æ‰ç¡®å®š</li></ul><p>è¿è¡Œæ—¶å¤šæ€æœ‰ä¸‰ä¸ªæ¡ä»¶:</p><ul><li>ç»§æ‰¿</li><li>è¦†ç›–(é‡å†™)</li><li>å‘ä¸Šè½¬å‹</li></ul><p>å¤šæ€æ˜¯æŒ‡ç¨‹åºä¸­å®šä¹‰çš„å¼•ç”¨å˜é‡æ‰€æŒ‡å‘çš„å…·ä½“ç±»å‹å’Œé€šè¿‡è¯¥å¼•ç”¨å˜é‡å‘å‡ºçš„æ–¹æ³•è°ƒç”¨åœ¨ç¼–ç¨‹æ—¶å¹¶ä¸ç¡®å®šï¼Œè€Œæ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰ç¡®å®šï¼Œå³ä¸€ä¸ªå¼•ç”¨å˜é‡å€’åº•ä¼šæŒ‡å‘å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¯¥å¼•ç”¨å˜é‡å‘å‡ºçš„æ–¹æ³•è°ƒç”¨åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­å®ç°çš„æ–¹æ³•ï¼Œå¿…é¡»åœ¨ç”±ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½å†³å®šã€‚å› ä¸ºåœ¨ç¨‹åºè¿è¡Œæ—¶æ‰ç¡®å®šå…·ä½“çš„ç±»ï¼Œè¿™æ ·ï¼Œä¸ç”¨ä¿®æ”¹æºç¨‹åºä»£ç ï¼Œå°±å¯ä»¥è®©å¼•ç”¨å˜é‡ç»‘å®šåˆ°å„ç§ä¸åŒçš„ç±»å®ç°ä¸Šï¼Œä»è€Œå¯¼è‡´è¯¥å¼•ç”¨è°ƒç”¨çš„å…·ä½“æ–¹æ³•éšä¹‹æ”¹å˜ï¼Œå³ä¸ä¿®æ”¹ç¨‹åºä»£ç å°±å¯ä»¥æ”¹å˜ç¨‹åºè¿è¡Œæ—¶æ‰€ç»‘å®šçš„å…·ä½“ä»£ç ï¼Œè®©ç¨‹åºå¯ä»¥é€‰æ‹©å¤šä¸ªè¿è¡ŒçŠ¶æ€ï¼Œè¿™å°±æ˜¯å¤šæ€æ€§ã€‚å¤šæ€æ€§å¢å¼ºäº†è½¯ä»¶çš„çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚</p><h3 id="22-Javaä¸­å®ç°å¤šæ€çš„æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#22-Javaä¸­å®ç°å¤šæ€çš„æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="22.Javaä¸­å®ç°å¤šæ€çš„æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ"></a><a href="">22.Javaä¸­å®ç°å¤šæ€çš„æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ</a></h3><p>é çš„æ˜¯çˆ¶ç±»æˆ–æ¥å£å®šä¹‰çš„å¼•ç”¨å˜é‡å¯ä»¥æŒ‡å‘å­ç±»æˆ–å…·ä½“å®ç°ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè€Œç¨‹åºè°ƒç”¨çš„æ–¹æ³•åœ¨è¿è¡ŒæœŸæ‰åŠ¨æ€ç»‘å®šï¼Œå°±æ˜¯å¼•ç”¨å˜é‡æ‰€æŒ‡å‘çš„å…·ä½“å®ä¾‹å¯¹è±¡çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯å†…å­˜é‡Œæ­£åœ¨è¿è¡Œçš„é‚£ä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯å¼•ç”¨å˜é‡çš„ç±»å‹ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚</p><h3 id="23-abstract-class-æŠ½è±¡ç±»-å’Œinterface-æ¥å£-æœ‰ä»€ä¹ˆåŒºåˆ«-ï¼ˆç¾å›¢ï¼‰"><a href="#23-abstract-class-æŠ½è±¡ç±»-å’Œinterface-æ¥å£-æœ‰ä»€ä¹ˆåŒºåˆ«-ï¼ˆç¾å›¢ï¼‰" class="headerlink" title="23.abstract class(æŠ½è±¡ç±»)å’Œinterface(æ¥å£)æœ‰ä»€ä¹ˆåŒºåˆ«?ï¼ˆç¾å›¢ï¼‰"></a><a href="">23.abstract class(æŠ½è±¡ç±»)å’Œinterface(æ¥å£)æœ‰ä»€ä¹ˆåŒºåˆ«?ï¼ˆç¾å›¢ï¼‰</a></h3><p>å«æœ‰abstractä¿®é¥°ç¬¦çš„classå³ä¸ºæŠ½è±¡ç±»ï¼Œ<strong>abstract ç±»ä¸èƒ½åˆ›å»ºå®ä¾‹å¯¹è±¡ã€‚</strong>å«æœ‰abstractæ–¹æ³•çš„ç±»å¿…é¡»å®šä¹‰ä¸ºabstract classï¼Œabstract classç±»ä¸­çš„æ–¹æ³•ä¸å¿…æ˜¯æŠ½è±¡çš„ã€‚abstract classç±»ä¸­å®šä¹‰æŠ½è±¡æ–¹æ³•å¿…é¡»åœ¨å…·ä½“(Concrete)å­ç±»ä¸­å®ç°ï¼Œæ‰€ä»¥ï¼Œä¸èƒ½æœ‰æŠ½è±¡æ„é€ æ–¹æ³•æˆ–æŠ½è±¡é™æ€æ–¹æ³•ã€‚å¦‚æœå­ç±»æ²¡æœ‰å®ç°æŠ½è±¡çˆ¶ç±»ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆå­ç±»ä¹Ÿå¿…é¡»å®šä¹‰ä¸ºabstractç±»å‹ã€‚</p><p>æ¥å£ï¼ˆinterfaceï¼‰å¯ä»¥è¯´æˆæ˜¯æŠ½è±¡ç±»çš„ä¸€ç§ç‰¹ä¾‹ï¼Œæ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½å¿…é¡»æ˜¯æŠ½è±¡çš„ã€‚æ¥å£ä¸­çš„æ–¹æ³•å®šä¹‰é»˜è®¤ä¸ºpublic abstractç±»å‹ï¼Œæ¥å£ä¸­çš„æˆå‘˜å˜é‡ç±»å‹é»˜è®¤ä¸ºpublic static finalã€‚</p><p>ä¸‹é¢æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…çš„è¯­æ³•åŒºåˆ«ï¼š</p><p>1ï¼‰æŠ½è±¡ç±»å¯ä»¥æœ‰æ„é€ æ–¹æ³•ï¼Œæ¥å£ä¸­ä¸èƒ½æœ‰æ„é€ æ–¹æ³•ã€‚</p><p>2ï¼‰æŠ½è±¡ç±»ä¸­å¯ä»¥æœ‰æ™®é€šæˆå‘˜å˜é‡ï¼Œæ¥å£ä¸­æ²¡æœ‰æ™®é€šæˆå‘˜å˜é‡</p><p>3ï¼‰æŠ½è±¡ç±»ä¸­å¯ä»¥åŒ…å«éæŠ½è±¡çš„æ™®é€šæ–¹æ³•ï¼Œæ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•å¿…é¡»éƒ½æ˜¯æŠ½è±¡çš„ï¼Œä¸èƒ½æœ‰éæŠ½è±¡çš„æ™®é€šæ–¹æ³•ã€‚</p><p>4ï¼‰ æŠ½è±¡ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•çš„è®¿é—®ç±»å‹å¯ä»¥æ˜¯publicï¼Œprotectedï¼Œä½†æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•åªèƒ½æ˜¯publicç±»å‹çš„ï¼Œå¹¶ä¸”é»˜è®¤å³ä¸ºpublic abstractç±»å‹ã€‚</p><p>5ï¼‰æŠ½è±¡ç±»ä¸­å¯ä»¥åŒ…å«é™æ€æ–¹æ³•ï¼Œæ¥å£ä¸­ä¸èƒ½åŒ…å«é™æ€æ–¹æ³•</p><p>6ï¼‰æŠ½è±¡ç±»å’Œæ¥å£ä¸­éƒ½å¯ä»¥åŒ…å«é™æ€æˆå‘˜å˜é‡ï¼ŒæŠ½è±¡ç±»ä¸­çš„é™æ€æˆå‘˜å˜é‡çš„è®¿é—®ç±»å‹å¯ä»¥ä»»æ„ï¼Œä½†æ¥å£ä¸­å®šä¹‰çš„å˜é‡åªèƒ½æ˜¯public static finalç±»å‹ï¼Œå¹¶ä¸”é»˜è®¤å³ä¸ºpublic static finalç±»å‹ã€‚</p><p>7ï¼‰ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œä½†åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ã€‚</p><p><strong>æ¥å£çš„å˜é‡ä¸ºä»€ä¹ˆæ˜¯staticå’Œfinalçš„ï¼Ÿ</strong></p><p>staticï¼šå¿…é¡»ã€‚å› ä¸ºæ¥å£æ˜¯å¯ä»¥å¤šç»§æ‰¿çš„ã€‚å¦‚æœä¸€ä¸ªç±»å®ç°äº†ä¸¤ä¸ªæ¥å£ï¼Œä¸”ä¸¤ä¸ªæ¥å£éƒ½å…·æœ‰ç›¸åŒåå­—çš„å˜é‡ï¼Œæ­¤æ—¶è¿™ä¸ªå˜é‡å¯ä»¥è¢«å®ç°ç±»ä½¿ç”¨ï¼Œé‚£ä¹ˆå¦‚æœä¸æ˜¯staticçš„ï¼Œè¿™ä¸ªå˜é‡æ¥è‡ªå“ªä¸€ä¸ªæ¥å£å°±ä¼šäº§ç”Ÿæ­§ä¹‰ï¼Œæ‰€ä»¥å®ç°ç±»ä½¿ç”¨æ¥å£ä¸­çš„å˜é‡å¿…é¡»é€šè¿‡æ¥å£åæŒ‡å®šï¼Œä¹Ÿå°±åªèƒ½å®šä¸ºstaticçš„ã€‚</p><p>finalï¼šæˆ‘è®¤ä¸ºå› ä¸ºå¿…é¡»æ˜¯<a href="https://so.csdn.net/so/search?q=static&amp;spm=1001.2101.3001.7020">static</a>çš„ï¼Œé‚£ä¹ˆæ‰€æœ‰å­ç±»å…±äº«ï¼Œè€Œæ¥å£æ˜¯ä¸€ç§æŠ½è±¡ï¼Œ æ‰€ä»¥ä¸€ä¸ªå­ç±»ä¿®æ”¹äº†å€¼ä¼šå½±å“åˆ°å…¶ä»–æ‰€æœ‰å­ç±»ï¼Œå› æ­¤å°±ä¸åº”è¯¥å…è®¸å­ç±»ä¿®æ”¹è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥å®šä¹‰ä¸ºfinalã€‚</p><p><strong>ä¸‹é¢æ¥ç€å†è¯´è¯´ä¸¤è€…åœ¨åº”ç”¨ä¸Šçš„åŒºåˆ«ï¼š</strong></p><p>æ¥å£æ›´å¤šçš„æ˜¯åœ¨ç³»ç»Ÿæ¶æ„è®¾è®¡æ–¹æ³•å‘æŒ¥ä½œç”¨ï¼Œä¸»è¦ç”¨äºå®šä¹‰æ¨¡å—ä¹‹é—´çš„é€šä¿¡å¥‘çº¦ã€‚è€ŒæŠ½è±¡ç±»åœ¨ä»£ç å®ç°æ–¹é¢å‘æŒ¥ä½œç”¨ï¼Œå¯ä»¥å®ç°ä»£ç çš„é‡ç”¨ï¼Œä¾‹å¦‚ï¼Œæ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼æ˜¯æŠ½è±¡ç±»çš„ä¸€ä¸ªå…¸å‹åº”ç”¨ï¼Œå‡è®¾æŸä¸ªé¡¹ç›®çš„æ‰€æœ‰Servletç±»éƒ½è¦ç”¨ç›¸åŒçš„æ–¹å¼è¿›è¡Œæƒé™åˆ¤æ–­ã€è®°å½•è®¿é—®æ—¥å¿—å’Œå¤„ç†å¼‚å¸¸ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®šä¹‰ä¸€ä¸ªæŠ½è±¡çš„åŸºç±»ï¼Œè®©æ‰€æœ‰çš„Servletéƒ½ç»§æ‰¿è¿™ä¸ªæŠ½è±¡åŸºç±»ï¼Œåœ¨æŠ½è±¡åŸºç±»çš„serviceæ–¹æ³•ä¸­å®Œæˆæƒé™åˆ¤æ–­ã€è®°å½•è®¿é—®æ—¥å¿—å’Œå¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œåœ¨å„ä¸ªå­ç±»ä¸­åªæ˜¯å®Œæˆå„è‡ªçš„ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="comment">// è®°å½•è®¿é—®æ—¥å¿—, è¿›è¡Œæƒé™åˆ¤æ–­</span></span><br><span class="line">        <span class="keyword">if</span> (å…·æœ‰æƒé™) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                doService(request, response);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="comment">// todoï¼šè®°å½•å¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">doService</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="comment">//æ³¨æ„è®¿é—®æƒé™å®šä¹‰æˆprotectedï¼Œæ˜¾å¾—æ—¢ä¸“ä¸šï¼Œåˆä¸¥è°¨ï¼Œå› ä¸ºå®ƒæ˜¯ä¸“é—¨ç»™å­ç±»ç”¨çš„</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServlet1</span> <span class="keyword">extends</span> <span class="title class_">BaseServlet</span> &#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doService</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOExcetion, ServletException &#123;</span><br><span class="line">        <span class="comment">// æœ¬Servletåªå¤„ç†çš„å…·ä½“ä¸šåŠ¡é€»è¾‘ä»£ç </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çˆ¶ç±»æ–¹æ³•ä¸­é—´çš„æŸæ®µä»£ç ä¸ç¡®å®šï¼Œç•™ç»™å­ç±»å¹²ï¼Œå°±ç”¨æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ã€‚<br>å¤‡æ³¨ï¼šè¿™é“é¢˜çš„æ€è·¯æ˜¯å…ˆä»æ€»ä½“è§£é‡ŠæŠ½è±¡ç±»å’Œæ¥å£çš„åŸºæœ¬æ¦‚å¿µï¼Œç„¶åå†æ¯”è¾ƒä¸¤è€…çš„è¯­æ³•ç»†èŠ‚ï¼Œæœ€åå†è¯´ä¸¤è€…çš„åº”ç”¨åŒºåˆ«ã€‚æ¯”è¾ƒä¸¤è€…è¯­æ³•ç»†èŠ‚åŒºåˆ«çš„æ¡ç†æ˜¯ï¼šå…ˆä»ä¸€ä¸ªç±»ä¸­çš„æ„é€ æ–¹æ³•ã€æ™®é€šæˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼ˆåŒ…æ‹¬æŠ½è±¡æ–¹æ³•ï¼‰ï¼Œé™æ€å˜é‡å’Œæ–¹æ³•ï¼Œç»§æ‰¿æ€§ç­‰6ä¸ªæ–¹é¢é€ä¸€å»æ¯”è¾ƒå›ç­”ï¼Œæ¥ç€ä»ç¬¬ä¸‰è€…ç»§æ‰¿çš„è§’åº¦çš„å›ç­”ï¼Œç‰¹åˆ«æ˜¯æœ€åç”¨äº†ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ¥å±•ç°è‡ªå·±æ·±åšçš„æŠ€æœ¯åŠŸåº•ã€‚</p><h3 id="24-abstractçš„methodæ˜¯å¦å¯åŒæ—¶æ˜¯static-æ˜¯å¦å¯åŒæ—¶æ˜¯nativeï¼Œæ˜¯å¦å¯åŒæ—¶æ˜¯synchronized"><a href="#24-abstractçš„methodæ˜¯å¦å¯åŒæ—¶æ˜¯static-æ˜¯å¦å¯åŒæ—¶æ˜¯nativeï¼Œæ˜¯å¦å¯åŒæ—¶æ˜¯synchronized" class="headerlink" title="24.abstractçš„methodæ˜¯å¦å¯åŒæ—¶æ˜¯static,æ˜¯å¦å¯åŒæ—¶æ˜¯nativeï¼Œæ˜¯å¦å¯åŒæ—¶æ˜¯synchronized?"></a><a href="">24.abstractçš„methodæ˜¯å¦å¯åŒæ—¶æ˜¯static,æ˜¯å¦å¯åŒæ—¶æ˜¯nativeï¼Œæ˜¯å¦å¯åŒæ—¶æ˜¯synchronized?</a></h3><p>abstractçš„method ä¸å¯ä»¥æ˜¯staticçš„ï¼Œå› ä¸ºæŠ½è±¡çš„æ–¹æ³•æ˜¯è¦è¢«å­ç±»å®ç°çš„ï¼Œè€Œstaticä¸å­ç±»æ‰¯ä¸ä¸Šå…³ç³»ï¼</p><p>nativeæ–¹æ³•è¡¨ç¤ºè¯¥æ–¹æ³•è¦ç”¨å¦å¤–ä¸€ç§ä¾èµ–å¹³å°çš„ç¼–ç¨‹è¯­è¨€å®ç°çš„ï¼Œä¸å­˜åœ¨ç€è¢«å­ç±»å®ç°çš„é—®é¢˜ï¼Œæ‰€ä»¥ï¼Œå®ƒä¹Ÿä¸èƒ½æ˜¯æŠ½è±¡çš„ï¼Œä¸èƒ½ä¸abstractæ··ç”¨ã€‚ä¾‹å¦‚ï¼ŒFileOutputStreamç±»è¦å’Œç¡¬ä»¶æ‰“äº¤é“ï¼Œåº•å±‚çš„å®ç°ç”¨çš„æ˜¯æ“ä½œç³»ç»Ÿç›¸å…³çš„apiå®ç°ï¼Œä¾‹å¦‚ï¼Œåœ¨windowsç”¨cè¯­è¨€å®ç°çš„ï¼Œæ‰€ä»¥ï¼ŒæŸ¥çœ‹jdk çš„æºä»£ç ï¼Œå¯ä»¥å‘ç°FileOutputStreamçš„openæ–¹æ³•çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><p>private native void open(String name) throws FileNotFoundException;</p><p>å¦‚æœæˆ‘ä»¬è¦ç”¨javaè°ƒç”¨åˆ«äººå†™çš„cè¯­è¨€å‡½æ•°ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•ç›´æ¥è°ƒç”¨çš„ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§javaçš„è¦æ±‚å†™ä¸€ä¸ªcè¯­è¨€çš„å‡½æ•°ï¼Œç”¨æˆ‘ä»¬çš„è¿™ä¸ªcè¯­è¨€å‡½æ•°å»è°ƒç”¨åˆ«äººçš„cè¯­è¨€å‡½æ•°ã€‚ç”±äºæˆ‘ä»¬çš„cè¯­è¨€å‡½æ•°æ˜¯æŒ‰javaçš„è¦æ±‚æ¥å†™çš„ï¼Œæˆ‘ä»¬è¿™ä¸ªcè¯­è¨€å‡½æ•°å°±å¯ä»¥ä¸javaå¯¹æ¥ä¸Šï¼Œjavaé‚£è¾¹çš„å¯¹æ¥æ–¹å¼å°±æ˜¯å®šä¹‰å‡ºä¸æˆ‘ä»¬è¿™ä¸ªcå‡½æ•°ç›¸å¯¹åº”çš„æ–¹æ³•ï¼Œjavaä¸­å¯¹åº”çš„æ–¹æ³•ä¸éœ€è¦å†™å…·ä½“çš„ä»£ç ï¼Œä½†éœ€è¦åœ¨å‰é¢å£°æ˜nativeã€‚</p><p>å…³äºsynchronizedä¸abstractåˆç”¨çš„é—®é¢˜ï¼Œæˆ‘è§‰å¾—ä¹Ÿä¸è¡Œï¼Œå› ä¸ºåœ¨æˆ‘å‡ å¹´çš„å­¦ä¹ å’Œå¼€å‘ä¸­ï¼Œä»æ¥æ²¡è§åˆ°è¿‡è¿™ç§æƒ…å†µï¼Œå¹¶ä¸”æˆ‘è§‰å¾—synchronizedåº”è¯¥æ˜¯ä½œç”¨åœ¨ä¸€ä¸ªå…·ä½“çš„æ–¹æ³•ä¸Šæ‰æœ‰æ„ä¹‰ã€‚è€Œä¸”ï¼Œæ–¹æ³•ä¸Šçš„synchronizedåŒæ­¥æ‰€ä½¿ç”¨çš„åŒæ­¥é”å¯¹è±¡æ˜¯thisï¼Œè€ŒæŠ½è±¡æ–¹æ³•ä¸Šæ— æ³•ç¡®å®šthisæ˜¯ä»€ä¹ˆã€‚</p><h3 id="25-ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼ŸStatic-Nested-Class-å’Œ-Inner-Classçš„ä¸åŒã€‚"><a href="#25-ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼ŸStatic-Nested-Class-å’Œ-Inner-Classçš„ä¸åŒã€‚" class="headerlink" title="25.ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼ŸStatic Nested Class å’Œ Inner Classçš„ä¸åŒã€‚"></a><a href="">25.ä»€ä¹ˆæ˜¯å†…éƒ¨ç±»ï¼ŸStatic Nested Class å’Œ Inner Classçš„ä¸åŒã€‚</a></h3><p>å†…éƒ¨ç±»å°±æ˜¯åœ¨ä¸€ä¸ªç±»çš„å†…éƒ¨å®šä¹‰çš„ç±»ï¼Œå†…éƒ¨ç±»ä¸­ä¸èƒ½å®šä¹‰é™æ€æˆå‘˜ï¼ˆé™æ€æˆå‘˜ä¸æ˜¯å¯¹è±¡çš„ç‰¹æ€§ï¼Œåªæ˜¯ä¸ºäº†æ‰¾ä¸€ä¸ªå®¹èº«ä¹‹å¤„ï¼Œæ‰€ä»¥éœ€è¦æ”¾åˆ°ä¸€ä¸ªç±»ä¸­è€Œå·²ï¼Œè¿™ä¹ˆä¸€ç‚¹å°äº‹ï¼Œä½ è¿˜è¦æŠŠå®ƒæ”¾åˆ°ç±»å†…éƒ¨çš„ä¸€ä¸ªç±»ä¸­ï¼Œè¿‡åˆ†äº†å•Šï¼æä¾›å†…éƒ¨ç±»ï¼Œä¸æ˜¯ä¸ºè®©ä½ å¹²è¿™ç§äº‹æƒ…ï¼Œæ— èŠï¼Œä¸è®©ä½ å¹²ã€‚æˆ‘æƒ³å¯èƒ½æ˜¯æ—¢ç„¶é™æ€æˆå‘˜ç±»ä¼¼cè¯­è¨€çš„å…¨å±€å˜é‡ï¼Œè€Œå†…éƒ¨ç±»é€šå¸¸æ˜¯ç”¨äºåˆ›å»ºå†…éƒ¨å¯¹è±¡ç”¨çš„ï¼Œæ‰€ä»¥ï¼ŒæŠŠâ€œå…¨å±€å˜é‡â€æ”¾åœ¨å†…éƒ¨ç±»ä¸­å°±æ˜¯æ¯«æ— æ„ä¹‰çš„äº‹æƒ…ï¼Œæ—¢ç„¶æ˜¯æ¯«æ— æ„ä¹‰çš„äº‹æƒ…ï¼Œå°±åº”è¯¥è¢«ç¦æ­¢ï¼‰ï¼Œå†…éƒ¨ç±»å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»ä¸­çš„æˆå‘˜å˜é‡ï¼Œå†…éƒ¨ç±»å¯ä»¥å®šä¹‰åœ¨å¤–éƒ¨ç±»çš„æ–¹æ³•å¤–é¢ï¼Œä¹Ÿå¯ä»¥å®šä¹‰åœ¨å¤–éƒ¨ç±»çš„æ–¹æ³•ä½“ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Outer</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">out_x</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//åœ¨æ–¹æ³•ä½“å†…éƒ¨å®šä¹‰çš„å†…éƒ¨ç±»</span></span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">Inner2</span> &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">                out_x = <span class="number">3</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Inner2</span> <span class="variable">inner2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Inner2</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨æ–¹æ³•ä½“å¤–é¢å®šä¹‰çš„å†…éƒ¨ç±»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Inner1</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ–¹æ³•ä½“å¤–é¢å®šä¹‰çš„å†…éƒ¨ç±»çš„è®¿é—®ç±»å‹å¯ä»¥æ˜¯public,protected,é»˜è®¤çš„ï¼Œprivateç­‰4ç§ç±»å‹ï¼Œè¿™å°±å¥½åƒç±»ä¸­å®šä¹‰çš„æˆå‘˜å˜é‡æœ‰4ç§è®¿é—®ç±»å‹ä¸€æ ·ï¼Œå®ƒä»¬å†³å®šè¿™ä¸ªå†…éƒ¨ç±»çš„å®šä¹‰å¯¹å…¶ä»–ç±»æ˜¯å¦å¯è§ï¼›å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å¤–é¢åˆ›å»ºå†…éƒ¨ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œåˆ›å»ºå†…éƒ¨ç±»çš„å®ä¾‹å¯¹è±¡æ—¶ï¼Œä¸€å®šè¦å…ˆåˆ›å»ºå¤–éƒ¨ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åç”¨è¿™ä¸ªå¤–éƒ¨ç±»çš„å®ä¾‹å¯¹è±¡å»åˆ›å»ºå†…éƒ¨ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Outer</span> <span class="variable">outer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Outer</span>();</span><br><span class="line">Outer.<span class="type">Inner1</span> <span class="variable">inner1</span> <span class="operator">=</span> outer.<span class="keyword">new</span> <span class="title class_">Innner1</span>();</span><br></pre></td></tr></table></figure><p><strong>åœ¨æ–¹æ³•å†…éƒ¨å®šä¹‰çš„å†…éƒ¨ç±»å‰é¢ä¸èƒ½æœ‰è®¿é—®ç±»å‹ä¿®é¥°ç¬¦</strong>ï¼Œå°±å¥½åƒæ–¹æ³•ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡ä¸€æ ·ï¼Œä½†è¿™ç§å†…éƒ¨ç±»çš„å‰é¢å¯ä»¥ä½¿ç”¨finalæˆ–abstractä¿®é¥°ç¬¦ã€‚è¿™ç§å†…éƒ¨ç±»å¯¹å…¶ä»–ç±»æ˜¯ä¸å¯è§çš„å…¶ä»–ç±»æ— æ³•å¼•ç”¨è¿™ç§å†…éƒ¨ç±»ï¼Œä½†æ˜¯è¿™ç§å†…éƒ¨ç±»åˆ›å»ºçš„å®ä¾‹å¯¹è±¡å¯ä»¥ä¼ é€’ç»™å…¶ä»–ç±»è®¿é—®ã€‚è¿™ç§å†…éƒ¨ç±»å¿…é¡»æ˜¯å…ˆå®šä¹‰ï¼Œåä½¿ç”¨ï¼Œå³å†…éƒ¨ç±»çš„å®šä¹‰ä»£ç å¿…é¡»å‡ºç°åœ¨ä½¿ç”¨è¯¥ç±»ä¹‹å‰ï¼Œè¿™ä¸æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡å¿…é¡»å…ˆå®šä¹‰åä½¿ç”¨çš„é“ç†ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚è¿™ç§å†…éƒ¨ç±»å¯ä»¥è®¿é—®æ–¹æ³•ä½“ä¸­çš„å±€éƒ¨å˜é‡ï¼Œä½†æ˜¯ï¼Œè¯¥å±€éƒ¨å˜é‡å‰å¿…é¡»åŠ finalä¿®é¥°ç¬¦ã€‚</p><p>åœ¨æ–¹æ³•ä½“å†…éƒ¨è¿˜å¯ä»¥é‡‡ç”¨å¦‚ä¸‹è¯­æ³•æ¥åˆ›å»ºä¸€ç§åŒ¿åå†…éƒ¨ç±»ï¼Œå³å®šä¹‰æŸä¸€æ¥å£æˆ–ç±»çš„å­ç±»çš„åŒæ—¶ï¼Œè¿˜åˆ›å»ºäº†è¯¥å­ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œæ— éœ€ä¸ºè¯¥å­ç±»å®šä¹‰åç§°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Outer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œåœ¨æ–¹æ³•å¤–éƒ¨å®šä¹‰çš„å†…éƒ¨ç±»å‰é¢å¯ä»¥åŠ ä¸Šstaticå…³é”®å­—ï¼Œä»è€Œæˆä¸ºStatic Nested Classï¼Œå®ƒä¸å†å…·æœ‰å†…éƒ¨ç±»çš„ç‰¹æ€§ï¼Œæ‰€æœ‰ï¼Œä»ç‹­ä¹‰ä¸Šè®²ï¼Œå®ƒä¸æ˜¯å†…éƒ¨ç±»ã€‚Static Nested Classä¸æ™®é€šç±»åœ¨è¿è¡Œæ—¶çš„è¡Œä¸ºå’ŒåŠŸèƒ½ä¸Šæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåªæ˜¯åœ¨ç¼–ç¨‹å¼•ç”¨æ—¶çš„è¯­æ³•ä¸Šæœ‰ä¸€äº›å·®åˆ«ï¼Œå®ƒå¯ä»¥å®šä¹‰æˆpublicã€protectedã€é»˜è®¤çš„ã€privateç­‰å¤šç§ç±»å‹ï¼Œè€Œæ™®é€šç±»åªèƒ½å®šä¹‰æˆpublicå’Œé»˜è®¤çš„è¿™ä¸¤ç§ç±»å‹ã€‚åœ¨å¤–é¢å¼•ç”¨Static Nested Classç±»çš„åç§°ä¸ºâ€œå¤–éƒ¨ç±»å.å†…éƒ¨ç±»åâ€ã€‚åœ¨å¤–é¢ä¸éœ€è¦åˆ›å»ºå¤–éƒ¨ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œå°±å¯ä»¥ç›´æ¥åˆ›å»ºStatic Nested Classï¼Œä¾‹å¦‚ï¼Œå‡è®¾Inneræ˜¯å®šä¹‰åœ¨Outerç±»ä¸­çš„Static Nested Classï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¦‚ä¸‹è¯­å¥åˆ›å»ºInnerç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Outer.<span class="type">Inner</span> <span class="variable">inner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Outer</span>.Inner();</span><br></pre></td></tr></table></figure><p>ç”±äºstatic Nested Classä¸ä¾èµ–äºå¤–éƒ¨ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œstatic Nested Classèƒ½è®¿é—®å¤–éƒ¨ç±»çš„éstaticæˆå‘˜å˜é‡ã€‚å½“åœ¨å¤–éƒ¨ç±»ä¸­è®¿é—®Static Nested Classæ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Static Nested Classçš„åå­—ï¼Œè€Œä¸éœ€è¦åŠ ä¸Šå¤–éƒ¨ç±»çš„åå­—äº†ï¼Œåœ¨Static Nested Classä¸­ä¹Ÿå¯ä»¥ç›´æ¥å¼•ç”¨å¤–éƒ¨ç±»çš„staticçš„æˆå‘˜å˜é‡ï¼Œä¸éœ€è¦åŠ ä¸Šå¤–éƒ¨ç±»çš„åå­—ã€‚</p><p>åœ¨é™æ€æ–¹æ³•ä¸­å®šä¹‰çš„å†…éƒ¨ç±»ä¹Ÿæ˜¯Static Nested Classï¼Œè¿™æ—¶å€™ä¸èƒ½åœ¨ç±»å‰é¢åŠ staticå…³é”®å­—ï¼Œé™æ€æ–¹æ³•ä¸­çš„Static Nested Classä¸æ™®é€šæ–¹æ³•ä¸­çš„å†…éƒ¨ç±»çš„åº”ç”¨æ–¹å¼å¾ˆç›¸ä¼¼ï¼Œå®ƒé™¤äº†å¯ä»¥ç›´æ¥è®¿é—®å¤–éƒ¨ç±»ä¸­çš„staticçš„æˆå‘˜å˜é‡ï¼Œè¿˜å¯ä»¥è®¿é—®é™æ€æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ï¼Œä½†æ˜¯ï¼Œè¯¥å±€éƒ¨å˜é‡å‰å¿…é¡»åŠ finalä¿®é¥°ç¬¦ã€‚</p><p>å¤‡æ³¨ï¼šé¦–å…ˆæ ¹æ®å°è±¡è¯´å‡ºè‡ªå·±å¯¹å†…éƒ¨ç±»çš„æ€»ä½“æ–¹é¢çš„ç‰¹ç‚¹ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸¤ä¸ªåœ°æ–¹å¯ä»¥å®šä¹‰ï¼Œå¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æˆå‘˜å˜é‡ï¼Œä¸èƒ½å®šä¹‰é™æ€æˆå‘˜ï¼Œè¿™æ˜¯å¤§çš„ç‰¹ç‚¹ã€‚ç„¶åå†è¯´ä¸€äº›ç»†èŠ‚æ–¹é¢çš„çŸ¥è¯†ï¼Œä¾‹å¦‚ï¼Œå‡ ç§å®šä¹‰æ–¹å¼çš„è¯­æ³•åŒºåˆ«ï¼Œé™æ€å†…éƒ¨ç±»ï¼Œä»¥åŠåŒ¿åå†…éƒ¨ç±»ã€‚</p><h3 id="26-å†…éƒ¨ç±»å¯ä»¥å¼•ç”¨å®ƒçš„åŒ…å«ç±»çš„æˆå‘˜å—ï¼Ÿæœ‰æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ"><a href="#26-å†…éƒ¨ç±»å¯ä»¥å¼•ç”¨å®ƒçš„åŒ…å«ç±»çš„æˆå‘˜å—ï¼Ÿæœ‰æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ" class="headerlink" title="26.å†…éƒ¨ç±»å¯ä»¥å¼•ç”¨å®ƒçš„åŒ…å«ç±»çš„æˆå‘˜å—ï¼Ÿæœ‰æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ"></a><a href="">26.å†…éƒ¨ç±»å¯ä»¥å¼•ç”¨å®ƒçš„åŒ…å«ç±»çš„æˆå‘˜å—ï¼Ÿæœ‰æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ</a></h3><p>å®Œå…¨å¯ä»¥ã€‚å¦‚æœä¸æ˜¯é™æ€å†…éƒ¨ç±»ï¼Œé‚£æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ï¼</p><p>å¦‚æœæŠŠé™æ€åµŒå¥—ç±»å½“ä½œå†…éƒ¨ç±»çš„ä¸€ç§ç‰¹ä¾‹ï¼Œé‚£åœ¨è¿™ç§æƒ…å†µä¸‹ä¸å¯ä»¥è®¿é—®å¤–éƒ¨ç±»çš„æ™®é€šæˆå‘˜å˜é‡ï¼Œè€Œåªèƒ½è®¿é—®å¤–éƒ¨ç±»ä¸­çš„é™æ€æˆå‘˜ï¼Œä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Outer</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> x;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Inner</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">            syso(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="27-Anonymous-Inner-Class-åŒ¿åå†…éƒ¨ç±»-æ˜¯å¦å¯ä»¥extends-ç»§æ‰¿-å…¶å®ƒç±»ï¼Œæ˜¯å¦å¯ä»¥implements-å®ç°-interface-æ¥å£"><a href="#27-Anonymous-Inner-Class-åŒ¿åå†…éƒ¨ç±»-æ˜¯å¦å¯ä»¥extends-ç»§æ‰¿-å…¶å®ƒç±»ï¼Œæ˜¯å¦å¯ä»¥implements-å®ç°-interface-æ¥å£" class="headerlink" title="27.Anonymous Inner Class (åŒ¿åå†…éƒ¨ç±») æ˜¯å¦å¯ä»¥extends(ç»§æ‰¿)å…¶å®ƒç±»ï¼Œæ˜¯å¦å¯ä»¥implements(å®ç°)interface(æ¥å£)?"></a><a href="">27.Anonymous Inner Class (åŒ¿åå†…éƒ¨ç±») æ˜¯å¦å¯ä»¥extends(ç»§æ‰¿)å…¶å®ƒç±»ï¼Œæ˜¯å¦å¯ä»¥implements(å®ç°)interface(æ¥å£)?</a></h3><p>å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»æˆ–å®ç°å…¶ä»–æ¥å£ã€‚ä¸ä»…æ˜¯å¯ä»¥ï¼Œè€Œæ˜¯å¿…é¡»!</p><h3 id="28-super-getClass-æ–¹æ³•è°ƒç”¨"><a href="#28-super-getClass-æ–¹æ³•è°ƒç”¨" class="headerlink" title="28.super.getClass()æ–¹æ³•è°ƒç”¨"></a><a href="">28.super.getClass()æ–¹æ³•è°ƒç”¨</a></h3><p>ä¸‹é¢ç¨‹åºçš„è¾“å‡ºç»“æœæ˜¯å¤šå°‘ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> <span class="keyword">extends</span> <span class="title class_">Date</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Test</span>().test();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="built_in">super</span>.getClass().getName());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆå¥‡æ€ªï¼Œç»“æœæ˜¯Testã€‚</p><p>åœ¨testæ–¹æ³•ä¸­ï¼Œç›´æ¥è°ƒç”¨getClass().getName()æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯Testç±»åã€‚ç”±äºgetClass()åœ¨Objectç±»ä¸­å®šä¹‰æˆäº†finalï¼Œå­ç±»ä¸èƒ½è¦†ç›–è¯¥æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œåœ¨testæ–¹æ³•ä¸­è°ƒç”¨getClass().getName()æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯åœ¨è°ƒç”¨ä»çˆ¶ç±»ç»§æ‰¿çš„getClass()æ–¹æ³•ï¼Œç­‰æ•ˆäºè°ƒç”¨super.getClass().getName()æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œsuper.getClass().getName()æ–¹æ³•è¿”å›çš„ä¹Ÿåº”è¯¥æ˜¯Testã€‚</p><p>å¦‚æœæƒ³å¾—åˆ°çˆ¶ç±»çš„åç§°ï¼Œåº”è¯¥ç”¨å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getClass().getSuperClass().getName();</span><br></pre></td></tr></table></figure><h3 id="29-Stringæ˜¯æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹å—"><a href="#29-Stringæ˜¯æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹å—" class="headerlink" title="29.Stringæ˜¯æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹å—?"></a><a href="">29.Stringæ˜¯æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹å—?</a></h3><p>åŸºæœ¬æ•°æ®ç±»å‹åŒ…æ‹¬byteã€intã€charã€longã€floatã€doubleã€booleanå’Œshortã€‚</p><p>java.lang.Stringç±»æ˜¯finalç±»å‹çš„ï¼Œå› æ­¤ä¸å¯ä»¥ç»§æ‰¿è¿™ä¸ªç±»ã€ä¸èƒ½ä¿®æ”¹è¿™ä¸ªç±»ã€‚ä¸ºäº†æé«˜æ•ˆç‡èŠ‚çœç©ºé—´ï¼Œæˆ‘ä»¬åº”è¯¥ç”¨StringBufferç±»</p><h3 id="30-String-s-â€œHelloâ€-s-s-â€œ-world-â€-è¿™ä¸¤è¡Œä»£ç æ‰§è¡Œåï¼ŒåŸå§‹çš„Stringå¯¹è±¡ä¸­çš„å†…å®¹åˆ°åº•å˜äº†æ²¡æœ‰ï¼Ÿ"><a href="#30-String-s-â€œHelloâ€-s-s-â€œ-world-â€-è¿™ä¸¤è¡Œä»£ç æ‰§è¡Œåï¼ŒåŸå§‹çš„Stringå¯¹è±¡ä¸­çš„å†…å®¹åˆ°åº•å˜äº†æ²¡æœ‰ï¼Ÿ" class="headerlink" title="30.String s = â€œHelloâ€;s = s + â€œ world!â€;è¿™ä¸¤è¡Œä»£ç æ‰§è¡Œåï¼ŒåŸå§‹çš„Stringå¯¹è±¡ä¸­çš„å†…å®¹åˆ°åº•å˜äº†æ²¡æœ‰ï¼Ÿ"></a><a href="">30.String s = â€œHelloâ€;s = s + â€œ world!â€;è¿™ä¸¤è¡Œä»£ç æ‰§è¡Œåï¼ŒåŸå§‹çš„Stringå¯¹è±¡ä¸­çš„å†…å®¹åˆ°åº•å˜äº†æ²¡æœ‰ï¼Ÿ</a></h3><p>æ²¡æœ‰ã€‚</p><p>å› ä¸ºStringè¢«è®¾è®¡æˆä¸å¯å˜(immutable)ç±»ï¼Œæ‰€ä»¥å®ƒçš„æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ä¸å¯å˜å¯¹è±¡ã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼ŒsåŸå…ˆæŒ‡å‘ä¸€ä¸ªStringå¯¹è±¡ï¼Œå†…å®¹æ˜¯ â€œHelloâ€ï¼Œç„¶åæˆ‘ä»¬å¯¹sè¿›è¡Œäº†+æ“ä½œï¼Œé‚£ä¹ˆsæ‰€æŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æ²¡æœ‰ã€‚è¿™æ—¶ï¼Œsä¸æŒ‡å‘åŸæ¥é‚£ä¸ªå¯¹è±¡äº†ï¼Œè€ŒæŒ‡å‘äº†å¦ä¸€ä¸ª Stringå¯¹è±¡ï¼Œå†…å®¹ä¸ºâ€Hello world!â€ï¼ŒåŸæ¥é‚£ä¸ªå¯¹è±¡è¿˜å­˜åœ¨äºå†…å­˜ä¹‹ä¸­ï¼Œåªæ˜¯sè¿™ä¸ªå¼•ç”¨å˜é‡ä¸å†æŒ‡å‘å®ƒäº†ã€‚</p><p>é€šè¿‡ä¸Šé¢çš„è¯´æ˜ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¯¼å‡ºå¦ä¸€ä¸ªç»“è®ºï¼Œå¦‚æœç»å¸¸å¯¹å­—ç¬¦ä¸²è¿›è¡Œå„ç§å„æ ·çš„ä¿®æ”¹ï¼Œæˆ–è€…è¯´ï¼Œä¸å¯é¢„è§çš„ä¿®æ”¹ï¼Œé‚£ä¹ˆä½¿ç”¨Stringæ¥ä»£è¡¨å­—ç¬¦ä¸²çš„è¯ä¼šå¼•èµ·å¾ˆå¤§çš„å†…å­˜å¼€é”€ã€‚å› ä¸º Stringå¯¹è±¡å»ºç«‹ä¹‹åä¸èƒ½å†æ”¹å˜ï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸€ä¸ªä¸åŒçš„å­—ç¬¦ä¸²ï¼Œéƒ½éœ€è¦ä¸€ä¸ªStringå¯¹è±¡æ¥è¡¨ç¤ºã€‚è¿™æ—¶ï¼Œåº”è¯¥è€ƒè™‘ä½¿ç”¨StringBufferç±»ï¼Œå®ƒå…è®¸ä¿®æ”¹ï¼Œè€Œä¸æ˜¯æ¯ä¸ªä¸åŒçš„å­—ç¬¦ä¸²éƒ½è¦ç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚å¹¶ä¸”ï¼Œè¿™ä¸¤ç§ç±»çš„å¯¹è±¡è½¬æ¢ååˆ†å®¹æ˜“ã€‚</p><p>åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çŸ¥é“ï¼Œå¦‚æœè¦ä½¿ç”¨å†…å®¹ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œä¸å¿…æ¯æ¬¡éƒ½newä¸€ä¸ªStringã€‚ä¾‹å¦‚æˆ‘ä»¬è¦åœ¨æ„é€ å™¨ä¸­å¯¹ä¸€ä¸ªåå«sçš„Stringå¼•ç”¨å˜é‡è¿›è¡Œåˆå§‹åŒ–ï¼ŒæŠŠå®ƒè®¾ç½®ä¸ºåˆå§‹å€¼ï¼Œåº”å½“è¿™æ ·åšï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line"><span class="keyword">private</span> String s;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">public</span> Demo &#123;</span><br><span class="line">s = <span class="string">&quot;Initial Value&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œé<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;Initial Value&quot;</span>);</span><br></pre></td></tr></table></figure><br>åè€…æ¯æ¬¡éƒ½ä¼šè°ƒç”¨æ„é€ å™¨ï¼Œç”Ÿæˆæ–°å¯¹è±¡ï¼Œæ€§èƒ½ä½ä¸‹ä¸”å†…å­˜å¼€é”€å¤§ï¼Œå¹¶ä¸”æ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºStringå¯¹è±¡ä¸å¯æ”¹å˜ï¼Œæ‰€ä»¥å¯¹äºå†…å®¹ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œåªè¦ä¸€ä¸ªStringå¯¹è±¡æ¥è¡¨ç¤ºå°±å¯ä»¥äº†ã€‚ä¹Ÿå°±è¯´ï¼Œå¤šæ¬¡è°ƒç”¨ä¸Šé¢çš„æ„é€ å™¨åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œä»–ä»¬çš„Stringç±»å‹å±æ€§séƒ½æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚</p><p>ä¸Šé¢çš„ç»“è®ºè¿˜åŸºäºè¿™æ ·ä¸€ä¸ªäº‹å®ï¼šå¯¹äºå­—ç¬¦ä¸²å¸¸é‡ï¼Œå¦‚æœå†…å®¹ç›¸åŒï¼ŒJavaè®¤ä¸ºå®ƒä»¬ä»£è¡¨åŒä¸€ä¸ªStringå¯¹è±¡ã€‚è€Œç”¨å…³é”®å­—newè°ƒç”¨æ„é€ å™¨ï¼Œæ€»æ˜¯ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œæ— è®ºå†…å®¹æ˜¯å¦ç›¸åŒã€‚</p><p>è‡³äºä¸ºä»€ä¹ˆè¦æŠŠStringç±»è®¾è®¡æˆä¸å¯å˜ç±»ï¼Œæ˜¯å®ƒçš„ç”¨é€”å†³å®šçš„ã€‚å…¶å®ä¸åªStringï¼Œå¾ˆå¤šJavaæ ‡å‡†ç±»åº“ä¸­çš„ç±»éƒ½æ˜¯ä¸å¯å˜çš„ã€‚åœ¨å¼€å‘ä¸€ä¸ªç³»ç»Ÿçš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™ä¹Ÿéœ€è¦è®¾è®¡ä¸å¯å˜ç±»ï¼Œæ¥ä¼ é€’ä¸€ç»„ç›¸å…³çš„å€¼ï¼Œè¿™ä¹Ÿæ˜¯é¢å‘å¯¹è±¡æ€æƒ³çš„ä½“ç°ã€‚ä¸å¯å˜ç±»æœ‰ä¸€äº›ä¼˜ç‚¹ï¼Œæ¯”å¦‚å› ä¸ºå®ƒçš„å¯¹è±¡æ˜¯åªè¯»çš„ï¼Œæ‰€ä»¥å¤šçº¿ç¨‹å¹¶å‘è®¿é—®ä¹Ÿä¸ä¼šæœ‰ä»»ä½•é—®é¢˜ã€‚å½“ç„¶ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œæ¯”å¦‚æ¯ä¸ªä¸åŒçš„çŠ¶æ€éƒ½è¦ä¸€ä¸ªå¯¹è±¡æ¥ä»£è¡¨ï¼Œå¯èƒ½é€ æˆæ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚æ‰€ä»¥Javaæ ‡å‡†ç±»åº“è¿˜æä¾›äº†ä¸€ä¸ªå¯å˜ç‰ˆæœ¬ï¼Œå³StringBufferã€‚</p><h3 id="31-æ˜¯å¦å¯ä»¥ç»§æ‰¿Stringç±»"><a href="#31-æ˜¯å¦å¯ä»¥ç»§æ‰¿Stringç±»" class="headerlink" title="31.æ˜¯å¦å¯ä»¥ç»§æ‰¿Stringç±»?"></a><a href="">31.æ˜¯å¦å¯ä»¥ç»§æ‰¿Stringç±»?</a></h3><p>Stringç±»æ˜¯finalç±»æ•…ä¸å¯ä»¥ç»§æ‰¿ã€‚</p><h3 id="32-String-s-new-String-â€œxyzâ€-åˆ›å»ºäº†å‡ ä¸ªString-Object-äºŒè€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#32-String-s-new-String-â€œxyzâ€-åˆ›å»ºäº†å‡ ä¸ªString-Object-äºŒè€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="32.String s = new String(â€œxyzâ€);åˆ›å»ºäº†å‡ ä¸ªString Object? äºŒè€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a><a href="">32.String s = new String(â€œxyzâ€);åˆ›å»ºäº†å‡ ä¸ªString Object? äºŒè€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></h3><p>ä¸¤ä¸ªæˆ–ä¸€ä¸ªï¼Œâ€xyzâ€å¯¹åº”ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ”¾åœ¨å­—ç¬¦ä¸²å¸¸é‡ç¼“å†²åŒºï¼Œå¸¸é‡â€xyzâ€ä¸ç®¡å‡ºç°å¤šå°‘éï¼Œéƒ½æ˜¯ç¼“å†²åŒºä¸­çš„é‚£ä¸€ä¸ªã€‚New Stringæ¯å†™ä¸€éï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå®ƒä¾æ®é‚£ä¸ªå¸¸é‡â€xyzâ€å¯¹è±¡çš„å†…å®¹æ¥åˆ›å»ºå‡ºä¸€ä¸ªæ–°Stringå¯¹è±¡ã€‚å¦‚æœä»¥å‰å°±ç”¨è¿‡â€™xyzâ€™ï¼Œè¿™å¥ä»£ç å°±ä¸ä¼šåˆ›å»ºâ€xyzâ€è‡ªå·±äº†ï¼Œç›´æ¥ä»ç¼“å†²åŒºæ‹¿ã€‚</p><h3 id="33-String-å’ŒStringBufferçš„åŒºåˆ«"><a href="#33-String-å’ŒStringBufferçš„åŒºåˆ«" class="headerlink" title="33.String å’ŒStringBufferçš„åŒºåˆ«"></a><a href="">33.String å’ŒStringBufferçš„åŒºåˆ«</a></h3><p>JAVAå¹³å°æä¾›äº†ä¸¤ä¸ªç±»ï¼šStringå’ŒStringBufferï¼Œå®ƒä»¬å¯ä»¥å‚¨å­˜å’Œæ“ä½œå­—ç¬¦ä¸²ï¼Œå³åŒ…å«å¤šä¸ªå­—ç¬¦çš„å­—ç¬¦æ•°æ®ã€‚è¿™ä¸ªStringç±»æä¾›äº†æ•°å€¼ä¸å¯æ”¹å˜çš„å­—ç¬¦ä¸²ã€‚è€Œè¿™ä¸ªStringBufferç±»æä¾›çš„å­—ç¬¦ä¸²å¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚å½“ä½ çŸ¥é“å­—ç¬¦æ•°æ®è¦æ”¹å˜çš„æ—¶å€™ä½ å°±å¯ä»¥ä½¿ç”¨StringBufferã€‚å…¸å‹åœ°ï¼Œä½ å¯ä»¥ä½¿ç”¨StringBufferæ¥åŠ¨æ€æ„é€ å­—ç¬¦æ•°æ®ã€‚å¦å¤–ï¼ŒStringå®ç°äº†equalsæ–¹æ³•ï¼Œnew String(â€œabcâ€).equals(new String(â€œabcâ€)çš„ç»“æœä¸ºtrue,è€ŒStringBufferæ²¡æœ‰å®ç°equalsæ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œnew StringBuffer(â€œabcâ€).equals(new StringBuffer(â€œabcâ€)çš„ç»“æœä¸ºfalseã€‚</p><p>æ¥ç€è¦ä¸¾ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥è¯´æ˜ï¼Œæˆ‘ä»¬è¦æŠŠ1åˆ°100çš„æ‰€æœ‰æ•°å­—æ‹¼èµ·æ¥ï¼Œç»„æˆä¸€ä¸ªä¸²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">StringBuffer</span> <span class="variable">sbf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">sbf.append(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç æ•ˆç‡å¾ˆé«˜ï¼Œå› ä¸ºåªåˆ›å»ºäº†ä¸€ä¸ªStringBufferå¯¹è±¡ï¼Œè€Œä¸‹é¢çš„ä»£ç æ•ˆç‡å¾ˆä½ï¼Œå› ä¸ºåˆ›å»ºäº†101ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">str = str + i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Stringè¦†ç›–äº†equalsæ–¹æ³•å’ŒhashCodeæ–¹æ³•ï¼Œè€ŒStringBufferæ²¡æœ‰è¦†ç›–equalsæ–¹æ³•å’ŒhashCodeæ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œå°†StringBufferå¯¹è±¡å­˜å‚¨è¿›Javaé›†åˆç±»ä¸­æ—¶ä¼šå‡ºç°é—®é¢˜ã€‚</p><h3 id="34-å¦‚ä½•æŠŠä¸€æ®µé€—å·åˆ†å‰²çš„å­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ªæ•°ç»„"><a href="#34-å¦‚ä½•æŠŠä¸€æ®µé€—å·åˆ†å‰²çš„å­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ªæ•°ç»„" class="headerlink" title="34.å¦‚ä½•æŠŠä¸€æ®µé€—å·åˆ†å‰²çš„å­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ªæ•°ç»„?"></a><a href="">34.å¦‚ä½•æŠŠä¸€æ®µé€—å·åˆ†å‰²çš„å­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ªæ•°ç»„?</a></h3><p>1ï¼‰ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»£ç å¤§æ¦‚ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String [] result = orgStr.split(<span class="string">&quot;,&quot;</span>);</span><br></pre></td></tr></table></figure><p>2ï¼‰ç”¨ StringTokenizer ,ä»£ç ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">StringTokenizer</span> <span class="variable">tokener</span> <span class="operator">=</span> StringTokenizer(orgStr,<span class="string">&quot;,&quot;</span>);</span><br><span class="line">String [] result = <span class="keyword">new</span> <span class="title class_">String</span>[tokener.countTokens()];</span><br><span class="line">Int i=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(tokener.hasNext()&#123;result[i++]=toker.nextToken();&#125;</span><br></pre></td></tr></table></figure><h3 id="35-æ•°ç»„æœ‰æ²¡æœ‰length-è¿™ä¸ªæ–¹æ³•-Stringæœ‰æ²¡æœ‰length-è¿™ä¸ªæ–¹æ³•ï¼Ÿ"><a href="#35-æ•°ç»„æœ‰æ²¡æœ‰length-è¿™ä¸ªæ–¹æ³•-Stringæœ‰æ²¡æœ‰length-è¿™ä¸ªæ–¹æ³•ï¼Ÿ" class="headerlink" title="35.æ•°ç»„æœ‰æ²¡æœ‰length()è¿™ä¸ªæ–¹æ³•? Stringæœ‰æ²¡æœ‰length()è¿™ä¸ªæ–¹æ³•ï¼Ÿ"></a><a href="">35.æ•°ç»„æœ‰æ²¡æœ‰length()è¿™ä¸ªæ–¹æ³•? Stringæœ‰æ²¡æœ‰length()è¿™ä¸ªæ–¹æ³•ï¼Ÿ</a></h3><p>æ•°ç»„æ²¡æœ‰length()è¿™ä¸ªæ–¹æ³•ï¼Œæœ‰lengthçš„å±æ€§ã€‚Stringæœ‰length()è¿™ä¸ªæ–¹æ³•ã€‚</p><h3 id="36-ä¸‹é¢è¿™æ¡è¯­å¥ä¸€å…±åˆ›å»ºäº†å¤šå°‘ä¸ªå¯¹è±¡-String-s-â€aâ€-â€bâ€-â€câ€-â€dâ€"><a href="#36-ä¸‹é¢è¿™æ¡è¯­å¥ä¸€å…±åˆ›å»ºäº†å¤šå°‘ä¸ªå¯¹è±¡-String-s-â€aâ€-â€bâ€-â€câ€-â€dâ€" class="headerlink" title="36.ä¸‹é¢è¿™æ¡è¯­å¥ä¸€å…±åˆ›å»ºäº†å¤šå°‘ä¸ªå¯¹è±¡? String s=â€aâ€+â€bâ€+â€câ€+â€dâ€;"></a><a href="">36.ä¸‹é¢è¿™æ¡è¯­å¥ä¸€å…±åˆ›å»ºäº†å¤šå°‘ä¸ªå¯¹è±¡? String s=â€aâ€+â€bâ€+â€câ€+â€dâ€;</a></h3><p>å¯¹äºå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> s1 + <span class="string">&quot;b&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">s3</span> <span class="operator">=</span> <span class="string">&quot;a&quot;</span> + <span class="string">&quot;b&quot;</span>;</span><br><span class="line">System.out.println(s2 == <span class="string">&quot;ab&quot;</span>);</span><br><span class="line">System.out.println(s3 == <span class="string">&quot;ab&quot;</span>);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¡è¯­å¥æ‰“å°çš„ç»“æœä¸ºfalseï¼Œç¬¬äºŒæ¡è¯­å¥æ‰“å°çš„ç»“æœä¸ºtrueï¼Œè¿™è¯´æ˜javacç¼–è¯‘å¯ä»¥å¯¹å­—ç¬¦ä¸²å¸¸é‡ç›´æ¥ç›¸åŠ çš„è¡¨è¾¾å¼è¿›è¡Œä¼˜åŒ–ï¼Œä¸å¿…è¦ç­‰åˆ°è¿è¡ŒæœŸå»è¿›è¡ŒåŠ æ³•è¿ç®—å¤„ç†ï¼Œè€Œæ˜¯åœ¨ç¼–è¯‘æ—¶å»æ‰å…¶ä¸­çš„åŠ å·ï¼Œç›´æ¥å°†å…¶ç¼–è¯‘æˆä¸€ä¸ªè¿™äº›å¸¸é‡ç›¸è¿çš„ç»“æœã€‚</p><p>é¢˜ç›®ä¸­çš„ç¬¬ä¸€è¡Œä»£ç è¢«ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ä¼˜åŒ–åï¼Œç›¸å½“äºç›´æ¥å®šä¹‰äº†ä¸€ä¸ªâ€abcdâ€çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ï¼Œä¸Šé¢çš„ä»£ç åº”è¯¥åªåˆ›å»ºäº†ä¸€ä¸ªStringå¯¹è±¡ã€‚å†™å¦‚ä¸‹ä¸¤è¡Œä»£ç ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="string">&quot;a&quot;</span> + <span class="string">&quot;b&quot;</span> + <span class="string">&quot;c&quot;</span> + <span class="string">&quot;d&quot;</span>;</span><br><span class="line">System.out.println(s == <span class="string">&quot;abcd&quot;</span>);</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆæ‰“å°çš„ç»“æœåº”è¯¥ä¸ºtrueã€‚</p><h3 id="37-try-é‡Œæœ‰ä¸€ä¸ªreturnè¯­å¥ï¼Œé‚£ä¹ˆç´§è·Ÿåœ¨è¿™ä¸ªtryåçš„finally-é‡Œçš„codeä¼šä¸ä¼šè¢«æ‰§è¡Œï¼Œä»€ä¹ˆæ—¶å€™è¢«æ‰§è¡Œï¼Œåœ¨returnå‰è¿˜æ˜¯å"><a href="#37-try-é‡Œæœ‰ä¸€ä¸ªreturnè¯­å¥ï¼Œé‚£ä¹ˆç´§è·Ÿåœ¨è¿™ä¸ªtryåçš„finally-é‡Œçš„codeä¼šä¸ä¼šè¢«æ‰§è¡Œï¼Œä»€ä¹ˆæ—¶å€™è¢«æ‰§è¡Œï¼Œåœ¨returnå‰è¿˜æ˜¯å" class="headerlink" title="37.try {}é‡Œæœ‰ä¸€ä¸ªreturnè¯­å¥ï¼Œé‚£ä¹ˆç´§è·Ÿåœ¨è¿™ä¸ªtryåçš„finally {}é‡Œçš„codeä¼šä¸ä¼šè¢«æ‰§è¡Œï¼Œä»€ä¹ˆæ—¶å€™è¢«æ‰§è¡Œï¼Œåœ¨returnå‰è¿˜æ˜¯å?"></a><a href="">37.try {}é‡Œæœ‰ä¸€ä¸ªreturnè¯­å¥ï¼Œé‚£ä¹ˆç´§è·Ÿåœ¨è¿™ä¸ªtryåçš„finally {}é‡Œçš„codeä¼šä¸ä¼šè¢«æ‰§è¡Œï¼Œä»€ä¹ˆæ—¶å€™è¢«æ‰§è¡Œï¼Œåœ¨returnå‰è¿˜æ˜¯å?</a></h3><p>ä¹Ÿè®¸ä½ çš„ç­”æ¡ˆæ˜¯åœ¨returnä¹‹å‰ï¼Œä½†å¾€æ›´ç»†åœ°è¯´ï¼Œæˆ‘çš„ç­”æ¡ˆæ˜¯åœ¨returnä¸­é—´æ‰§è¡Œï¼Œè¯·çœ‹ä¸‹é¢ç¨‹åºä»£ç çš„è¿è¡Œç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(Test.test());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            ++x;</span><br><span class="line">           <span class="comment">// return x;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€”â€”â€”â€”-æ‰§è¡Œç»“æœ â€”â€”â€”â€”-</p><p>1</p><p>è¿è¡Œç»“æœæ˜¯1ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¦‚æœåœ¨tryä¸­returnçš„æƒ…å†µä¸‹ï¼Œå…ˆæŠŠtryä¸­å°†è¦returnçš„å€¼å…ˆå­˜åˆ°ä¸€ä¸ªæœ¬åœ°å˜é‡ä¸­ï¼Œå³æœ¬ä¾‹ä¸­çš„x=1å°†ä¼šè¢«ä¿å­˜ä¸‹æ¥ã€‚æ¥ä¸‹æ¥å»æ‰§è¡Œfinallyè¯­å¥ï¼Œæœ€åè¿”å›çš„æ˜¯å­˜åœ¨æœ¬åœ°å˜é‡ä¸­çš„å€¼ï¼Œå³è¿”å›x=1.</p><p>è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„ï¼Œå¦‚æœä½ åœ¨finallyé‡Œä¹Ÿç”¨äº†returnè¯­å¥ï¼Œæ¯”å¦‚return ++xã€‚é‚£ä¹ˆç¨‹åºè¿”å›å€¼ä¼šæ˜¯2ã€‚å› ä¸ºJVMè§„èŒƒè§„å®šäº†ï¼Œå½“tryå’Œfinallyé‡Œéƒ½æœ‰returnæ—¶ï¼Œä¼šå¿½ç•¥tryçš„returnï¼Œè€Œä½¿ç”¨finallyçš„returnã€‚</p><h3 id="38-final-finally-finalizeçš„åŒºåˆ«ã€‚"><a href="#38-final-finally-finalizeçš„åŒºåˆ«ã€‚" class="headerlink" title="38.final, finally, finalizeçš„åŒºåˆ«ã€‚"></a><a href="">38.final, finally, finalizeçš„åŒºåˆ«ã€‚</a></h3><p>final ç”¨äºå£°æ˜å±æ€§ï¼Œæ–¹æ³•å’Œç±»ï¼Œåˆ†åˆ«è¡¨ç¤ºå±æ€§ä¸å¯å˜ï¼Œæ–¹æ³•ä¸å¯è¦†ç›–ï¼Œç±»ä¸å¯ç»§æ‰¿ã€‚</p><p>å†…éƒ¨ç±»è¦è®¿é—®å±€éƒ¨å˜é‡ï¼Œå±€éƒ¨å˜é‡å¿…é¡»å®šä¹‰æˆfinalç±»å‹ã€‚</p><p>finallyæ˜¯å¼‚å¸¸å¤„ç†è¯­å¥ç»“æ„çš„ä¸€éƒ¨åˆ†ï¼Œè¡¨ç¤ºæ€»æ˜¯æ‰§è¡Œã€‚</p><p>finalizeæ˜¯Objectç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨åƒåœ¾æ”¶é›†å™¨æ‰§è¡Œçš„æ—¶å€™ä¼šè°ƒç”¨è¢«å›æ”¶å¯¹è±¡çš„æ­¤æ–¹æ³•ï¼Œå¯ä»¥è¦†ç›–æ­¤æ–¹æ³•æä¾›åƒåœ¾æ”¶é›†æ—¶çš„å…¶ä»–èµ„æºå›æ”¶ï¼Œä¾‹å¦‚å…³é—­æ–‡ä»¶ç­‰ã€‚JVMä¸ä¿è¯æ­¤æ–¹æ³•æ€»è¢«è°ƒç”¨</p><h3 id="39-è¯´å‡ºä¸€äº›å¸¸ç”¨çš„ç±»ï¼ŒåŒ…ï¼Œæ¥å£ï¼Œè¯·å„ä¸¾5ä¸ªã€‚"><a href="#39-è¯´å‡ºä¸€äº›å¸¸ç”¨çš„ç±»ï¼ŒåŒ…ï¼Œæ¥å£ï¼Œè¯·å„ä¸¾5ä¸ªã€‚" class="headerlink" title="39.è¯´å‡ºä¸€äº›å¸¸ç”¨çš„ç±»ï¼ŒåŒ…ï¼Œæ¥å£ï¼Œè¯·å„ä¸¾5ä¸ªã€‚"></a><a href="">39.è¯´å‡ºä¸€äº›å¸¸ç”¨çš„ç±»ï¼ŒåŒ…ï¼Œæ¥å£ï¼Œè¯·å„ä¸¾5ä¸ªã€‚</a></h3><p>è¦è®©äººå®¶æ„Ÿè§‰ä½ å¯¹java eeå¼€å‘å¾ˆç†Ÿï¼Œæ‰€ä»¥ï¼Œä¸èƒ½ä»…ä»…åªåˆ—core javaä¸­çš„é‚£äº›ä¸œè¥¿ï¼Œè¦å¤šåˆ—ä½ åœ¨åšsshé¡¹ç›®ä¸­æ¶‰åŠçš„é‚£äº›ä¸œè¥¿ï¼Œå°±å†™ä½ æœ€è¿‘å†™çš„é‚£äº›ç¨‹åºä¸­æ¶‰åŠçš„é‚£äº›ç±»ã€‚</p><p>å¸¸ç”¨çš„ç±»ï¼šBufferedReader BufferedWriter FileReader FileWirter String Integer</p><p>java.util.Dateï¼ŒSystemï¼ŒClassï¼ŒList,HashMap</p><p>å¸¸ç”¨çš„åŒ…ï¼šjava.lang java.io java.util java.sql ,javax.servlet,org.apache.strtuts.action,org.hibernate</p><p>å¸¸ç”¨çš„æ¥å£ï¼šRemote List Map Document NodeList,Servlet,HttpServletRequest,HttpServletResponse,Transaction(Hibernate)ã€Session(Hibernate),HttpSession</p><h3 id="40-javaä¸­æœ‰å‡ ç§ç±»å‹çš„æµï¼ŸJDKä¸ºæ¯ç§ç±»å‹çš„æµæä¾›äº†ä¸€äº›æŠ½è±¡ç±»ä»¥ä¾›ç»§æ‰¿ï¼Œè¯·è¯´å‡ºä»–ä»¬åˆ†åˆ«æ˜¯å“ªäº›ç±»ï¼Ÿ"><a href="#40-javaä¸­æœ‰å‡ ç§ç±»å‹çš„æµï¼ŸJDKä¸ºæ¯ç§ç±»å‹çš„æµæä¾›äº†ä¸€äº›æŠ½è±¡ç±»ä»¥ä¾›ç»§æ‰¿ï¼Œè¯·è¯´å‡ºä»–ä»¬åˆ†åˆ«æ˜¯å“ªäº›ç±»ï¼Ÿ" class="headerlink" title="40.javaä¸­æœ‰å‡ ç§ç±»å‹çš„æµï¼ŸJDKä¸ºæ¯ç§ç±»å‹çš„æµæä¾›äº†ä¸€äº›æŠ½è±¡ç±»ä»¥ä¾›ç»§æ‰¿ï¼Œè¯·è¯´å‡ºä»–ä»¬åˆ†åˆ«æ˜¯å“ªäº›ç±»ï¼Ÿ"></a><a href="">40.javaä¸­æœ‰å‡ ç§ç±»å‹çš„æµï¼ŸJDKä¸ºæ¯ç§ç±»å‹çš„æµæä¾›äº†ä¸€äº›æŠ½è±¡ç±»ä»¥ä¾›ç»§æ‰¿ï¼Œè¯·è¯´å‡ºä»–ä»¬åˆ†åˆ«æ˜¯å“ªäº›ç±»ï¼Ÿ</a></h3><p>å­—èŠ‚æµï¼Œå­—ç¬¦æµã€‚</p><p>å­—èŠ‚æµç»§æ‰¿äºInputStream OutputStreamï¼Œå­—ç¬¦æµç»§æ‰¿äºInputStreamReader OutputStreamWriterã€‚åœ¨java.ioåŒ…ä¸­è¿˜æœ‰è®¸å¤šå…¶ä»–çš„æµï¼Œä¸»è¦æ˜¯ä¸ºäº†æé«˜æ€§èƒ½å’Œä½¿ç”¨æ–¹ä¾¿ã€‚</p><h3 id="41-å­—èŠ‚æµä¸å­—ç¬¦æµçš„åŒºåˆ«"><a href="#41-å­—èŠ‚æµä¸å­—ç¬¦æµçš„åŒºåˆ«" class="headerlink" title="41.å­—èŠ‚æµä¸å­—ç¬¦æµçš„åŒºåˆ«"></a><a href="">41.å­—èŠ‚æµä¸å­—ç¬¦æµçš„åŒºåˆ«</a></h3><p>è¦æŠŠä¸€ç‰‡äºŒè¿›åˆ¶æ•°æ®é€ä¸€è¾“å‡ºåˆ°æŸä¸ªè®¾å¤‡ä¸­ï¼Œæˆ–è€…ä»æŸä¸ªè®¾å¤‡ä¸­é€ä¸€è¯»å–ä¸€ç‰‡äºŒè¿›åˆ¶æ•°æ®ï¼Œä¸ç®¡è¾“å…¥è¾“å‡ºè®¾å¤‡æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬è¦ç”¨ç»Ÿä¸€çš„æ–¹å¼æ¥å®Œæˆè¿™äº›æ“ä½œï¼Œç”¨ä¸€ç§æŠ½è±¡çš„æ–¹å¼è¿›è¡Œæè¿°ï¼Œè¿™ä¸ªæŠ½è±¡æè¿°æ–¹å¼èµ·åä¸ºIOæµï¼Œå¯¹åº”çš„æŠ½è±¡ç±»ä¸ºOutputStreamå’ŒInputStream ï¼Œä¸åŒçš„å®ç°ç±»å°±ä»£è¡¨ä¸åŒçš„è¾“å…¥å’Œè¾“å‡ºè®¾å¤‡ï¼Œå®ƒä»¬éƒ½æ˜¯é’ˆå¯¹å­—èŠ‚è¿›è¡Œæ“ä½œçš„ã€‚</p><p>åœ¨åº”ç”¨ä¸­ï¼Œç»å¸¸è¦æŠŠå®Œå…¨æ˜¯å­—ç¬¦çš„ä¸€æ®µæ–‡æœ¬è¾“å‡ºå»æˆ–è¯»è¿›æ¥ï¼Œç”¨å­—èŠ‚æµå¯ä»¥å—ï¼Ÿè®¡ç®—æœºä¸­çš„ä¸€åˆ‡æœ€ç»ˆéƒ½æ˜¯äºŒè¿›åˆ¶çš„å­—èŠ‚å½¢å¼å­˜åœ¨ã€‚å¯¹äºâ€œä¸­å›½â€è¿™äº›å­—ç¬¦ï¼Œé¦–å…ˆè¦å¾—åˆ°å…¶å¯¹åº”çš„å­—èŠ‚ï¼Œç„¶åå°†å­—èŠ‚å†™å…¥åˆ°è¾“å‡ºæµã€‚è¯»å–æ—¶ï¼Œé¦–å…ˆè¯»åˆ°çš„æ˜¯å­—èŠ‚ï¼Œå¯æ˜¯æˆ‘ä»¬è¦æŠŠå®ƒæ˜¾ç¤ºä¸ºå­—ç¬¦ï¼Œæˆ‘ä»¬éœ€è¦å°†å­—èŠ‚è½¬æ¢æˆå­—ç¬¦ã€‚ç”±äºè¿™æ ·çš„éœ€æ±‚å¾ˆå¹¿æ³›ï¼Œäººå®¶ä¸“é—¨æä¾›äº†å­—ç¬¦æµçš„åŒ…è£…ç±»ã€‚</p><p>åº•å±‚è®¾å¤‡æ°¸è¿œåªæ¥å—å­—èŠ‚æ•°æ®ï¼Œæœ‰æ—¶å€™è¦å†™å­—ç¬¦ä¸²åˆ°åº•å±‚è®¾å¤‡ï¼Œéœ€è¦å°†å­—ç¬¦ä¸²è½¬æˆå­—èŠ‚å†è¿›è¡Œå†™å…¥ã€‚å­—ç¬¦æµæ˜¯å­—èŠ‚æµçš„åŒ…è£…ï¼Œå­—ç¬¦æµåˆ™æ˜¯ç›´æ¥æ¥å—å­—ç¬¦ä¸²ï¼Œå®ƒå†…éƒ¨å°†ä¸²è½¬æˆå­—èŠ‚ï¼Œå†å†™å…¥åº•å±‚è®¾å¤‡ï¼Œè¿™ä¸ºæˆ‘ä»¬å‘IOè®¾å¤‡å†™å…¥æˆ–è¯»å–å­—ç¬¦ä¸²æä¾›äº†ä¸€ç‚¹ç‚¹æ–¹ä¾¿ã€‚</p><p>å­—ç¬¦å‘å­—èŠ‚è½¬æ¢æ—¶ï¼Œè¦æ³¨æ„ç¼–ç çš„é—®é¢˜ï¼Œå› ä¸ºå­—ç¬¦ä¸²è½¬æˆå­—èŠ‚æ•°ç»„ï¼Œå…¶å®æ˜¯è½¬æˆè¯¥å­—ç¬¦çš„æŸç§ç¼–ç çš„å­—èŠ‚å½¢å¼ï¼Œè¯»å–ä¹Ÿæ˜¯åä¹‹çš„é“ç†ã€‚</p><h3 id="42-ä»€ä¹ˆæ˜¯javaåºåˆ—åŒ–ï¼Œå¦‚ä½•å®ç°javaåºåˆ—åŒ–ï¼Ÿæˆ–è€…è¯·è§£é‡ŠSerializableæ¥å£çš„ä½œç”¨ã€‚"><a href="#42-ä»€ä¹ˆæ˜¯javaåºåˆ—åŒ–ï¼Œå¦‚ä½•å®ç°javaåºåˆ—åŒ–ï¼Ÿæˆ–è€…è¯·è§£é‡ŠSerializableæ¥å£çš„ä½œç”¨ã€‚" class="headerlink" title="42.ä»€ä¹ˆæ˜¯javaåºåˆ—åŒ–ï¼Œå¦‚ä½•å®ç°javaåºåˆ—åŒ–ï¼Ÿæˆ–è€…è¯·è§£é‡ŠSerializableæ¥å£çš„ä½œç”¨ã€‚"></a><a href="">42.ä»€ä¹ˆæ˜¯javaåºåˆ—åŒ–ï¼Œå¦‚ä½•å®ç°javaåºåˆ—åŒ–ï¼Ÿæˆ–è€…è¯·è§£é‡ŠSerializableæ¥å£çš„ä½œç”¨ã€‚</a></h3><p>æˆ‘ä»¬æœ‰æ—¶å€™å°†ä¸€ä¸ªjavaå¯¹è±¡å˜æˆå­—èŠ‚æµçš„å½¢å¼ä¼ å‡ºå»æˆ–è€…ä»ä¸€ä¸ªå­—èŠ‚æµä¸­æ¢å¤æˆä¸€ä¸ªjavaå¯¹è±¡ï¼Œä¾‹å¦‚ï¼Œè¦å°†javaå¯¹è±¡å­˜å‚¨åˆ°ç¡¬ç›˜æˆ–è€…ä¼ é€ç»™ç½‘ç»œä¸Šçš„å…¶ä»–è®¡ç®—æœºï¼Œè¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ä»£ç å»æŠŠä¸€ä¸ªjavaå¯¹è±¡å˜æˆæŸä¸ªæ ¼å¼çš„å­—èŠ‚æµå†ä¼ è¾“ï¼Œä½†æ˜¯ï¼Œjreæœ¬èº«å°±æä¾›äº†è¿™ç§æ”¯æŒï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨OutputStreamçš„writeObjectæ–¹æ³•æ¥åšï¼Œå¦‚æœè¦è®©java å¸®æˆ‘ä»¬åšï¼Œè¦è¢«ä¼ è¾“çš„å¯¹è±¡å¿…é¡»å®ç°serializableæ¥å£ï¼Œè¿™æ ·ï¼Œjavacç¼–è¯‘æ—¶å°±ä¼šè¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œç¼–è¯‘çš„ç±»æ‰å¯ä»¥è¢«writeObjectæ–¹æ³•æ“ä½œï¼Œè¿™å°±æ˜¯æ‰€è°“çš„åºåˆ—åŒ–ã€‚éœ€è¦è¢«åºåˆ—åŒ–çš„ç±»å¿…é¡»å®ç°Serializableæ¥å£ï¼Œè¯¥æ¥å£æ˜¯ä¸€ä¸ªminiæ¥å£ï¼Œå…¶ä¸­æ²¡æœ‰éœ€è¦å®ç°çš„æ–¹æ³•ï¼Œimplements Serializableåªæ˜¯ä¸ºäº†æ ‡æ³¨è¯¥å¯¹è±¡æ˜¯å¯è¢«åºåˆ—åŒ–çš„ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨webå¼€å‘ä¸­ï¼Œå¦‚æœå¯¹è±¡è¢«ä¿å­˜åœ¨äº†Sessionä¸­ï¼Œtomcatåœ¨é‡å¯æ—¶è¦æŠŠSessionå¯¹è±¡åºåˆ—åŒ–åˆ°ç¡¬ç›˜ï¼Œè¿™ä¸ªå¯¹è±¡å°±å¿…é¡»å®ç°Serializableæ¥å£ã€‚å¦‚æœå¯¹è±¡è¦ç»è¿‡åˆ†å¸ƒå¼ç³»ç»Ÿè¿›è¡Œç½‘ç»œä¼ è¾“æˆ–é€šè¿‡RPCç­‰è¿œç¨‹è°ƒç”¨ï¼Œè¿™å°±éœ€è¦åœ¨ç½‘ç»œä¸Šä¼ è¾“å¯¹è±¡ï¼Œè¢«ä¼ è¾“çš„å¯¹è±¡å°±å¿…é¡»å®ç°Serializableæ¥å£ã€‚</p><h3 id="43-Javaæºç çš„ç¼–è¯‘è¿‡ç¨‹ï¼Ÿï¼ˆåä¸ºï¼‰"><a href="#43-Javaæºç çš„ç¼–è¯‘è¿‡ç¨‹ï¼Ÿï¼ˆåä¸ºï¼‰" class="headerlink" title="43.Javaæºç çš„ç¼–è¯‘è¿‡ç¨‹ï¼Ÿï¼ˆåä¸ºï¼‰"></a><a href="">43.Javaæºç çš„ç¼–è¯‘è¿‡ç¨‹ï¼Ÿï¼ˆåä¸ºï¼‰</a></h3><p>Javaæºç æ˜¯ç”±Javacç¼–è¯‘å™¨ç¼–è¯‘çš„ï¼Œæµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/20170205113216819.jpg" alt=""></p><p>æºä»£ç -&gt; è¯æ³•åˆ†æå™¨ -&gt; è¯­æ³•åˆ†æå™¨ -&gt; è¯­ä¹‰åˆ†æå™¨ -&gt; å­—èŠ‚ç ç”Ÿæˆå™¨</p><p>Javacçš„ä»»åŠ¡å°±æ˜¯å°†Javaæºä»£ç ç¼–è¯‘æˆJavaå­—èŠ‚ç ï¼Œæ€»ç»“è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p> 1ï¼‰<strong>è¯æ³•åˆ†æ</strong>ï¼šè¯»å–æºä»£ç ï¼Œä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚çš„è¯»è¿›æ¥ï¼Œæ‰¾å‡ºè¿™äº›è¯æ³•ä¸­æˆ‘ä»¬å®šä¹‰çš„è¯­è¨€å…³é”®è¯å¦‚ï¼šifã€elseã€whileç­‰ï¼Œè¯†åˆ«å“ªäº›ifæ˜¯åˆæ³•çš„å“ªäº›æ˜¯ä¸åˆæ³•çš„ã€‚è¿™ä¸ªæ­¥éª¤å°±æ˜¯è¯æ³•åˆ†æè¿‡ç¨‹ã€‚</p><p>è¯æ³•åˆ†æçš„ç»“æœï¼šå°±æ˜¯ä»æºä»£ç ä¸­æ‰¾å‡ºäº†ä¸€äº›è§„èŒƒåŒ–çš„tokenæµï¼Œå°±åƒäººç±»è¯­è¨€ä¸­ï¼Œç»™ä½ ä¸€å¥è¯ä½ è¦åˆ†è¾¨å‡ºå“ªäº›æ˜¯ä¸€ä¸ªè¯è¯­ï¼Œå“ªäº›æ˜¯æ ‡ç‚¹ç¬¦å·ï¼Œå“ªäº›æ˜¯åŠ¨è¯ï¼Œå“ªäº›æ˜¯åè¯ã€‚</p><p>2ï¼‰<strong>è¯­æ³•åˆ†æ</strong>ï¼šå°±æ˜¯å¯¹è¯æ³•åˆ†æä¸­å¾—åˆ°çš„tokenæµè¿›è¡Œè¯­æ³•åˆ†æï¼Œè¿™ä¸€æ­¥å°±æ˜¯æ£€æŸ¥è¿™äº›å…³é”®è¯ç»„åˆåœ¨ä¸€èµ·æ˜¯ä¸æ˜¯ç¬¦åˆJavaè¯­è¨€è§„èŒƒã€‚å¦‚ifçš„åé¢æ˜¯ä¸æ˜¯ç´§è·Ÿç€ä¸€ä¸ªå¸ƒå°”å‹åˆ¤æ–­è¡¨è¾¾å¼ã€‚</p><p>è¯­æ³•åˆ†æçš„ç»“æœï¼šå°±æ˜¯å½¢æˆä¸€ä¸ªç¬¦åˆJavaè¯­è¨€è§„å®šçš„æŠ½è±¡è¯­æ³•æ ‘ï¼ŒæŠ½è±¡è¯­æ³•æ ‘æ˜¯ä¸€ä¸ªç»“æ„åŒ–çš„è¯­æ³•è¡¨è¾¾å½¢å¼ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠè¯­è¨€çš„ä¸»è¦è¯æ³•ç”¨ä¸€ä¸ªç»“æ„åŒ–çš„å½¢å¼ç»„ç»‡åœ¨ä¸€èµ·ã€‚è¿™æ£µè¯­æ³•æ ‘å¯ä»¥è¢«åé¢æŒ‰ç…§æ–°çš„è§„åˆ™å†é‡æ–°ç»„ç»‡ã€‚</p><p>3ï¼‰<strong>è¯­ä¹‰åˆ†æ</strong>ï¼šè¯­æ³•åˆ†æå®Œæˆä¹‹åä¹Ÿå°±ä¸å­˜åœ¨è¯­æ³•é—®é¢˜äº†ï¼Œè¯­ä¹‰åˆ†æçš„ä¸»è¦å·¥ä½œå°±æ˜¯æŠŠä¸€äº›éš¾æ‡‚çš„ï¼Œå¤æ‚çš„è¯­æ³•è½¬åŒ–æˆæ›´ç®€å•çš„è¯­æ³•ã€‚å°±å¦‚éš¾æ‡‚çš„æ–‡è¨€æ–‡è½¬åŒ–ä¸ºå¤§å®¶éƒ½æ‡‚çš„ç™¾è¯æ–‡ï¼Œæˆ–è€…æ˜¯æ³¨é‡Šä¸€ä¸‹ä¸€äº›ä¸æ‡‚çš„æˆè¯­ã€‚</p><p>è¯­ä¹‰åˆ†æç»“æœï¼šå°±æ˜¯å°†å¤æ‚çš„è¯­æ³•è½¬åŒ–ä¸ºç®€å•çš„è¯­æ³•ï¼Œå¯¹åº”åˆ°Javaå°±æ˜¯å°†foreachè½¬åŒ–ä¸ºforå¾ªç¯ï¼Œè¿˜æœ‰ä¸€äº›æ³¨é‡Šç­‰ã€‚æœ€åç”Ÿæˆä¸€æ£µæŠ½è±¡çš„è¯­æ³•æ ‘ï¼Œè¿™æ£µè¯­æ³•æ ‘ä¹Ÿå°±æ›´æ¥è¿‘ç›®æ ‡è¯­è¨€çš„è¯­æ³•è§„åˆ™ã€‚</p><p>4ï¼‰<strong>å­—èŠ‚ç ç”Ÿæˆ</strong>ï¼šå°†ä¼šæ ¹æ®ç»è¿‡æ³¨é‡Šçš„æŠ½è±¡è¯­æ³•æ ‘ç”Ÿæˆå­—èŠ‚ç ï¼Œä¹Ÿå°±æ˜¯å°†ä¸€ä¸ªæ•°æ®ç»“æ„è½¬åŒ–ä¸ºå¦å¤–ä¸€ä¸ªæ•°æ®ç»“æ„ã€‚å°±åƒå°†æ‰€æœ‰çš„ä¸­æ–‡è¯è¯­ç¿»è¯‘æˆè‹±æ–‡å•è¯åæŒ‰ç…§è‹±æ–‡è¯­æ³•ç»„è£…æ–‡è‹±æ–‡è¯­å¥ã€‚ä»£ç ç”Ÿæˆå™¨çš„ç»“æœå°±æ˜¯ç”Ÿæˆç¬¦åˆjavaè™šæ‹Ÿæœºè§„èŒƒçš„å­—èŠ‚ç ã€‚</p><p><strong>è¯æ³•åˆ†æå°±æ˜¯å°†å…³é”®è¯ç»„ç»‡æˆtokenæµå³æ£€æŸ¥æºç ä¸­çš„çš„å…³é”®è¯æ˜¯å¦æ­£ç¡®å¹¶ç»„ç»‡æˆtokenæµï¼Œè€Œè¯­æ³•åˆ†æå°±æ˜¯æ£€æŸ¥æºç æ˜¯å¦ç¬¦åˆjavaè¯­æ³•è§„èŒƒå¹¶å°†è¯ç»„æˆè¯­å¥ã€‚è¯­ä¹‰åˆ†æå°±æ˜¯ç®€åŒ–å¤æ‚çš„æ·»åŠ ç¼ºå°‘çš„ï¼Œæ£€æŸ¥å˜é‡ç±»å‹æ˜¯å¦åˆæ³•ã€‚ä»£ç ç”Ÿæˆå™¨å°±æ˜¯éå†è¿™æ£µæ ‘ç”Ÿæˆç¬¦åˆJVMè§„èŒƒçš„å­—èŠ‚ç ã€‚</strong></p><h3 id="44-ä¸€ä¸ªObjectå å¤šå°‘å­—èŠ‚ï¼Ÿï¼ˆshopeeï¼‰"><a href="#44-ä¸€ä¸ªObjectå å¤šå°‘å­—èŠ‚ï¼Ÿï¼ˆshopeeï¼‰" class="headerlink" title="44.ä¸€ä¸ªObjectå å¤šå°‘å­—èŠ‚ï¼Ÿï¼ˆshopeeï¼‰"></a><a href="">44.ä¸€ä¸ªObjectå å¤šå°‘å­—èŠ‚ï¼Ÿï¼ˆshopeeï¼‰</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"><span class="comment">// oæ™®é€šå¯¹è±¡æŒ‡é’ˆï¼ˆOopsï¼‰4 å­—èŠ‚ï¼ˆå¼€å¯å‹ç¼©å  4 å­—èŠ‚ï¼Œæ²¡å¼€å¯å  8 å­—èŠ‚ï¼‰ï¼Œobjectå¯¹è±¡å  16 å­—èŠ‚ </span></span><br></pre></td></tr></table></figure><h3 id="46-ä»€ä¹ˆæ˜¯å­—èŠ‚ç -é‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„æ˜¯ä»€ä¹ˆ"><a href="#46-ä»€ä¹ˆæ˜¯å­—èŠ‚ç -é‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„æ˜¯ä»€ä¹ˆ" class="headerlink" title="46.ä»€ä¹ˆæ˜¯å­—èŠ‚ç ?é‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„æ˜¯ä»€ä¹ˆ?"></a><a href="">46.ä»€ä¹ˆæ˜¯å­—èŠ‚ç ?é‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„æ˜¯ä»€ä¹ˆ?</a></h3><p>åœ¨ Java ä¸­ï¼ŒJVM å¯ä»¥ç†è§£çš„ä»£ç å°±å«åšå­—èŠ‚ç ï¼ˆå³æ‰©å±•åä¸º <code>.class</code> çš„æ–‡ä»¶ï¼‰ï¼Œå®ƒä¸é¢å‘ä»»ä½•ç‰¹å®šçš„å¤„ç†å™¨ï¼Œåªé¢å‘è™šæ‹Ÿæœºã€‚Java è¯­è¨€é€šè¿‡å­—èŠ‚ç çš„æ–¹å¼ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†ä¼ ç»Ÿè§£é‡Šå‹è¯­è¨€æ‰§è¡Œæ•ˆç‡ä½çš„é—®é¢˜ï¼ŒåŒæ—¶åˆä¿ç•™äº†è§£é‡Šå‹è¯­è¨€å¯ç§»æ¤çš„ç‰¹ç‚¹ã€‚æ‰€ä»¥ï¼Œ Java ç¨‹åºè¿è¡Œæ—¶ç›¸å¯¹æ¥è¯´è¿˜æ˜¯é«˜æ•ˆçš„ï¼ˆä¸è¿‡ï¼Œå’Œ C++ï¼ŒRustï¼ŒGo ç­‰è¯­è¨€è¿˜æ˜¯æœ‰ä¸€å®šå·®è·çš„ï¼‰ï¼Œè€Œä¸”ï¼Œç”±äºå­—èŠ‚ç å¹¶ä¸é’ˆå¯¹ä¸€ç§ç‰¹å®šçš„æœºå™¨ï¼Œå› æ­¤ï¼ŒJava ç¨‹åºæ— é¡»é‡æ–°ç¼–è¯‘ä¾¿å¯åœ¨å¤šç§ä¸åŒæ“ä½œç³»ç»Ÿçš„è®¡ç®—æœºä¸Šè¿è¡Œã€‚</p><h3 id="47-Java-ç¨‹åºä»æºä»£ç åˆ°è¿è¡Œçš„è¿‡ç¨‹"><a href="#47-Java-ç¨‹åºä»æºä»£ç åˆ°è¿è¡Œçš„è¿‡ç¨‹" class="headerlink" title="47.Java ç¨‹åºä»æºä»£ç åˆ°è¿è¡Œçš„è¿‡ç¨‹"></a><a href="">47.<strong>Java ç¨‹åºä»æºä»£ç åˆ°è¿è¡Œçš„è¿‡ç¨‹</strong></a></h3><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20220209132736220.png" alt="image-20220209132736220"></p><p>æˆ‘ä»¬éœ€è¦æ ¼å¤–æ³¨æ„çš„æ˜¯ <code>.class-&gt;æœºå™¨ç </code> è¿™ä¸€æ­¥ã€‚åœ¨è¿™ä¸€æ­¥ JVM ç±»åŠ è½½å™¨é¦–å…ˆåŠ è½½å­—èŠ‚ç æ–‡ä»¶ï¼Œç„¶åé€šè¿‡è§£é‡Šå™¨é€è¡Œè§£é‡Šæ‰§è¡Œï¼Œè¿™ç§æ–¹å¼çš„æ‰§è¡Œé€Ÿåº¦ä¼šç›¸å¯¹æ¯”è¾ƒæ…¢ã€‚è€Œä¸”ï¼Œæœ‰äº›æ–¹æ³•å’Œä»£ç å—æ˜¯ç»å¸¸éœ€è¦è¢«è°ƒç”¨çš„(ä¹Ÿå°±æ˜¯æ‰€è°“çš„çƒ­ç‚¹ä»£ç )ï¼Œæ‰€ä»¥åé¢å¼•è¿›äº† JITï¼ˆjust-in-time compilationï¼‰ ç¼–è¯‘å™¨ï¼Œè€Œ JIT å±äºè¿è¡Œæ—¶ç¼–è¯‘ã€‚å½“ JIT ç¼–è¯‘å™¨å®Œæˆç¬¬ä¸€æ¬¡ç¼–è¯‘åï¼Œå…¶ä¼šå°†å­—èŠ‚ç å¯¹åº”çš„æœºå™¨ç ä¿å­˜ä¸‹æ¥ï¼Œä¸‹æ¬¡å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚è€Œæˆ‘ä»¬çŸ¥é“ï¼Œæœºå™¨ç çš„è¿è¡Œæ•ˆç‡è‚¯å®šæ˜¯é«˜äº Java è§£é‡Šå™¨çš„ã€‚è¿™ä¹Ÿè§£é‡Šäº†æˆ‘ä»¬ä¸ºä»€ä¹ˆç»å¸¸ä¼šè¯´ <strong>Java æ˜¯ç¼–è¯‘ä¸è§£é‡Šå…±å­˜çš„è¯­è¨€</strong> ã€‚ </p><h3 id="48-ä¸ºä»€ä¹ˆè¯´-Java-è¯­è¨€â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜â€ï¼Ÿ"><a href="#48-ä¸ºä»€ä¹ˆè¯´-Java-è¯­è¨€â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜â€ï¼Ÿ" class="headerlink" title="48.ä¸ºä»€ä¹ˆè¯´ Java è¯­è¨€â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜â€ï¼Ÿ"></a><a href="">48.ä¸ºä»€ä¹ˆè¯´ Java è¯­è¨€â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜â€ï¼Ÿ</a></h3><p>å› ä¸º Java è¯­è¨€æ—¢å…·æœ‰ç¼–è¯‘å‹è¯­è¨€çš„ç‰¹å¾ï¼Œä¹Ÿå…·æœ‰è§£é‡Šå‹è¯­è¨€çš„ç‰¹å¾ã€‚å› ä¸º Java ç¨‹åºè¦ç»è¿‡å…ˆç¼–è¯‘ï¼Œåè§£é‡Šä¸¤ä¸ªæ­¥éª¤ï¼Œç”± Java ç¼–å†™çš„ç¨‹åºéœ€è¦å…ˆç»è¿‡ç¼–è¯‘æ­¥éª¤ï¼Œç”Ÿæˆå­—èŠ‚ç ï¼ˆ<code>.class</code> æ–‡ä»¶ï¼‰ï¼Œè¿™ç§å­—èŠ‚ç å¿…é¡»ç”± Java è§£é‡Šå™¨æ¥è§£é‡Šæ‰§è¡Œã€‚</p><h3 id="49-é™æ€æ–¹æ³•ä¸ºä»€ä¹ˆä¸èƒ½è°ƒç”¨éé™æ€æˆå‘˜"><a href="#49-é™æ€æ–¹æ³•ä¸ºä»€ä¹ˆä¸èƒ½è°ƒç”¨éé™æ€æˆå‘˜" class="headerlink" title="49.é™æ€æ–¹æ³•ä¸ºä»€ä¹ˆä¸èƒ½è°ƒç”¨éé™æ€æˆå‘˜?"></a><a href="">49.é™æ€æ–¹æ³•ä¸ºä»€ä¹ˆä¸èƒ½è°ƒç”¨éé™æ€æˆå‘˜?</a></h3><p>è¿™ä¸ªéœ€è¦ç»“åˆ JVM çš„ç›¸å…³çŸ¥è¯†ï¼Œä¸»è¦åŸå› å¦‚ä¸‹ï¼š</p><ol><li>é™æ€æ–¹æ³•æ˜¯å±äºç±»çš„ï¼Œåœ¨ç±»åŠ è½½çš„æ—¶å€™å°±ä¼šåˆ†é…å†…å­˜ï¼Œå¯ä»¥é€šè¿‡ç±»åç›´æ¥è®¿é—®ã€‚è€Œéé™æ€æˆå‘˜å±äºå®ä¾‹å¯¹è±¡ï¼Œåªæœ‰åœ¨å¯¹è±¡å®ä¾‹åŒ–ä¹‹åæ‰å­˜åœ¨ï¼Œéœ€è¦é€šè¿‡ç±»çš„å®ä¾‹å¯¹è±¡å»è®¿é—®ã€‚</li><li>åœ¨ç±»çš„éé™æ€æˆå‘˜ä¸å­˜åœ¨çš„æ—¶å€™é™æ€æ–¹æ³•å°±å·²ç»å­˜åœ¨äº†ï¼Œæ­¤æ—¶è°ƒç”¨åœ¨å†…å­˜ä¸­è¿˜ä¸å­˜åœ¨çš„éé™æ€æˆå‘˜ï¼Œå±äºéæ³•æ“ä½œã€‚</li></ol><h3 id="50-é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•æœ‰ä½•ä¸åŒï¼Ÿ"><a href="#50-é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•æœ‰ä½•ä¸åŒï¼Ÿ" class="headerlink" title="50.é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•æœ‰ä½•ä¸åŒï¼Ÿ"></a><a href="">50.é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•æœ‰ä½•ä¸åŒï¼Ÿ</a></h3><p><strong>1ã€è°ƒç”¨æ–¹å¼</strong></p><p>åœ¨å¤–éƒ¨è°ƒç”¨é™æ€æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>ç±»å.æ–¹æ³•å</code> çš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>å¯¹è±¡.æ–¹æ³•å</code> çš„æ–¹å¼ï¼Œè€Œå®ä¾‹æ–¹æ³•åªæœ‰åé¢è¿™ç§æ–¹å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>è°ƒç”¨é™æ€æ–¹æ³•å¯ä»¥æ— éœ€åˆ›å»ºå¯¹è±¡</strong> ã€‚</p><p><strong>2ã€è®¿é—®ç±»æˆå‘˜æ˜¯å¦å­˜åœ¨é™åˆ¶</strong></p><p>é™æ€æ–¹æ³•åœ¨è®¿é—®æœ¬ç±»çš„æˆå‘˜æ—¶ï¼Œåªå…è®¸è®¿é—®é™æ€æˆå‘˜ï¼ˆå³é™æ€æˆå‘˜å˜é‡å’Œé™æ€æ–¹æ³•ï¼‰ï¼Œä¸å…è®¸è®¿é—®å®ä¾‹æˆå‘˜ï¼ˆå³å®ä¾‹æˆå‘˜å˜é‡å’Œå®ä¾‹æ–¹æ³•ï¼‰ï¼Œè€Œå®ä¾‹æ–¹æ³•ä¸å­˜åœ¨è¿™ä¸ªé™åˆ¶ã€‚</p><h3 id="51-hashCode-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#51-hashCode-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="51. hashCode() æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a><a href="">51. hashCode() æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</a></h3><p><code>hashCode()</code> çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼ˆ<code>int</code> æ•´æ•°ï¼‰ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ã€‚è¿™ä¸ªå“ˆå¸Œç çš„ä½œç”¨æ˜¯ç¡®å®šè¯¥å¯¹è±¡åœ¨å“ˆå¸Œè¡¨ä¸­çš„ç´¢å¼•ä½ç½®ã€‚æ•£åˆ—è¡¨å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹(key-value)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼š<strong>èƒ½æ ¹æ®â€œé”®â€å¿«é€Ÿçš„æ£€ç´¢å‡ºå¯¹åº”çš„â€œå€¼â€ã€‚è¿™å…¶ä¸­å°±åˆ©ç”¨åˆ°äº†æ•£åˆ—ç ï¼ï¼ˆå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€è¦çš„å¯¹è±¡ï¼‰</strong></p><h3 id="52-ä¸ºä»€ä¹ˆè¦æœ‰-hashCodeï¼Ÿ"><a href="#52-ä¸ºä»€ä¹ˆè¦æœ‰-hashCodeï¼Ÿ" class="headerlink" title="52.ä¸ºä»€ä¹ˆè¦æœ‰ hashCodeï¼Ÿ"></a><a href="">52.ä¸ºä»€ä¹ˆè¦æœ‰ hashCodeï¼Ÿ</a></h3><p>æˆ‘ä»¬ä»¥â€œ<code>HashSet</code> å¦‚ä½•æ£€æŸ¥é‡å¤â€ä¸ºä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¦æœ‰ <code>hashCode</code>ï¼Ÿ</p><blockquote><p>å½“ä½ æŠŠå¯¹è±¡åŠ å…¥ <code>HashSet</code> æ—¶ï¼Œ<code>HashSet</code> ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ <code>hashCode</code> å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸å…¶ä»–å·²ç»åŠ å…¥çš„å¯¹è±¡çš„ <code>hashCode</code> å€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„ <code>hashCode</code>ï¼Œ<code>HashSet</code> ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ <code>hashCode</code> å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ <code>equals()</code> æ–¹æ³•æ¥æ£€æŸ¥ <code>hashCode</code> ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œ<code>HashSet</code> å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚è¿™æ ·æˆ‘ä»¬å°±å¤§å¤§å‡å°‘äº† <code>equals</code> çš„æ¬¡æ•°ï¼Œç›¸åº”å°±å¤§å¤§æé«˜äº†æ‰§è¡Œé€Ÿåº¦ã€‚</p></blockquote><p>å…¶å®ï¼Œ <code>hashCode()</code> å’Œ <code>equals()</code>éƒ½æ˜¯ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚</p><p><strong>é‚£ä¸ºä»€ä¹ˆ JDK è¿˜è¦åŒæ—¶æä¾›è¿™ä¸¤ä¸ªæ–¹æ³•å‘¢ï¼Ÿ</strong></p><p>è¿™æ˜¯å› ä¸ºåœ¨ä¸€äº›å®¹å™¨ï¼ˆæ¯”å¦‚ <code>HashMap</code>ã€<code>HashSet</code>ï¼‰ä¸­ï¼Œæœ‰äº† <code>hashCode()</code> ä¹‹åï¼Œåˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨å¯¹åº”å®¹å™¨ä¸­çš„æ•ˆç‡ä¼šæ›´é«˜ï¼ˆå‚è€ƒæ·»åŠ å…ƒç´ è¿›<code>HastSet</code>çš„è¿‡ç¨‹ï¼‰ï¼</p><p>æˆ‘ä»¬åœ¨å‰é¢ä¹Ÿæåˆ°äº†æ·»åŠ å…ƒç´ è¿›<code>HastSet</code>çš„è¿‡ç¨‹ï¼Œå¦‚æœ <code>HashSet</code> åœ¨å¯¹æ¯”çš„æ—¶å€™ï¼ŒåŒæ ·çš„ <code>hashCode</code> æœ‰å¤šä¸ªå¯¹è±¡ï¼Œå®ƒä¼šç»§ç»­ä½¿ç”¨ <code>equals()</code> æ¥åˆ¤æ–­æ˜¯å¦çœŸçš„ç›¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ <code>hashCode</code> å¸®åŠ©æˆ‘ä»¬å¤§å¤§ç¼©å°äº†æŸ¥æ‰¾æˆæœ¬ã€‚</p><p><strong>é‚£ä¸ºä»€ä¹ˆä¸åªæä¾› <code>hashCode()</code> æ–¹æ³•å‘¢ï¼Ÿ</strong></p><p>è¿™æ˜¯å› ä¸ºä¸¤ä¸ªå¯¹è±¡çš„<code>hashCode</code> å€¼ç›¸ç­‰å¹¶ä¸ä»£è¡¨ä¸¤ä¸ªå¯¹è±¡å°±ç›¸ç­‰ã€‚</p><p><strong>é‚£ä¸ºä»€ä¹ˆä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„ <code>hashCode</code> å€¼ï¼Œå®ƒä»¬ä¹Ÿä¸ä¸€å®šæ˜¯ç›¸ç­‰çš„ï¼Ÿ</strong></p><p>å› ä¸º <code>hashCode()</code> æ‰€ä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ä¹Ÿè®¸åˆšå¥½ä¼šè®©å¤šä¸ªå¯¹è±¡ä¼ å›ç›¸åŒçš„å“ˆå¸Œå€¼ã€‚è¶Šç³Ÿç³•çš„å“ˆå¸Œç®—æ³•è¶Šå®¹æ˜“ç¢°æ’ï¼Œä½†è¿™ä¹Ÿä¸æ•°æ®å€¼åŸŸåˆ†å¸ƒçš„ç‰¹æ€§æœ‰å…³ï¼ˆæ‰€è°“å“ˆå¸Œç¢°æ’ä¹Ÿå°±æ˜¯æŒ‡çš„æ˜¯ä¸åŒçš„å¯¹è±¡å¾—åˆ°ç›¸åŒçš„ <code>hashCode</code> )ã€‚</p><p>æ€»ç»“ä¸‹æ¥å°±æ˜¯ ï¼š</p><ul><li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„<code>hashCode</code> å€¼ç›¸ç­‰ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç›¸ç­‰ï¼ˆå“ˆå¸Œç¢°æ’ï¼‰ã€‚</li><li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„<code>hashCode</code> å€¼ç›¸ç­‰å¹¶ä¸”<code>equals()</code>æ–¹æ³•è¿”å› <code>true</code>ï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ã€‚</li><li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„<code>hashCode</code> å€¼ä¸ç›¸ç­‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰ã€‚</li></ul><h3 id="53-ä¸ºä»€ä¹ˆé‡å†™-equals-æ—¶å¿…é¡»é‡å†™-hashCode-æ–¹æ³•ï¼Ÿ"><a href="#53-ä¸ºä»€ä¹ˆé‡å†™-equals-æ—¶å¿…é¡»é‡å†™-hashCode-æ–¹æ³•ï¼Ÿ" class="headerlink" title="53.ä¸ºä»€ä¹ˆé‡å†™ equals() æ—¶å¿…é¡»é‡å†™ hashCode() æ–¹æ³•ï¼Ÿ"></a><a href="">53.ä¸ºä»€ä¹ˆé‡å†™ equals() æ—¶å¿…é¡»é‡å†™ hashCode() æ–¹æ³•ï¼Ÿ</a></h3><p>å› ä¸ºä¸¤ä¸ªç›¸ç­‰çš„å¯¹è±¡çš„ <code>hashCode</code> å€¼å¿…é¡»æ˜¯ç›¸ç­‰ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœ <code>equals</code> æ–¹æ³•åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸ç­‰çš„ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡çš„ <code>hashCode</code> å€¼ä¹Ÿè¦ç›¸ç­‰ã€‚</p><p>å¦‚æœé‡å†™ <code>equals()</code> æ—¶æ²¡æœ‰é‡å†™ <code>hashCode()</code> æ–¹æ³•çš„è¯å°±å¯èƒ½ä¼šå¯¼è‡´ <code>equals</code> æ–¹æ³•åˆ¤æ–­æ˜¯ç›¸ç­‰çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œ<code>hashCode</code> å€¼å´ä¸ç›¸ç­‰ã€‚</p><p>è®¸å¤šå®¹å™¨ç±»ï¼Œå¦‚ HashMapã€HashSet éƒ½ä¾èµ–äº hashcode ä¸ equals çš„è§„å®šã€‚</p><h3 id="54-Java-ä¸­çš„å‡ ç§åŸºæœ¬æ•°æ®ç±»å‹äº†è§£ä¹ˆï¼Ÿ"><a href="#54-Java-ä¸­çš„å‡ ç§åŸºæœ¬æ•°æ®ç±»å‹äº†è§£ä¹ˆï¼Ÿ" class="headerlink" title="54. Java ä¸­çš„å‡ ç§åŸºæœ¬æ•°æ®ç±»å‹äº†è§£ä¹ˆï¼Ÿ"></a><a href="">54. Java ä¸­çš„å‡ ç§åŸºæœ¬æ•°æ®ç±»å‹äº†è§£ä¹ˆï¼Ÿ</a></h3><p>Java ä¸­æœ‰ 8 ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåˆ†åˆ«ä¸ºï¼š</p><ol><li>6 ç§æ•°å­—ç±»å‹ ï¼š<code>byte</code>ã€<code>short</code>ã€<code>int</code>ã€<code>long</code>ã€<code>float</code>ã€<code>double</code></li><li>1 ç§å­—ç¬¦ç±»å‹ï¼š<code>char</code></li><li>1 ç§å¸ƒå°”å‹ï¼š<code>boolean</code></li></ol><h3 id="55-åŒ…è£…ç±»å‹çš„å¸¸é‡æ± æŠ€æœ¯äº†è§£ä¹ˆï¼Ÿ"><a href="#55-åŒ…è£…ç±»å‹çš„å¸¸é‡æ± æŠ€æœ¯äº†è§£ä¹ˆï¼Ÿ" class="headerlink" title="55.åŒ…è£…ç±»å‹çš„å¸¸é‡æ± æŠ€æœ¯äº†è§£ä¹ˆï¼Ÿ"></a><a href="">55.åŒ…è£…ç±»å‹çš„å¸¸é‡æ± æŠ€æœ¯äº†è§£ä¹ˆï¼Ÿ</a></h3><p>Java åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»çš„å¤§éƒ¨åˆ†éƒ½å®ç°äº†å¸¸é‡æ± æŠ€æœ¯ã€‚</p><p><code>Byte</code>,<code>Short</code>,<code>Integer</code>,<code>Long</code> è¿™ 4 ç§åŒ…è£…ç±»é»˜è®¤åˆ›å»ºäº†æ•°å€¼ <strong>[-128ï¼Œ127]</strong> çš„ç›¸åº”ç±»å‹çš„ç¼“å­˜æ•°æ®ï¼Œ<code>Character</code> åˆ›å»ºäº†æ•°å€¼åœ¨ <strong>[0,127]</strong> èŒƒå›´çš„ç¼“å­˜æ•°æ®ï¼Œ<code>Boolean</code> ç›´æ¥è¿”å› <code>True</code> or <code>False</code>ã€‚</p><p>å¦‚æœè¶…å‡ºå¯¹åº”èŒƒå›´ä»ç„¶ä¼šå»åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œç¼“å­˜çš„èŒƒå›´åŒºé—´çš„å¤§å°åªæ˜¯åœ¨æ€§èƒ½å’Œèµ„æºä¹‹é—´çš„æƒè¡¡ã€‚</p><p>ä¸¤ç§æµ®ç‚¹æ•°ç±»å‹çš„åŒ…è£…ç±» <code>Float</code>,<code>Double</code> å¹¶æ²¡æœ‰å®ç°å¸¸é‡æ± æŠ€æœ¯ã€‚</p><h3 id="56-è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±äº†è§£å—ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#56-è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±äº†è§£å—ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="56. è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±äº†è§£å—ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a><a href="">56. è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±äº†è§£å—ï¼ŸåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</a></h3><p><strong>ä»€ä¹ˆæ˜¯è‡ªåŠ¨æ‹†è£…ç®±ï¼Ÿ</strong></p><ul><li><strong>è£…ç®±</strong>ï¼šå°†åŸºæœ¬ç±»å‹ç”¨å®ƒä»¬å¯¹åº”çš„å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼›</li><li><strong>æ‹†ç®±</strong>ï¼šå°†åŒ…è£…ç±»å‹è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼›</li></ul><h3 id="57-é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«ï¼ˆç¾å›¢ï¼‰"><a href="#57-é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«ï¼ˆç¾å›¢ï¼‰" class="headerlink" title="57.é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«ï¼ˆç¾å›¢ï¼‰"></a><a href="">57.é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«ï¼ˆç¾å›¢ï¼‰</a></h3><p>ä¸¤è€…çš„ä¸»è¦åŒºåˆ«åœ¨äºè§£å†³é—®é¢˜çš„æ–¹å¼ä¸åŒï¼š</p><ul><li>é¢å‘è¿‡ç¨‹æŠŠè§£å†³é—®é¢˜çš„è¿‡ç¨‹æ‹†æˆä¸€ä¸ªä¸ªæ–¹æ³•ï¼Œé€šè¿‡ä¸€ä¸ªä¸ªæ–¹æ³•çš„æ‰§è¡Œè§£å†³é—®é¢˜ã€‚</li><li>é¢å‘å¯¹è±¡ä¼šå…ˆæŠ½è±¡å‡ºå¯¹è±¡ï¼Œç„¶åç”¨å¯¹è±¡æ‰§è¡Œæ–¹æ³•çš„æ–¹å¼è§£å†³é—®é¢˜ã€‚</li></ul><p>å¦å¤–ï¼Œé¢å‘å¯¹è±¡å¼€å‘çš„ç¨‹åºä¸€èˆ¬æ›´æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ã€‚</p><h3 id="58-æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ"><a href="#58-æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="58.æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ"></a><a href="">58.æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ</a></h3><p><strong>è¯­æ³•å½¢å¼</strong> ï¼šä»è¯­æ³•å½¢å¼ä¸Šçœ‹ï¼Œæˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œè€Œå±€éƒ¨å˜é‡æ˜¯åœ¨ä»£ç å—æˆ–æ–¹æ³•ä¸­å®šä¹‰çš„å˜é‡æˆ–æ˜¯æ–¹æ³•çš„å‚æ•°ï¼›æˆå‘˜å˜é‡å¯ä»¥è¢« <code>public</code>,<code>private</code>,<code>static</code> ç­‰ä¿®é¥°ç¬¦æ‰€ä¿®é¥°ï¼Œè€Œå±€éƒ¨å˜é‡ä¸èƒ½è¢«è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦åŠ <code>static</code> æ‰€ä¿®é¥°ï¼›ä½†æ˜¯ï¼Œæˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡éƒ½èƒ½è¢« <code>final</code> æ‰€ä¿®é¥°ã€‚</p><p><strong>å­˜å‚¨æ–¹å¼</strong> ï¼šä»å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼æ¥çœ‹,å¦‚æœæˆå‘˜å˜é‡æ˜¯ä½¿ç”¨ <code>static</code> ä¿®é¥°çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ <code>static</code> ä¿®é¥°ï¼Œè¿™ä¸ªæˆå‘˜å˜é‡æ˜¯å±äºå®ä¾‹çš„ã€‚è€Œå¯¹è±¡å­˜åœ¨äºå †å†…å­˜ï¼Œå±€éƒ¨å˜é‡åˆ™å­˜åœ¨äºæ ˆå†…å­˜ã€‚</p><p><strong>ç”Ÿå­˜æ—¶é—´</strong> ï¼šä»å˜é‡åœ¨å†…å­˜ä¸­çš„ç”Ÿå­˜æ—¶é—´ä¸Šçœ‹ï¼Œæˆå‘˜å˜é‡æ˜¯å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒéšç€å¯¹è±¡çš„åˆ›å»ºè€Œå­˜åœ¨ï¼Œè€Œå±€éƒ¨å˜é‡éšç€æ–¹æ³•çš„è°ƒç”¨è€Œè‡ªåŠ¨æ¶ˆå¤±ã€‚</p><p><strong>é»˜è®¤å€¼</strong> ï¼šä»å˜é‡æ˜¯å¦æœ‰é»˜è®¤å€¼æ¥çœ‹ï¼Œæˆå‘˜å˜é‡å¦‚æœæ²¡æœ‰è¢«èµ‹åˆï¼Œåˆ™ä¼šè‡ªåŠ¨ä»¥ç±»å‹çš„é»˜è®¤å€¼è€Œèµ‹å€¼ï¼ˆä¸€ç§æƒ…å†µä¾‹å¤–:è¢« <code>final</code> ä¿®é¥°çš„æˆå‘˜å˜é‡ä¹Ÿå¿…é¡»æ˜¾å¼åœ°èµ‹å€¼ï¼‰ï¼Œè€Œå±€éƒ¨å˜é‡åˆ™ä¸ä¼šè‡ªåŠ¨èµ‹å€¼ã€‚</p><h3 id="59-æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«äº†è§£å—ï¼Ÿä»€ä¹ˆæ˜¯å¼•ç”¨æ‹·è´ï¼Ÿ"><a href="#59-æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«äº†è§£å—ï¼Ÿä»€ä¹ˆæ˜¯å¼•ç”¨æ‹·è´ï¼Ÿ" class="headerlink" title="59.æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«äº†è§£å—ï¼Ÿä»€ä¹ˆæ˜¯å¼•ç”¨æ‹·è´ï¼Ÿ"></a><a href="">59.æ·±æ‹·è´å’Œæµ…æ‹·è´åŒºåˆ«äº†è§£å—ï¼Ÿä»€ä¹ˆæ˜¯å¼•ç”¨æ‹·è´ï¼Ÿ</a></h3><p><strong>æµ…æ‹·è´</strong>ï¼šæµ…æ‹·è´ä¼šåœ¨å †ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ˆåŒºåˆ«äºå¼•ç”¨æ‹·è´çš„ä¸€ç‚¹ï¼‰ï¼Œä¸è¿‡ï¼Œå¦‚æœåŸå¯¹è±¡å†…éƒ¨çš„å±æ€§æ˜¯å¼•ç”¨ç±»å‹çš„è¯ï¼Œæµ…æ‹·è´ä¼šç›´æ¥å¤åˆ¶å†…éƒ¨å¯¹è±¡çš„å¼•ç”¨åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´æ‹·è´å¯¹è±¡å’ŒåŸå¯¹è±¡å…±ç”¨åŒä¸€ä¸ªå†…éƒ¨å¯¹è±¡ã€‚</p><p><strong>æ·±æ‹·è´</strong> ï¼šæ·±æ‹·è´ä¼šå®Œå…¨å¤åˆ¶æ•´ä¸ªå¯¹è±¡ï¼ŒåŒ…æ‹¬è¿™ä¸ªå¯¹è±¡æ‰€åŒ…å«çš„å†…éƒ¨å¯¹è±¡ã€‚</p><p><strong>å¼•ç”¨æ‹·è´</strong>å°±æ˜¯ä¸¤ä¸ªä¸åŒçš„å¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚</p><h3 id="60-String-ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„"><a href="#60-String-ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„" class="headerlink" title="60.String ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„?"></a><a href="">60.String ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„?</a></h3><p><code>String</code> ç±»ä¸­ä½¿ç”¨ <code>final</code> å…³é”®å­—ä¿®é¥°å­—ç¬¦æ•°ç»„æ¥ä¿å­˜å­—ç¬¦ä¸²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">String</span> <span class="keyword">implements</span> <span class="title class_">java</span>.io.Serializable, Comparable&lt;String&gt;, CharSequence &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">char</span> value[];</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>String</code> çœŸæ­£ä¸å¯å˜æœ‰ä¸‹é¢å‡ ç‚¹åŸå› ï¼š</p><ol><li>ä¿å­˜å­—ç¬¦ä¸²çš„æ•°ç»„è¢« <code>final</code> ä¿®é¥°ä¸”ä¸ºç§æœ‰çš„ï¼Œå¹¶ä¸”<code>String</code> ç±»æ²¡æœ‰æä¾›/æš´éœ²ä¿®æ”¹è¿™ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•ã€‚</li><li><code>String</code> ç±»è¢« <code>final</code> ä¿®é¥°å¯¼è‡´å…¶ä¸èƒ½è¢«ç»§æ‰¿ï¼Œè¿›è€Œé¿å…äº†å­ç±»ç ´å <code>String</code> ä¸å¯å˜ã€‚</li></ol><h3 id="61-Stringã€StringBufferã€StringBuilder-çš„åŒºåˆ«ï¼Ÿï¼ˆç¾å›¢ï¼‰"><a href="#61-Stringã€StringBufferã€StringBuilder-çš„åŒºåˆ«ï¼Ÿï¼ˆç¾å›¢ï¼‰" class="headerlink" title="61. Stringã€StringBufferã€StringBuilder çš„åŒºåˆ«ï¼Ÿï¼ˆç¾å›¢ï¼‰"></a><a href="">61. Stringã€StringBufferã€StringBuilder çš„åŒºåˆ«ï¼Ÿï¼ˆç¾å›¢ï¼‰</a></h3><ul><li><p><strong>å¯å˜æ€§</strong>ï¼šStringæ˜¯ä¸å¯å˜çš„ï¼Œ<code>StringBuilder</code> ä¸ <code>StringBuffer</code> éƒ½ç»§æ‰¿è‡ª <code>AbstractStringBuilder</code> ç±»ï¼Œåœ¨ <code>AbstractStringBuilder</code> ä¸­ä¹Ÿæ˜¯ä½¿ç”¨å­—ç¬¦æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²ï¼Œä¸è¿‡æ²¡æœ‰ä½¿ç”¨ <code>final</code> å’Œ <code>private</code> å…³é”®å­—ä¿®é¥°ï¼Œæœ€å…³é”®çš„æ˜¯è¿™ä¸ª <code>AbstractStringBuilder</code> ç±»è¿˜æä¾›äº†å¾ˆå¤šä¿®æ”¹å­—ç¬¦ä¸²çš„æ–¹æ³•æ¯”å¦‚ <code>append</code> æ–¹æ³•ã€‚</p></li><li><p><strong>çº¿ç¨‹å®‰å…¨æ€§</strong>:<code>String</code> ä¸­çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå°±å¯ä»¥ç†è§£ä¸ºå¸¸é‡ï¼Œçº¿ç¨‹å®‰å…¨ã€‚<code>StringBuffer</code> å¯¹æ–¹æ³•åŠ äº†åŒæ­¥é”æˆ–è€…å¯¹è°ƒç”¨çš„æ–¹æ³•åŠ äº†åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚<code>StringBuilder</code> å¹¶æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡ŒåŠ åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚ </p></li><li><p><strong>æ€§èƒ½ï¼š</strong>æ¯æ¬¡å¯¹ <code>String</code> ç±»å‹è¿›è¡Œæ”¹å˜çš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ <code>String</code> å¯¹è±¡ï¼Œç„¶åå°†æŒ‡é’ˆæŒ‡å‘æ–°çš„ <code>String</code> å¯¹è±¡ã€‚<code>StringBuffer</code> æ¯æ¬¡éƒ½ä¼šå¯¹ <code>StringBuffer</code> å¯¹è±¡æœ¬èº«è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯ç”Ÿæˆæ–°çš„å¯¹è±¡å¹¶æ”¹å˜å¯¹è±¡å¼•ç”¨ã€‚ç›¸åŒæƒ…å†µä¸‹ä½¿ç”¨ <code>StringBuilder</code> ç›¸æ¯”ä½¿ç”¨ <code>StringBuffer</code> ä»…èƒ½è·å¾— 10%~15% å·¦å³çš„æ€§èƒ½æå‡ï¼Œä½†å´è¦å†’å¤šçº¿ç¨‹ä¸å®‰å…¨çš„é£é™©ã€‚ </p></li></ul><h3 id="62-å­—ç¬¦ä¸²å¸¸é‡æ± çš„ä½œç”¨äº†è§£å—ï¼Ÿ"><a href="#62-å­—ç¬¦ä¸²å¸¸é‡æ± çš„ä½œç”¨äº†è§£å—ï¼Ÿ" class="headerlink" title="62.å­—ç¬¦ä¸²å¸¸é‡æ± çš„ä½œç”¨äº†è§£å—ï¼Ÿ"></a><a href="">62.å­—ç¬¦ä¸²å¸¸é‡æ± çš„ä½œç”¨äº†è§£å—ï¼Ÿ</a></h3><p><strong>å­—ç¬¦ä¸²å¸¸é‡æ± </strong> æ˜¯ JVM ä¸ºäº†æå‡æ€§èƒ½å’Œå‡å°‘å†…å­˜æ¶ˆè€—ä¸“ä¸ºå­—ç¬¦ä¸²ï¼ˆString ç±»ï¼‰ä¸“é—¨å¼€è¾Ÿçš„ä¸€å—åŒºåŸŸï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†é¿å…å­—ç¬¦ä¸²çš„é‡å¤åˆ›å»ºã€‚JDK1.7 ä¹‹å‰è¿è¡Œæ—¶å¸¸é‡æ± é€»è¾‘åŒ…å«å­—ç¬¦ä¸²å¸¸é‡æ± å­˜æ”¾åœ¨æ–¹æ³•åŒºã€‚JDK1.7 çš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± è¢«ä»æ–¹æ³•åŒºæ‹¿åˆ°äº†å †ä¸­ã€‚</p><h3 id="63-Java-æ³›å‹äº†è§£ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯ç±»å‹æ“¦é™¤ï¼Ÿ"><a href="#63-Java-æ³›å‹äº†è§£ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯ç±»å‹æ“¦é™¤ï¼Ÿ" class="headerlink" title="63.Java æ³›å‹äº†è§£ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯ç±»å‹æ“¦é™¤ï¼Ÿ"></a><a href="">63.Java æ³›å‹äº†è§£ä¹ˆï¼Ÿä»€ä¹ˆæ˜¯ç±»å‹æ“¦é™¤ï¼Ÿ</a></h3><p><strong>Java æ³›å‹ï¼ˆgenericsï¼‰</strong> æ˜¯ JDK 5 ä¸­å¼•å…¥çš„ä¸€ä¸ªæ–°ç‰¹æ€§, æ³›å‹æä¾›äº†ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨æ£€æµ‹æœºåˆ¶ï¼Œè¯¥æœºåˆ¶å…è®¸ç¨‹åºå‘˜åœ¨ç¼–è¯‘æ—¶æ£€æµ‹åˆ°éæ³•çš„ç±»å‹ã€‚æ³›å‹çš„æœ¬è´¨æ˜¯å‚æ•°åŒ–ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰€æ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚</p><p>Java çš„æ³›å‹æ˜¯ä¼ªæ³›å‹ï¼Œè¿™æ˜¯å› ä¸º Java åœ¨è¿è¡ŒæœŸé—´ï¼Œæ‰€æœ‰çš„æ³›å‹ä¿¡æ¯éƒ½ä¼šè¢«æ“¦æ‰ï¼Œè¿™ä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´ç±»å‹æ“¦é™¤ ã€‚åœ¨ç¼–è¯‘é˜¶æ®µä¼šè¿›è¡Œæ‰€è°“çš„â€œç±»å‹æ“¦é™¤â€ï¼ˆType Erasureï¼‰ï¼Œå°†æ‰€æœ‰çš„æ³›å‹è¡¨ç¤ºï¼ˆå°–æ‹¬å·ä¸­çš„å†…å®¹ï¼‰éƒ½æ›¿æ¢ä¸ºå…·ä½“çš„ç±»å‹ï¼ˆå…¶å¯¹åº”çš„åŸç”Ÿæ€ç±»å‹ï¼‰ï¼Œå°±åƒå®Œå…¨æ²¡æœ‰æ³›å‹ä¸€æ ·ã€‚æ¯”å¦‚æˆ‘ä»¬å‘ä¸€ä¸ªæ•´å‹listé›†åˆé‡Œé¢æ·»åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œç›´æ¥è°ƒç”¨addæ–¹æ³•çš„è¯ï¼Œä¼šæŠ¥é”™ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åå°„çš„æ–¹æ³•æ·»åŠ ï¼Œè¿™å°±è¯´æ˜åœ¨è¿è¡ŒæœŸé—´æ‰€æœ‰çš„æ³›å‹ä¿¡æ¯éƒ½ä¼šè¢«æ“¦æ‰ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³›å‹æ–¹æ³•å‘¢</strong>ï¼Ÿå› ä¸ºæ³›å‹ç±»è¦åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°±æŒ‡æ˜ç±»å‹ï¼Œå¦‚æœæƒ³æ¢ä¸€ç§ç±»å‹ï¼Œä¸å¾—ä¸é‡æ–°newä¸€æ¬¡ï¼Œå¯èƒ½ä¸å¤Ÿçµæ´»ï¼›è€Œæ³›å‹æ–¹æ³•å¯ä»¥åœ¨è°ƒç”¨çš„æ—¶å€™æŒ‡æ˜ç±»å‹ï¼Œæ›´åŠ çµæ´»ã€‚</p><h4 id="æ³›å‹çš„ä¸Šé™å’Œä¸‹é™ï¼Ÿ"><a href="#æ³›å‹çš„ä¸Šé™å’Œä¸‹é™ï¼Ÿ" class="headerlink" title="æ³›å‹çš„ä¸Šé™å’Œä¸‹é™ï¼Ÿ"></a>æ³›å‹çš„ä¸Šé™å’Œä¸‹é™ï¼Ÿ</h4><p>åœ¨ä½¿ç”¨æ³›å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºä¼ å…¥çš„æ³›å‹ç±»å‹å®å‚è¿›è¡Œä¸Šä¸‹è¾¹ç•Œçš„é™åˆ¶ï¼Œå¦‚ï¼šç±»å‹å®å‚åªå‡†ä¼ å…¥æŸç§ç±»å‹çš„çˆ¶ç±»æˆ–æŸç§ç±»å‹çš„å­ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">list.add(<span class="number">12</span>);</span><br><span class="line"><span class="comment">//è¿™é‡Œç›´æ¥æ·»åŠ ä¼šæŠ¥é”™</span></span><br><span class="line">list.add(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">Class&lt;? <span class="keyword">extends</span> <span class="title class_">List</span>&gt; clazz = list.getClass();</span><br><span class="line"><span class="type">Method</span> <span class="variable">add</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;add&quot;</span>, Object.class);</span><br><span class="line"><span class="comment">//ä½†æ˜¯é€šè¿‡åå°„æ·»åŠ æ˜¯å¯ä»¥çš„</span></span><br><span class="line"><span class="comment">//è¿™å°±è¯´æ˜åœ¨è¿è¡ŒæœŸé—´æ‰€æœ‰çš„æ³›å‹ä¿¡æ¯éƒ½ä¼šè¢«æ“¦æ‰</span></span><br><span class="line">add.invoke(list, <span class="string">&quot;kl&quot;</span>);</span><br><span class="line">System.out.println(list);</span><br></pre></td></tr></table></figure><h3 id="64-å¸¸ç”¨çš„é€šé…ç¬¦æœ‰å“ªäº›ï¼Ÿ"><a href="#64-å¸¸ç”¨çš„é€šé…ç¬¦æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="64.å¸¸ç”¨çš„é€šé…ç¬¦æœ‰å“ªäº›ï¼Ÿ"></a><a href="">64.å¸¸ç”¨çš„é€šé…ç¬¦æœ‰å“ªäº›ï¼Ÿ</a></h3><p><strong>å¸¸ç”¨çš„é€šé…ç¬¦ä¸ºï¼š Tï¼ŒEï¼ŒKï¼ŒVï¼Œï¼Ÿ</strong></p><ul><li>ï¼Ÿ è¡¨ç¤ºä¸ç¡®å®šçš„ Java ç±»å‹</li><li>T (type) è¡¨ç¤ºå…·ä½“çš„ä¸€ä¸ª Java ç±»å‹</li><li>K V (key value) åˆ†åˆ«ä»£è¡¨ Java é”®å€¼ä¸­çš„ Key Value</li><li>E (element) ä»£è¡¨ Element</li></ul><h3 id="65-ä½•ä¸ºåå°„ï¼Ÿ"><a href="#65-ä½•ä¸ºåå°„ï¼Ÿ" class="headerlink" title="65.ä½•ä¸ºåå°„ï¼Ÿ"></a><a href="">65.ä½•ä¸ºåå°„ï¼Ÿ</a></h3><p>é€šè¿‡åå°„ä½ å¯ä»¥è·å–ä»»æ„ä¸€ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œä½ è¿˜å¯ä»¥è°ƒç”¨è¿™äº›æ–¹æ³•å’Œå±æ€§ã€‚</p><h4 id="åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹"><a href="#åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹" class="headerlink" title="åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹"></a>åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹</h4><ul><li><strong>ä¼˜ç‚¹</strong> ï¼š å¯ä»¥è®©å’±ä»¬çš„ä»£ç æ›´åŠ çµæ´»ã€ä¸ºå„ç§æ¡†æ¶æä¾›å¼€ç®±å³ç”¨çš„åŠŸèƒ½æä¾›äº†ä¾¿åˆ©</li><li><strong>ç¼ºç‚¹</strong> ï¼šè®©æˆ‘ä»¬åœ¨è¿è¡Œæ—¶æœ‰äº†åˆ†ææ“ä½œç±»çš„èƒ½åŠ›ï¼Œè¿™åŒæ ·ä¹Ÿå¢åŠ äº†å®‰å…¨é—®é¢˜ã€‚æ¯”å¦‚å¯ä»¥æ— è§†æ³›å‹å‚æ•°çš„å®‰å…¨æ£€æŸ¥ï¼ˆæ³›å‹å‚æ•°çš„å®‰å…¨æ£€æŸ¥å‘ç”Ÿåœ¨ç¼–è¯‘æ—¶ï¼‰ã€‚å¦å¤–ï¼Œåå°„çš„æ€§èƒ½ä¹Ÿè¦ç¨å·®ç‚¹ï¼Œä¸è¿‡ï¼Œå¯¹äºæ¡†æ¶æ¥è¯´å®é™…æ˜¯å½±å“ä¸å¤§çš„ã€‚</li></ul><h3 id="66-Java-ä¸­-IO-æµåˆ†ä¸ºå‡ ç§"><a href="#66-Java-ä¸­-IO-æµåˆ†ä¸ºå‡ ç§" class="headerlink" title="66.Java ä¸­ IO æµåˆ†ä¸ºå‡ ç§?"></a><a href="">66.Java ä¸­ IO æµåˆ†ä¸ºå‡ ç§?</a></h3><ul><li>æŒ‰ç…§æµçš„æµå‘åˆ†ï¼Œå¯ä»¥åˆ†ä¸ºè¾“å…¥æµå’Œè¾“å‡ºæµï¼›</li><li>æŒ‰ç…§æ“ä½œå•å…ƒåˆ’åˆ†ï¼Œå¯ä»¥åˆ’åˆ†ä¸ºå­—èŠ‚æµå’Œå­—ç¬¦æµï¼›</li><li>æŒ‰ç…§æµçš„è§’è‰²åˆ’åˆ†ä¸ºèŠ‚ç‚¹æµå’Œå¤„ç†æµã€‚</li></ul><p>Java IO æµå…±æ¶‰åŠ 40 å¤šä¸ªç±»ï¼Œ Java IO æµçš„ 40 å¤šä¸ªç±»éƒ½æ˜¯ä»å¦‚ä¸‹ 4 ä¸ªæŠ½è±¡ç±»åŸºç±»ä¸­æ´¾ç”Ÿå‡ºæ¥çš„ã€‚</p><ul><li>InputStream/Reader: æ‰€æœ‰çš„è¾“å…¥æµçš„åŸºç±»ï¼Œå‰è€…æ˜¯å­—èŠ‚è¾“å…¥æµï¼Œåè€…æ˜¯å­—ç¬¦è¾“å…¥æµã€‚</li><li>OutputStream/Writer: æ‰€æœ‰è¾“å‡ºæµçš„åŸºç±»ï¼Œå‰è€…æ˜¯å­—èŠ‚è¾“å‡ºæµï¼Œåè€…æ˜¯å­—ç¬¦è¾“å‡ºæµã€‚</li></ul><h3 id="67-æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ-ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ"><a href="#67-æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ-ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ" class="headerlink" title="67.æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ,ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ?"></a><a href="">67.æ—¢ç„¶æœ‰äº†å­—èŠ‚æµ,ä¸ºä»€ä¹ˆè¿˜è¦æœ‰å­—ç¬¦æµ?</a></h3><p>é—®é¢˜æœ¬è´¨æƒ³é—®ï¼š<strong>ä¸ç®¡æ˜¯æ–‡ä»¶è¯»å†™è¿˜æ˜¯ç½‘ç»œå‘é€æ¥æ”¶ï¼Œä¿¡æ¯çš„æœ€å°å­˜å‚¨å•å…ƒéƒ½æ˜¯å­—èŠ‚ï¼Œé‚£ä¸ºä»€ä¹ˆ I/O æµæ“ä½œè¦åˆ†ä¸ºå­—èŠ‚æµæ“ä½œå’Œå­—ç¬¦æµæ“ä½œå‘¢ï¼Ÿ</strong></p><p>å›ç­”ï¼šå­—ç¬¦æµæ˜¯ç”± Java è™šæ‹Ÿæœºå°†å­—èŠ‚è½¬æ¢å¾—åˆ°çš„ï¼Œé—®é¢˜å°±å‡ºåœ¨è¿™ä¸ªè¿‡ç¨‹è¿˜ç®—æ˜¯éå¸¸è€—æ—¶ï¼Œå¹¶ä¸”ï¼Œå¦‚æœæˆ‘ä»¬ä¸çŸ¥é“ç¼–ç ç±»å‹å°±å¾ˆå®¹æ˜“å‡ºç°ä¹±ç é—®é¢˜ã€‚æ‰€ä»¥ï¼Œ I/O æµå°±å¹²è„†æä¾›äº†ä¸€ä¸ªç›´æ¥æ“ä½œå­—ç¬¦çš„æ¥å£ï¼Œæ–¹ä¾¿æˆ‘ä»¬å¹³æ—¶å¯¹å­—ç¬¦è¿›è¡Œæµæ“ä½œã€‚å¦‚æœéŸ³é¢‘æ–‡ä»¶ã€å›¾ç‰‡ç­‰åª’ä½“æ–‡ä»¶ç”¨å­—èŠ‚æµæ¯”è¾ƒå¥½ï¼Œå¦‚æœæ¶‰åŠåˆ°å­—ç¬¦çš„è¯ä½¿ç”¨å­—ç¬¦æµæ¯”è¾ƒå¥½ã€‚</p><h3 id="68-javaå’Œcè¯­è¨€çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ"><a href="#68-javaå’Œcè¯­è¨€çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" class="headerlink" title="68.javaå’Œcè¯­è¨€çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ"></a><a href="">68.<strong>javaå’Œcè¯­è¨€çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ</strong></a></h3><p>ç›¸åŒçš„åœ°æ–¹ï¼š</p><p>ã€€ã€€1ã€è¯­æ³•ç±»ä¼¼ï¼š</p><p>ã€€ã€€ç”±äºJavaå¯ä»¥ç®—æ˜¯ä»C++å‘å±•è€Œæ¥çš„ï¼Œå› æ­¤Javaä¸Cè¯­è¨€çš„è¯­æ³•æ¯”è¾ƒç±»ä¼¼</p><p>ã€€ã€€2ã€ç¼–ç¨‹çš„ç†Ÿç»ƒç¨‹åº¦å°±æ˜¯å¯¹è¯­è¨€ç¨‹åºåº“çš„æŒæ¡ç¨‹åº¦ï¼š</p><p>ã€€ã€€ä»æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ï¼Œç¼–ç¨‹è¯­è¨€éƒ½æ˜¯ç”±è¯­æ³•å’Œç›¸åº”çš„ç¨‹åºåº“æ‰€æ„æˆï¼ŒJavaæœ‰è‡ªèº«çš„ç±»åº“ï¼ŒCè¯­è¨€åˆ™æœ‰æ ‡å‡†åº“ã€‚æ‰€è°“çš„ç¼–ç¨‹ï¼Œå°±æ˜¯ä½¿ç”¨ä¸è¯­æ³•æ¥è°ƒç”¨å’Œç»„åˆç¨‹åºåº“ä¸­çš„å‡½æ•°ã€‚</p><p>ã€€ã€€ä¸åŒçš„åœ°æ–¹ï¼š</p><p>ã€€ã€€1ã€å†…å­˜ç®¡ç†</p><p>ã€€ã€€åœ¨Javaä¸­ï¼ŒåŸºæœ¬ä¸ç”¨è€ƒè™‘å†…å­˜çš„é—®é¢˜ï¼Œå¦‚æœæƒ³ç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œnewä¸€ä¸ªå°±å¯ä»¥ï¼Œè¿™ä¸ªè¿‡ç¨‹çš„èƒŒååˆ™æ˜¯JREä¸ºå¯¹è±¡åˆ†ç±»çš„ä¸€å®šå†…å­˜ï¼Œå½“JREå‘ç°ä½ ä¸å†ä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä»–å°±ä¼šè‡ªåŠ¨å›æ”¶å†…å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ åªç®¡å€Ÿä¸œè¥¿ï¼Œä¸ç”¨ç®¡å½’è¿˜ï¼Œå› ä¸ºä¸æœ‰äººå½“ä½ çš„è·Ÿç­ï¼Œåœ¨ä½ ä¸ä½¿ç”¨çš„æ—¶å€™å°±æŠŠä¸œè¥¿å½’è¿˜äº†ï¼Œä¸è¿‡è¿™ä¸ªè¿‡ç¨‹è¿˜æ˜¯æœ‰çš„ï¼Œåªä¸è¿‡æ˜¯JREä½œçš„è€Œå·²ã€‚</p><p>ã€€ã€€ä½†æ˜¯Cåˆ™ä¸åŒï¼Œå¦‚æœä½ æƒ³ç”¨ï¼Œä½ å¯ä»¥ç”¨mallocä¹‹ç±»çš„æ–¹æ³•ç”³è¯·å†…å­˜ï¼Œå½“ä½ ä½¿ç”¨å®Œäº†ï¼Œå› ä¸ºæ²¡æœ‰è·Ÿç­çš„ï¼Œä½ éœ€è¦è‡ªå·±æŠŠè¿™å—å†…å­˜å½’è¿˜å›å»ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨freeæ–¹æ³•æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚ç”±äºéœ€è¦æ˜¾å¼çš„å½’è¿˜å†…å­˜ï¼Œå› æ­¤å½“ä¸€ä¸ªå‡½æ•°éœ€è¦å°†ä¸€å—å†…å­˜è¿”å›ç»™è°ƒç”¨è€…çš„æ—¶å€™ï¼Œé—®é¢˜å°±æ¯”è¾ƒå¤æ‚äº†ï¼Œä¸å¦‚é¢å‘å¯¹è±¡å’Œå…·æœ‰å†…å­˜å›æ”¶åŠŸèƒ½çš„Javaé‚£ä¹ˆç›´è§‚äº†ã€‚å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œåœ¨Cè¯­è¨€ä¸­ï¼Œæœ‰å‡ ç§è§£å†³æ–¹æ¡ˆï¼š</p><p>ã€€ã€€ï¼ˆ1ï¼‰ åœ¨è°ƒç”¨è€…ä¸­å…ˆåˆ†é…å¥½å†…å­˜ï¼Œä½œä¸ºå‚æ•°ä¼ å…¥åˆ°è¢«è°ƒç”¨çš„å‡½æ•°ä¸­</p><p>ã€€ã€€ï¼ˆ2ï¼‰ åœ¨è¢«è°ƒç”¨çš„å‡½æ•°ä¸­åˆ†é…ï¼Œä½¿ç”¨å®Œååœ¨è°ƒç”¨è€…ä¸­é‡Šæ”¾</p><p>ã€€ã€€ï¼ˆ3ï¼‰ åœ¨è¢«è°ƒç”¨å‡½æ•°ä¸­ä½¿ç”¨staticå˜é‡ï¼Œå¯ä»¥å°†è¯¥å˜é‡è¿”å›</p><p>ã€€ã€€2ã€é¢å‘å¯¹è±¡</p><p>ã€€ã€€Javaçš„é¢å‘å¯¹è±¡çš„ç‰¹ç‚¹å¾ˆæ˜æ˜¾ï¼Œè€ŒCåˆ™æ˜¯ä¸€ä¸ªåœ°é“çš„ç»“æ„åŒ–è¯­è¨€ã€‚ Javaä¸­æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ç±»Stringï¼Œ é€šè¿‡è°ƒç”¨ String.lengthï¼ˆï¼‰å°±å¯ä»¥çŸ¥é“å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä½†æ˜¯åœ¨Cè¯­è¨€ä¸­ï¼Œåˆ™éœ€è¦è°ƒç”¨å‡½æ•°strlenï¼ˆstrï¼‰æ¥å¾—åˆ°å­—ç¬¦ä¸²ï¼ˆå­—ç¬¦æ•°ç»„ï¼‰çš„é•¿åº¦ã€‚ç”±äºCä¸æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œä¹Ÿå°±æ²¡æœ‰thisçš„æ¦‚å¿µï¼Œå› æ­¤å½“ä½¿ç”¨ä¸€ä¸ªä¸æŸä¸ªâ€œä¸œè¥¿â€ç›¸å…³çš„å‡½æ•°æ—¶ï¼Œå°±éœ€è¦ä¸åŒå…¶çƒ¦çš„å°†ä»£è¡¨è¿™ä¸ªâ€œä¸œè¥¿â€çš„å˜é‡ä½œä¸ºå‚æ•°ä¼ é€’è¿›å»ã€‚</p><p>ã€€ã€€3ã€åç§°ç©ºé—´</p><p>ã€€ã€€Javaé€šè¿‡åŒ…ï¼ˆpackageï¼‰æ¥å®ç°åç§°ç©ºé—´ï¼Œåœ¨Cè¯­è¨€ä¸­ï¼Œæ‰€æœ‰çš„å‡½æ•°éƒ½å¤„äºåŒä¸€åç§°ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰åç§°ç©ºé—´ï¼Œå› æ­¤å°±ä¼šå¾ˆå¤šç¨‹åºæä¾›çš„apiæ¥å£å‡½æ•°éƒ½æœ‰ä¸€ä¸ªå‰ç¼€ï¼Œä¾‹å¦‚MYSQLçš„mysql<em>initï¼ˆï¼‰ï¼Œ mysql_real_connectï¼ˆï¼‰ï¼Œ mysql_real_queryï¼ˆï¼‰ç­‰å‡½æ•°åç§°å‰é¢çš„mysql</em>ã€‚</p><h3 id="69-intç±»å‹å’Œlongç±»å‹ç›¸åŠ ï¼Œç»“æœæ˜¯ä»€ä¹ˆç±»å‹-ç¾å›¢"><a href="#69-intç±»å‹å’Œlongç±»å‹ç›¸åŠ ï¼Œç»“æœæ˜¯ä»€ä¹ˆç±»å‹-ç¾å›¢" class="headerlink" title="69.intç±»å‹å’Œlongç±»å‹ç›¸åŠ ï¼Œç»“æœæ˜¯ä»€ä¹ˆç±»å‹(ç¾å›¢)"></a><a href="">69.intç±»å‹å’Œlongç±»å‹ç›¸åŠ ï¼Œç»“æœæ˜¯ä»€ä¹ˆç±»å‹(ç¾å›¢)</a></h3><p>ç»“æœæ˜¯longç±»å‹ï¼Œintç±»å‹ä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹æå‡</p><p><a href="https://segmentfault.com/a/1190000020905371">https://segmentfault.com/a/1190000020905371</a></p><h3 id="70-static-å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨"><a href="#70-static-å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨" class="headerlink" title="70.static å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨"></a><a href="">70.static å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨</a></h3><p>staticå…³é”®å­—å¯ä»¥ç”¨æ¥ä¿®é¥°ä»£ç å—è¡¨ç¤ºé™æ€ä»£ç å—ï¼Œä¿®é¥°æˆå‘˜å˜é‡è¡¨ç¤ºå…¨å±€é™æ€æˆå‘˜å˜é‡ï¼Œä¿®é¥°æ–¹æ³•è¡¨ç¤ºé™æ€æ–¹æ³•ã€‚(æ³¨æ„ï¼šä¸èƒ½ä¿®é¥°æ™®é€šç±»ï¼Œé™¤äº†å†…éƒ¨ç±»ï¼‰</p><p>é™æ€æ˜¯ç›¸å¯¹äºåŠ¨æ€çš„ï¼ŒåŠ¨æ€æ˜¯æŒ‡Javaç¨‹åºåœ¨JVMä¸Šè¿è¡Œæ—¶ï¼ŒJVMä¼šæ ¹æ®ç¨‹åºçš„éœ€è¦åŠ¨æ€åˆ›å»ºå¯¹è±¡å¹¶å­˜å‚¨å¯¹è±¡(åˆ†é…å†…å­˜)ï¼Œå¯¹è±¡ä½¿å‘½ç»“æŸåï¼Œå¯¹è±¡ä¼šè¢«åƒåœ¾å›æ”¶å™¨é”€æ¯ï¼Œå³å†…å­˜å›æ”¶ç”±JVMç»Ÿä¸€ç®¡ç†å¹¶åˆ†é…ç»™å…¶ä»–æ–°åˆ›å»ºçš„å¯¹è±¡ï¼›é™æ€æ˜¯æŒ‡Javaç¨‹åºè¿˜æ²¡æœ‰è¿è¡Œæ—¶ï¼ŒJVMå°±ä¼šä¸ºåŠ è½½çš„ç±»åˆ†é…ç©ºé—´å­˜å‚¨è¢«staticå…³é”®å­—ä¿®é¥°çš„å†…å®¹ï¼›å¦‚é™æ€æˆå‘˜å˜é‡ï¼ŒJavaç±»åŠ è½½åˆ°JVMä¸­ï¼ŒJVMä¼šæŠŠç±»ä»¥åŠç±»çš„é™æ€æˆå‘˜å˜é‡å­˜å‚¨åœ¨æ–¹æ³•åŒºï¼Œæˆ‘ä»¬çŸ¥é“æ–¹æ³•åŒºæ˜¯çº¿ç¨‹å…±äº«ä¸”å¾ˆå°‘å‘ç”ŸGCçš„åŒºåŸŸï¼Œæ‰€ä»¥è¢«staticå…³é”®å­—ä¿®é¥°çš„å†…å®¹éƒ½æ˜¯å…¨å±€å…±äº«çš„ï¼Œä¸”åªä¼šä¸ºå…¶åˆ†é…ä¸€æ¬¡å­˜å‚¨ç©ºé—´ã€‚</p><p>æ‰€ä»¥å½“ç±»çš„æŸäº›å†…å®¹ä¸å±äºå¯¹è±¡ï¼Œè€Œç”±å¯¹è±¡å…±äº«å³å±äºç±»çš„æ—¶å€™ï¼Œå°±å¯ä»¥è€ƒè™‘æ˜¯å¦ç”¨staticå…³é”®å­—è¿›è¡Œä¿®é¥°ã€‚</p><p><strong>staticå…³é”®å­—çš„çš„ä½œç”¨</strong></p><p><strong>1 ä¿®é¥°ä»£ç å—</strong></p><p>ç±»ä¸­ç”¨staticå…³é”®å­—ä¿®é¥°çš„ä»£ç å—ç§°ä¸ºé™æ€ä»£ç ï¼Œåä¹‹æ²¡æœ‰ç”¨staticå…³é”®å­—ä¿®é¥°çš„ä»£ç å—ç§°ä¸ºå®ä¾‹ä»£ç å—ã€‚</p><p>å®ä¾‹ä»£ç å—ä¼šéšç€å¯¹è±¡çš„åˆ›å»ºè€Œæ‰§è¡Œï¼Œå³æ¯ä¸ªå¯¹è±¡éƒ½ä¼šæœ‰è‡ªå·±çš„å®ä¾‹ä»£ç å—ï¼Œè¡¨ç°å‡ºæ¥å°±æ˜¯å®ä¾‹ä»£ç å—çš„è¿è¡Œç»“æœä¼šå½±å“å½“å‰å¯¹è±¡çš„å†…å®¹ï¼Œå¹¶éšç€å¯¹è±¡çš„é”€æ¯è€Œæ¶ˆå¤±(å†…å­˜å›æ”¶)ï¼›è€Œé™æ€ä»£ç å—æ˜¯å½“Javaç±»åŠ è½½åˆ°JVMå†…å­˜ä¸­è€Œæ‰§è¡Œçš„ä»£ç å—ï¼Œç”±äºç±»çš„åŠ è½½åœ¨JVMè¿è¡ŒæœŸé—´åªä¼šå‘ç”Ÿä¸€æ¬¡ï¼Œæ‰€ä»¥é™æ€ä»£ç å—ä¹Ÿåªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</p><p>å› ä¸ºé™æ€ä»£ç å—çš„ä¸»è¦ä½œç”¨æ˜¯ç”¨æ¥è¿›è¡Œä¸€äº›å¤æ‚çš„åˆå§‹åŒ–å·¥ä½œï¼Œæ‰€ä»¥é™æ€ä»£ç å—è·Ÿéšç±»å­˜å‚¨åœ¨æ–¹æ³•åŒºçš„è¡¨ç°å½¢å¼æ˜¯é™æ€ä»£ç å—æ‰§è¡Œçš„ç»“æœå­˜å‚¨åœ¨æ–¹æ³•åŒºï¼Œå³åˆå§‹åŒ–é‡å­˜å‚¨åœ¨æ–¹æ³•åŒºå¹¶è¢«çº¿ç¨‹å…±äº«ã€‚</p><p><strong>2 ä¿®é¥°æˆå‘˜å˜é‡</strong></p><p>ç±»ä¸­ç”¨staticå…³é”®å­—ä¿®é¥°çš„æˆå‘˜å˜é‡ç§°ä¸ºé™æ€æˆå‘˜å˜é‡ï¼Œå› ä¸ºstaticä¸èƒ½ä¿®é¥°å±€éƒ¨å˜é‡(ä¸ºä»€ä¹ˆï¼Ÿ)ï¼Œå› æ­¤é™æ€æˆå‘˜å˜é‡ä¹Ÿèƒ½ç§°ä¸ºé™æ€å˜é‡ã€‚é™æ€å˜é‡è·Ÿä»£ç å—ç±»ä¼¼ï¼Œåœ¨ç±»åŠ è½½åˆ°JVMå†…å­˜ä¸­ï¼ŒJVMä¼šæŠŠé™æ€å˜é‡æ”¾å…¥æ–¹æ³•åŒºå¹¶åˆ†é…å†…å­˜ï¼Œä¹Ÿç”±çº¿ç¨‹å…±äº«ã€‚è®¿é—®å½¢å¼æ˜¯ï¼šç±»å.é™æ€æˆå‘˜åã€‚</p><p>ä¸€ä¸ªç±»çš„é™æ€å˜é‡å’Œè¯¥ç±»çš„é™æ€ä»£ç å—çš„åŠ è½½é¡ºåºã€‚ç±»ä¼šä¼˜å…ˆåŠ è½½é™æ€å˜é‡ï¼Œç„¶ååŠ è½½é™æ€ä»£ç å—ï¼Œä½†æœ‰å¤šä¸ªé™æ€å˜é‡å’Œå¤šä¸ªä»£ç å—æ—¶ï¼Œä¼šæŒ‰ç…§ç¼–å†™çš„é¡ºåºè¿›è¡ŒåŠ è½½ã€‚</p><p><strong>staticå…³é”®ä¸èƒ½ä¿®é¥°å±€éƒ¨å˜é‡ï¼ŒåŒ…æ‹¬å®ä¾‹æ–¹æ³•å’Œé™æ€æ–¹æ³•ï¼Œä¸ç„¶å°±ä¼šä¸staticå…³é”®å­—çš„åˆè¡·-å…±äº«ç›¸è¿èƒŒã€‚</strong></p><p><strong>3 ä¿®é¥°æ–¹æ³•</strong></p><p>ç”¨staticå…³é”®å­—ä¿®é¥°çš„æ–¹æ³•ç§°ä¸ºé™æ€æ–¹æ³•ï¼Œå¦åˆ™ç§°ä¸ºå®ä¾‹æ–¹æ³•ã€‚é€šè¿‡ç±»å.æ–¹æ³•åè°ƒç”¨ï¼Œä½†éœ€è¦æ³¨æ„é™æ€æ–¹æ³•å¯ä»¥ç›´æ¥è°ƒç”¨ç±»çš„é™æ€å˜é‡å’Œå…¶ä»–é™æ€æ–¹æ³•ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨æˆå‘˜å˜é‡å’Œå®ä¾‹æ–¹æ³•(é™¤éé€šè¿‡å¯¹è±¡è°ƒç”¨)ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šæ—¢ç„¶ç±»çš„å®ä¾‹æ–¹æ³•éœ€è¦å¯¹è±¡è°ƒç”¨æ‰èƒ½è®¿é—®ï¼Œè€Œé™æ€æ–¹æ³•ç›´æ¥é€šè¿‡ç±»åå°±èƒ½è®¿é—®ï¼Œé‚£ä¹ˆåœ¨ä¸è€ƒè™‘éƒ¨ç½²æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç±»æ˜¯å¦‚ä½•å¼€å§‹æ‰§è¡Œçš„å‘¢ï¼Ÿæœ€å¤§çš„å¯èƒ½å°±æ˜¯é€šè¿‡â€œç±»å.é™æ€æ–¹æ³•â€å¯åŠ¨Javaï¼Œè€Œæˆ‘å®šä¹‰é‚£ä¹ˆå¤šé™æ€æ–¹æ³•ï¼ŒJVMåˆæ˜¯å¦‚ä½•çŸ¥é“ä¸»å…¥å£å‘¢ï¼Ÿ</p><p>æˆ–è®¸ï¼Œä½ æƒ³åˆ°äº†mainæ–¹æ³•ã€‚</p><p>æ²¡é”™ï¼Œå°±æ˜¯mainæ–¹æ³•è¢«Javaè§„èŒƒå®šä¹‰æˆJavaç±»çš„ä¸»å…¥å£ã€‚Javaç±»çš„è¿è¡Œéƒ½ç”±mainæ–¹æ³•å¼€å¯</p><p><strong>staticå…³é”®å­—çš„ç¼ºç‚¹</strong></p><p>å°è£…æ˜¯Javaç±»çš„ä¸‰å¤§ç‰¹æ€§ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯é¢å‘å¯¹è±¡çš„ä¸»è¦ç‰¹æ€§ã€‚å› ä¸ºä¸éœ€è¦é€šè¿‡å¯¹è±¡ï¼Œè€Œç›´æ¥é€šè¿‡ç±»å°±èƒ½è®¿é—®ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™æœ‰ç‚¹ç ´åç±»çš„å°è£…æ€§ï¼›æ‰€ä»¥é™¤äº†Utilsç±»ï¼Œä»£ç ä¸­åº”è¯¥å°½é‡å°‘ç”¨staticå…³é”®å­—ä¿®é¥°å˜é‡å’Œæ–¹æ³•ã€‚</p><h3 id="71-Tomcatå¤„ç†HTTPè¯·æ±‚è¿‡ç¨‹åˆ†æï¼ˆèœé¸Ÿç½‘ç»œï¼‰"><a href="#71-Tomcatå¤„ç†HTTPè¯·æ±‚è¿‡ç¨‹åˆ†æï¼ˆèœé¸Ÿç½‘ç»œï¼‰" class="headerlink" title="71.Tomcatå¤„ç†HTTPè¯·æ±‚è¿‡ç¨‹åˆ†æï¼ˆèœé¸Ÿç½‘ç»œï¼‰"></a><a href="">71.Tomcatå¤„ç†HTTPè¯·æ±‚è¿‡ç¨‹åˆ†æï¼ˆèœé¸Ÿç½‘ç»œï¼‰</a></h3><p>Tomcatæ˜¯ä¸€ä¸ªwebåº”ç”¨æœåŠ¡å™¨ï¼Œæ˜¯ä¸€ä¸ªServlet/Jspå®¹å™¨ï¼Œä¸»è¦è´Ÿè´£å°†å®¢æˆ·ç«¯è¯·æ±‚ä¼ é€’ç»™å¯¹åº”çš„Servletï¼Œå¹¶ä¸”å°†Servletçš„å“åº”æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/20181214143933248.jpg" alt=""></p><p>Tomcatçš„å¿ƒè„æ˜¯ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šConnectorï¼ˆè¿æ¥å™¨ï¼‰å’ŒContainerï¼ˆå®¹å™¨ï¼‰ã€‚å…¶ä¸­ä¸€ä¸ªContainerå¯ä»¥é€‰æ‹©å¤šä¸ªConnectorã€‚</p><p>redirectPortå­—é¢æ„æ€æ˜¯é‡å®šå‘ç«¯å£ã€‚å½“ç”¨æˆ·ç”¨httpè¯·æ±‚æŸä¸ªèµ„æºï¼Œè€Œè¯¥èµ„æºæœ¬èº«åˆè¢«è®¾ç½®äº†å¿…é¡»è¦httpsæ–¹å¼è®¿é—®ï¼Œæ­¤æ—¶Tomcatä¼šè‡ªåŠ¨é‡å®šå‘åˆ°è¿™ä¸ªredirectPortè®¾ç½®çš„httpsç«¯å£ã€‚</p><h4 id="1ã€Connectorç»„ä»¶"><a href="#1ã€Connectorç»„ä»¶" class="headerlink" title="1ã€Connectorç»„ä»¶"></a><strong>1ã€Connectorç»„ä»¶</strong></h4><p>Connector æœ€é‡è¦çš„åŠŸèƒ½å°±æ˜¯æ¥æ”¶è¿æ¥è¯·æ±‚ç„¶ååˆ†é…çº¿ç¨‹è®© Containeræ¥å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œæ‰€ä»¥è¿™å¿…ç„¶æ˜¯å¤šçº¿ç¨‹çš„ï¼Œå¤šçº¿ç¨‹çš„å¤„ç†æ˜¯ Connector è®¾è®¡çš„æ ¸å¿ƒã€‚Connectorç›‘å¬æŒ‡å®šç«¯å£ä¸Šè¯·æ±‚ï¼Œå½“è¯·æ±‚åˆ°æ¥æ—¶åˆ›å»ºä¸€ä¸ªrequestå’Œresponseå¯¹è±¡äº¤æ¢æ•°æ®ï¼Œç„¶åæ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†è¯·æ±‚å¹¶æŠŠrequestå’Œresponseä¼ é€’ç»™Engineç»„ä»¶ï¼Œæœ€åä»Engineè·å–ä¸€ä¸ªå“åº”å¹¶è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>Connectorç»„ä»¶å¸¸ç”¨å±æ€§è¯´æ˜ï¼š</p><p>ï¼ˆ1ï¼‰ addressï¼šæŒ‡å®šè¿æ¥å™¨ç›‘å¬çš„åœ°å€ï¼Œé»˜è®¤ä¸ºæ‰€æœ‰åœ°å€ï¼Œå³0.0.0.0ï¼Œå¯ä»¥è‡ªå·±æŒ‡å®šåœ°ã€‚ï¼ˆ2ï¼‰ maxThreadsï¼šæ”¯æŒçš„æœ€å¤§å¹¶å‘è¿æ¥æ•°ï¼Œé»˜è®¤ä¸º200ï¼›</p><p>ï¼ˆ3ï¼‰ portï¼šç›‘å¬çš„ç«¯å£ï¼›</p><p>ï¼ˆ4ï¼‰ protocolï¼šè¿æ¥å™¨ä½¿ç”¨çš„åè®®ï¼Œé»˜è®¤ä¸ºHTTP/1.1ï¼Œå®šä¹‰AJPåè®®æ—¶é€šå¸¸ä¸ºAJP/1.3ï¼›</p><p>ï¼ˆ5ï¼‰ redirectPortï¼šå¦‚æœæŸè¿æ¥å™¨æ”¯æŒçš„åè®®æ˜¯HTTPï¼Œå½“æ¥æ”¶å®¢æˆ·ç«¯å‘æ¥çš„HTTPSè¯·æ±‚æ—¶ï¼Œåˆ™è½¬å‘è‡³æ­¤å±æ€§å®šä¹‰çš„ç«¯å£ï¼›</p><p>ï¼ˆ6ï¼‰ connectionTimeoutï¼šç­‰å¾…å®¢æˆ·ç«¯å‘é€è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ï¼Œé»˜è®¤ä¸º60000ï¼Œå³1åˆ†é’Ÿï¼›</p><p>ï¼ˆ7ï¼‰ enableLookupsï¼šæ˜¯å¦é€šè¿‡request.getRemoteHost()è¿›è¡ŒDNSæŸ¥è¯¢ä»¥è·å–å®¢æˆ·ç«¯çš„ä¸»æœºåï¼›é»˜è®¤ä¸ºtrueï¼› è¿›è¡Œåè§£çš„ï¼Œå¯ä»¥è®¾ç½®ä¸ºfalseã€‚</p><p>ï¼ˆ8ï¼‰ acceptCountï¼šè®¾ç½®ç­‰å¾…é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦ï¼›é€šå¸¸åœ¨tomcatæ‰€æœ‰å¤„ç†çº¿ç¨‹å‡å¤„äºç¹å¿™çŠ¶æ€æ—¶ï¼Œæ–°å‘æ¥çš„è¯·æ±‚å°†è¢«æ”¾ç½®äºç­‰å¾…é˜Ÿåˆ—ä¸­ï¼›</p><h4 id="2-containerç»„ä»¶"><a href="#2-containerç»„ä»¶" class="headerlink" title="2.containerç»„ä»¶"></a><strong>2.containerç»„ä»¶</strong></h4><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/20181214144120710.jpg" alt=""></p><p>Containeræ˜¯å®¹å™¨çš„çˆ¶æ¥å£ï¼Œè¯¥å®¹å™¨çš„è®¾è®¡ç”¨çš„æ˜¯å…¸å‹çš„è´£ä»»é“¾çš„è®¾è®¡æ¨¡å¼ï¼Œå®ƒç”±å››ä¸ªè‡ªå®¹å™¨ç»„ä»¶æ„æˆï¼Œåˆ†åˆ«æ˜¯Engineã€Hostã€Contextã€Wrapperã€‚è¿™å››ä¸ªç»„ä»¶æ˜¯è´Ÿè´£å…³ç³»ï¼Œå­˜åœ¨åŒ…å«å…³ç³»ã€‚é€šå¸¸ä¸€ä¸ªServlet classå¯¹åº”ä¸€ä¸ªWrapperï¼Œå¦‚æœæœ‰å¤šä¸ªServletåˆ™å®šä¹‰å¤šä¸ªWrapperï¼Œå¦‚æœæœ‰å¤šä¸ªWrapperå°±è¦å®šä¹‰ä¸€ä¸ªæ›´é«˜çš„Containerï¼Œå¦‚Contextã€‚ Contextå®šä¹‰åœ¨çˆ¶å®¹å™¨ Host ä¸­ï¼Œå…¶ä¸­Host ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯è¦è¿è¡Œ war ç¨‹åºï¼Œå°±å¿…é¡»è¦ Hostï¼Œå› ä¸º war ä¸­å¿…æœ‰ web.xml æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„è§£æå°±éœ€è¦ Host äº†ï¼Œå¦‚æœè¦æœ‰å¤šä¸ª Host å°±è¦å®šä¹‰ä¸€ä¸ª top å®¹å™¨ Engine äº†ã€‚è€Œ Engine æ²¡æœ‰çˆ¶å®¹å™¨äº†ï¼Œä¸€ä¸ª Engine ä»£è¡¨ä¸€ä¸ªå®Œæ•´çš„ Servlet å¼•æ“ã€‚</p><p>2.1ã€Engine<br>Engineæ˜¯Servletå¤„ç†å™¨çš„ä¸€ä¸ªå®ä¾‹ï¼Œå³servletå¼•æ“ï¼Œé»˜è®¤ä¸ºå®šä¹‰åœ¨server.xmlä¸­çš„Catalinaã€‚Engineéœ€è¦defaultHostå±æ€§æ¥ä¸ºå…¶å®šä¹‰ä¸€ä¸ªæ¥æ”¶æ‰€æœ‰è¯·æ±‚çš„è™šæ‹Ÿä¸»æœºhostç»„ä»¶ã€‚</p><p>2.2ã€Host<br>Hostæ˜¯Engineçš„å­å®¹å™¨ã€‚ä¸€ä¸ª Host åœ¨ Engine ä¸­ä»£è¡¨ä¸€ä¸ªè™šæ‹Ÿä¸»æœºï¼Œè¿™ä¸ªè™šæ‹Ÿä¸»æœºçš„ä½œç”¨å°±æ˜¯è¿è¡Œå¤šä¸ªåº”ç”¨ã€æ¥æ”¶å¹¶å¤„ç†è¯·æ±‚ã€ä¿å­˜ä¸€ä¸ªä¸»æœºåº”è¯¥æœ‰çš„ä¿¡æ¯ã€‚</p><p>å¸¸ç”¨å±æ€§è¯´æ˜ï¼š</p><p>ï¼ˆ1ï¼‰appBaseï¼šæ­¤Hostçš„webappsç›®å½•ï¼Œé¡¹ç›®å­˜æ”¾è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼›</p><p>ï¼ˆ2ï¼‰autoDeployï¼šåœ¨Tomcatå¤„äºè¿è¡ŒçŠ¶æ€æ—¶æ”¾ç½®äºappBaseç›®å½•ä¸­çš„åº”ç”¨ç¨‹åºæ–‡ä»¶æ˜¯å¦è‡ªåŠ¨è¿›è¡Œdeployï¼›é»˜è®¤ä¸ºtrueï¼›</p><p>ï¼ˆ3ï¼‰unpackWarsï¼šåœ¨å¯ç”¨æ­¤webappsæ—¶æ˜¯å¦å¯¹WARæ ¼å¼çš„å½’æ¡£æ–‡ä»¶å…ˆè¿›è¡Œå±•å¼€ï¼›é»˜è®¤ä¸ºtrueï¼›</p><p>2.3ã€Context<br>Context ä»£è¡¨ Servlet çš„ Contextï¼Œå®ƒå…·å¤‡äº† Servlet è¿è¡Œçš„åŸºæœ¬ç¯å¢ƒï¼Œç†è®ºä¸Šåªè¦æœ‰ Context å°±èƒ½è¿è¡Œ Servlet äº†ã€‚ç®€å•çš„ Tomcat å¯ä»¥æ²¡æœ‰ Engine å’Œ Hostã€‚Context æœ€é‡è¦çš„åŠŸèƒ½å°±æ˜¯ç®¡ç†å®ƒé‡Œé¢çš„ Servlet å®ä¾‹ï¼ŒServlet å®ä¾‹åœ¨ Context ä¸­æ˜¯ä»¥ Wrapper å‡ºç°çš„ï¼Œè¿˜æœ‰ä¸€ç‚¹å°±æ˜¯ Context å¦‚ä½•æ‰èƒ½æ‰¾åˆ°æ­£ç¡®çš„ Servlet æ¥æ‰§è¡Œå®ƒå‘¢ï¼Ÿ Tomcat5 ä»¥å‰æ˜¯é€šè¿‡ä¸€ä¸ª Mapper ç±»æ¥ç®¡ç†çš„ï¼ŒTomcat5 ä»¥åè¿™ä¸ªåŠŸèƒ½è¢«ç§»åˆ°äº† request ä¸­ï¼Œåœ¨å‰é¢çš„æ—¶åºå›¾ä¸­å°±å¯ä»¥å‘ç°è·å–å­å®¹å™¨éƒ½æ˜¯é€šè¿‡ request æ¥åˆ†é…çš„</p><p>å¸¸ç”¨å±æ€§å®šä¹‰ï¼š</p><p>ï¼ˆ1ï¼‰ docBaseï¼šç›¸åº”çš„Webåº”ç”¨ç¨‹åºçš„å­˜æ”¾ä½ç½®ï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œèµ·å§‹è·¯å¾„ä¸ºæ­¤Contextæ‰€å±Hostä¸­appBaseå®šä¹‰çš„è·¯å¾„ï¼›åˆ‡è®°ï¼ŒdocBaseçš„è·¯å¾„åä¸èƒ½ä¸ç›¸åº”çš„Hostä¸­appBaseä¸­å®šä¹‰çš„è·¯å¾„åæœ‰åŒ…å«å…³ç³»ï¼Œæ¯”å¦‚ï¼Œå¦‚æœappBaseä¸ºdeployï¼Œè€ŒdocBaseç»ä¸èƒ½ä¸ºdeploy-bbsç±»çš„åå­—ï¼›</p><p>ï¼ˆ2ï¼‰pathï¼šç›¸å¯¹äºWebæœåŠ¡å™¨æ ¹è·¯å¾„è€Œè¨€çš„URIï¼›å¦‚æœä¸ºç©ºâ€œâ€ï¼Œåˆ™è¡¨ç¤ºä¸ºæ­¤webappçš„æ ¹è·¯å¾„ï¼›å¦‚æœcontextå®šä¹‰åœ¨ä¸€ä¸ªå•ç‹¬çš„xmlæ–‡ä»¶ä¸­ï¼Œæ­¤å±æ€§ä¸éœ€è¦å®šä¹‰ï¼Œæœ‰å¯èƒ½æ˜¯åˆ«åï¼›</p><p>ï¼ˆ3ï¼‰ reloadableï¼šæ˜¯å¦å…è®¸é‡æ–°åŠ è½½æ­¤contextç›¸å…³çš„Webåº”ç”¨ç¨‹åºçš„ç±»ï¼›é»˜è®¤ä¸ºfalseï¼›</p><p>2.4ã€Wrapper<br>Wrapper ä»£è¡¨ä¸€ä¸ª Servletï¼Œå®ƒè´Ÿè´£ç®¡ç†ä¸€ä¸ª Servletï¼ŒåŒ…æ‹¬Servlet çš„è£…è½½ã€åˆå§‹åŒ–ã€æ‰§è¡Œä»¥åŠèµ„æºå›æ”¶ã€‚Wrapper æ˜¯æœ€åº•å±‚çš„å®¹å™¨ï¼Œå®ƒæ²¡æœ‰å­å®¹å™¨äº†ï¼Œæ‰€ä»¥è°ƒç”¨å®ƒçš„ addChild å°†ä¼šæŠ¥é”™ã€‚ Wrapper çš„å®ç°ç±»æ˜¯ StandardWrapperï¼ŒStandardWrapper è¿˜å®ç°äº† ServletConfigï¼Œç”±æ­¤çœ‹å‡º StandardWrapper å°†ç›´æ¥å’Œ Servlet çš„å„ç§ä¿¡æ¯æ‰“äº¤é“ã€‚</p><p>2.5ã€Realm<br>Wrapper ä»£è¡¨ä¸€ä¸ª Servletï¼Œå®ƒè´Ÿè´£ç®¡ç†ä¸€ä¸ª Servletï¼ŒåŒ…æ‹¬çš„ Servlet çš„è£…è½½ã€åˆå§‹åŒ–ã€æ‰§è¡Œä»¥åŠèµ„æºå›æ”¶ã€‚Wrapper æ˜¯æœ€åº•å±‚çš„å®¹å™¨ï¼Œå®ƒæ²¡æœ‰å­å®¹å™¨äº†ï¼Œæ‰€ä»¥è°ƒç”¨å®ƒçš„ addChild å°†ä¼šæŠ¥é”™ã€‚ Wrapper çš„å®ç°ç±»æ˜¯ StandardWrapperï¼ŒStandardWrapper è¿˜å®ç°äº†æ‹¥æœ‰ä¸€ä¸ª Servlet åˆå§‹åŒ–ä¿¡æ¯çš„ ServletConfigï¼Œç”±æ­¤çœ‹å‡º StandardWrapper å°†ç›´æ¥å’Œ Servlet çš„å„ç§ä¿¡æ¯æ‰“äº¤é“ã€‚</p><p>2.6ã€Value<br>Valveç±»ä¼¼äºè¿‡æ»¤å™¨ï¼Œå®ƒå¯ä»¥å·¥ä½œäºEngineå’ŒHost/Contextä¹‹é—´ã€Hostå’ŒContextä¹‹é—´ä»¥åŠContextå’ŒWebåº”ç”¨ç¨‹åºçš„æŸèµ„æºä¹‹é—´ã€‚ä¸€ä¸ªå®¹å™¨å†…å¯ä»¥å»ºç«‹å¤šä¸ªValveï¼Œè€Œä¸”Valveå®šä¹‰çš„æ¬¡åºä¹Ÿå†³å®šäº†å®ƒä»¬ç”Ÿæ•ˆçš„æ¬¡åºã€‚</p><h4 id="Tomcatå¤„ç†ä¸€ä¸ªHTTPè¯·æ±‚çš„è¿‡ç¨‹"><a href="#Tomcatå¤„ç†ä¸€ä¸ªHTTPè¯·æ±‚çš„è¿‡ç¨‹" class="headerlink" title="Tomcatå¤„ç†ä¸€ä¸ªHTTPè¯·æ±‚çš„è¿‡ç¨‹"></a>Tomcatå¤„ç†ä¸€ä¸ªHTTPè¯·æ±‚çš„è¿‡ç¨‹</h4><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/20181214144140580.jpg" alt=""></p><p>1.ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ç½‘å€localhost:8080/test/index.jspï¼Œè¯·æ±‚è¢«å‘é€åˆ°æœ¬æœºç«¯å£8080ï¼Œè¢«åœ¨é‚£é‡Œç›‘å¬çš„Coyote HTTP/1.1 Connectorè·å¾—ï¼›</p><p>2.ConnectoræŠŠè¯¥è¯·æ±‚äº¤ç»™å®ƒæ‰€åœ¨çš„Serviceçš„Engineï¼ˆContainerï¼‰æ¥å¤„ç†ï¼Œå¹¶ç­‰å¾…Engineçš„å›åº”ï¼›</p><p>3.Engineè·å¾—è¯·æ±‚localhost/test/index.jspï¼ŒåŒ¹é…æ‰€æœ‰çš„è™šæ‹Ÿä¸»æœºHostï¼›</p><p>4.EngineåŒ¹é…åˆ°åä¸ºlocalhostçš„Hostï¼ˆå³ä½¿åŒ¹é…ä¸åˆ°ä¹ŸæŠŠè¯·æ±‚äº¤ç»™è¯¥Hostå¤„ç†ï¼Œå› ä¸ºè¯¥Hostè¢«å®šä¹‰ä¸ºè¯¥Engineçš„é»˜è®¤ä¸»æœºï¼‰ã€‚åä¸ºlocalhostçš„Hostè·å¾—è¯·æ±‚/test/index.jspï¼ŒåŒ¹é…å®ƒæ‰€æ‹¥æœ‰çš„æ‰€æœ‰Contextã€‚HoståŒ¹é…åˆ°è·¯å¾„ä¸º/testçš„Contextï¼ˆå¦‚æœåŒ¹é…ä¸åˆ°å°±æŠŠè¯¥è¯·æ±‚äº¤ç»™è·¯å¾„åä¸ºâ€œ â€çš„Contextå»å¤„ç†ï¼‰ï¼›</p><p>5.path=â€œ/testâ€çš„Contextè·å¾—è¯·æ±‚/index.jspï¼Œåœ¨å®ƒçš„mapping tableä¸­å¯»æ‰¾å‡ºå¯¹åº”çš„Servletã€‚ContextåŒ¹é…åˆ°URL Patternä¸º*.jspçš„Servletï¼Œå¯¹åº”äºJspServletç±»ï¼›</p><p>6.æ„é€ HttpServletRequestå¯¹è±¡å’ŒHttpServletResponseå¯¹è±¡ï¼Œä½œä¸ºå‚æ•°è°ƒç”¨JspServletçš„doGet()æˆ–doPost(),æ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€æ•°æ®å­˜å‚¨ç­‰ï¼›</p><p>7.ContextæŠŠæ‰§è¡Œå®Œä¹‹åçš„HttpServletResponseå¯¹è±¡è¿”å›ç»™Hostï¼›</p><p>8.HostæŠŠHttpServletResponseå¯¹è±¡è¿”å›ç»™Engineï¼›</p><p>9.EngineæŠŠHttpServletResponseå¯¹è±¡è¿”å›Connectorï¼›</p><p>10.ConnectoræŠŠHttpServletResponseå¯¹è±¡è¿”å›ç»™å®¢æˆ·Browserã€‚</p><h3 id="72-a-a-b-ä¸-a-b-çš„åŒºåˆ«"><a href="#72-a-a-b-ä¸-a-b-çš„åŒºåˆ«" class="headerlink" title="72. a = a + b ä¸ a += b çš„åŒºåˆ«"></a><a href="">72. a = a + b ä¸ a += b çš„åŒºåˆ«</a></h3><p>+= éšå¼çš„å°†åŠ æ“ä½œçš„ç»“æœç±»å‹å¼ºåˆ¶è½¬æ¢ä¸ºæŒæœ‰ç»“æœçš„ç±»å‹ã€‚å¦‚æœä¸¤è¿™ä¸ªæ•´å‹ç›¸åŠ ï¼Œå¦‚ byteã€short æˆ–è€… intï¼Œé¦–å…ˆä¼šå°†å®ƒä»¬æå‡åˆ° int ç±»å‹ï¼Œç„¶ååœ¨æ‰§è¡ŒåŠ æ³•æ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">byte</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">127</span>;</span><br><span class="line"><span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">127</span>;</span><br><span class="line">b = a + b; <span class="comment">// error : cannot convert from int to byte</span></span><br><span class="line">b += a; <span class="comment">// ok</span></span><br></pre></td></tr></table></figure><p>(å› ä¸º a+b æ“ä½œä¼šå°† aã€b æå‡ä¸º int ç±»å‹ï¼Œæ‰€ä»¥å°† int ç±»å‹èµ‹å€¼ç»™ byte å°±ä¼šç¼–è¯‘å‡ºé”™)</p><h3 id="73-3-0-1-0-3-å°†ä¼šè¿”å›ä»€ä¹ˆ-true-è¿˜æ˜¯-false"><a href="#73-3-0-1-0-3-å°†ä¼šè¿”å›ä»€ä¹ˆ-true-è¿˜æ˜¯-false" class="headerlink" title="73. 3*0.1 == 0.3 å°†ä¼šè¿”å›ä»€ä¹ˆ? true è¿˜æ˜¯ false?"></a><a href="">73. 3*0.1 == 0.3 å°†ä¼šè¿”å›ä»€ä¹ˆ? true è¿˜æ˜¯ false?</a></h3><p>falseï¼Œå› ä¸ºæœ‰äº›æµ®ç‚¹æ•°ä¸èƒ½å®Œå…¨ç²¾ç¡®çš„è¡¨ç¤ºå‡ºæ¥ã€‚</p><h3 id="74-this-amp-super-åœ¨æ„é€ æ–¹æ³•ä¸­çš„åŒºåˆ«ï¼Ÿ"><a href="#74-this-amp-super-åœ¨æ„é€ æ–¹æ³•ä¸­çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="74. this() &amp; super()åœ¨æ„é€ æ–¹æ³•ä¸­çš„åŒºåˆ«ï¼Ÿ"></a><a href="">74. this() &amp; super()åœ¨æ„é€ æ–¹æ³•ä¸­çš„åŒºåˆ«ï¼Ÿ</a></h3><ul><li>è°ƒç”¨super()å¿…é¡»å†™åœ¨å­ç±»æ„é€ æ–¹æ³•çš„ç¬¬ä¸€è¡Œ, å¦åˆ™ç¼–è¯‘ä¸é€šè¿‡</li><li>superä»å­ç±»è°ƒç”¨çˆ¶ç±»æ„é€ , thisåœ¨åŒä¸€ç±»ä¸­è°ƒç”¨å…¶ä»–æ„é€ å‡éœ€è¦æ”¾åœ¨ç¬¬ä¸€è¡Œ</li><li>å°½ç®¡å¯ä»¥ç”¨thisè°ƒç”¨ä¸€ä¸ªæ„é€ å™¨, å´ä¸èƒ½è°ƒç”¨2ä¸ª</li><li>thiså’Œsuperä¸èƒ½å‡ºç°åœ¨åŒä¸€ä¸ªæ„é€ å™¨ä¸­, å¦åˆ™ç¼–è¯‘ä¸é€šè¿‡</li><li>this()ã€super()éƒ½æŒ‡çš„å¯¹è±¡,ä¸å¯ä»¥åœ¨staticç¯å¢ƒä¸­ä½¿ç”¨</li><li>æœ¬è´¨thisæŒ‡å‘æœ¬å¯¹è±¡çš„æŒ‡é’ˆã€‚superæ˜¯ä¸€ä¸ªå…³é”®å­—</li></ul><h3 id="75-Javaç§»ä½è¿ç®—ç¬¦ï¼Ÿ"><a href="#75-Javaç§»ä½è¿ç®—ç¬¦ï¼Ÿ" class="headerlink" title="75.Javaç§»ä½è¿ç®—ç¬¦ï¼Ÿ"></a><a href="">75.Javaç§»ä½è¿ç®—ç¬¦ï¼Ÿ</a></h3><p>javaä¸­æœ‰ä¸‰ç§ç§»ä½è¿ç®—ç¬¦</p><ul><li><code>&lt;&lt;</code> :å·¦ç§»è¿ç®—ç¬¦,<code>x &lt;&lt; 1</code>,ç›¸å½“äºxä¹˜ä»¥2(ä¸æº¢å‡ºçš„æƒ…å†µä¸‹),ä½ä½è¡¥0</li><li><code>&gt;&gt;</code> :å¸¦ç¬¦å·å³ç§»,<code>x &gt;&gt; 1</code>,ç›¸å½“äºxé™¤ä»¥2,æ­£æ•°é«˜ä½è¡¥0,è´Ÿæ•°é«˜ä½è¡¥1</li><li><code>&gt;&gt;&gt;</code> :æ— ç¬¦å·å³ç§»,å¿½ç•¥ç¬¦å·ä½,ç©ºä½éƒ½ä»¥0è¡¥é½</li></ul>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…«è‚¡æ–‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯åŠ¨SpringBooté¡¹ç›®æ—¶æŠ¥é”™Error parsing HTTP request header</title>
      <link href="/posts/53549.html"/>
      <url>/posts/53549.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨æœåŠ¡å™¨ä¸­ä½¿ç”¨Dockeréƒ¨ç½²SpringBooté¡¹ç›®æ—¶ï¼Œåœ¨å¯åŠ¨æ—¥å¿—é‡Œå‘ç°é¡¹ç›®æŠ¥é”™ï¼ŒæŠ¥é”™å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> Error parsing HTTP request header</span><br><span class="line"> Note: further occurrences of HTTP request parsing errors will be logged at DEBUG level.</span><br><span class="line">java.lang.IllegalArgumentException: Invalid character found in method name [0x040x010x00P0x8e]0x880x8e0...]. HTTP method names must be tokens</span><br><span class="line">        at org.apache.coyote.http11.Http11InputBuffer.parseRequestLine(Http11InputBuffer.java:417)</span><br><span class="line">        at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:261)</span><br><span class="line">        at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)</span><br><span class="line">        at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:888)</span><br><span class="line">        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1597)</span><br><span class="line">        at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)</span><br><span class="line">        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)</span><br><span class="line">        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)</span><br><span class="line">        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)</span><br><span class="line">        at java.base/java.lang.Thread.run(Thread.java:832)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åœ¨è¯·æ±‚ä¿¡æ¯ä¸­åŒ…å«äº†éæ³•å­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸€ä¸ªTomcaté…ç½®ç±»ï¼Œä½¿å¾—å¯ä»¥æ’å…¥\â€#&lt;&gt;[\]^`{|}ä¸­çš„ä»»æ„ç‰¹æ®Šå­—ç¬¦ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.catalina.connector.Connector;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TomcatConfig</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> TomcatServletWebServerFactory <span class="title function_">webServerFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">TomcatServletWebServerFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TomcatServletWebServerFactory</span>();</span><br><span class="line">        factory.addConnectorCustomizers((Connector connector) -&gt; &#123;</span><br><span class="line">                connector.setProperty(<span class="string">&quot;relaxedPathChars&quot;</span>, <span class="string">&quot;\&quot;#&lt;&gt;[\\]^`&#123;|&#125;&quot;</span>);</span><br><span class="line">                connector.setProperty(<span class="string">&quot;relaxedQueryChars&quot;</span>, <span class="string">&quot;\&quot;#&lt;&gt;[\\]^`&#123;|&#125;&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> factory;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡æ–°æ‰“åŒ…é¡¹ç›®ï¼Œå¹¶éƒ¨ç½²åœ¨dockerä¸­ï¼Œå‘ç°å·²ç»æ²¡æœ‰æŠ¥é”™ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>209.é•¿åº¦æœ€å°çš„å­æ•°ç»„</title>
      <link href="/posts/44730.html"/>
      <url>/posts/44730.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/minimum-size-subarray-sum/">é¢˜ç›®</a>æè¿°ï¼š</p><span id="more"></span><blockquote><p>ç»™å®šä¸€ä¸ªå«æœ‰ n ä¸ªæ­£æ•´æ•°çš„æ•°ç»„å’Œä¸€ä¸ªæ­£æ•´æ•° s ï¼Œæ‰¾å‡ºè¯¥æ•°ç»„ä¸­æ»¡è¶³å…¶å’Œ â‰¥ s çš„é•¿åº¦æœ€å°çš„ è¿ç»­ å­æ•°ç»„ï¼Œå¹¶è¿”å›å…¶é•¿åº¦ã€‚å¦‚æœä¸å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„å­æ•°ç»„ï¼Œè¿”å› 0ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>è¾“å…¥ï¼šs = 7, nums = [2,3,1,2,4,3] è¾“å‡ºï¼š2 è§£é‡Šï¼šå­æ•°ç»„ [4,3] æ˜¯è¯¥æ¡ä»¶ä¸‹çš„é•¿åº¦æœ€å°çš„å­æ•°ç»„ã€‚</p></blockquote><p>é¦–å…ˆæƒ³åˆ°çš„è‚¯å®šæ˜¯æš´åŠ›è§£æ³•ï¼Œä½¿ç”¨ä¸¤ä¸ªforå¾ªç¯ï¼Œç„¶åä¸æ–­åœ°å¯»æ‰¾æ»¡è¶³æ¡ä»¶çš„å­åºåˆ—ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n^2)ã€‚</p><p>ä¸‹é¢ä»‹ç»ä½¿ç”¨æ»‘åŠ¨çª—å£çš„è§£æ³•ã€‚</p><p>æ»‘åŠ¨çª—å£å…¶å®å°±æ˜¯åŒæŒ‡é’ˆï¼Œé€šè¿‡ä¸¤ä¸ªæŒ‡é’ˆä¸æ–­æ”¹å˜å­åºåˆ—çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ï¼Œç›´åˆ°æ‰¾åˆ°é•¿åº¦æœ€å°çš„å­åºåˆ—ã€‚è§£é¢˜çš„å…³é”®å°±æ˜¯éœ€è¦æ³¨æ„å¦‚ä½•ç§»åŠ¨èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®çš„æŒ‡é’ˆã€‚å¦‚æœå½“å‰çš„çª—å£é‡Œé¢çš„å€¼çš„å’Œå¤§äºç»™å®šçš„å€¼äº†ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‘å‰ç§»åŠ¨åˆå§‹ä½ç½®çš„æŒ‡é’ˆï¼Œè€Œç»“æŸä½ç½®çš„æŒ‡é’ˆåªæ˜¯ç”¨æ¥éå†æ•°ç»„çš„ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minSubArrayLen</span><span class="params">(<span class="type">int</span> target, <span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> <span class="number">0</span>;right &lt; nums.length; ++right)&#123; <span class="comment">//ç»“æŸæŒ‡é’ˆéå†æ•°ç»„</span></span><br><span class="line">            sum += nums[right];</span><br><span class="line">            <span class="keyword">while</span>(sum &gt;= target)&#123;</span><br><span class="line">                result = Math.min(result,right-left+<span class="number">1</span>);</span><br><span class="line">                sum -= nums[left++]; <span class="comment">//ç§»åŠ¨åˆå§‹æŒ‡é’ˆ</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result == Integer.MAX_VALUE?<span class="number">0</span>:result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ»‘åŠ¨çª—å£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>977.æœ‰åºæ•°ç»„çš„å¹³æ–¹</title>
      <link href="/posts/35851.html"/>
      <url>/posts/35851.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/squares-of-a-sorted-array/">é¢˜ç›®</a>æè¿°ï¼š</p><span id="more"></span><blockquote><p>ç»™ä½ ä¸€ä¸ªæŒ‰ éé€’å‡é¡ºåº æ’åºçš„æ•´æ•°æ•°ç»„ numsï¼Œè¿”å› æ¯ä¸ªæ•°å­—çš„å¹³æ–¹ ç»„æˆçš„æ–°æ•°ç»„ï¼Œè¦æ±‚ä¹ŸæŒ‰ éé€’å‡é¡ºåº æ’åºã€‚</p><p>ç¤ºä¾‹ 1ï¼š è¾“å…¥ï¼šnums = [-4,-1,0,3,10] è¾“å‡ºï¼š[0,1,9,16,100] è§£é‡Šï¼šå¹³æ–¹åï¼Œæ•°ç»„å˜ä¸º [16,1,0,9,100]ï¼Œæ’åºåï¼Œæ•°ç»„å˜ä¸º [0,1,9,16,100]</p><p>ç¤ºä¾‹ 2ï¼š è¾“å…¥ï¼šnums = [-7,-3,2,3,11] è¾“å‡ºï¼š[4,9,9,49,121]</p></blockquote><p>ç®€å•çš„æ€è·¯å°±æ˜¯æš´åŠ›ç ´è§£äº†ï¼Œæ²¡ä»€ä¹ˆè¯´çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] sortedSquares(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i &lt; nums.length; ++i)&#123;</span><br><span class="line">            nums[i] *= nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)ã€‚</p><p>æ¥ä¸‹æ¥ä½¿ç”¨åŒæŒ‡é’ˆæ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] sortedSquares(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length];</span><br><span class="line">        <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[l]*nums[l] &gt; nums[r]*nums[r])&#123;</span><br><span class="line">                res[k--] = nums[l]*nums[l++];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                res[k--] = nums[r]*nums[r--];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŒæŒ‡é’ˆæ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>26.åˆ é™¤æ•°ç»„ä¸­çš„é‡å¤é¡¹</title>
      <link href="/posts/5982.html"/>
      <url>/posts/5982.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array/">é¢˜ç›®</a>æè¿°ï¼š</p><span id="more"></span><blockquote><p>ç»™ä½ ä¸€ä¸ªæœ‰åºæ•°ç»„ nums ï¼Œè¯·ä½  åŸåœ° åˆ é™¤é‡å¤å‡ºç°çš„å…ƒç´ ï¼Œä½¿æ¯ä¸ªå…ƒç´  åªå‡ºç°ä¸€æ¬¡ ï¼Œè¿”å›åˆ é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚</p><p>ä¸è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½ å¿…é¡»åœ¨ åŸåœ° ä¿®æ”¹è¾“å…¥æ•°ç»„ å¹¶åœ¨ä½¿ç”¨ O(1) é¢å¤–ç©ºé—´çš„æ¡ä»¶ä¸‹å®Œæˆã€‚</p><p>ç¤ºä¾‹1ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums = [1,1,2]<br>è¾“å‡ºï¼š2, nums = [1,2]<br>è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2 ï¼Œå¹¶ä¸”åŸæ•°ç»„ nums çš„å‰ä¸¤ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 1, 2 ã€‚ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚  </p></blockquote><p>ç¤ºä¾‹2ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums = [0,0,1,1,1,2,2,3,3,4]<br>è¾“å‡ºï¼š5, nums = [0,1,2,3,4]<br>è§£é‡Šï¼šå‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5 ï¼Œ å¹¶ä¸”åŸæ•°ç»„ nums çš„å‰äº”ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 0, 1, 2, 3, 4 ã€‚ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p></blockquote></blockquote><p>ä½¿ç”¨åŒæŒ‡é’ˆæ³•ï¼Œå®šä¹‰å¿«æ…¢æŒ‡é’ˆï¼Œé¦–å…ˆå®šä¹‰æ…¢æŒ‡é’ˆä¸º0ï¼›å¿«æŒ‡é’ˆä¸º1ï¼›ç„¶åå¾ªç¯å¿«æŒ‡é’ˆï¼Œå¦‚æœå¿«æŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ ä¸ç­‰äºæ…¢æŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ ï¼Œé‚£ä¹ˆä»¤å¿«æŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ ç­‰äºæ…¢æŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ çš„åä¸€ä¸ªå…ƒç´ ã€‚æœ€ç»ˆè¿”å›æ…¢æŒ‡é’ˆ+1ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">removeDuplicates</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">lowIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">fastIndex</span> <span class="operator">=</span> <span class="number">1</span>;fastIndex &lt; nums.length; ++fastIndex)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[lowIndex] != nums[fastIndex])&#123;</span><br><span class="line">                nums[lowIndex + <span class="number">1</span>] = nums[fastIndex];</span><br><span class="line">                ++lowIndex;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lowIndex + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŒæŒ‡é’ˆæ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•ä¹‹åŒæŒ‡é’ˆæ³•</title>
      <link href="/posts/36720.html"/>
      <url>/posts/36720.html</url>
      
        <content type="html"><![CDATA[<h3 id="åŒæŒ‡é’ˆæ³•"><a href="#åŒæŒ‡é’ˆæ³•" class="headerlink" title="åŒæŒ‡é’ˆæ³•"></a>åŒæŒ‡é’ˆæ³•</h3><p>åŒæŒ‡é’ˆæ³•ï¼ˆå¿«æ…¢æŒ‡é’ˆæ³•ï¼‰ï¼š <strong>é€šè¿‡ä¸€ä¸ªå¿«æŒ‡é’ˆå’Œæ…¢æŒ‡é’ˆåœ¨ä¸€ä¸ªforå¾ªç¯ä¸‹å®Œæˆä¸¤ä¸ªforå¾ªç¯çš„å·¥ä½œã€‚</strong></p><p>åŒæŒ‡é’ˆæ³•ï¼ˆå¿«æ…¢æŒ‡é’ˆæ³•ï¼‰åœ¨æ•°ç»„å’Œé“¾è¡¨çš„æ“ä½œä¸­æ˜¯éå¸¸å¸¸è§çš„ï¼Œå¾ˆå¤šè€ƒå¯Ÿæ•°ç»„ã€é“¾è¡¨ã€å­—ç¬¦ä¸²ç­‰æ“ä½œçš„é¢è¯•é¢˜ï¼Œéƒ½ä½¿ç”¨åŒæŒ‡é’ˆæ³•ã€‚ä¾‹å¦‚<a href="https://leetcode-cn.com/problems/remove-element/">27.ç§»é™¤å…ƒç´ </a></p><span id="more"></span><blockquote><p>ç»™ä½ ä¸€ä¸ªæ•°ç»„ nums å’Œä¸€ä¸ªå€¼ valï¼Œä½ éœ€è¦ åŸåœ° ç§»é™¤æ‰€æœ‰æ•°å€¼ç­‰äº val çš„å…ƒç´ ï¼Œå¹¶è¿”å›ç§»é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚</p><p>ä¸è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½ å¿…é¡»ä»…ä½¿ç”¨ O(1) é¢å¤–ç©ºé—´å¹¶<strong>åŸåœ°</strong>ä¿®æ”¹è¾“å…¥æ•°ç»„ã€‚</p><p>å…ƒç´ çš„é¡ºåºå¯ä»¥æ”¹å˜ã€‚ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p><p>ç¤ºä¾‹ 1: ç»™å®š nums = [3,2,2,3], val = 3, å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2, å¹¶ä¸” nums ä¸­çš„å‰ä¸¤ä¸ªå…ƒç´ å‡ä¸º 2ã€‚ ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p><p>ç¤ºä¾‹ 2: ç»™å®š nums = [0,1,2,2,3,0,4,2], val = 2, å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5, å¹¶ä¸” nums ä¸­çš„å‰äº”ä¸ªå…ƒç´ ä¸º 0, 1, 3, 0, 4ã€‚</p><p><strong>ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</strong></p></blockquote><p>è¿™é“é¢˜ç›®å¯ä»¥ä½¿ç”¨æš´åŠ›ç ´è§£çš„æ–¹æ³•ï¼Œé€šè¿‡ä¸¤å±‚forå¾ªç¯ï¼Œä¸€ä¸ªforå¾ªç¯éå†æ•°ç»„å…ƒç´  ï¼Œç¬¬äºŒä¸ªforå¾ªç¯æ›´æ–°æ•°ç»„ï¼Œä¸è¿‡æ—¶é—´å¤æ‚åº¦æ˜¯O(n^2)ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">removeElement</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; ++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i] == val)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; length; ++j)&#123;</span><br><span class="line">                    nums[j-<span class="number">1</span>] = nums[j];</span><br><span class="line">                &#125;</span><br><span class="line">                --i;</span><br><span class="line">                --length;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³è¦é™ä½æ—¶é—´å¤æ‚åº¦ä¸ºO(n),å¯ä»¥ä½¿ç”¨åŒæŒ‡é’ˆæ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">removeElement</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">lowIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">fastIndex</span> <span class="operator">=</span> <span class="number">0</span>;fastIndex &lt; nums.length; ++fastIndex)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[fastIndex]!=val)&#123;</span><br><span class="line">                nums[lowIndex++] = nums[fastIndex];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lowIndex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŒæŒ‡é’ˆæ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ·æ–°JWTä»¤ç‰Œåº”è¯¥å¦‚ä½•è®¾è®¡</title>
      <link href="/posts/663.html"/>
      <url>/posts/663.html</url>
      
        <content type="html"><![CDATA[<h3 id="ä¸ºä»€ä¹ˆè¦åˆ·æ–°Tokençš„è¿‡æœŸæ—¶é—´ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦åˆ·æ–°Tokençš„è¿‡æœŸæ—¶é—´ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åˆ·æ–°Tokençš„è¿‡æœŸæ—¶é—´ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦åˆ·æ–°Tokençš„è¿‡æœŸæ—¶é—´ï¼Ÿ</h3><p>æˆ‘ä»¬åœ¨å®šä¹‰JwtUtilå·¥å…·ç±»çš„æ—¶å€™ï¼Œç”Ÿæˆçš„<code>Token</code>éƒ½æœ‰è¿‡æœŸæ—¶é—´ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå‡è®¾<code>Token</code>è¿‡æœŸæ—¶é—´ä¸º15å¤©ï¼Œç”¨æˆ·åœ¨ç¬¬14å¤©çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥å…ç™»å½•æ­£å¸¸è®¿é—®ç³»ç»Ÿã€‚ä½†æ˜¯åˆ°äº†ç¬¬15å¤©ï¼Œç”¨æˆ·çš„Tokenè¿‡æœŸï¼Œäºæ˜¯ç”¨æˆ·éœ€è¦é‡æ–°ç™»å½•ç³»ç»Ÿã€‚</p><span id="more"></span><p><code>HttpSession</code>çš„è¿‡æœŸæ—¶é—´æ¯”è¾ƒä¼˜é›…ï¼Œé»˜è®¤ä¸º15åˆ†é’Ÿã€‚å¦‚æœç”¨æˆ·è¿ç»­ä½¿ç”¨ç³»ç»Ÿï¼Œåªè¦é—´éš”æ—¶é—´ä¸è¶…è¿‡15åˆ†é’Ÿï¼Œç³»ç»Ÿå°±ä¸ä¼šé”€æ¯<code>HttpSession</code>å¯¹è±¡ã€‚JWTçš„ä»¤ç‰Œè¿‡æœŸæ—¶é—´èƒ½ä¸èƒ½åšæˆ<code>HttpSession</code>é‚£æ ·è¶…æ—¶æ—¶é—´ï¼Œåªè¦ç”¨æˆ·é—´éš”æ“ä½œæ—¶é—´ä¸è¶…è¿‡15å¤©ï¼Œç³»ç»Ÿå°±ä¸éœ€è¦ç”¨æˆ·é‡æ–°ç™»å½•ç³»ç»Ÿã€‚å®ç°è¿™ç§æ•ˆæœçš„æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼š<code>åŒToken</code>å’Œ<code>Tokenç¼“å­˜</code>ï¼Œè¿™é‡Œé‡ç‚¹è®²ä¸€ä¸‹<code>Token</code>ç¼“å­˜æ–¹æ¡ˆã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/604388a80995d6ac22960228.jpg" alt="img"></p><p>Tokenç¼“å­˜æ–¹æ¡ˆæ˜¯æŠŠ<code>Token</code>ç¼“å­˜åˆ°Redisï¼Œç„¶åè®¾ç½®Redisé‡Œé¢ç¼“å­˜çš„<code>Token</code>è¿‡æœŸæ—¶é—´ä¸ºæ­£å¸¸<code>Token</code>çš„1å€,ç„¶åæ ¹æ®æƒ…å†µåˆ·æ–°<code>Token</code>çš„è¿‡æœŸæ—¶é—´ã€‚</p><p><strong>Tokenå¤±æ•ˆï¼Œç¼“å­˜ä¹Ÿä¸å­˜åœ¨çš„æƒ…å†µ</strong></p><p>å½“ç¬¬15å¤©ï¼Œç”¨æˆ·çš„<code>Token</code>å¤±æ•ˆä»¥åï¼Œæˆ‘ä»¬è®©Shiroç¨‹åºåˆ°RedisæŸ¥çœ‹æ˜¯å¦å­˜åœ¨ç¼“å­˜çš„<code>Token</code>ï¼Œå¦‚æœè¿™ä¸ª<code>Token</code>ä¸å­˜åœ¨äºRedisé‡Œé¢ï¼Œå°±è¯´æ˜ç”¨æˆ·çš„æ“ä½œé—´éš”äº†15å¤©ï¼Œéœ€è¦é‡æ–°ç™»å½•ã€‚</p><p><strong>Tokenå¤±æ•ˆï¼Œä½†æ˜¯ç¼“å­˜è¿˜å­˜åœ¨çš„æƒ…å†µ</strong></p><p>å¦‚æœRedisä¸­å­˜åœ¨ç¼“å­˜çš„<code>Token</code>ï¼Œè¯´æ˜å½“å‰<code>Token</code>å¤±æ•ˆåï¼Œé—´éš”æ—¶é—´è¿˜æ²¡æœ‰è¶…è¿‡15å¤©ï¼Œä¸åº”è¯¥è®©ç”¨æˆ·é‡æ–°ç™»å½•ã€‚æ‰€ä»¥è¦ç”Ÿæˆæ–°çš„<code>Token</code>è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”æŠŠè¿™ä¸ª<code>Token</code>ç¼“å­˜åˆ°Redisé‡Œé¢ï¼Œè¿™ç§æ“ä½œæˆä¸ºåˆ·æ–°<code>Token</code>è¿‡æœŸæ—¶é—´ã€‚</p><h3 id="å®¢æˆ·ç«¯å¦‚ä½•æ›´æ–°ä»¤ç‰Œï¼Ÿ"><a href="#å®¢æˆ·ç«¯å¦‚ä½•æ›´æ–°ä»¤ç‰Œï¼Ÿ" class="headerlink" title="å®¢æˆ·ç«¯å¦‚ä½•æ›´æ–°ä»¤ç‰Œï¼Ÿ"></a>å®¢æˆ·ç«¯å¦‚ä½•æ›´æ–°ä»¤ç‰Œï¼Ÿ</h3><p>åœ¨æˆ‘ä»¬çš„æ–¹æ¡ˆä¸­ï¼ŒæœåŠ¡ç«¯åˆ·æ–°<code>Token</code>è¿‡æœŸæ—¶é—´ï¼Œå…¶å®å°±æ˜¯ç”Ÿæˆä¸€ä¸ªæ–°çš„<code>Token</code>ç»™å®¢æˆ·ç«¯ã€‚é‚£ä¹ˆå®¢æˆ·ç«¯æ€ä¹ˆçŸ¥é“è¿™æ¬¡å“åº”å¸¦å›æ¥çš„Tokenæ˜¯æ›´æ–°è¿‡çš„å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜å¾ˆå®¹æ˜“è§£å†³ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/604388be09c7fd5520570382.jpg" alt="img"></p><p>åªè¦ç”¨æˆ·æˆåŠŸç™»é™†ç³»ç»Ÿï¼Œå½“åç«¯æœåŠ¡å™¨æ›´æ–°<code>Token</code>çš„æ—¶å€™ï¼Œå°±åœ¨å“åº”ä¸­æ·»åŠ <code>Token</code>ã€‚å®¢æˆ·ç«¯é‚£è¾¹åˆ¤æ–­æ¯æ¬¡Ajaxå“åº”é‡Œé¢æ˜¯å¦åŒ…å«<code>Token</code>ï¼Œå¦‚æœåŒ…å«ï¼Œå°±æŠŠ<code>Token</code>ä¿å­˜èµ·æ¥å°±å¯ä»¥äº†ã€‚</p><h3 id="å¦‚ä½•åœ¨å“åº”ä¸­æ·»åŠ ä»¤ç‰Œï¼Ÿ"><a href="#å¦‚ä½•åœ¨å“åº”ä¸­æ·»åŠ ä»¤ç‰Œï¼Ÿ" class="headerlink" title="å¦‚ä½•åœ¨å“åº”ä¸­æ·»åŠ ä»¤ç‰Œï¼Ÿ"></a>å¦‚ä½•åœ¨å“åº”ä¸­æ·»åŠ ä»¤ç‰Œï¼Ÿ</h3><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/604388d2095c736a14600633.jpg" alt="img"></p><p>æˆ‘ä»¬å®šä¹‰<code>OAuth2Filter</code>ç±»æ‹¦æˆªæ‰€æœ‰çš„HTTPè¯·æ±‚ï¼Œä¸€æ–¹é¢å®ƒä¼šæŠŠè¯·æ±‚ä¸­çš„<code>Token</code>å­—ç¬¦ä¸²æå–å‡ºæ¥ï¼Œå°è£…æˆå¯¹è±¡äº¤ç»™Shiroæ¡†æ¶ï¼›å¦ä¸€æ–¹é¢ï¼Œå®ƒä¼šæ£€æŸ¥<code>Token</code>çš„æœ‰æ•ˆæ€§ã€‚å¦‚æœ<code>Token</code>è¿‡æœŸï¼Œé‚£ä¹ˆä¼šç”Ÿæˆæ–°çš„<code>Token</code>ï¼Œåˆ†åˆ«å­˜å‚¨åœ¨<code>ThreadLocalToken</code>å’Œ<code>Redis</code>ä¸­ã€‚</p><p>ä¹‹æ‰€ä»¥è¦æŠŠ<code>æ–°ä»¤ç‰Œ</code>ä¿å­˜åˆ°<code>ThreadLocalToken</code>é‡Œé¢ï¼Œæ˜¯å› ä¸ºè¦å‘<code>AOPåˆ‡é¢ç±»</code>ä¼ é€’è¿™ä¸ª<code>æ–°ä»¤ç‰Œ</code>ã€‚è™½ç„¶<code>OAuth2Filter</code>ä¸­æœ‰<code>doFilterInternal()</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å“åº”å¹¶ä¸”å†™å…¥<code>æ–°ä»¤ç‰Œ</code>ã€‚ä½†æ˜¯è¿™ä¸ªåšéå¸¸éº»çƒ¦ï¼Œé¦–å…ˆæˆ‘ä»¬è¦é€šè¿‡IOæµè¯»å–å“åº”ä¸­çš„æ•°æ®ï¼Œç„¶åè¿˜è¦æŠŠæ•°æ®è§£ææˆJSONå¯¹è±¡ï¼Œæœ€åå†æ”¾å…¥è¿™ä¸ªæ–°ä»¤ç‰Œã€‚å¦‚æœæˆ‘ä»¬å®šä¹‰äº†<code>AOPåˆ‡é¢ç±»</code>ï¼Œæ‹¦æˆªæ‰€æœ‰Webæ–¹æ³•è¿”å›çš„<code>Rå¯¹è±¡</code>ï¼Œç„¶ååœ¨<code>Rå¯¹è±¡</code>é‡Œé¢æ·»åŠ <code>æ–°ä»¤ç‰Œ</code>ï¼Œè¿™å¤šç®€å•å•Šã€‚ä½†æ˜¯<code>OAuth2Filter</code>å’Œ<code>AOP</code>åˆ‡é¢ç±»ä¹‹é—´æ²¡æœ‰è°ƒç”¨å…³ç³»ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆéš¾æŠŠ<code>æ–°ä»¤ç‰Œ</code>ä¼ ç»™<code>AOPåˆ‡é¢ç±»</code>ã€‚</p><p>è¿™é‡Œæˆ‘æƒ³åˆ°äº†<code>ThreadLocal</code>ï¼Œåªè¦æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼Œå¾€<code>ThreadLocal</code>é‡Œé¢å†™å…¥æ•°æ®å’Œè¯»å–æ•°æ®æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚åœ¨Webé¡¹ç›®ä¸­ï¼Œä»<code>OAuth2Filter</code>åˆ°<code>AOPåˆ‡é¢ç±»</code>ï¼Œéƒ½æ˜¯ç”±åŒä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œçš„ï¼Œä¸­é€”ä¸ä¼šæ›´æ¢çº¿ç¨‹ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”¾å¿ƒçš„æŠŠæ–°ä»¤ç‰Œä¿å­˜éƒ½åœ¨<code>ThreadLocal</code>é‡Œé¢ï¼Œ<code>AOPåˆ‡é¢ç±»</code>å¯ä»¥æˆåŠŸçš„å–å‡ºæ–°ä»¤ç‰Œï¼Œç„¶åå¾€<code>Rå¯¹è±¡</code>é‡Œé¢æ·»åŠ æ–°ä»¤ç‰Œå³å¯ã€‚</p><p><code>ThreadLocalToken</code>æ˜¯æˆ‘è‡ªå®šä¹‰çš„ç±»ï¼Œé‡Œé¢åŒ…å«äº†<code>ThreadLocal</code>ç±»å‹çš„å˜é‡ï¼Œå¯ä»¥ç”¨æ¥ä¿å­˜çº¿ç¨‹å®‰å…¨çš„æ•°æ®ï¼Œè€Œä¸”é¿å…äº†ä½¿ç”¨çº¿ç¨‹é”ã€‚</p><h3 id="åˆ›å»ºThreadLocalç±»"><a href="#åˆ›å»ºThreadLocalç±»" class="headerlink" title="åˆ›å»ºThreadLocalç±»"></a>åˆ›å»ºThreadLocalç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadLocalToken</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> ThreadLocal&lt;String&gt; local=<span class="keyword">new</span> <span class="title class_">ThreadLocal</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setToken</span><span class="params">(String token)</span>&#123;</span><br><span class="line">        local.set(token);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getToken</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> local.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span>&#123;</span><br><span class="line">        local.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºOAuth2Filterç±»"><a href="#åˆ›å»ºOAuth2Filterç±»" class="headerlink" title="åˆ›å»ºOAuth2Filterç±»"></a>åˆ›å»º<code>OAuth2Filter</code>ç±»</h3><p>åœ¨åˆ›å»ºè¿‡æ»¤å™¨çš„æ—¶å€™ï¼Œé¦–å…ˆåº”è¯¥åˆ¤æ–­å“ªäº›è¯·æ±‚åº”è¯¥è¢«<code>Shiro</code>æ¡†æ¶å¤„ç†ï¼Œå¦‚æœæ˜¯<code>options</code>è¯·æ±‚åˆ™ç›´æ¥æ”¾è¡Œï¼Œå…¶ä½™çš„æ‰€æœ‰è¯·æ±‚éƒ½è¦è¢«<code>Shiro</code>å¤„ç†ï¼Œåœ¨å®¢æˆ·ç«¯æäº¤è¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœæ•°æ®æ˜¯<code>application/json</code>æ•°æ®ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯·æ±‚ä¼šè¢«åˆ†æˆ<code>options</code>å’Œ<code>post</code>ä¸¤æ¬¡è¯·æ±‚ï¼Œ<code>options</code>è¯·æ±‚åªæ˜¯ä¸€ä¸ªè¯•æ¢æ€§çš„è¯·æ±‚ï¼Œè¯•æ¢ä¸€ä¸‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒï¼Œè¯·æ±‚ä¸­ä¸æºå¸¦æ•°æ®ï¼Œå¦‚æœæœåŠ¡å™¨æ”¯æŒï¼Œé‚£ä¹ˆå°±ä¼šç»§ç»­å‘é€<code>post</code>è¯·æ±‚ï¼Œè¿™æ—¶å€™æ‰ä¼šè¢«<code>Shiro</code>å¤„ç†ã€‚ç„¶åè¿‡æ»¤å™¨ä¼šåˆ¤æ–­ä¸€ä¸‹<code>Token</code>æ˜¯å¦è¿‡æœŸï¼Œæ˜¯çœŸè¿‡æœŸè¿˜æ˜¯å‡è¿‡æœŸï¼Œä»è¯·æ±‚å¤´ä¸­æå–ä¸­<code>Token</code>å­—ç¬¦ä¸²ï¼Œå¦‚æœæ˜¯çœŸè¿‡æœŸï¼Œé‚£ä¹ˆå°±è¿”å›æç¤ºä¿¡æ¯ï¼Œè®©ç”¨æˆ·é‡æ–°ç™»å½•ï¼›å¦‚æœæ˜¯å‡è¿‡æœŸï¼Œåç«¯å°±ç”Ÿæˆæ–°çš„ä»¤ç‰Œï¼Œåˆ·æ–°ä»¤ç‰Œï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚æœ€åå°±æ˜¯æŠŠæ–°ä»¤ç‰Œä¿å­˜èµ·æ¥ï¼ŒåŒæ—¶ä¿å­˜åˆ°ThreadLocalTokenå’ŒReidsã€‚</p><blockquote><h3 id="æ³¨æ„äº‹é¡¹ï¼š"><a href="#æ³¨æ„äº‹é¡¹ï¼š" class="headerlink" title="æ³¨æ„äº‹é¡¹ï¼š"></a>æ³¨æ„äº‹é¡¹ï¼š</h3><p>å› ä¸ºåœ¨<code>OAuth2Filter</code>ç±»ä¸­è¦è¯»å†™<code>ThreadLocal</code>ä¸­çš„æ•°æ®ï¼Œæ‰€ä»¥<code>OAuth2Filter</code>ç±»å¿…é¡»è¦è®¾ç½®æˆå¤šä¾‹çš„ï¼Œå¦åˆ™<code>ThreadLocal</code>å°†æ— æ³•ä½¿ç”¨ã€‚</p></blockquote><p>åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ JWTéœ€è¦ç”¨åˆ°çš„å¯†é’¥ã€è¿‡æœŸæ—¶é—´å’Œç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">emos:</span></span><br><span class="line">  <span class="attr">jwt:</span></span><br><span class="line">    <span class="comment">#å¯†é’¥</span></span><br><span class="line">    <span class="attr">secret:</span> <span class="string">abc123456</span></span><br><span class="line">    <span class="comment">#ä»¤ç‰Œè¿‡æœŸæ—¶é—´ï¼ˆå¤©ï¼‰</span></span><br><span class="line">    <span class="attr">expire:</span>  <span class="number">5</span></span><br><span class="line">    <span class="comment">#ä»¤ç‰Œç¼“å­˜æ—¶é—´ï¼ˆå¤©æ•°ï¼‰</span></span><br><span class="line">    <span class="attr">cache-expire:</span> <span class="number">10</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>com.example.emos.wx.config.shiro</code>ä¸­åˆ›å»º<code>OAuth2Filter</code>ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.emos.wx.config.shiro;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.auth0.jwt.exceptions.JWTDecodeException;</span><br><span class="line"><span class="keyword">import</span> com.auth0.jwt.exceptions.TokenExpiredException;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.HttpStatus;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.web.filter.authc.AuthenticatingFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Scope;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OAuth2Filter</span> <span class="keyword">extends</span> <span class="title class_">AuthenticatingFilter</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ThreadLocalToken threadLocalToken;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;emos.jwt.cache-expire&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> cacheExpire;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JwtUtil jwtUtil;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‹¦æˆªè¯·æ±‚ä¹‹åï¼Œç”¨äºæŠŠä»¤ç‰Œå­—ç¬¦ä¸²å°è£…æˆä»¤ç‰Œå¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> AuthenticationToken <span class="title function_">createToken</span><span class="params">(ServletRequest request, </span></span><br><span class="line"><span class="params">ServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//è·å–è¯·æ±‚token</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> getRequestToken((HttpServletRequest) request);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(token)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OAuth2Token</span>(token);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‹¦æˆªè¯·æ±‚ï¼Œåˆ¤æ–­è¯·æ±‚æ˜¯å¦éœ€è¦è¢«Shiroå¤„ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">isAccessAllowed</span><span class="params">(ServletRequest request, </span></span><br><span class="line"><span class="params">ServletResponse response, Object mappedValue)</span> &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">req</span> <span class="operator">=</span> (HttpServletRequest) request;</span><br><span class="line">        <span class="comment">// Ajaxæäº¤application/jsonæ•°æ®çš„æ—¶å€™ï¼Œä¼šå…ˆå‘å‡ºOptionsè¯·æ±‚</span></span><br><span class="line"><span class="comment">// è¿™é‡Œè¦æ”¾è¡ŒOptionsè¯·æ±‚ï¼Œä¸éœ€è¦Shiroå¤„ç†</span></span><br><span class="line"><span class="keyword">if</span> (req.getMethod().equals(RequestMethod.OPTIONS.name())) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">// é™¤äº†Optionsè¯·æ±‚ä¹‹å¤–ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½è¦è¢«Shiroå¤„ç†</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¯¥æ–¹æ³•ç”¨äºå¤„ç†æ‰€æœ‰åº”è¯¥è¢«Shiroå¤„ç†çš„è¯·æ±‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">onAccessDenied</span><span class="params">(ServletRequest request, </span></span><br><span class="line"><span class="params">ServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">req</span> <span class="operator">=</span> (HttpServletRequest) request;</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">resp</span> <span class="operator">=</span> (HttpServletResponse) response;</span><br><span class="line"></span><br><span class="line">resp.setHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"><span class="comment">//å…è®¸è·¨åŸŸè¯·æ±‚</span></span><br><span class="line">        resp.setHeader(<span class="string">&quot;Access-Control-Allow-Credentials&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">        resp.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, req.getHeader(<span class="string">&quot;Origin&quot;</span>));</span><br><span class="line"></span><br><span class="line">threadLocalToken.clear();</span><br><span class="line">        <span class="comment">//è·å–è¯·æ±‚tokenï¼Œå¦‚æœtokenä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å›401</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> getRequestToken((HttpServletRequest) request);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(token)) &#123;</span><br><span class="line">            resp.setStatus(HttpStatus.SC_UNAUTHORIZED);</span><br><span class="line">            resp.getWriter().print(<span class="string">&quot;æ— æ•ˆçš„ä»¤ç‰Œ&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            jwtUtil.verifierToken(token); <span class="comment">//æ£€æŸ¥ä»¤ç‰Œæ˜¯å¦è¿‡æœŸ</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (TokenExpiredException e) &#123;</span><br><span class="line">            <span class="comment">//å®¢æˆ·ç«¯ä»¤ç‰Œè¿‡æœŸï¼ŒæŸ¥è¯¢Redisä¸­æ˜¯å¦å­˜åœ¨ä»¤ç‰Œï¼Œå¦‚æœå­˜åœ¨ä»¤ç‰Œå°±é‡æ–°ç”Ÿæˆä¸€ä¸ªä»¤ç‰Œç»™å®¢æˆ·ç«¯</span></span><br><span class="line">            <span class="keyword">if</span> (redisTemplate.hasKey(token)) &#123;</span><br><span class="line">                redisTemplate.delete(token);<span class="comment">//åˆ é™¤ä»¤ç‰Œ</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">userId</span> <span class="operator">=</span> jwtUtil.getUserId(token);</span><br><span class="line">                token = jwtUtil.createToken(userId);  <span class="comment">//ç”Ÿæˆæ–°çš„ä»¤ç‰Œ</span></span><br><span class="line">                <span class="comment">//æŠŠæ–°çš„ä»¤ç‰Œä¿å­˜åˆ°Redisä¸­</span></span><br><span class="line">                redisTemplate.opsForValue().set(token, userId + <span class="string">&quot;&quot;</span>, cacheExpire, TimeUnit.DAYS);</span><br><span class="line">                <span class="comment">//æŠŠæ–°ä»¤ç‰Œç»‘å®šåˆ°çº¿ç¨‹</span></span><br><span class="line">                threadLocalToken.setToken(token);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//å¦‚æœRedisä¸å­˜åœ¨ä»¤ç‰Œï¼Œè®©ç”¨æˆ·é‡æ–°ç™»å½•</span></span><br><span class="line">                resp.setStatus(HttpStatus.SC_UNAUTHORIZED);</span><br><span class="line">                resp.getWriter().print(<span class="string">&quot;ä»¤ç‰Œå·²ç»è¿‡æœŸ&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (JWTDecodeException e) &#123;</span><br><span class="line">            resp.setStatus(HttpStatus.SC_UNAUTHORIZED);</span><br><span class="line">            resp.getWriter().print(<span class="string">&quot;æ— æ•ˆçš„ä»¤ç‰Œ&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">bool</span> <span class="operator">=</span> executeLogin(request, response);</span><br><span class="line">        <span class="keyword">return</span> bool;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">onLoginFailure</span><span class="params">(AuthenticationToken token,</span></span><br><span class="line"><span class="params">AuthenticationException e, ServletRequest request, ServletResponse response)</span> &#123;</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">req</span> <span class="operator">=</span> (HttpServletRequest) request;</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">resp</span> <span class="operator">=</span> (HttpServletResponse) response;</span><br><span class="line">        resp.setStatus(HttpStatus.SC_UNAUTHORIZED);</span><br><span class="line">        resp.setContentType(<span class="string">&quot;application/json;charset=utf-8&quot;</span>);</span><br><span class="line">        resp.setHeader(<span class="string">&quot;Access-Control-Allow-Credentials&quot;</span>, <span class="string">&quot;true&quot;</span>);</span><br><span class="line">        resp.setHeader(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, req.getHeader(<span class="string">&quot;Origin&quot;</span>));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            resp.getWriter().print(e.getMessage());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException exception) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–è¯·æ±‚å¤´é‡Œé¢çš„token</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getRequestToken</span><span class="params">(HttpServletRequest httpRequest)</span> &#123;</span><br><span class="line">        <span class="comment">//ä»headerä¸­è·å–token</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> httpRequest.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœheaderä¸­ä¸å­˜åœ¨tokenï¼Œåˆ™ä»å‚æ•°ä¸­è·å–token</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(token)) &#123;</span><br><span class="line">            token = httpRequest.getParameter(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> token;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilterInternal</span><span class="params">(ServletRequest request, </span></span><br><span class="line"><span class="params">ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="built_in">super</span>.doFilterInternal(request, response, chain);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JWT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŠµå¾¡è·¨ç«™è„šæœ¬(XSS)æ”»å‡»</title>
      <link href="/posts/8078.html"/>
      <url>/posts/8078.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€XSSæ”»å‡»çš„å±å®³"><a href="#ä¸€ã€XSSæ”»å‡»çš„å±å®³" class="headerlink" title="ä¸€ã€XSSæ”»å‡»çš„å±å®³"></a>ä¸€ã€XSSæ”»å‡»çš„å±å®³</h2><p>XSSæ”»å‡»é€šå¸¸æŒ‡çš„æ˜¯é€šè¿‡åˆ©ç”¨ç½‘é¡µå¼€å‘æ—¶ç•™ä¸‹çš„æ¼æ´ï¼Œé€šè¿‡å·§å¦™çš„æ–¹æ³•æ³¨å…¥æ¶æ„æŒ‡ä»¤ä»£ç åˆ°ç½‘é¡µï¼Œä½¿ç”¨æˆ·åŠ è½½å¹¶æ‰§è¡Œæ”»å‡»è€…æ¶æ„åˆ¶é€ çš„ç½‘é¡µç¨‹åºã€‚è¿™äº›æ¶æ„ç½‘é¡µç¨‹åºé€šå¸¸æ˜¯JavaScriptï¼Œä½†å®é™…ä¸Šä¹Ÿå¯ä»¥åŒ…æ‹¬Javaã€ VBScriptã€ActiveXã€ Flash æˆ–è€…ç”šè‡³æ˜¯æ™®é€šçš„HTMLã€‚æ”»å‡»æˆåŠŸåï¼Œæ”»å‡»è€…å¯èƒ½å¾—åˆ°åŒ…æ‹¬ä½†ä¸é™äºæ›´é«˜çš„æƒé™ï¼ˆå¦‚æ‰§è¡Œä¸€äº›æ“ä½œï¼‰ã€ç§å¯†ç½‘é¡µå†…å®¹ã€ä¼šè¯å’Œcookieç­‰å„ç§å†…å®¹ã€‚</p><span id="more"></span><p>ä¾‹å¦‚ç”¨æˆ·åœ¨å‘å¸–æˆ–è€…æ³¨å†Œçš„æ—¶å€™ï¼Œåœ¨æ–‡æœ¬æ¡†ä¸­è¾“å…¥<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>ï¼Œè¿™æ®µä»£ç å¦‚æœä¸ç»è¿‡è½¬ä¹‰å¤„ç†ï¼Œè€Œç›´æ¥ä¿å­˜åˆ°æ•°æ®åº“ã€‚å°†æ¥è§†å›¾å±‚æ¸²æŸ“HTMLçš„æ—¶å€™ï¼ŒæŠŠè¿™æ®µä»£ç è¾“å‡ºåˆ°é¡µé¢ä¸Šï¼Œé‚£ä¹ˆ<code>&lt;script&gt;</code>æ ‡ç­¾çš„å†…å®¹å°±ä¼šè¢«æ‰§è¡Œã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç™»é™†åˆ°æŸä¸ªç½‘ç«™ã€‚å¦‚æœç½‘ç«™ä½¿ç”¨<code>HttpSession</code>ä¿å­˜ç™»é™†å‡­è¯ï¼Œé‚£ä¹ˆ<code>SessionId</code>ä¼šä»¥<code>Cookie</code>çš„å½¢å¼ä¿å­˜åœ¨æµè§ˆå™¨ä¸Šã€‚å¦‚æœé»‘å®¢åœ¨è¿™ä¸ªç½‘é¡µå‘å¸–çš„æ—¶å€™ï¼Œå¡«å†™çš„<code>JavaScript</code>ä»£ç æ˜¯ç”¨æ¥è·å–<code>Cookie</code>å†…å®¹çš„ï¼Œå¹¶ä¸”æŠŠ<code>Cookie</code>å†…å®¹é€šè¿‡Ajaxå‘é€ç»™é»‘å®¢è‡ªå·±çš„ç”µè„‘ã€‚äºæ˜¯åªè¦æœ‰äººåœ¨è¿™ä¸ªç½‘ç«™ä¸Šæµè§ˆé»‘å®¢å‘çš„å¸–å­ï¼Œé‚£ä¹ˆè§†å›¾å±‚æ¸²æŸ“HTMLé¡µé¢ï¼Œå°±ä¼šæ‰§è¡Œæ³¨å…¥çš„XSSè„šæœ¬ï¼Œäºæ˜¯ä½ çš„<code>Cookie</code>ä¿¡æ¯å°±æ³„éœ²äº†ã€‚é»‘å®¢åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šæ„å»ºå‡º<code>Cookie</code>ï¼Œå°±å¯ä»¥å†’å……å·²ç»ç™»é™†çš„ç”¨æˆ·ã€‚</p><p>å³ä¾¿å¾ˆå¤šç½‘ç«™ä½¿ç”¨äº†JWTï¼Œç™»é™†å‡­è¯ï¼ˆ<code>Tokenä»¤ç‰Œ</code>ï¼‰æ˜¯å­˜å‚¨åœ¨æµè§ˆå™¨ä¸Šé¢çš„ã€‚æ‰€ä»¥ç”¨XSSè„šæœ¬å¯ä»¥è½»æ¾çš„ä»Storageä¸­æå–å‡º<code>Token</code>ï¼Œé»‘å®¢ä¾ç„¶å¯ä»¥è½»æ¾çš„å†’å……å·²ç»ç™»é™†çš„ç”¨æˆ·ã€‚</p><p>æ‰€ä»¥é¿å…XSSæ”»å‡»æœ€æœ‰æ•ˆçš„åŠæ³•å°±æ˜¯å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œè½¬ä¹‰ï¼Œç„¶åå­˜å‚¨åˆ°æ•°æ®åº“é‡Œé¢ã€‚ç­‰åˆ°è§†å›¾å±‚æ¸²æŸ“HTMLé¡µé¢çš„æ—¶å€™ã€‚è½¬ä¹‰åçš„æ–‡å­—æ˜¯ä¸ä¼šè¢«å½“åšJavaScriptæ‰§è¡Œçš„ï¼Œè¿™å°±å¯ä»¥æŠµå¾¡XSSæ”»å‡»ã€‚</p><h2 id="äºŒã€å¯¼å…¥ä¾èµ–åº“"><a href="#äºŒã€å¯¼å…¥ä¾èµ–åº“" class="headerlink" title="äºŒã€å¯¼å…¥ä¾èµ–åº“"></a>äºŒã€å¯¼å…¥ä¾èµ–åº“</h2><p>å› ä¸º<code>Hutool</code>å·¥å…·åŒ…å¸¦æœ‰XSSè½¬ä¹‰çš„å·¥å…·ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¯¼å…¥<code>Hutool</code>ï¼Œç„¶ååˆ©ç”¨<code>Servlet</code>è§„èŒƒæä¾›çš„è¯·æ±‚åŒ…è£…ç±»ï¼Œå®šä¹‰æ•°æ®è½¬ä¹‰åŠŸèƒ½ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ä¸‰ã€å®šä¹‰è¯·æ±‚åŒ…è£…ç±»"><a href="#ä¸‰ã€å®šä¹‰è¯·æ±‚åŒ…è£…ç±»" class="headerlink" title="ä¸‰ã€å®šä¹‰è¯·æ±‚åŒ…è£…ç±»"></a>ä¸‰ã€å®šä¹‰è¯·æ±‚åŒ…è£…ç±»</h2><p>æˆ‘ä»¬å¹³æ—¶å†™Webé¡¹ç›®é‡åˆ°çš„<code>HttpServletRequest</code>ï¼Œå®ƒå…¶å®æ˜¯ä¸ªæ¥å£ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦é‡æ–°å®šä¹‰è¯·æ±‚ç±»ï¼Œæ‰©å±•è¿™ä¸ªæ¥å£æ˜¯æœ€ä¸åº”è¯¥çš„ã€‚å› ä¸º<code>HttpServletRequest</code>æ¥å£ä¸­æŠ½è±¡æ–¹æ³•å¤ªå¤šäº†ï¼Œæˆ‘ä»¬é€ä¸€å®ç°èµ·æ¥å¤ªè€—è´¹æ—¶é—´ã€‚æ‰€ä»¥æˆ‘ä»¬åº”è¯¥æŒ‘é€‰ä¸€ä¸ªç®€å•ä¸€ç‚¹çš„è‡ªå®šä¹‰è¯·æ±‚ç±»çš„æ–¹å¼ã€‚é‚£å°±æ˜¯ç»§æ‰¿<code>HttpServletRequestWrapper</code>çˆ¶ç±»ã€‚</p><p>JavaEEåªæ˜¯ä¸€ä¸ªæ ‡å‡†ï¼Œå…·ä½“çš„å®ç°ç”±å„å®¶åº”ç”¨æœåŠ¡å™¨å‚å•†æ¥å®Œæˆã€‚æ¯”å¦‚è¯´<code>Tomcat</code>åœ¨å®ç°<code>Servlet</code>è§„èŒƒçš„æ—¶å€™ï¼Œå°±è‡ªå®šä¹‰äº†<code>HttpServletRequest</code>æ¥å£çš„å®ç°ç±»ã€‚åŒæ—¶JavaEEè§„èŒƒè¿˜å®šä¹‰äº†<code>HttpServletRequestWrapper</code>ï¼Œè¿™ä¸ªç±»æ˜¯è¯·æ±‚ç±»çš„åŒ…è£…ç±»ï¼Œç”¨ä¸Šäº†è£…é¥°å™¨æ¨¡å¼ã€‚ä¸å¾—ä¸è¯´è¿™é‡Œç”¨åˆ°çš„è®¾è®¡æ¨¡å¼çœŸçš„éå¸¸æ£’ï¼Œæ— è®ºå„å®¶åº”ç”¨æœåŠ¡å™¨å‚å•†æ€ä¹ˆå»å®ç°<code>HttpServletRequest</code>æ¥å£ï¼Œç”¨æˆ·æƒ³è¦è‡ªå®šä¹‰è¯·æ±‚ï¼Œåªéœ€è¦ç»§æ‰¿<code>HttpServletRequestWrapper</code>ï¼Œå¯¹åº”è¦†ç›–æŸä¸ªæ–¹æ³•å³å¯ï¼Œç„¶åæŠŠè¯·æ±‚ä¼ å…¥è¯·æ±‚åŒ…è£…ç±»ï¼Œè£…é¥°å™¨æ¨¡å¼å°±ä¼šæ›¿ä»£è¯·æ±‚å¯¹è±¡ä¸­å¯¹åº”çš„æŸä¸ªæ–¹æ³•ã€‚ç”¨æˆ·çš„ä»£ç å’ŒæœåŠ¡å™¨å‚å•†çš„ä»£ç å®Œå…¨è§£è€¦ï¼Œæˆ‘ä»¬ä¸ç”¨å…³å¿ƒ<code>HttpServletRequest</code>æ¥å£æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå€ŸåŠ©äºåŒ…è£…ç±»æˆ‘ä»¬å¯ä»¥éšæ„ä¿®æ”¹è¯·æ±‚ä¸­çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cn.hutool.core.util.StrUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.http.HtmlUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.json.JSONUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ReadListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletInputStream;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequestWrapper;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.Charset;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XssHttpServletRequestWrapper</span> <span class="keyword">extends</span> <span class="title class_">HttpServletRequestWrapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å­ç±»å®šä¹‰ä¸€ä¸ªæ„é€ å™¨æ¥æ”¶ä¼ å…¥çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">XssHttpServletRequestWrapper</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(request);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getParameter</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> <span class="built_in">super</span>.getParameter(name);</span><br><span class="line">        <span class="keyword">if</span> (!StrUtil.hasEmpty(value)) &#123;</span><br><span class="line">            <span class="comment">//å°†æ•°æ®è¿›è¡Œè½¬ä¹‰</span></span><br><span class="line">            value = HtmlUtil.filter(value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String[] getParameterValues(String name) &#123;</span><br><span class="line">        String[] values = <span class="built_in">super</span>.getParameterValues(name);</span><br><span class="line">        <span class="keyword">if</span> (values != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; values.length; i++) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> values[i];</span><br><span class="line">                <span class="keyword">if</span> (!StrUtil.hasEmpty(value)) &#123;</span><br><span class="line">                    value = HtmlUtil.filter(value);</span><br><span class="line">                &#125;</span><br><span class="line">                values[i] = value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> values;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, String[]&gt; getParameterMap() &#123;</span><br><span class="line">        Map&lt;String, String[]&gt; parameters = <span class="built_in">super</span>.getParameterMap();</span><br><span class="line">        Map&lt;String, String[]&gt; map = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (parameters != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (String key : parameters.keySet()) &#123;</span><br><span class="line">                String[] values = parameters.get(key);</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; values.length; i++) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> values[i];</span><br><span class="line">                    <span class="keyword">if</span> (!StrUtil.hasEmpty(value)) &#123;</span><br><span class="line">                        value = HtmlUtil.filter(value);</span><br><span class="line">                    &#125;</span><br><span class="line">                    values[i] = value;</span><br><span class="line">                &#125;</span><br><span class="line">                map.put(key, values);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getHeader</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> <span class="built_in">super</span>.getHeader(name);</span><br><span class="line">        <span class="keyword">if</span> (!StrUtil.hasEmpty(value)) &#123;</span><br><span class="line">            value = HtmlUtil.filter(value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * SpringMVCæ¡†æ¶é€šè¿‡è¿™ä¸ªæ–¹æ³•ä»è¯·æ±‚é‡Œé¢æå–å®¢æˆ·ç«¯æäº¤çš„æ•°æ®ï¼Œç„¶åæŠŠè¿™äº›æ•°æ®å°è£…åˆ°formå¯¹è±¡é‡Œé¢ï¼Œ</span></span><br><span class="line"><span class="comment">     * å¦‚æœä¸å¯¹getInputStream()æ–¹æ³•è¯»å–çš„æ•°æ®åšè½¬ä¹‰ï¼Œé‚£ä¹ˆåç«¯é¡¹ç›®å°±ä¸å…·å¤‡æŠµå¾¡è·¨ç«™è„šæœ¬æ”»å‡»çš„èƒ½åŠ›ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ServletInputStream <span class="title function_">getInputStream</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="built_in">super</span>.getInputStream();</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">body</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="type">InputStreamReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(in, Charset.forName(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">buffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(reader);</span><br><span class="line">        <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> buffer.readLine();</span><br><span class="line">        <span class="keyword">while</span> (line != <span class="literal">null</span>) &#123;</span><br><span class="line">            body.append(line);</span><br><span class="line">            line = buffer.readLine();</span><br><span class="line">        &#125;</span><br><span class="line">        buffer.close();</span><br><span class="line">        reader.close();</span><br><span class="line">        in.close();</span><br><span class="line"></span><br><span class="line">        Map&lt;String, Object&gt; map = JSONUtil.parseObj(body.toString());</span><br><span class="line">        Map&lt;String, Object&gt; resultMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>(map.size());</span><br><span class="line">        <span class="keyword">for</span> (String key : map.keySet()) &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">val</span> <span class="operator">=</span> map.get(key);</span><br><span class="line">            <span class="keyword">if</span> (map.get(key) <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">                resultMap.put(key, HtmlUtil.filter(val.toString()));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                resultMap.put(key, val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> JSONUtil.toJsonStr(resultMap);</span><br><span class="line">        <span class="keyword">final</span> <span class="type">ByteArrayInputStream</span> <span class="variable">bain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(str.getBytes());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServletInputStream</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">read</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">                <span class="keyword">return</span> bain.read();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isFinished</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isReady</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setReadListener</span><span class="params">(ReadListener listener)</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å››ã€åˆ›å»ºè¿‡æ»¤å™¨ï¼ŒæŠŠæ‰€æœ‰è¯·æ±‚å¯¹è±¡ä¼ å…¥åŒ…è£…ç±»"><a href="#å››ã€åˆ›å»ºè¿‡æ»¤å™¨ï¼ŒæŠŠæ‰€æœ‰è¯·æ±‚å¯¹è±¡ä¼ å…¥åŒ…è£…ç±»" class="headerlink" title="å››ã€åˆ›å»ºè¿‡æ»¤å™¨ï¼ŒæŠŠæ‰€æœ‰è¯·æ±‚å¯¹è±¡ä¼ å…¥åŒ…è£…ç±»"></a>å››ã€åˆ›å»ºè¿‡æ»¤å™¨ï¼ŒæŠŠæ‰€æœ‰è¯·æ±‚å¯¹è±¡ä¼ å…¥åŒ…è£…ç±»</h2><p>ä¸ºäº†è®©åˆšåˆšå®šä¹‰çš„åŒ…è£…ç±»ç”Ÿæ•ˆï¼Œæˆ‘ä»¬è¿˜è¦åœ¨è¯·æ±‚åŒ…è£…ç±»çš„æ‰€åœ¨ç›®å½•ä¸‹ä¸­åˆ›å»º<code>XssFilter</code>è¿‡æ»¤å™¨ã€‚è¿‡æ»¤å™¨æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œç„¶åæŠŠè¯·æ±‚ä¼ å…¥åŒ…è£…ç±»ï¼Œè¿™æ ·åŒ…è£…ç±»å°±èƒ½è¦†ç›–æ‰€æœ‰è¯·æ±‚çš„å‚æ•°æ–¹æ³•ï¼Œç”¨æˆ·ä»è¯·æ±‚ä¸­è·å¾—æ•°æ®ï¼Œå…¨éƒ½ç»è¿‡è½¬ä¹‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebFilter(urlPatterns = &quot;/*&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XssFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="type">XssHttpServletRequestWrapper</span> <span class="variable">xssRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XssHttpServletRequestWrapper</span>(</span><br><span class="line">                (HttpServletRequest) request);</span><br><span class="line">        chain.doFilter(xssRequest, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äº”ã€ç»™å¯åŠ¨ç±»æ·»åŠ æ³¨è§£"><a href="#äº”ã€ç»™å¯åŠ¨ç±»æ·»åŠ æ³¨è§£" class="headerlink" title="äº”ã€ç»™å¯åŠ¨ç±»æ·»åŠ æ³¨è§£"></a>äº”ã€ç»™å¯åŠ¨ç±»æ·»åŠ æ³¨è§£</h2><p>ç»™SpringBootå¯åŠ¨ç±»æ·»åŠ <code>@ServletComponentScan</code>æ³¨è§£ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¿«é€Ÿæ’åº</title>
      <link href="/posts/11306.html"/>
      <url>/posts/11306.html</url>
      
        <content type="html"><![CDATA[<p><strong>ç®—æ³•æè¿°</strong></p><ol><li>æ¯ä¸€è½®æ’åºé€‰æ‹©ä¸€ä¸ªåŸºå‡†ç‚¹ï¼ˆpivotï¼‰è¿›è¡Œåˆ†åŒº<ol><li>è®©å°äºåŸºå‡†ç‚¹çš„å…ƒç´ çš„è¿›å…¥ä¸€ä¸ªåˆ†åŒºï¼Œå¤§äºåŸºå‡†ç‚¹çš„å…ƒç´ çš„è¿›å…¥å¦ä¸€ä¸ªåˆ†åŒº</li><li>å½“åˆ†åŒºå®Œæˆæ—¶ï¼ŒåŸºå‡†ç‚¹å…ƒç´ çš„ä½ç½®å°±æ˜¯å…¶æœ€ç»ˆä½ç½®</li></ol></li><li>åœ¨å­åˆ†åŒºå†…é‡å¤ä»¥ä¸Šè¿‡ç¨‹ï¼Œç›´è‡³å­åˆ†åŒºå…ƒç´ ä¸ªæ•°å°‘äºç­‰äº 1ï¼Œè¿™ä½“ç°çš„æ˜¯åˆ†è€Œæ²»ä¹‹çš„æ€æƒ³ ï¼ˆ<a href="https://en.wikipedia.org/wiki/Divide-and-conquer_algorithm">divide-and-conquer</a>ï¼‰</li><li>ä»ä»¥ä¸Šæè¿°å¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªå…³é”®åœ¨äºåˆ†åŒºç®—æ³•ï¼Œå¸¸è§çš„æœ‰æ´›ç©†æ‰˜åˆ†åŒºæ–¹æ¡ˆã€åŒè¾¹å¾ªç¯åˆ†åŒºæ–¹æ¡ˆã€éœå°”åˆ†åŒºæ–¹æ¡ˆ</li></ol><span id="more"></span><p><strong>å•è¾¹å¾ªç¯å¿«æ’ï¼ˆlomuto æ´›ç©†æ‰˜åˆ†åŒºæ–¹æ¡ˆï¼‰</strong></p><ol><li><p>é€‰æ‹©æœ€å³å…ƒç´ ä½œä¸ºåŸºå‡†ç‚¹å…ƒç´ </p></li><li><p>j æŒ‡é’ˆè´Ÿè´£æ‰¾åˆ°æ¯”åŸºå‡†ç‚¹å°çš„å…ƒç´ ï¼Œä¸€æ—¦æ‰¾åˆ°åˆ™ä¸ i è¿›è¡Œäº¤æ¢</p></li><li><p>i æŒ‡é’ˆç»´æŠ¤å°äºåŸºå‡†ç‚¹å…ƒç´ çš„è¾¹ç•Œï¼Œä¹Ÿæ˜¯æ¯æ¬¡äº¤æ¢çš„ç›®æ ‡ç´¢å¼•</p></li><li><p>æœ€ååŸºå‡†ç‚¹ä¸ i äº¤æ¢ï¼Œi å³ä¸ºåˆ†åŒºä½ç½®</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">quick</span><span class="params">(<span class="type">int</span>[] a, <span class="type">int</span> l, <span class="type">int</span> h)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= h) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> partition(a, l, h); <span class="comment">// p ç´¢å¼•å€¼</span></span><br><span class="line">    quick(a, l, p - <span class="number">1</span>); <span class="comment">// å·¦è¾¹åˆ†åŒºçš„èŒƒå›´ç¡®å®š</span></span><br><span class="line">    quick(a, p + <span class="number">1</span>, h); <span class="comment">// å·¦è¾¹åˆ†åŒºçš„èŒƒå›´ç¡®å®š</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span>[] a, <span class="type">int</span> l, <span class="type">int</span> h)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">pv</span> <span class="operator">=</span> a[h]; <span class="comment">// åŸºå‡†ç‚¹å…ƒç´ </span></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> l;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> l; j &lt; h; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[j] &lt; pv) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i != j) &#123;</span><br><span class="line">                swap(a, i, j);</span><br><span class="line">            &#125;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i != h) &#123;</span><br><span class="line">        swap(a, h, i);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(Arrays.toString(a) + <span class="string">&quot; i=&quot;</span> + i);</span><br><span class="line">    <span class="comment">// è¿”å›å€¼ä»£è¡¨äº†åŸºå‡†ç‚¹å…ƒç´ æ‰€åœ¨çš„æ­£ç¡®ç´¢å¼•ï¼Œç”¨å®ƒç¡®å®šä¸‹ä¸€è½®åˆ†åŒºçš„è¾¹ç•Œ</span></span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>åŒè¾¹å¾ªç¯å¿«æ’ï¼ˆä¸å®Œå…¨ç­‰ä»·äº hoare éœå°”åˆ†åŒºæ–¹æ¡ˆï¼‰</strong></p><ol><li>é€‰æ‹©æœ€å·¦å…ƒç´ ä½œä¸ºåŸºå‡†ç‚¹å…ƒç´ </li><li>j æŒ‡é’ˆè´Ÿè´£ä»å³å‘å·¦æ‰¾æ¯”åŸºå‡†ç‚¹å°çš„å…ƒç´ ï¼Œi æŒ‡é’ˆè´Ÿè´£ä»å·¦å‘å³æ‰¾æ¯”åŸºå‡†ç‚¹å¤§çš„å…ƒç´ ï¼Œä¸€æ—¦æ‰¾åˆ°äºŒè€…äº¤æ¢ï¼Œç›´è‡³ iï¼Œj ç›¸äº¤</li><li>æœ€ååŸºå‡†ç‚¹ä¸ iï¼ˆæ­¤æ—¶ i ä¸ j ç›¸ç­‰ï¼‰äº¤æ¢ï¼Œi å³ä¸ºåˆ†åŒºä½ç½®</li></ol><p>è¦ç‚¹</p><ol><li><p>åŸºå‡†ç‚¹åœ¨å·¦è¾¹ï¼Œå¹¶ä¸”è¦å…ˆ j å i</p></li><li><p>while( ==<strong>i</strong> <strong>&lt; j</strong>== &amp;&amp; a[j] &gt; pv ) jâ€” </p></li><li>while ( ==<strong>i</strong> <strong>&lt; j</strong>== &amp;&amp; a[i] ==<strong>&lt;=</strong>== pv ) i++</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">quick</span><span class="params">(<span class="type">int</span>[] a, <span class="type">int</span> l, <span class="type">int</span> h)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= h) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> partition(a, l, h);</span><br><span class="line">    quick(a, l, p - <span class="number">1</span>);</span><br><span class="line">    quick(a, p + <span class="number">1</span>, h);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span>[] a, <span class="type">int</span> l, <span class="type">int</span> h)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">pv</span> <span class="operator">=</span> a[l];</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> l;</span><br><span class="line">    <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> h;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">        <span class="comment">// j ä»å³æ‰¾å°çš„</span></span><br><span class="line">        <span class="keyword">while</span> (i &lt; j &amp;&amp; a[j] &gt; pv) &#123;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// i ä»å·¦æ‰¾å¤§çš„</span></span><br><span class="line">        <span class="keyword">while</span> (i &lt; j &amp;&amp; a[i] &lt;= pv) &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        swap(a, i, j);</span><br><span class="line">    &#125;</span><br><span class="line">    swap(a, l, j);</span><br><span class="line">    System.out.println(Arrays.toString(a) + <span class="string">&quot; j=&quot;</span> + j);</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¿«æ’ç‰¹ç‚¹</strong></p><ol><li><p>å¹³å‡æ—¶é—´å¤æ‚åº¦æ˜¯ $O(nlog_2â¡n )$ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦ $O(n^2)$</p></li><li><p>æ•°æ®é‡è¾ƒå¤§æ—¶ï¼Œä¼˜åŠ¿éå¸¸æ˜æ˜¾</p></li><li><p>å±äºä¸ç¨³å®šæ’åº</p></li></ol><p><strong>æ´›ç©†æ‰˜åˆ†åŒºæ–¹æ¡ˆ vs éœå°”åˆ†åŒºæ–¹æ¡ˆ</strong></p><ul><li>éœå°”çš„ç§»åŠ¨æ¬¡æ•°å¹³å‡æ¥è®²æ¯”æ´›ç©†æ‰˜å°‘3å€</li><li><a href="https://qastack.cn/cs/11458/quicksort-partitioning-hoare-vs-lomuto">https://qastack.cn/cs/11458/quicksort-partitioning-hoare-vs-lomuto</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ’å…¥æ’åº</title>
      <link href="/posts/50190.html"/>
      <url>/posts/50190.html</url>
      
        <content type="html"><![CDATA[<p><strong>ç®—æ³•æè¿°</strong></p><ol><li>å°†æ•°ç»„åˆ†ä¸ºä¸¤ä¸ªåŒºåŸŸï¼Œæ’åºåŒºåŸŸå’Œæœªæ’åºåŒºåŸŸï¼Œæ¯ä¸€è½®ä»æœªæ’åºåŒºåŸŸä¸­å–å‡ºç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ’å…¥åˆ°æ’åºåŒºåŸŸï¼ˆéœ€ä¿è¯é¡ºåºï¼‰</li><li>é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œç›´åˆ°æ•´ä¸ªæ•°ç»„æœ‰åº</li></ol><span id="more"></span><p><strong>ç®—æ³•å®ç°</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¿®æ”¹äº†ä»£ç ä¸å¸Œå°”æ’åºä¸€è‡´</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(<span class="type">int</span>[] a)</span> &#123;</span><br><span class="line">    <span class="comment">// i ä»£è¡¨å¾…æ’å…¥å…ƒç´ çš„ç´¢å¼•</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> a[i]; <span class="comment">// ä»£è¡¨å¾…æ’å…¥çš„å…ƒç´ å€¼</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i;</span><br><span class="line">        System.out.println(j);</span><br><span class="line">        <span class="keyword">while</span> (j &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (t &lt; a[j - <span class="number">1</span>]) &#123; <span class="comment">// j-1 æ˜¯ä¸Šä¸€ä¸ªå…ƒç´ ç´¢å¼•ï¼Œå¦‚æœ &gt; tï¼Œåç§»</span></span><br><span class="line">                a[j] = a[j - <span class="number">1</span>];</span><br><span class="line">                j--;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// å¦‚æœ j-1 å·²ç» &lt;= t, åˆ™ j å°±æ˜¯æ’å…¥ä½ç½®</span></span><br><span class="line">                <span class="keyword">break</span>; <span class="comment">//é€€å‡ºæ’åºï¼Œå‡å°‘æ¯”è¾ƒæ¬¡æ•°</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        a[j] = t;</span><br><span class="line">        System.out.println(Arrays.toString(a) + <span class="string">&quot; &quot;</span> + j);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸é€‰æ‹©æ’åºæ¯”è¾ƒ</strong></p><ol><li><p>äºŒè€…å¹³å‡æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(n^2)$</p></li><li><p>å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ’å…¥éƒ½ç•¥ä¼˜äºé€‰æ‹©</p></li><li><p>æœ‰åºé›†åˆæ’å…¥çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$</p></li><li><p>æ’å…¥å±äºç¨³å®šæ’åºç®—æ³•ï¼Œè€Œé€‰æ‹©å±äºä¸ç¨³å®šæ’åº</p></li></ol><p><strong>æç¤º</strong></p><blockquote><p><em>æ’å…¥æ’åºé€šå¸¸è¢«è½»è§†ï¼Œå…¶å®å®ƒçš„åœ°ä½éå¸¸é‡è¦ã€‚å°æ•°æ®é‡æ’åºï¼Œéƒ½ä¼šä¼˜å…ˆé€‰æ‹©æ’å…¥æ’åº</em></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€‰æ‹©æ’åº</title>
      <link href="/posts/51203.html"/>
      <url>/posts/51203.html</url>
      
        <content type="html"><![CDATA[<p><strong>ç®—æ³•æè¿°</strong></p><ol><li>å°†æ•°ç»„åˆ†ä¸ºä¸¤ä¸ªå­é›†ï¼Œæ’åºçš„å’Œæœªæ’åºçš„ï¼Œæ¯ä¸€è½®ä»æœªæ’åºçš„å­é›†ä¸­é€‰å‡ºæœ€å°çš„å…ƒç´ ï¼Œæ”¾å…¥æ’åºå­é›†</li><li>é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œç›´åˆ°æ•´ä¸ªæ•°ç»„æœ‰åº</li></ol><span id="more"></span><p><strong>ç®—æ³•å®ç°</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">selection</span><span class="params">(<span class="type">int</span>[] a)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; a.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// i ä»£è¡¨æ¯è½®é€‰æ‹©æœ€å°å…ƒç´ è¦äº¤æ¢åˆ°çš„ç›®æ ‡ç´¢å¼•</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">s</span> <span class="operator">=</span> i; <span class="comment">// ä»£è¡¨æœ€å°å…ƒç´ çš„ç´¢å¼•</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> s + <span class="number">1</span>; j &lt; a.length; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[s] &gt; a[j]) &#123; <span class="comment">// j å…ƒç´ æ¯” s å…ƒç´ è¿˜è¦å°, æ›´æ–° s</span></span><br><span class="line">                s = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (s != i) &#123;</span><br><span class="line">            swap(a, s, i);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Arrays.toString(a));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¼˜åŒ–ç‚¹ï¼šä¸ºå‡å°‘äº¤æ¢æ¬¡æ•°ï¼Œæ¯ä¸€è½®å¯ä»¥å…ˆæ‰¾æœ€å°çš„ç´¢å¼•ï¼Œåœ¨æ¯è½®æœ€åå†äº¤æ¢å…ƒç´ </li></ul><p><strong>ä¸å†’æ³¡æ’åºæ¯”è¾ƒ</strong></p><ol><li><p>äºŒè€…å¹³å‡æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ $O(n^2)$ </p></li><li><p>é€‰æ‹©æ’åºä¸€èˆ¬è¦å¿«äºå†’æ³¡ï¼Œå› ä¸ºå…¶äº¤æ¢æ¬¡æ•°å°‘</p></li><li><p>ä½†å¦‚æœé›†åˆæœ‰åºåº¦é«˜ï¼Œå†’æ³¡ä¼˜äºé€‰æ‹©</p></li><li><p>å†’æ³¡å±äºç¨³å®šæ’åºç®—æ³•ï¼Œè€Œé€‰æ‹©å±äºä¸ç¨³å®šæ’åº</p><ul><li>ç¨³å®šæ’åºæŒ‡ï¼ŒæŒ‰å¯¹è±¡ä¸­ä¸åŒå­—æ®µè¿›è¡Œå¤šæ¬¡æ’åºï¼Œä¸ä¼šæ‰“ä¹±åŒå€¼å…ƒç´ çš„é¡ºåº</li><li>ä¸ç¨³å®šæ’åºåˆ™åä¹‹</li></ul></li></ol><p><strong>ç¨³å®šæ’åºä¸ä¸ç¨³å®šæ’åº</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">&quot;=================ä¸ç¨³å®š================&quot;</span>);</span><br><span class="line">Card[] cards = getStaticCards();</span><br><span class="line">System.out.println(Arrays.toString(cards));</span><br><span class="line">selection(cards, Comparator.comparingInt((Card a) -&gt; a.sharpOrder).reversed());</span><br><span class="line">System.out.println(Arrays.toString(cards));</span><br><span class="line">selection(cards, Comparator.comparingInt((Card a) -&gt; a.numberOrder).reversed());</span><br><span class="line">System.out.println(Arrays.toString(cards));</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;=================ç¨³å®š=================&quot;</span>);</span><br><span class="line">cards = getStaticCards();</span><br><span class="line">System.out.println(Arrays.toString(cards));</span><br><span class="line">bubble(cards, Comparator.comparingInt((Card a) -&gt; a.sharpOrder).reversed());</span><br><span class="line">System.out.println(Arrays.toString(cards));</span><br><span class="line">bubble(cards, Comparator.comparingInt((Card a) -&gt; a.numberOrder).reversed());</span><br><span class="line">System.out.println(Arrays.toString(cards));</span><br></pre></td></tr></table></figure><p>éƒ½æ˜¯å…ˆæŒ‰ç…§èŠ±è‰²æ’åºï¼ˆâ™ â™¥â™£â™¦ï¼‰ï¼Œå†æŒ‰ç…§æ•°å­—æ’åºï¼ˆAKQJâ€¦ï¼‰</p><ul><li><p>ä¸ç¨³å®šæ’åºç®—æ³•æŒ‰æ•°å­—æ’åºæ—¶ï¼Œä¼šæ‰“ä¹±åŸæœ¬åŒå€¼çš„èŠ±è‰²é¡ºåº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[â™ 7], [â™ 2], [â™ 4], [â™ 5], [â™¥2], [â™¥5]]</span><br><span class="line">[[â™ 7], [â™ 5], [â™¥5], [â™ 4], [â™¥2], [â™ 2]]</span><br></pre></td></tr></table></figure><p>åŸæ¥ â™ 2 åœ¨å‰ â™¥2 åœ¨åï¼ŒæŒ‰æ•°å­—å†æ’åï¼Œä»–ä¿©çš„ä½ç½®å˜äº†</p></li><li><p>ç¨³å®šæ’åºç®—æ³•æŒ‰æ•°å­—æ’åºæ—¶ï¼Œä¼šä¿ç•™åŸæœ¬åŒå€¼çš„èŠ±è‰²é¡ºåºï¼Œå¦‚ä¸‹æ‰€ç¤º â™ 2 ä¸ â™¥2 çš„ç›¸å¯¹ä½ç½®ä¸å˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[â™ 7], [â™ 2], [â™ 4], [â™ 5], [â™¥2], [â™¥5]]</span><br><span class="line">[[â™ 7], [â™ 5], [â™¥5], [â™ 4], [â™ 2], [â™¥2]]</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†’æ³¡æ’åº</title>
      <link href="/posts/21238.html"/>
      <url>/posts/21238.html</url>
      
        <content type="html"><![CDATA[<p><strong>ç®—æ³•æè¿°</strong></p><ol><li>ä¾æ¬¡æ¯”è¾ƒæ•°ç»„ä¸­ç›¸é‚»ä¸¤ä¸ªå…ƒç´ å¤§å°ï¼Œè‹¥ a[j] &gt; a[j+1]ï¼Œåˆ™äº¤æ¢ä¸¤ä¸ªå…ƒç´ ï¼Œä¸¤ä¸¤éƒ½æ¯”è¾ƒä¸€éç§°ä¸ºä¸€è½®å†’æ³¡ï¼Œç»“æœæ˜¯è®©æœ€å¤§çš„å…ƒç´ æ’è‡³æœ€å</li><li>é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œç›´åˆ°æ•´ä¸ªæ•°ç»„æœ‰åº</li></ol><span id="more"></span><p><strong>ç®—æ³•å®ç°</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">bubble</span><span class="params">(<span class="type">int</span>[] a)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; a.length - <span class="number">1</span>; j++) &#123;</span><br><span class="line">        <span class="comment">// ä¸€è½®å†’æ³¡</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">swapped</span> <span class="operator">=</span> <span class="literal">false</span>; <span class="comment">// æ˜¯å¦å‘ç”Ÿäº†äº¤æ¢</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; a.length - <span class="number">1</span> - j; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¯”è¾ƒæ¬¡æ•°&quot;</span> + i);</span><br><span class="line">            <span class="keyword">if</span> (a[i] &gt; a[i + <span class="number">1</span>]) &#123;</span><br><span class="line">                Utils.swap(a, i, i + <span class="number">1</span>);</span><br><span class="line">                swapped = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬&quot;</span> + j + <span class="string">&quot;è½®å†’æ³¡&quot;</span></span><br><span class="line">                           + Arrays.toString(a));</span><br><span class="line">        <span class="keyword">if</span> (!swapped) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¼˜åŒ–ç‚¹1ï¼šæ¯ç»è¿‡ä¸€è½®å†’æ³¡ï¼Œå†…å±‚å¾ªç¯å°±å¯ä»¥å‡å°‘ä¸€æ¬¡</li><li>ä¼˜åŒ–ç‚¹2ï¼šå¦‚æœæŸä¸€è½®å†’æ³¡æ²¡æœ‰å‘ç”Ÿäº¤æ¢ï¼Œåˆ™è¡¨ç¤ºæ‰€æœ‰æ•°æ®æœ‰åºï¼Œå¯ä»¥ç»“æŸå¤–å±‚å¾ªç¯</li></ul><p><strong>è¿›ä¸€æ­¥ä¼˜åŒ–</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">bubble_v2</span><span class="params">(<span class="type">int</span>[] a)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> a.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">last</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// è¡¨ç¤ºæœ€åä¸€æ¬¡äº¤æ¢ç´¢å¼•ä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ¯”è¾ƒæ¬¡æ•°&quot;</span> + i);</span><br><span class="line">            <span class="keyword">if</span> (a[i] &gt; a[i + <span class="number">1</span>]) &#123;</span><br><span class="line">                Utils.swap(a, i, i + <span class="number">1</span>);</span><br><span class="line">                last = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        n = last;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¬¬è½®å†’æ³¡&quot;</span></span><br><span class="line">                           + Arrays.toString(a));</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ¯è½®å†’æ³¡æ—¶ï¼Œæœ€åä¸€æ¬¡äº¤æ¢ç´¢å¼•å¯ä»¥ä½œä¸ºä¸‹ä¸€è½®å†’æ³¡çš„æ¯”è¾ƒæ¬¡æ•°ï¼Œå¦‚æœè¿™ä¸ªå€¼ä¸ºé›¶ï¼Œè¡¨ç¤ºæ•´ä¸ªæ•°ç»„æœ‰åºï¼Œç›´æ¥é€€å‡ºå¤–å±‚å¾ªç¯å³å¯</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒåˆ†æŸ¥æ‰¾</title>
      <link href="/posts/42877.html"/>
      <url>/posts/42877.html</url>
      
        <content type="html"><![CDATA[<p><strong>ç®—æ³•æè¿°</strong></p><ol><li>å‰æï¼šæœ‰å·²æ’åºæ•°ç»„ Aï¼ˆå‡è®¾å·²ç»åšå¥½ï¼‰</li><li>å®šä¹‰å·¦è¾¹ç•Œ Lã€å³è¾¹ç•Œ Rï¼Œç¡®å®šæœç´¢èŒƒå›´ï¼Œå¾ªç¯æ‰§è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼ˆ3ã€4ä¸¤æ­¥ï¼‰</li><li>è·å–ä¸­é—´ç´¢å¼• M = Floor((L+R) /2)</li></ol><span id="more"></span><ol><li>ä¸­é—´ç´¢å¼•çš„å€¼  A[M] ä¸å¾…æœç´¢çš„å€¼ T è¿›è¡Œæ¯”è¾ƒ</li></ol><p>â€‹         â‘  A[M] == T è¡¨ç¤ºæ‰¾åˆ°ï¼Œè¿”å›ä¸­é—´ç´¢å¼•</p><p>â€‹         â‘¡ A[M] &gt; Tï¼Œä¸­é—´å€¼å³ä¾§çš„å…¶å®ƒå…ƒç´ éƒ½å¤§äº Tï¼Œæ— éœ€æ¯”è¾ƒï¼Œä¸­é—´ç´¢å¼•å·¦è¾¹å»æ‰¾ï¼ŒM - 1 è®¾ç½®ä¸ºå³è¾¹ç•Œï¼Œé‡æ–°æŸ¥æ‰¾</p><p>â€‹         â‘¢ A[M] &lt; Tï¼Œä¸­é—´å€¼å·¦ä¾§çš„å…¶å®ƒå…ƒç´ éƒ½å°äº Tï¼Œæ— éœ€æ¯”è¾ƒï¼Œä¸­é—´ç´¢å¼•å³è¾¹å»æ‰¾ï¼Œ M + 1 è®¾ç½®ä¸ºå·¦è¾¹ç•Œï¼Œé‡æ–°æŸ¥æ‰¾</p><ol><li>å½“ L &gt; R æ—¶ï¼Œè¡¨ç¤ºæ²¡æœ‰æ‰¾åˆ°ï¼Œåº”ç»“æŸå¾ªç¯</li></ol><p><strong>ç®—æ³•å®ç°</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">binarySearch</span><span class="params">(<span class="type">int</span>[] a, <span class="type">int</span> t)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> <span class="number">0</span>, r = a.length - <span class="number">1</span>, m;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        m = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (a[m] == t) &#123;</span><br><span class="line">            <span class="keyword">return</span> m;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a[m] &gt; t) &#123;</span><br><span class="line">            r = m - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            l = m + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ä»£ç </strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] array = &#123;<span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">31</span>, <span class="number">35</span>, <span class="number">40</span>, <span class="number">45</span>, <span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>&#125;;</span><br><span class="line">    <span class="type">int</span> <span class="variable">target</span> <span class="operator">=</span> <span class="number">47</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">idx</span> <span class="operator">=</span> binarySearch(array, target);</span><br><span class="line">    System.out.println(idx);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è§£å†³æ•´æ•°æº¢å‡ºé—®é¢˜</strong></p><p>å½“ l å’Œ r éƒ½è¾ƒå¤§æ—¶ï¼Œ<code>l + r</code> æœ‰å¯èƒ½è¶…è¿‡æ•´æ•°èŒƒå›´ï¼Œé€ æˆè¿ç®—é”™è¯¯ï¼Œè§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> l + (r - l) / <span class="number">2</span>;</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ˜¯ç§»ä½ï¼Œå³ç§»1ä½ï¼Œç›¸å½“<code>l + r</code> çš„å€¼é™¤ä»¥2å–æ•´ï¼Œä¸”æ•ˆç‡ç›¸æ¯”é™¤æ³•æ›´é«˜ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> (l + r) &gt;&gt;&gt; <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p><strong>å…¶å®ƒè€ƒæ³•</strong></p><ol><li><p>æœ‰ä¸€ä¸ªæœ‰åºè¡¨ä¸º 1,5,8,11,19,22,31,35,40,45,48,49,50 å½“äºŒåˆ†æŸ¥æ‰¾å€¼ä¸º 48 çš„ç»“ç‚¹æ—¶ï¼ŒæŸ¥æ‰¾æˆåŠŸéœ€è¦æ¯”è¾ƒçš„æ¬¡æ•° </p></li><li><p>ä½¿ç”¨äºŒåˆ†æ³•åœ¨åºåˆ— 1,4,6,7,15,33,39,50,64,78,75,81,89,96 ä¸­æŸ¥æ‰¾å…ƒç´  81 æ—¶ï¼Œéœ€è¦ç»è¿‡ï¼ˆ   ï¼‰æ¬¡æ¯”è¾ƒ</p></li><li><p>åœ¨æ‹¥æœ‰128ä¸ªå…ƒç´ çš„æ•°ç»„ä¸­äºŒåˆ†æŸ¥æ‰¾ä¸€ä¸ªæ•°ï¼Œéœ€è¦æ¯”è¾ƒçš„æ¬¡æ•°æœ€å¤šä¸è¶…è¿‡å¤šå°‘æ¬¡</p></li></ol><p>å¯¹äºå‰ä¸¤ä¸ªé¢˜ç›®ï¼Œè®°å¾—ä¸€ä¸ªç®€è¦åˆ¤æ–­å£è¯€ï¼šå¥‡æ•°äºŒåˆ†å–ä¸­é—´ï¼Œå¶æ•°äºŒåˆ†å–ä¸­é—´é å·¦ã€‚å¯¹äºåä¸€é“é¢˜ç›®ï¼Œéœ€è¦çŸ¥é“å…¬å¼ï¼š</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20211103205108420.png" alt="image-20211103205108420"></p><p>å…¶ä¸­ n ä¸ºæŸ¥æ‰¾æ¬¡æ•°ï¼ŒN ä¸ºå…ƒç´ ä¸ªæ•°</p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shiroè®¤è¯æµç¨‹æºç åˆ†æ</title>
      <link href="/posts/29996.html"/>
      <url>/posts/29996.html</url>
      
        <content type="html"><![CDATA[<h2 id="åˆ›å»ºè®¤è¯æµ‹è¯•ç±»"><a href="#åˆ›å»ºè®¤è¯æµ‹è¯•ç±»" class="headerlink" title="åˆ›å»ºè®¤è¯æµ‹è¯•ç±»"></a>åˆ›å»ºè®¤è¯æµ‹è¯•ç±»</h2><span id="more"></span><p>åˆ›å»º<code>TestAuthenticator</code>ç±»,ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestAuthenticator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//1.åˆ›å»ºå®‰å…¨ç®¡ç†å™¨å¯¹è±¡</span></span><br><span class="line">        <span class="type">DefaultSecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultSecurityManager</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.ç»™å®‰å…¨ç®¡ç†å™¨è®¾ç½®realm</span></span><br><span class="line">        securityManager.setRealm(<span class="keyword">new</span> <span class="title class_">IniRealm</span>(<span class="string">&quot;classpath:shiro.ini&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.SecurityUtils ç»™å…¨å±€å®‰å…¨å·¥å…·ç±»è®¾ç½®å®‰å…¨ç®¡ç†å™¨</span></span><br><span class="line">        SecurityUtils.setSecurityManager(securityManager);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.å…³é”®å¯¹è±¡ subject ä¸»ä½“</span></span><br><span class="line">        <span class="type">Subject</span> <span class="variable">subject</span> <span class="operator">=</span> SecurityUtils.getSubject();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.åˆ›å»ºä»¤ç‰Œ</span></span><br><span class="line">        <span class="type">UsernamePasswordToken</span> <span class="variable">token</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordToken</span>(<span class="string">&quot;heling&quot;</span>, <span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;è®¤è¯çŠ¶æ€ï¼š&quot;</span> + subject.isAuthenticated());</span><br><span class="line">            subject.login(token); <span class="comment">//ç”¨æˆ·è®¤è¯</span></span><br><span class="line">            System.out.println(<span class="string">&quot;è®¤è¯çŠ¶æ€ï¼š&quot;</span> + subject.isAuthenticated());</span><br><span class="line">        &#125;<span class="keyword">catch</span> (UnknownAccountException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(<span class="string">&quot;è®¤è¯å¤±è´¥ï¼šç”¨æˆ·åä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IncorrectCredentialsException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(<span class="string">&quot;è®¤è¯å¤±è´¥ï¼šå¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>shiro.ini</code>å†…å®¹ä¸ºï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[users]</span></span><br><span class="line"><span class="attr">heling</span>=<span class="number">123</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œæµ‹è¯•ç»“æœä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è®¤è¯çŠ¶æ€ï¼šfalse</span><br><span class="line">è®¤è¯çŠ¶æ€ï¼štrue</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šè¿‡ç¨‹æ˜¯shiroä¸­æœ€ç®€å•çš„ä¸€ä¸ªè®¤è¯ï¼Œå…¶ä¸­çš„æƒé™ç®¡ç†æ•°æ®æ˜¯é€šè¿‡<code>IniRealm</code>çš„å½¢å¼å»è¯»å–é…ç½®æ–‡ä»¶<code>shiro.ini</code>æ¥åŠ è½½æ•°æ®ï¼Œä½†æ˜¯ä»¥åçš„æƒé™ç®¡ç†æ•°æ®è‚¯å®šéƒ½æ˜¯æ¥æºäºæ•°æ®åº“çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠæ•°æ®æ›´æ”¹åˆ°æ•°æ®åº“ã€‚<br>Shiroä»<code>Realm</code>è·å–å®‰å…¨æ•°æ® (å¦‚ç”¨æˆ·,è§’è‰²ï¼Œæƒé™)ï¼Œå°±æ˜¯è¯´<code>SecurityManager</code>è¦éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œé‚£ä¹ˆå®ƒéœ€è¦ä»<code>Realm</code>è·å–ç›¸åº”çš„ç”¨æˆ·è¿›è¡Œæ¯”è¾ƒï¼Œæ¥ç¡®å®šç”¨æˆ·çš„èº«ä»½æ˜¯å¦åˆæ³•;ä¹Ÿéœ€è¦ä»<code>Realm</code>å¾—åˆ°ç”¨æˆ·ç›¸åº”çš„è§’è‰²ã€æƒé™ï¼Œè¿›è¡ŒéªŒè¯ç”¨æˆ·çš„æ“ä½œæ˜¯å¦èƒ½å¤Ÿè¿›è¡Œï¼Œå¯ä»¥æŠŠ<code>Realm</code>çœ‹<code>DataSource</code>;<code>Realm</code>å¯ä»¥å†³å®šæˆ‘ä»¬çš„æƒé™ç®¡ç†æ•°æ®æ˜¯æ¥æºäºinié…ç½®æ–‡ä»¶è¿˜æ˜¯æ•°æ®åº“ï¼Œä¹Ÿå°±æ˜¯æ•°æ®çš„è°ƒé…æ˜¯ç”±<code>Realm</code>æ¥æ‰§è¡Œçš„ï¼Œä¸ºäº†ææ¸…æ¥š<code>Realm</code>çš„è°ƒé…æµç¨‹ï¼Œæˆ‘ä»¬ç®€å•çœ‹ä¸€ä¸‹è®¤è¯çš„æºç ã€‚</p><h2 id="è®¤è¯æºç åˆ†æ"><a href="#è®¤è¯æºç åˆ†æ" class="headerlink" title="è®¤è¯æºç åˆ†æ"></a>è®¤è¯æºç åˆ†æ</h2><h3 id="ç”¨æˆ·åè®¤è¯"><a href="#ç”¨æˆ·åè®¤è¯" class="headerlink" title="ç”¨æˆ·åè®¤è¯"></a>ç”¨æˆ·åè®¤è¯</h3><p>é¦–å…ˆåœ¨<code>subject.login(token);</code>å¤„æ‰“ä¸Šæ–­ç‚¹ï¼Œç„¶åDebugè¿è¡Œã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/abb91f97c04344d185c28329c0b6e98b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç¨‹åºåœåœ¨æ–­ç‚¹ä¹‹åï¼Œæˆ‘ä»¬è¿›è¡Œloginæ–¹æ³•ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/aa6db40626e548e7b84b269c7d89edb5.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯ä»¥çœ‹åˆ°è™½ç„¶æ˜¯subjectè°ƒç”¨çš„loginï¼Œä½†æ˜¯çœŸæ­£å»æ‰§è¡Œçš„æ˜¯<code>DelegatingSubject</code>ä¸­çš„loginï¼Œæ–¹æ³•åˆšå¼€å§‹è°ƒç”¨äº†ä¸€ä¸ªclearæ–¹æ³•ï¼Œç„¶åç”±å®‰å…¨ç®¡ç†å™¨è¿›è¡Œè®¤è¯ï¼Œå†…éƒ¨çš„<code>this</code>å°±æ˜¯<code>DelegatingSubject</code>ç±»ï¼Œtokenå°±æ˜¯æˆ‘ä»¬ä¼ è¿‡æ¥çš„ç”±èº«ä»½ä¿¡æ¯å’Œå‡­è¯ä¿¡æ¯ç»„æˆçš„ä»¤ç‰Œã€‚ç„¶åå†è¿›å…¥<code>securityManager</code>çš„<code>login</code>æ–¹æ³•ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/670c5123f30d46bbafbb6ff5e16041bf.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">æˆ‘ä»¬å‘ç°å®é™…ä¸ŠçœŸæ­£å»æ‰§è¡Œçš„æ˜¯<code>DefaultSecurityManager</code>ä¸­çš„<code>login</code>æ–¹æ³•ï¼Œæ–¹æ³•åˆšå¼€å§‹å°±æ‰§è¡Œä¸€ä¸ª<code>authenticate</code>æ–¹æ³•ï¼Œä¼ å…¥tokenï¼Œç„¶åç»§ç»­è¿›å…¥è¿™ä¸ªæ–¹æ³•å†…éƒ¨ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/ba35e85f6ad14c9fa897ce20e91398e3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»§ç»­è°ƒç”¨<code>AuthenticatingSecurityManager</code>ç±»ä¸­çš„<code>authenticate</code>æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­åˆè°ƒç”¨äº†å½“å‰ç±»ä¸­çš„<code>authenticator</code>å¯¹è±¡çš„<code>authenticate</code>æ–¹æ³•ï¼Œç»§ç»­è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/9402e1a1f8034893a9e8c5fd6a1bc5e8.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°è°ƒç”¨äº†<code>AbstractAuthenticator</code>ä¸­çš„<code>authenticate</code>æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ç”±è°ƒç”¨äº†<code>doAuthenticate</code>æ–¹æ³•ï¼Œç»§ç»­è¿›å…¥<code>doAuthenticate</code>ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/f6ad84a63576444f9d8985ddb898fe17.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ¥åˆ°äº†<code>ModularRealmAuthenticator</code>ç±»ä¸­çš„<code>doAuthenticate</code>æ–¹æ³•ï¼Œæ–¹æ³•å¼€å§‹æ—¶æœ‰ä¸€ä¸ªæ–­è¨€è¯¢é—®æ˜¯å¦é…ç½®Realmï¼Œç„¶å<code>getRealms</code>æ–¹æ³•æ‹¿åˆ°äº†æ‰€æœ‰çš„åŸŸï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªåŸŸï¼Œæ‰€ä»¥<code>realms.size() == 1</code>ï¼Œè¿›å…¥<code>doSingleRealmAuthentication</code>æ–¹æ³•ã€‚ç„¶åè¿›å…¥<code>doSingleRealmAuthentication</code>æ–¹æ³•æŸ¥çœ‹ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/96aad19cbd0546c78be891e7f315ccee.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><code>doSingleRealmAuthentication</code>æ–¹æ³•åˆšå¼€å§‹è¯¢é—®realmæ˜¯å¦æ”¯æŒtokenï¼Œrealmè‚¯å®šæ”¯æŒï¼Œæ‰€ä»¥realmè°ƒç”¨<code>getAuthenticationInfo</code>æ–¹æ³•ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/978beb8dbea941a2b5ebdb3d3fca5361.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯ä»¥å‘ç°å®ƒæ˜¯ä»ç¼“å­˜ä¸­æ‹¿å–è®¤è¯ä¿¡æ¯ï¼Œå› ä¸ºç¨‹åºç¬¬ä¸€æ¬¡è¿è¡Œæ˜¯æ²¡æœ‰ç¼“å­˜çš„ï¼Œæ‰€ä»¥è¿™æ¬¡è‚¯å®šæ‹¿ä¸åˆ°ä¿¡æ¯ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/28c7b736e9c94d62b07ac7f62fc0125f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»§ç»­è°ƒç”¨<code>doGetAuthenticationInfo</code>æ–¹æ³•ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/685d1c660c3043a28430df813f7cb092.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™é‡Œå¯ä»¥çœ‹åˆ°<code>doGetAuthenticationInfo</code>æ–¹æ³•å°†tokenå–å‡ºæ¥ï¼Œç„¶åå¼ºè½¬æˆUsernamePasswordTokenï¼Œç„¶åé€šè¿‡<code>upToken.getUsername()</code>è·å¾—ç”¨æˆ·åï¼Œæœ€åä½¿ç”¨<code>getUser</code>æ–¹æ³•æ‹¿åˆ°ç”¨æˆ·ã€‚æˆ‘ä»¬ç»§ç»­è¿›å…¥<code>getUsername</code>æ–¹æ³•ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1cdc7bffae5a4828a4973396fd8c1cbf.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯ä»¥çœ‹åˆ°å·²ç»æ‹¿åˆ°ç”¨æˆ·å<code>heling</code>ã€‚ç„¶åä¸‹ä¸€æ­¥å›å»ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/64f805fe727b41d5bf3f4c1342d0cfe1.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å†è¿›å…¥<code>getUser</code>æ–¹æ³•ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/b699614a96b64ce48aaef3c747fccbc6.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">usernameè¢«ä¼ è¿›æ¥äº†ï¼Œå¾€ä¸‹èµ°ï¼Œå‘ç°<code>this.users</code>çš„size=1ï¼Œå› ä¸ºæˆ‘ä»¬çš„é…ç½®æ–‡ä»¶<code>shiro.ini</code>ä¸­åªæœ‰ä¸€ä¸ªç”¨æˆ·ã€‚ç„¶åè¿™é‡Œæ ¹æ®ç”¨æˆ·åæ‹¿åˆ°ç”¨æˆ·ï¼Œè¿”å›<code>SimpleAccount</code>ï¼Œç»§ç»­ä¸‹ä¸€æ­¥ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/b94005b97f1842a1b7586e00722b5caa.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™æ—¶å·²ç»æ‹¿åˆ°accountï¼Œæ‰€ä»¥accountè‚¯å®šä¸ä¸ºç©ºï¼Œè€Œä¸”accountä¹Ÿæ²¡æœ‰ä¸Šé”ï¼Œä¹Ÿæ²¡æœ‰åšè¿‡éªŒè¯å¯†ç æ˜¯å¦è¿‡æœŸçš„å¤„ç†ï¼Œæ‰€ä»¥æœ€ç»ˆåœ¨<code>SimpleAccountRealm</code>ç±»ä¸­é€šè¿‡<code>doGetAuthenticationInfo</code>æ–¹æ³•å®Œæˆäº†ä¸€ä¸ªç”¨æˆ·åçš„è®¤è¯ã€‚</p><h3 id="å¯†ç è®¤è¯"><a href="#å¯†ç è®¤è¯" class="headerlink" title="å¯†ç è®¤è¯"></a>å¯†ç è®¤è¯</h3><p>åœ¨<code>return acount</code>ä¹‹åç»§ç»­ä¸‹ä¸€æ­¥ï¼Œå›åˆ°äº†<code>AuthenticatingRealm</code>ç±»ï¼Œ<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/be85d7e965ec4682a6962d7b68bf3397.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">è¿™é‡Œæ‹¿åˆ°çš„infoè‚¯å®šä¸ä¸ºç©ºäº†ï¼Œç»§ç»­ä¸‹ä¸€æ­¥ï¼Œå› ä¸º<code>token != null &amp;&amp; info != null</code>ï¼Œæ‰€ä»¥å¢åŠ äº†ç¼“å­˜ï¼ˆ<code>this.cacheAuthenticationInfoIfPossible(token, info);</code>ï¼‰ã€‚ç»§ç»­å¾€ä¸‹èµ°ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/7a552b8a204045b6b64fb7eb59e6a684.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¦‚æœinfoä¸ä¸ºç©ºçš„è¯ï¼Œå°±è¿›å…¥ä¸€ä¸ªæ–­è¨€ï¼Œåˆ¤æ–­tokenä¸­çš„å¯†ç å’Œinfoä¸­çš„å¯†ç æ˜¯å¦ç›¸ç­‰ã€‚è¿›å…¥<code>assertCredentialsMatch</code>æ–¹æ³•æŸ¥çœ‹ã€‚<br><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/1e0e04f22c8c46f5941a22a359aa21a1.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›å…¥æ–¹æ³•ï¼Œæ‹¿åˆ°äº†ä¸€ä¸ªå¯†ç åŒ¹é…å™¨ï¼Œå¦‚æœå¯†ç åŒ¹é…å™¨ä¸ä¸ºç©ºçš„è¯ï¼Œå°±è°ƒç”¨<code>doCredentialsMatch</code>æ–¹æ³•å¯¹tokenä¸­çš„å¯†ç å’Œinfoä¸­çš„å¯†ç è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœå¯†ç ä¸æ­£ç¡®å°±æŠ›å‡º<code>IncorrectCredentialsException</code>å¼‚å¸¸ã€‚æ‰€ä»¥æœ€ç»ˆå¯†ç çš„æ ¡éªŒæ˜¯åœ¨<code>AuthenticatingRealm</code>ç±»ä¸­çš„<code>assertCredentialsMatch</code>æ–¹æ³•ä¸­å®Œæˆçš„ã€‚<br>å¦‚æœä»¥åæˆ‘ä»¬è¦æŠŠæ•°æ®æ¢æˆæ•°æ®åº“çš„å®ç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€æŠŠ<code>SimpleAccountRealm</code>ç±»ä¸­<code>doGetAuthenticationInfo</code>æ–¹æ³•çš„å®ç°æ¢æˆè¯»å–æ•°æ®åº“ï¼Œå› ä¸º<code>SimpleAccountRealm</code>ç»§æ‰¿è‡ª<code>AuthorizingRealm</code>ç±»ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦è‡ªå®šä¹‰Realmï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥è‡ªå·±å†™ä¸€ä¸ªç±»å»ç»§æ‰¿<code>AuthorizingRealm</code>å¹¶é‡å†™<code>doGetAuthenticationInfo</code>æ–¹æ³•ã€‚å¯†ç æ ¡éªŒæ˜¯ä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å¤„ç†çš„ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ç”¨æˆ·åè®¤è¯ä¹‹åè¿”å›infoä¿¡æ¯ï¼Œ<code>AuthenticatingRealm</code>ç±»ä¸­çš„<code>assertCredentialsMatch</code>æ–¹æ³•ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ ¡éªŒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Shiro </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shiro </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Boot å¿…çŸ¥å¿…ä¼š</title>
      <link href="/posts/5427.html"/>
      <url>/posts/5427.html</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€æ˜¯ä»€ä¹ˆï¼Ÿèƒ½åšä»€ä¹ˆï¼Ÿ"><a href="#ä¸€ã€æ˜¯ä»€ä¹ˆï¼Ÿèƒ½åšä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä¸€ã€æ˜¯ä»€ä¹ˆï¼Ÿèƒ½åšä»€ä¹ˆï¼Ÿ"></a>ä¸€ã€æ˜¯ä»€ä¹ˆï¼Ÿèƒ½åšä»€ä¹ˆï¼Ÿ</h2><ul><li><p>æ˜¯ä¸€ä¸ªå¿«é€Ÿå¼€å‘çš„è„šæ‰‹æ¶</p></li><li><p>ä½œç”¨ï¼šå¿«é€Ÿåˆ›å»ºç‹¬ç«‹çš„ã€ç”Ÿäº§çº§çš„åŸºäºSpringçš„åº”ç”¨ç¨‹åº</p><p>SpringBootæ˜¯åŸºäºSpringçš„ç”¨æ¥æå‡æ•ˆç‡çš„æ¡†æ¶ï¼Œå¯ä»¥è®©ç¼–ç æ›´åŠ ç®€å•ï¼Œé…ç½®ç®¡ç†ä¹Ÿæ›´åŠ ç®€å•ï¼Œéƒ¨ç½²ä¹Ÿæ›´æ–¹</p><span id="more"></span></li><li><p>ç‰¹æ€§</p><ul><li>æ— éœ€éƒ¨ç½²WARæ–‡ä»¶</li><li>æä¾›starterç®€åŒ–é…ç½®</li><li>å°½å¯èƒ½è‡ªåŠ¨é…ç½®Springä»¥åŠç¬¬ä¸‰æ–¹åº“</li><li>æä¾›â€œç”Ÿäº§å°±ç»ªâ€åŠŸèƒ½ï¼Œä¾‹å¦‚æŒ‡æ ‡ã€å¥åº·æ£€æŸ¥ã€å¤–éƒ¨é…ç½®ç­‰</li><li>æ— ä»£ç ç”Ÿæˆ&amp;æ— XML</li></ul></li></ul><h2 id="äºŒã€ç¼–å†™ç¬¬ä¸€ä¸ªSpringBootåº”ç”¨"><a href="#äºŒã€ç¼–å†™ç¬¬ä¸€ä¸ªSpringBootåº”ç”¨" class="headerlink" title="äºŒã€ç¼–å†™ç¬¬ä¸€ä¸ªSpringBootåº”ç”¨"></a>äºŒã€ç¼–å†™ç¬¬ä¸€ä¸ªSpringBootåº”ç”¨</h2><ul><li>éœ€æ±‚<ul><li>æ•´åˆSpring MVC</li><li>/testè·¯å¾„ï¼ˆç«¯ç‚¹ï¼‰</li></ul></li><li>ä½¿ç”¨Spring Initializrå¿«é€Ÿåˆ›å»ºSpring Bootåº”ç”¨</li></ul><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929122815096.png" alt="image-20210929122815096"  /></p><p>å·¦ä¾§é€‰æ‹©Spring Initializrï¼ŒSDKé€‰æ‹©JDK1.8ï¼ŒCustomä½¿ç”¨<a href="http://start.aliyun.com">http://start.aliyun.com</a>å¯ä»¥åŠ å¿«ä¸‹è½½é€Ÿåº¦ï¼Œç„¶åç‚¹å‡»Nextåˆ›å»ºã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929131811905.png" alt="image-20210929131811905"></p><p>å¡«å†™Groupå’Œé¡¹ç›®å”¯ä¸€æ ‡è¯†Artifactï¼Œæ‰“åŒ…æ–¹å¼é€‰æ‹©Jarï¼Œè¿™ä¹Ÿæ˜¯Sprintå®˜æ–¹æ¨èçš„æ‰“åŒ…æ–¹å¼ï¼ŒJavaç‰ˆæœ¬é€‰æ‹©8ï¼Œç‚¹å‡»Nextã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929132216076.png" alt="image-20210929132216076"></p><p>é€‰æ‹©æœ€æ–°ç‰ˆæœ¬çš„Spring Bootï¼Œæ·»åŠ Spring Webæ¥æ•´åˆSpring MVCã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929132409252.png" alt="image-20210929132409252"></p><p>å¡«å†™é¡¹ç›®åç§°ä»¥åŠé¡¹ç›®åœ°å€ï¼Œå®Œæˆã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929132612574.png" alt="image-20210929132612574"></p><p>ç”Ÿæˆçš„é¡¹ç›®å…¶å®å·²ç»æ•´åˆäº†MVCã€‚</p><p>ä¸‹é¢å†™Testç«¯ç‚¹ï¼Œåœ¨cn.cstubeåŒ…ä¸‹åˆ›å»ºç±»TestControllerã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.cstube;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@auther</span> heling</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/9/29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®å¯åŠ¨ä¹‹å‰ï¼Œä½¿ç”¨<code>mvn clean install</code>ç¡®ä¿èƒ½å¤Ÿæ„å»ºæˆåŠŸå†å»å¯åŠ¨ï¼Œä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢æœ‰JaråŒ…æ²¡æœ‰ä¸‹è½½å®Œæ•´ï¼Œå¯¼è‡´å¯åŠ¨å¤±è´¥ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929140808446.png" alt="image-20210929140808446"></p><p>æœ€åå¯åŠ¨SpringBootDemoApplicationç±»ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929141034166.png" alt="image-20210929141034166"></p><p>åœ¨æµè§ˆå™¨è®¿é—®<a href="localhost:8080/test">localhost:8080/test</a>ï¼Œå¯ä»¥çœ‹åˆ°å¯ä»¥è¿”å›testã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929141226978.png" alt="image-20210929141226978"></p><p>ä»¥ä¸Šæ˜¯åœ¨Ideaä¸­çš„å¯åŠ¨ï¼Œåœ¨å®é™…çš„é¡¹ç›®éƒ¨ç½²ä¸­æˆ‘ä»¬éœ€è¦è¿›åˆ°<code>target</code>ç›®å½•ï¼Œæ‰¾åˆ°å¯ä»¥æ‰§è¡Œçš„jaråŒ…ï¼Œç„¶åæ‰§è¡Œ<code>java -jar spring-boot-demo-0.0.1-SNAPSHOT.jar</code>ï¼ŒåŒæ ·åœ¨æµè§ˆå™¨ä¸­ä¹Ÿå¯ä»¥è¿”å›æ­£å¸¸ç»“æœã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929141503364.png" alt="image-20210929141503364"></p><h2 id="ä¸‰ã€Spring-Bootçš„åº”ç”¨ç»„æˆåˆ†æ"><a href="#ä¸‰ã€Spring-Bootçš„åº”ç”¨ç»„æˆåˆ†æ" class="headerlink" title="ä¸‰ã€Spring Bootçš„åº”ç”¨ç»„æˆåˆ†æ"></a>ä¸‰ã€Spring Bootçš„åº”ç”¨ç»„æˆåˆ†æ</h2><ul><li>ä¾èµ–ï¼š<code>pom.xml</code></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springmvcæ•´åˆ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--å•å…ƒæµ‹è¯•æ”¯æŒ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨ç±»ï¼šæ³¨è§£</li></ul><p><code>@SpringBootApplication</code>ä»£è¡¨è¿™ä¸ªç±»ä¸ºå¯åŠ¨ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringBootDemoApplication</span> &#123;</span><br><span class="line">    <span class="comment">//å¯åŠ¨ç±»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(SpringBootDemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é…ç½®ï¼šapplication.properties</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">spring-boot-demo</span></span><br><span class="line"><span class="comment"># åº”ç”¨æœåŠ¡ WEB è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8080</span></span><br></pre></td></tr></table></figure><ul><li>staticç›®å½•ï¼šé™æ€æ–‡ä»¶</li></ul><p>ä¸»è¦ç”¨äºå­˜æ”¾é™æ€æ–‡ä»¶ï¼Œæ¯”å¦‚htmlï¼Œcssæ–‡ä»¶ã€‚</p><ul><li>templatesç›®å½•ï¼šæ¨¡æ¿æ–‡ä»¶</li></ul><p>ç”¨äºå­˜æ”¾æ¨¡æ¿æ–‡ä»¶ï¼Œå› ä¸ºSpring MVCæ”¯æŒå¤šç§è§†å›¾æ ¼å¼ï¼Œæ¯”å¦‚jsp,freemarkerç­‰æ¨¡æ¿å¼•æ“ï¼Œä½†æ˜¯ç°åœ¨çš„åº”ç”¨å¤§å¤šåŸºäºå‰åç«¯åˆ†ç¦»å¼€å‘ï¼Œä»¥ååŸºæœ¬ç”¨ä¸åˆ°æ¨¡æ¿å¼•æ“ã€‚</p><h2 id="å››ã€Spring-Bootå¼€å‘ä¸‰æ¿æ–§"><a href="#å››ã€Spring-Bootå¼€å‘ä¸‰æ¿æ–§" class="headerlink" title="å››ã€Spring Bootå¼€å‘ä¸‰æ¿æ–§"></a>å››ã€Spring Bootå¼€å‘ä¸‰æ¿æ–§</h2><ul><li>åŠ ä¾èµ–</li></ul><p>å¦‚æœä½ æƒ³åœ¨Spring Bootæ•´åˆxxxï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨<code>pom.xml</code>ä¸­ä¸Šxxxçš„ä¾èµ–å³å¯ã€‚ä¾‹å¦‚æ•´åˆJPAå’ŒMybatisã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--        bootå®˜æ–¹æä¾›ï¼šspring-boot-starter-xxx--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--        mybatis éå®˜æ–¹æä¾›starter:xxx-spring-boot-starter--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å†™æ³¨è§£</li></ul><p>åœ¨å¯åŠ¨ç±»ä¸­ä¼šæ·»åŠ å„ç§å„æ ·çš„æ³¨è§£</p><ul><li>å†™é…ç½®</li></ul><p>åœ¨<code>application.properties</code>ä¸­æ·»åŠ å„ç§é…ç½®</p><h2 id="äº”ã€Spring-Boot-Actuator"><a href="#äº”ã€Spring-Boot-Actuator" class="headerlink" title="äº”ã€Spring Boot Actuator"></a>äº”ã€Spring Boot Actuator</h2><ul><li>æ˜¯ä»€ä¹ˆï¼Ÿ</li></ul><p>Spring Boot Actuatoræ˜¯Spring Bootä¸­éå¸¸é‡è¦çš„ç»„ä»¶ï¼Œå®ƒä¸ºæˆ‘ä»¬çš„åº”ç”¨æä¾›äº†å¼ºå¤§çš„ç›‘æ§èƒ½åŠ›ã€‚å¦‚ä»Šçš„åº”ç”¨è¶Šæ¥è¶Šå¤æ‚ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›ç›‘æ§å·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬è®°å½•é—®é¢˜ã€‚</p><ul><li>å¦‚ä½•æ•´åˆ?</li></ul><p>æ·»åŠ ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨åº”ç”¨ï¼Œå¯ä»¥çœ‹åˆ°actuatoræš´éœ²äº†ä¸¤ä¸ªç«¯ç‚¹ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929145625923.png" alt="image-20210929145625923"></p><p>æ‰“å¼€<a href="localhost:8080/actuator">localhost:8080/actuator</a></p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929145852358.png" alt="image-20210929145852358" style="zoom:50%;" /></p><p>ç‚¹å‡»<a href="http://localhost:8080/actuator/health">http://localhost:8080/actuator/health</a></p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929150133024.png" alt="image-20210929150133024" style="zoom:50%;" /></p><p>healthç«¯ç‚¹æ˜¯éå¸¸é‡è¦çš„ç«¯ç‚¹ï¼Œä»¥åä¼šç»å¸¸ç”¨åˆ°ã€‚ä½œç”¨æ˜¯å¥åº·æ£€æŸ¥ï¼Œä¹Ÿå°±æ˜¯æ£€æŸ¥åº”ç”¨çš„èµ„æºã€‚æˆ‘ä»¬éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®ã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åº”ç”¨åç§°</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">spring-boot-demo</span></span><br><span class="line"><span class="comment"># åº”ç”¨æœåŠ¡ WEB è®¿é—®ç«¯å£</span></span><br><span class="line"><span class="attr">server.port</span>=<span class="string">8080</span></span><br><span class="line"></span><br><span class="line"><span class="attr">management.endpoint.health.show-details</span>=<span class="string">always</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨åº”ç”¨ã€‚å†æ¬¡æ‰“å¼€<a href="http://localhost:8080/actuator/health">http://localhost:8080/actuator/health</a></p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929150622468.png" alt="image-20210929150622468" style="zoom:50%;" /></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæ£€æŸ¥äº†ç£ç›˜èµ„æºï¼Œç£ç›˜å¤§å°ä¸º325Gï¼Œå‰©ä½™ç©ºé—´ä¸º63.3Gï¼Œå¦‚æœå‰©ä½™ç©ºé—´ä½äºthresholdï¼Œé‚£ä¹ˆè¿™ä¸ªç£ç›˜å°±æ˜¯ä¸å¥åº·çš„ã€‚</p><p>statuså–å€¼ï¼š</p><ul><li>UPï¼šæ­£å¸¸</li><li>DOWN: é‡åˆ°äº†é—®é¢˜ï¼Œä¸æ­£å¸¸</li><li>OUT_OF_SERVICE: èµ„æºæœªåœ¨ä½¿ç”¨ï¼Œæˆ–è€…ä¸è¯¥å»ä½¿ç”¨</li><li>UNKNOWN: ä¸çŸ¥é“</li></ul><p><a href="http://localhost:8080/actuator/info">http://localhost:8080/actuator/info</a>æ˜¯ä¸€ä¸ªæè¿°ç«¯ç‚¹ï¼Œä¸»è¦ç”¨æ¥æè¿°åº”ç”¨ä¿¡æ¯ã€‚ä¾‹å¦‚åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æè¿°åº”ç”¨</span></span><br><span class="line"><span class="attr">info.app-name</span>=<span class="string">spring-boot-demo</span></span><br><span class="line"><span class="attr">info.author</span>=<span class="string">heling</span></span><br><span class="line"><span class="attr">info.email</span>=<span class="string">xxx@email</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨åº”ç”¨ï¼Œç„¶åè®¿é—®infoç«¯ç‚¹</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929151753941.png" alt="image-20210929151753941" style="zoom:50%;" /></p><p>ä¸‹é¢æ˜¯Spring Boot Actuatorå¸¸è§çš„ç›‘æ§ç«¯ç‚¹</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929151934733.png" alt="image-20210929151934733"></p><p>é™¤äº†healthå’Œinfoï¼Œå…¶ä»–çš„ç«¯ç‚¹éƒ½æ˜¯éšè—çš„ã€‚åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®å³å¯æ¿€æ´»æ‰€æœ‰ç«¯ç‚¹ã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¿€æ´»æ‰€æœ‰çš„actuatorç«¯ç‚¹</span></span><br><span class="line"><span class="attr">management.endpoints.web.exposure.include</span>=<span class="string">*</span></span><br></pre></td></tr></table></figure><p>é‡å¯åº”ç”¨ï¼Œåˆ·æ–°<a href="localhost:8080/actuator">localhost:8080/actuator</a>å°±ä¼šå‘ç°å·²æ¿€æ´»æ‰€æœ‰ç«¯ç‚¹ï¼Œå¦‚æœåªæƒ³æ¿€æ´»ä¸ªåˆ«ç«¯ç‚¹ï¼Œé‚£ä¹ˆå°±æ›´æ”¹ä¸€ä¸‹é…ç½®ï¼Œæ¯”å¦‚åªæ¿€æ´»metricså’Œhealthç«¯ç‚¹ã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management.endpoints.web.exposure.include</span>=<span class="string">metrics,health</span></span><br></pre></td></tr></table></figure><h2 id="å…­ã€Spring-Booté…ç½®ç®¡ç†"><a href="#å…­ã€Spring-Booté…ç½®ç®¡ç†" class="headerlink" title="å…­ã€Spring Booté…ç½®ç®¡ç†"></a>å…­ã€Spring Booté…ç½®ç®¡ç†</h2><ul><li>æ”¯æŒçš„é…ç½®æ ¼å¼</li></ul><p>Spring Booté™¤äº†æ”¯æŒ<code>.properties</code>ç±»å‹çš„é…ç½®æ–‡ä»¶å¤–ï¼Œè¿˜æ”¯æŒ<code>.yml</code>æˆ–è€…<code>.yaml</code>çš„æ–‡ä»¶ã€‚</p><p><strong>Yet Anther Markup Languageï¼ˆ.yml/.yamlï¼‰</strong>æ˜¯JSONå­é›†ï¼Œæ ¼å¼å¦‚ä¸‹</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">info:</span></span><br><span class="line">  <span class="attr">app-name:</span> <span class="string">spring-boot-demo</span></span><br><span class="line">  <span class="attr">author:</span> <span class="string">heling</span></span><br><span class="line">  <span class="attr">email:</span> <span class="string">xxx@email</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoint:</span></span><br><span class="line">    <span class="attr">health:</span></span><br><span class="line">      <span class="attr">show-details:</span> <span class="string">always</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">metrics,health</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">spring-boot-demo</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯<code>:</code>åçš„ç©ºæ ¼ä¸€å®šä¸èƒ½ç¼ºå°‘ï¼Œå¦å¤–æ¯ä¸€è¡Œå‰æœ‰ä¸¥æ ¼çš„ç¼©è¿›ã€‚</p><p>åœ¨å®é™…é¡¹ç›®ä¸­æ›´æ¨èä½¿ç”¨<code>.yml</code>æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œå› ä¸ºå…¶å¯è¯»æ€§æ›´å¼ºï¼Œåœ¨ä¸šç•Œæ›´å—æ¬¢è¿ï¼Œè€Œä¸”å®ƒå¯ä»¥ä¿è¯é…ç½®è¯»å–çš„é¡ºåºã€‚</p><ul><li><p>é…ç½®ç®¡ç†å¸¸ç”¨æ–¹å¼</p><ul><li><p>é…ç½®æ–‡ä»¶</p></li><li><p>ç¯å¢ƒå˜é‡</p><p>ä¾‹å¦‚åœ¨å°†<code>always</code>æ”¹ä¸º<code>$&#123;SOME_ENV&#125;</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">info:</span></span><br><span class="line">  <span class="attr">app-name:</span> <span class="string">spring-boot-demo</span></span><br><span class="line">  <span class="attr">author:</span> <span class="string">heling</span></span><br><span class="line">  <span class="attr">email:</span> <span class="string">xxx@email</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoint:</span></span><br><span class="line">    <span class="attr">health:</span></span><br><span class="line">      <span class="attr">show-details:</span> <span class="string">$&#123;SOME_ENV&#125;</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">metrics,health</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">spring-boot-demo</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™æŒ‡å®šç¯å¢ƒå˜é‡</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929154407814.png" alt="image-20210929154407814"></p><p>å¯åŠ¨åº”ç”¨å‘ç°ä¾ç„¶å¯ä»¥å±•ç¤ºè¯¦æƒ…ï¼Œä½†æ˜¯åœ¨é‡æ–°æ„å»ºåº”ç”¨çš„æ—¶å€™ï¼Œä¼šå› ä¸ºå•å…ƒæµ‹è¯•æŠ¥é”™ï¼Œå› ä¸ºå•å…ƒæµ‹è¯•æ‹¿ä¸åˆ°ideaä¸­çš„é…ç½®ï¼Œè¿™æ—¶å€™å¯ä»¥åˆ é™¤æµ‹è¯•ç±»æˆ–è€…åœ¨ä½¿ç”¨<code>mvn clean install -DskipTests</code>è·³è¿‡å•å…ƒæµ‹è¯•ã€‚æ„å»ºåº”ç”¨ä¹‹åï¼Œä½¿ç”¨<code>java -jar spring-boot-demo-0.0.1-SNAPSHOT.jar --SOME_ENV=always</code>å¯åŠ¨åº”ç”¨ã€‚</p></li><li><p>å¤–éƒ¨é…ç½®æ–‡ä»¶</p><p>å°†JaråŒ…å’Œé…ç½®æ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œç„¶åä½¿ç”¨å‘½ä»¤å¯åŠ¨åº”ç”¨ï¼ŒSpring Bootä¼šä¼˜å…ˆè¯»å–é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´å¤–éƒ¨é…ç½®æ–‡ä»¶çš„ä¼˜å…ˆçº§æ¯”JaråŒ…çš„é…ç½®æ–‡ä»¶æ›´é«˜ã€‚</p></li><li><p>å‘½ä»¤è¡Œå‚æ•°</p><p>æ¯”å¦‚æˆ‘å¸Œæœ›åº”ç”¨çš„Tomcatè¿è¡Œç«¯å£ä¸º8081ï¼Œä½†æˆ‘åˆä¸æƒ³å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œåªéœ€è¦åœ¨è¿è¡Œé…ç½®é‡Œå¡«å†™<code>--server.port=8081</code>å°±å¯ä»¥äº†ã€‚</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929155914558.png" alt="image-20210929155914558"></p><p>å¦‚æœæ˜¯ä½¿ç”¨å‘½ä»¤çš„æ–¹å¼å¯åŠ¨åº”ç”¨çš„è¯ï¼Œä½¿ç”¨<code>java -jar spring-boot-demo-0.0.1-SNAPSHOT.jar --    server.port=8081</code>å¯åŠ¨å³å¯ã€‚</p></li></ul></li></ul><h2 id="ä¸ƒã€Profile"><a href="#ä¸ƒã€Profile" class="headerlink" title="ä¸ƒã€Profile"></a>ä¸ƒã€Profile</h2><ul><li>å¦‚ä½•å®ç°ä¸åŒç¯å¢ƒä¸åŒé…ç½®</li></ul><p>åœ¨å®é™…é¡¹ç›®ä¸­æˆ‘ä»¬å¾€å¾€éœ€è¦åœ¨ä¸åŒçš„ç¯å¢ƒä½¿ç”¨ä¸åŒçš„é…ç½®ï¼Œä¾‹å¦‚å¼€å‘ç¯å¢ƒçš„Tomcatä¸éœ€è¦æ€§èƒ½è°ƒä¼˜ï¼Œä½†æ˜¯ç”Ÿäº§ç¯å¢ƒçš„Tomcatå¾€å¾€éœ€è¦è®¾ç½®ä¸€äº›æ€§èƒ½è°ƒä¼˜å‚æ•°ï¼Œæ¯”å¦‚æœ€å¤§è¿æ¥æ•°ï¼Œæœ€å¤§é™åˆ¶æ•°ç­‰ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨Profileã€‚</p><ul><li>æ€ä¹ˆä½¿ç”¨</li></ul><p>å¦‚æœåº”ç”¨æ˜¯<code>yml</code>æ ¼å¼é…ç½®çš„ï¼Œé‚£ä¹ˆåœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨è¿å­—ç¬¦<code>---</code>å°†é…ç½®æ–‡ä»¶åˆ†æˆè‹¥å¹²æ®µï¼Œ</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰€æœ‰ç¯å¢ƒå…¬ç”¨çš„é…ç½®å±æ€§</span></span><br><span class="line"><span class="attr">info:</span></span><br><span class="line">  <span class="attr">app-name:</span> <span class="string">spring-boot-demo</span></span><br><span class="line">  <span class="attr">author:</span> <span class="string">heling</span></span><br><span class="line">  <span class="attr">email:</span> <span class="string">xxx@email</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoint:</span></span><br><span class="line">    <span class="attr">health:</span></span><br><span class="line">      <span class="attr">show-details:</span> <span class="string">$&#123;SOME_ENV&#125;</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">metrics,health</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">spring-boot-demo</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">config:</span></span><br><span class="line">    <span class="attr">activate:</span></span><br><span class="line">      <span class="attr">on-profile:</span> <span class="string">dev</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment"># profile=yçš„ä¸“ç”¨å±æ€§ï¼Œä¹Ÿå°±æ˜¯æŸä¸ªç¯å¢ƒä¸‹çš„ä¸“ç”¨å±æ€§</span></span><br><span class="line"><span class="comment"># ç”Ÿäº§ç¯å¢ƒ</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">config:</span></span><br><span class="line">    <span class="attr">activate:</span></span><br><span class="line">      <span class="attr">on-profile:</span> <span class="string">prod</span></span><br><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">tomcat:</span></span><br><span class="line">    <span class="attr">threads:</span></span><br><span class="line">      <span class="attr">max:</span> <span class="number">300</span></span><br><span class="line">    <span class="attr">max-connections:</span> <span class="number">1000</span></span><br></pre></td></tr></table></figure><p>å¦‚æœåº”ç”¨ä»¥<code>dev</code>å¯åŠ¨çš„è¯å°±ä¼šä½¿ç”¨1,2ä¸¤æ®µï¼Œå¦‚æœä»¥<code>prod</code>å¯åŠ¨çš„è¯ï¼Œå°±ä¼šä½¿ç”¨1,3ä¸¤æ®µã€‚ä¾‹å¦‚ä½¿ç”¨<code>prod</code>å¯åŠ¨</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929161705714.png" alt="image-20210929161705714"></p><p>å¦‚æœæƒ³åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šå¯åŠ¨ç¯å¢ƒï¼Œåˆ™æ·»åŠ é…ç½®</p><p><img src="https://heling-picture.oss-cn-hangzhou.aliyuncs.com/img/image-20210929162306832.png" alt="image-20210929162306832" style="zoom:50%;" /></p>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaæ³¨è§£å¼€å‘Servlet</title>
      <link href="/posts/11551.html"/>
      <url>/posts/11551.html</url>
      
        <content type="html"><![CDATA[<p>å…³äºJavaè‡ªåŠ¨æ³¨è§£å¼€å‘Servlet</p><span id="more"></span><h1 id="è‡ªåŠ¨æ³¨è§£é…ç½®"><a href="#è‡ªåŠ¨æ³¨è§£é…ç½®" class="headerlink" title="è‡ªåŠ¨æ³¨è§£é…ç½®"></a>è‡ªåŠ¨æ³¨è§£é…ç½®</h1><p>è‡ªåŠ¨æ³¨è§£å¼€å‘çš„å®ç°æ­¥éª¤ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªwebé¡¹ç›®</li><li>å®šä¹‰ä¸€ä¸ªç±»ï¼Œç»§æ‰¿HttpServlet</li><li>é‡å†™ä¸€ä¸ªdoGetå’ŒdoPostæ–¹æ³•</li><li>åœ¨ç±»ä¸Šä½¿ç”¨<code>@WebServlet</code>æ³¨è§£é…ç½®Servlet</li><li>éƒ¨ç½²å¹¶å¯åŠ¨é¡¹ç›®</li><li>é€šè¿‡æµè§ˆå™¨è¿›è¡Œæµ‹è¯•</li></ol><h2 id="1-é…ç½®æ­¥éª¤"><a href="#1-é…ç½®æ­¥éª¤" class="headerlink" title="1 é…ç½®æ­¥éª¤"></a>1 é…ç½®æ­¥éª¤</h2><h4 id="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºJavaWebå·¥ç¨‹ï¼Œå¹¶ç§»é™¤web-xml"><a href="#ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºJavaWebå·¥ç¨‹ï¼Œå¹¶ç§»é™¤web-xml" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºJavaWebå·¥ç¨‹ï¼Œå¹¶ç§»é™¤web.xml"></a>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºJavaWebå·¥ç¨‹ï¼Œå¹¶ç§»é™¤web.xml</h4><p><img src="https://img.imgdb.cn/item/605c192d8322e6675c76ce08.jpg" alt=""></p><p><img src="https://img.imgdb.cn/item/605c1a2d8322e6675c773eda.jpg" alt=""></p><p>é¡¹ç›®åˆ›å»ºå®Œæˆååœ¨webç›®å½•æ²¡æœ‰web.xmlæ–‡ä»¶ï¼Œåªæœ‰ä¸€ä¸ªindex.jspæ–‡ä»¶ï¼Œå¯ä»¥å°†index.jspæ–‡ä»¶åˆ é™¤ã€‚ä½†æ˜¯åœ¨webç›®å½•ä¸‹æˆ‘ä»¬ä»ç„¶éœ€è¦WEB-INFæ–‡ä»¶å¤¹ï¼Œå› ä¸ºé‡Œé¢ä¸æ­¢web.xmlè¿™ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿˜ä¼šæœ‰ç¬¬ä¸‰æ–¹çš„ä¾èµ–åŒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨webç›®å½•ä¸‹æ‰‹åŠ¨åˆ›å»ºWEB-INFï¼Œå¤§å°å†™ä¸€è‡´ã€‚</p><p><img src="https://img.imgdb.cn/item/605c1b6f8322e6675c77d9e3.jpg" alt=""></p><h4 id="ç¬¬äºŒæ­¥ï¼šç¼–å†™Servletï¼Œé…ç½®æ³¨è§£"><a href="#ç¬¬äºŒæ­¥ï¼šç¼–å†™Servletï¼Œé…ç½®æ³¨è§£" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šç¼–å†™Servletï¼Œé…ç½®æ³¨è§£"></a>ç¬¬äºŒæ­¥ï¼šç¼–å†™Servletï¼Œé…ç½®æ³¨è§£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.cstube.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">åŸºäºæ³¨è§£æ–¹å¼å¼€å‘Servlet</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet</span> (<span class="string">&quot;/servletDemo01&quot;</span>)  <span class="comment">//é…ç½®æ³¨è§£çš„æ˜ å°„</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServletDemo01</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ServletDemo01æ‰§è¡Œäº†...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•"><a href="#ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•"></a>ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•</h4><p>æµè§ˆå™¨åœ°å€æ è¾“å…¥<code>http://localhost:8080/demo3/servletDemo01</code>,æœ‰ä¸‹é¢ç»“æœï¼š</p><p><img src="https://img.imgdb.cn/item/605c1e9d8322e6675c79703f.jpg" alt=""></p><h2 id="2-è‡ªåŠ¨æ³¨è§£å¼€å‘çš„æ³¨è§£è¯¦è§£"><a href="#2-è‡ªåŠ¨æ³¨è§£å¼€å‘çš„æ³¨è§£è¯¦è§£" class="headerlink" title="2 è‡ªåŠ¨æ³¨è§£å¼€å‘çš„æ³¨è§£è¯¦è§£"></a>2 è‡ªåŠ¨æ³¨è§£å¼€å‘çš„æ³¨è§£è¯¦è§£</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * WebServletæ³¨è§£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> WebServlet &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‡å®šServletçš„åç§°ã€‚</span></span><br><span class="line"><span class="comment">     * ç›¸å½“äºxmlé…ç½®ä¸­&lt;servlet&gt;æ ‡ç­¾ä¸‹çš„&lt;servlet-name&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äºæ˜ å°„Servletè®¿é—®çš„urlæ˜ å°„</span></span><br><span class="line"><span class="comment">     * ç›¸å½“äºxmlé…ç½®æ—¶çš„&lt;url-pattern&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String[] value() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç›¸å½“äºxmlé…ç½®æ—¶çš„&lt;url-pattern&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String[] urlPatterns() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äºé…ç½®Servletçš„å¯åŠ¨æ—¶æœº</span></span><br><span class="line"><span class="comment">     * ç›¸å½“äºxmlé…ç½®çš„&lt;load-on-startup&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">loadOnStartup</span><span class="params">()</span> <span class="keyword">default</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äºé…ç½®Servletçš„åˆå§‹åŒ–å‚æ•°</span></span><br><span class="line"><span class="comment">     * ç›¸å½“äºxmlé…ç½®çš„&lt;init-param&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    WebInitParam[] initParams() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äºé…ç½®Servletæ˜¯å¦æ”¯æŒå¼‚æ­¥</span></span><br><span class="line"><span class="comment">     * ç›¸å½“äºxmlé…ç½®çš„&lt;async-supported&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">asyncSupported</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äºæŒ‡å®šServletçš„å°å›¾æ ‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">smallIcon</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äºæŒ‡å®šServletçš„å¤§å›¾æ ‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">largeIcon</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äºæŒ‡å®šServletçš„æè¿°ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">description</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äºæŒ‡å®šServletçš„æ˜¾ç¤ºåç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">displayName</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Servlet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS7å¯åŠ¨Tomcatåæµè§ˆå™¨æ— æ³•è®¿é—®çš„è§£å†³æ–¹æ³•</title>
      <link href="/posts/2483.html"/>
      <url>/posts/2483.html</url>
      
        <content type="html"><![CDATA[<p>è‡ªå·±çš„Linuxç³»ç»Ÿæ˜¯CentOS7,ä»Šå¤©åœ¨å­¦ä¹ Tomcatçš„ä½¿ç”¨çš„æ—¶å€™ï¼Œåœ¨Linuxé‡Œé¢å¯åŠ¨æˆåŠŸä¹‹åï¼Œåœ¨Windowsæµè§ˆå™¨è®¿é—®<code>http://ipåœ°å€:8080</code>å¤±è´¥ï¼ŒåŸæ¥éœ€è¦æœ‰é˜²ç«å¢™çš„ç›¸å…³æ“ä½œï¼Œè¦ç¼–è¾‘/etc/sysconfigç›®å½•ä¸‹é¢çš„iptablesæ–‡ä»¶ï¼Œä½†æ˜¯CentOS7ä¸­æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥å¦‚æœè¦å¯¹é˜²ç«å¢™æ“ä½œï¼Œéœ€è¦æ›´æ–°æˆ–è€…é‡æ–°å®‰è£…é˜²ç«å¢™æœåŠ¡ã€‚</p><span id="more"></span><p>è§£å†³æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>å®‰è£…æˆ–è€…æ›´æ–°iptables-services</p><p><code>yum install iptables-services</code></p></li><li><p>å¯åŠ¨iptables</p><p><code>systemctl enable iptables</code></p><p>è¿™ä¸ªæ—¶å€™ï¼Œ/etc/sysconfigç›®å½•ä¸‹é¢å°±æœ‰äº†iptablesæ–‡ä»¶äº†ã€‚</p></li><li><p>æ‰“å¼€iptables</p><p><code>systemctl start iptables</code></p></li><li><p>ç¼–è¾‘é˜²ç«å¢™é…ç½®</p><p><code>$ vi /etc/sysconfig/iptables</code></p></li><li><p>æ·»åŠ 8080ç«¯å£çš„é˜²ç«å¢™,å…è®¸è®¿é—®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">*filter</span><br><span class="line">:INPUT ACCEPT [0:0]</span><br><span class="line">:FORWARD ACCEPT [0:0]</span><br><span class="line">:OUTPUT ACCEPT [0:0]</span><br><span class="line">-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A INPUT -p icmp -j ACCEPT</span><br><span class="line">-A INPUT -i lo -j ACCEPT</span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 3306 -j ACCEPT</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 8080 -j ACCEPT</span><br><span class="line">-A INPUT -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">-A FORWARD -j REJECT --reject-with icmp-host-prohibited</span><br></pre></td></tr></table></figure></li><li><p>è¾“å…¥iå¼€å§‹ç¼–è¾‘,ESCé”®ç»“æŸç¼–è¾‘,wqä¿å­˜å¹¶é€€å‡º.</p></li><li><p>é‡å¯é˜²ç«å¢™</p><p><code>$ service iptables restart</code></p></li></ol><p>ä¹‹åå°±å¯ä»¥åœ¨æœ¬æœºé€šè¿‡æµè§ˆå™¨è®¿é—®<code>http://ipåœ°å€:8080</code>,å°±å¯ä»¥æ­£å¸¸çœ‹åˆ°tomcatçš„é»˜è®¤æ¬¢è¿é¡µé¢äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pythonä¸­çš„é«˜é˜¶å‡½æ•°</title>
      <link href="/posts/57202.html"/>
      <url>/posts/57202.html</url>
      
        <content type="html"><![CDATA[<p>æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè¿™æ ·çš„å‡½æ•°ç§°ä¸ºé«˜é˜¶å‡½æ•°ï¼Œé«˜é˜¶å‡½æ•°æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä½“ç°ã€‚å‡½æ•°å¼ç¼–ç¨‹å°±æ˜¯æŒ‡è¿™ç§é«˜åº¦æŠ½è±¡çš„ç¼–ç¨‹èŒƒå¼ã€‚</p><span id="more"></span><h2 id="ä½“éªŒé«˜é˜¶å‡½æ•°"><a href="#ä½“éªŒé«˜é˜¶å‡½æ•°" class="headerlink" title="ä½“éªŒé«˜é˜¶å‡½æ•°"></a>ä½“éªŒé«˜é˜¶å‡½æ•°</h2><p>åœ¨Pythonä¸­ï¼Œ<code>abs()</code>å‡½æ•°å¯ä»¥å®Œæˆå¯¹æ•°å­—æ±‚ç»å¯¹å€¼è®¡ç®—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">abs</span>(-<span class="number">10</span>)  <span class="comment"># 10</span></span><br></pre></td></tr></table></figure><p><code>round()</code>å‡½æ•°å¯ä»¥å®Œæˆå¯¹æ•°å­—çš„å››èˆäº”å…¥è®¡ç®—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">round</span>(<span class="number">1.2</span>)  <span class="comment"># 1</span></span><br><span class="line"><span class="built_in">round</span>(<span class="number">1.9</span>)  <span class="comment"># 2</span></span><br></pre></td></tr></table></figure><p>éœ€æ±‚ï¼šä»»æ„ä¸¤ä¸ªæ•°å­—ï¼ŒæŒ‰ç…§æŒ‡å®šè¦æ±‚æ•´ç†æ•°å­—åå†è¿›è¡Œæ±‚å’Œè®¡ç®—ã€‚</p><ul><li>æ–¹æ³•1</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_num</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(a) + <span class="built_in">abs</span>(b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">result = add_num(-<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 3</span></span><br></pre></td></tr></table></figure><ul><li>æ–¹æ³•2</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sum_num</span>(<span class="params">a, b, f</span>):</span><br><span class="line">    <span class="keyword">return</span> f(a) + f(b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">result = sum_num(-<span class="number">1</span>, <span class="number">2</span>, <span class="built_in">abs</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 3</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šä¸¤ç§æ–¹æ³•å¯¹æ¯”ä¹‹åï¼Œå‘ç°ï¼Œæ–¹æ³•2çš„ä»£ç ä¼šæ›´åŠ ç®€æ´ï¼Œå‡½æ•°çµæ´»æ€§æ›´é«˜ã€‚</p></blockquote><p>å‡½æ•°å¼ç¼–ç¨‹å¤§é‡ä½¿ç”¨å‡½æ•°ï¼Œå‡å°‘äº†ä»£ç çš„é‡å¤ï¼Œå› æ­¤ç¨‹åºæ¯”è¾ƒçŸ­ï¼Œå¼€å‘é€Ÿåº¦è¾ƒå¿«ã€‚</p><h2 id="å†…ç½®é«˜é˜¶å‡½æ•°"><a href="#å†…ç½®é«˜é˜¶å‡½æ•°" class="headerlink" title="å†…ç½®é«˜é˜¶å‡½æ•°"></a>å†…ç½®é«˜é˜¶å‡½æ•°</h2><h3 id="map"><a href="#map" class="headerlink" title="map()"></a>map()</h3><p>map(func, lst)ï¼Œå°†ä¼ å…¥çš„å‡½æ•°å˜é‡funcä½œç”¨åˆ°lstå˜é‡çš„æ¯ä¸ªå…ƒç´ ä¸­ï¼Œå¹¶å°†ç»“æœç»„æˆæ–°çš„åˆ—è¡¨(Python2)/è¿­ä»£å™¨(Python3)è¿”å›ã€‚</p><p>éœ€æ±‚ï¼šè®¡ç®—<code>list1</code>åºåˆ—ä¸­å„ä¸ªæ•°å­—çš„2æ¬¡æ–¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x ** <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">result = <span class="built_in">map</span>(func, list1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># &lt;map object at 0x0000013769653198&gt;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(result))  <span class="comment"># [1, 4, 9, 16, 25]</span></span><br></pre></td></tr></table></figure><h3 id="reduce"><a href="#reduce" class="headerlink" title="reduce()"></a>reduce()</h3><p>reduce(funcï¼Œlst)ï¼Œå…¶ä¸­funcå¿…é¡»æœ‰ä¸¤ä¸ªå‚æ•°ã€‚æ¯æ¬¡funcè®¡ç®—çš„ç»“æœç»§ç»­å’Œåºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ åšç´¯ç§¯è®¡ç®—ã€‚</p><blockquote><p>æ³¨æ„ï¼šreduce()ä¼ å…¥çš„å‚æ•°funcå¿…é¡»æ¥æ”¶2ä¸ªå‚æ•°ã€‚</p></blockquote><p>éœ€æ±‚ï¼šè®¡ç®—<code>list1</code>åºåˆ—ä¸­å„ä¸ªæ•°å­—çš„ç´¯åŠ å’Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"></span><br><span class="line">list1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">result = functools.reduce(func, list1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 15</span></span><br></pre></td></tr></table></figure><h3 id="filter"><a href="#filter" class="headerlink" title="filter()"></a>filter()</h3><p>filter(func, lst)å‡½æ•°ç”¨äºè¿‡æ»¤åºåˆ—, è¿‡æ»¤æ‰ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ , è¿”å›ä¸€ä¸ª filter å¯¹è±¡ã€‚å¦‚æœè¦è½¬æ¢ä¸ºåˆ—è¡¨, å¯ä»¥ä½¿ç”¨ list() æ¥è½¬æ¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x % <span class="number">2</span> == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">result = <span class="built_in">filter</span>(func, list1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># &lt;filter object at 0x0000017AF9DC3198&gt;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(result))  <span class="comment"># [2, 4, 6, 8, 10]</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·®åˆ†éšç§åŸºç¡€</title>
      <link href="/posts/9305.html"/>
      <url>/posts/9305.html</url>
      
        <content type="html"><![CDATA[<p>æ•°æ®çš„éšç§ä¿æŠ¤é—®é¢˜æœ€æ—©ç”±ç»Ÿè®¡å­¦å®¶Dalenius åœ¨20ä¸–çºª70å¹´ä»£æœ«æå‡ºï¼Œä»–è®¤ä¸ºï¼Œä¿æŠ¤æ•°æ®åº“ä¸­çš„éšç§ä¿¡æ¯ï¼Œå°±æ˜¯è¦ä½¿ä»»ä½•ç”¨æˆ·ï¼ˆåŒ…æ‹¬åˆæ³•ç”¨æˆ·å’Œæ½œåœ¨çš„æ”»å‡»è€…ï¼‰åœ¨è®¿é—®æ•°æ®åº“çš„è¿‡ç¨‹ä¸­æ— æ³•è·å–å…³äºä»»æ„ä¸ªä½“çš„ç¡®åˆ‡ä¿¡æ¯ ã€‚</p><span id="more"></span><p>ä»å·²æœ‰çš„ç ”ç©¶æ¥çœ‹ï¼Œk-anonymityåŠå…¶æ‰©å±•æ¨¡å‹åœ¨éšç§ä¿æŠ¤é¢†åŸŸå½±å“æ·±è¿œä¸”è¢«å¹¿æ³›åº”ç”¨ã€‚è¿™äº›æ¨¡ å‹çš„åŸºæœ¬æ€æƒ³æ˜¯å°†æ•°æ®é›†é‡Œä¸æ”»å‡»è€…èƒŒæ™¯çŸ¥è¯†ç›¸å…³çš„å±æ€§å®šä¹‰ä¸ºå‡†æ ‡è¯†ç¬¦ï¼Œé€šè¿‡å¯¹è®°å½•çš„å‡†æ ‡è¯†ç¬¦å€¼è¿›è¡Œæ³›åŒ–ã€å‹ç¼©å¤„ç†ï¼Œä½¿å¾—æ‰€æœ‰è®°å½•è¢«åˆ’åˆ†åˆ°è‹¥å¹²ä¸ªç­‰ä»·ç±»ï¼ˆEquivalence Groupï¼‰,æ¯ä¸ªç­‰ä»·ç±»ä¸­çš„è®°å½•å…·æœ‰ç›¸åŒ çš„å‡†æ ‡è¯†ç¬¦ï¼Œä»è€Œå®ç°å°†ä¸€ä¸ªè®°å½•éšè—åœ¨ä¸€ç»„è®°å½•ä¸­ã€‚å› æ­¤ï¼Œè¿™ç±»æ¨¡å‹ä¹Ÿè¢«ç§°ä¸ºåŸºäºåˆ†ç»„çš„éšç§ä¿æŠ¤æ¨¡å‹ã€‚</p><p>å·®åˆ†éšç§æ˜¯Dworkåœ¨2006å¹´é’ˆå¯¹ç»Ÿè®¡æ•°æ®åº“çš„éšç§æ³„éœ²é—®é¢˜æå‡ºçš„ä¸€ç§æ–°çš„éšç§å®šä¹‰ã€‚åœ¨æ­¤å®šä¹‰ä¸‹ï¼Œå¯¹æ•°æ®é›†çš„è®¡ç®—å¤„ç†ç»“æœå¯¹äºå…·ä½“æŸä¸ªè®°å½•çš„å˜åŒ–æ˜¯ä¸æ•æ„Ÿçš„ï¼Œå•ä¸ªè®°å½•åœ¨æ•°æ®é›†ä¸­æˆ–è€…ä¸åœ¨æ•°æ®é›†ä¸­ï¼Œå¯¹è®¡ç®—ç»“æœçš„å½±å“å¾®ä¹å…¶å¾®ã€‚æ‰€ä»¥ï¼Œä¸€ ä¸ªè®°å½•å› å…¶åŠ å…¥åˆ°æ•°æ®é›†ä¸­æ‰€äº§ç”Ÿçš„éšç§æ³„éœ²é£é™©è¢«æ§åˆ¶åœ¨æå°çš„ã€å¯æ¥å—çš„èŒƒå›´å†…ï¼Œæ”»å‡»è€…æ— æ³•é€šè¿‡è§‚å¯Ÿè®¡ç®—ç»“æœè€Œè·å–å‡†ç¡®çš„ä¸ªä½“ä¿¡æ¯ã€‚</p><p>å·®åˆ†éšç§ä¿æŠ¤æ¨¡å‹çš„æ€æƒ³æºè‡ªäºä¸€ä¸ªå¾ˆæœ´ç´ çš„è§‚å¯Ÿï¼š<strong>å½“æ•°æ®é›† ï¼¤ ä¸­åŒ…å«ä¸ªä½“ Aliceæ—¶ï¼Œè®¾ å¯¹ ï¼¤ è¿›è¡Œä»»æ„æŸ¥è¯¢æ“ä½œfï¼ˆä¾‹å¦‚è®¡æ•°ã€æ±‚å’Œã€å¹³å‡å€¼ã€ä¸­ä½æ•° æˆ–å…¶å®ƒèŒƒå›´æŸ¥è¯¢ç­‰ï¼‰æ‰€å¾—åˆ°çš„ç»“æœä¸ºï½†(ï¼¤ï¼‰ï¼Œå¦‚æœå°† Aliceçš„ä¿¡æ¯ä» ï¼¤ ä¸­åˆ é™¤åè¿›è¡ŒæŸ¥è¯¢å¾—åˆ°çš„ç»“æœä»ç„¶ä¸ºï½†ï¼ˆï¼¤ï¼‰ï¼Œåˆ™å¯ä»¥è®¤ä¸ºï¼ŒAliceçš„ä¿¡æ¯å¹¶æ²¡æœ‰å› ä¸ºè¢«åŒ…å«åœ¨æ•°æ®é›† ï¼¤ ä¸­è€Œäº§ç”Ÿé¢å¤–çš„é£é™©ã€‚å·®åˆ†éšç§ä¿æŠ¤å°±æ˜¯è¦ä¿è¯ä»»ä¸€ä¸ªä½“åœ¨æ•°æ®é›†ä¸­æˆ–è€…ä¸åœ¨æ•°æ® é›†ä¸­æ—¶ï¼Œå¯¹æœ€ç»ˆå‘å¸ƒçš„æŸ¥è¯¢ç»“æœå‡ ä¹æ²¡æœ‰å½±å“ã€‚å…·ä½“åœ°è¯´ï¼Œè®¾æœ‰ä¸¤ä¸ªå‡ ä¹å®Œå…¨ç›¸åŒçš„æ•°æ®é›†ï¼ˆä¸¤è€…çš„åŒºåˆ«ä»…åœ¨äºä¸€ä¸ªè®°å½•ä¸åŒï¼‰ï¼Œåˆ†åˆ«å¯¹è¿™ä¸¤ä¸ªæ•°æ®é›†è¿›è¡ŒæŸ¥ è¯¢è®¿é—®ï¼ŒåŒä¸€æŸ¥è¯¢åœ¨ä¸¤ä¸ªæ•°æ®é›†ä¸Šäº§ç”ŸåŒä¸€ç»“æœçš„æ¦‚ç‡çš„æ¯”å€¼æ¥è¿‘äºï¼‘ã€‚</strong></p><h2 id="å·®åˆ†éšç§å®šä¹‰"><a href="#å·®åˆ†éšç§å®šä¹‰" class="headerlink" title="å·®åˆ†éšç§å®šä¹‰"></a>å·®åˆ†éšç§å®šä¹‰</h2><p><img src="https://img.imgdb.cn/item/600153e13ffa7d37b34644c5.jpg" alt=""></p><p><img src="https://img.imgdb.cn/item/600155113ffa7d37b346de19.jpg"  /></p><h3 id="éšç§ä¿æŠ¤é¢„ç®—"><a href="#éšç§ä¿æŠ¤é¢„ç®—" class="headerlink" title="éšç§ä¿æŠ¤é¢„ç®—"></a>éšç§ä¿æŠ¤é¢„ç®—</h3><p>éšç§ä¿æŠ¤é¢„ç®—$\epsilon$ç”¨æ¥æ§åˆ¶ç®—æ³•Måœ¨ä¸¤ä¸ªç›¸é‚»æ•°æ®é›†ä¸Šè·å¾—ç›¸åŒè¾“å‡ºçš„æ¦‚ç‡æ¯”å€¼ï¼Œå®ƒäº‹å®ä¸Šä½“ç°äº†Mæ‰€èƒ½å¤Ÿæä¾›çš„éšç§ä¿æŠ¤æ°´å¹³ã€‚å®é™…åº”ç”¨ä¸­ï¼Œ$\epsilon$çš„å–å€¼å¾ˆå°ï¼Œä¾‹å¦‚0.01,0.1ï¼Œæˆ–è€…ln2,ln3ç­‰ï¼Œ$\epsilon$è¶Šå°ï¼Œè¡¨ç¤ºéšç§ä¿æŠ¤æ°´å¹³è¶Šé«˜ã€‚å½“$\epsilon$ä¸º0æ—¶ï¼Œè¡¨ç¤ºå¯¹äºä»»æ„ä¸´è¿‘æ•°æ®é›†ï¼Œç®—æ³•éƒ½å°†è¾“å‡ºä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒå®Œå…¨ç›¸åŒçš„ç»“æœï¼Œè¿™äº›ç»“æœä¹Ÿä¸èƒ½åæ˜ å‡ºä»»ä½•å…³äºæ•°æ®é›†çš„æœ‰ç”¨çš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œ$\epsilon$çš„å–å€¼è¦è€ƒè™‘åˆ°å®‰å…¨æ€§å’Œå¯ç”¨æ€§ä¹‹é—´çš„å¹³è¡¡ã€‚</p><h3 id="æ•æ„Ÿåº¦"><a href="#æ•æ„Ÿåº¦" class="headerlink" title="æ•æ„Ÿåº¦"></a>æ•æ„Ÿåº¦</h3><p>æ•æ„Ÿåº¦æ˜¯å†³å®šåŠ å…¥å™ªå£°å¤§å°çš„å…³é”®å‚æ•°ï¼Œå®ƒæŒ‡åˆ é™¤æ•°æ®é›†ä¸­ä»»ä¸€è®°å½•å¯¹æŸ¥è¯¢ç»“æœé€ æˆçš„<strong>æœ€å¤§æ”¹å˜</strong>ã€‚å·®åˆ†éšç§ä¸­å®šä¹‰äº†ä¸¤ç§æ•æ„Ÿåº¦ï¼Œå³<strong>å…¨å±€æ•æ„Ÿåº¦</strong>å’Œ<strong>å±€éƒ¨æ•æ„Ÿåº¦</strong>ã€‚</p><p><img src="https://img.imgdb.cn/item/600159893ffa7d37b349a7f5.jpg" alt=""></p><p>å‡½æ•°çš„å…¨å±€æ•æ„Ÿåº¦ç”±å‡½æ•°æœ¬èº«å†³å®šï¼Œä¸åŒçš„å‡½æ•°ä¼šæœ‰ä¸åŒçš„å…¨å±€æ•æ„Ÿåº¦ã€‚ä¸€äº›å‡½æ•°çš„å…¨å±€æ•æ„Ÿåº¦è¾ƒå°ï¼Œå› æ­¤åªéœ€è¦åŠ å…¥å°‘é‡çš„å™ªå£°å³å¯æ©ç›–å› ä¸€ä¸ªè®°å½•è¢«åˆ é™¤å¯¹æŸ¥è¯¢ç»“æœæ‰€äº§ç”Ÿçš„çš„å½±å“ã€‚ä½†æŸäº›å‡½æ•°çš„å…¨å±€æ•æ„Ÿåº¦è¾ƒå¤§ï¼Œå¿…é¡»åœ¨å‡½æ•°è¾“å‡ºä¸­æ·»åŠ è¶³å¤Ÿå¤§çš„å™ªå£°æ‰èƒ½ä¿è¯éšç§å®‰å…¨ï¼Œå¯¼è‡´æ•°æ®å¯ç”¨æ€§è¾ƒå·®ã€‚å› æ­¤æå‡ºäº†<strong>å±€éƒ¨æ•æ„Ÿåº¦</strong>çš„æ¦‚å¿µã€‚</p><p><img src="https://img.imgdb.cn/item/60015bc43ffa7d37b34af6b4.jpg" alt=""></p><p><img src="https://img.imgdb.cn/item/60015bf33ffa7d37b34b0fa2.jpg" alt=""></p><p>ä½†æ˜¯ï¼Œå±€éƒ¨æ•æ„Ÿåº¦åœ¨ä¸€å®šç¨‹åº¦ä¸Šä½“ç°äº†æ•°æ®é›†çš„æ•°æ®åˆ†å¸ƒç‰¹å¾ï¼Œå¦‚æœç›´æ¥åº”ç”¨å±€éƒ¨æ•æ„Ÿåº¦æ¥è®¡ç®—å™ªå£°é‡åˆ™ä¼šæ³„éœ²æ•°æ®é›†ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œå› æ­¤å±€éƒ¨æ•æ„Ÿåº¦çš„<strong>å¹³æ»‘ä¸Šç•Œ</strong>è¢«ç”¨æ¥ä¸å±€éƒ¨æ•æ„Ÿåº¦ä¸€èµ·ç¡®å®šå™ªå£°é‡çš„å¤§å°ã€‚</p><p><img src="https://img.imgdb.cn/item/6001614c3ffa7d37b34dc624.jpg" alt=""></p><p>æ‰€æœ‰æ»¡è¶³è¿™ä¸€å®šä¹‰çš„å‡½æ•°éƒ½å¯è¢«å®šä¹‰ä¸ºå¹³æ»‘ä¸Šç•Œï¼Œå°†å±€éƒ¨æ•æ„Ÿåº¦å¸¦å…¥åˆ°æ­¤å‡½æ•°ä¸­å¯å¾—åˆ°<strong>å¹³æ»‘æ•æ„Ÿåº¦</strong>ï¼Œè¿›è€Œç”¨äºè®¡ç®—å™ªå£°å¤§å°ã€‚</p><p><img src="https://img.imgdb.cn/item/600163743ffa7d37b34ed27d.jpg" alt=""></p><p>ç”±äºç»å¤§éƒ¨åˆ†å…³äºå·®åˆ†éšç§ä¿æŠ¤çš„ç ”ç©¶å‡é’ˆå¯¹è®¡æ•°æŸ¥è¯¢ã€æ±‚å’ŒæŸ¥è¯¢ç­‰æ•æ„Ÿåº¦è¾ƒå°çš„å‡½æ•°ï¼Œå› æ­¤ï¼Œè‹¥æ— ç‰¹æ®Šè¯´æ˜ï¼Œæœ¬æ–‡ä¸­æ•æ„Ÿåº¦å‡æŒ‡å…¨å±€æ•æ„Ÿåº¦ã€‚</p><h2 id="å·®åˆ†éšç§çš„ç»„åˆæ€§è´¨"><a href="#å·®åˆ†éšç§çš„ç»„åˆæ€§è´¨" class="headerlink" title="å·®åˆ†éšç§çš„ç»„åˆæ€§è´¨"></a>å·®åˆ†éšç§çš„ç»„åˆæ€§è´¨</h2><p>ä¸€ä¸ªå¤æ‚çš„éšç§ä¿æŠ¤é—®é¢˜é€šå¸¸éœ€è¦å¤šæ¬¡åº”ç”¨å·®åˆ†éšç§æ‰èƒ½è§£å†³ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯æ•´ä¸ªè¿‡ç¨‹çš„éšç§ä¿æŠ¤æ°´å¹³æ§åˆ¶åœ¨ç»™å®šçš„é¢„ç®—$\epsilon$ä¹‹å†…ï¼Œéœ€è¦åˆç†åœ°å°†å…¨éƒ¨é¢„ç®—åˆ†é…åˆ°æ•´ä¸ªç®—æ³•çš„å„ä¸ªæ­¥éª¤ä¸­ã€‚è¿™æ—¶å¯ä»¥åˆ©ç”¨éšç§ä¿æŠ¤ç®—æ³•çš„ä¸¤ä¸ªç»„åˆæ€§è´¨ï¼š</p><p><img src="https://img.imgdb.cn/item/60023e303ffa7d37b3ac3e30.jpg" alt=""></p><p><img src="https://img.imgdb.cn/item/60023e8b3ffa7d37b3ac582b.jpg" style="zoom: 67%;" /></p><h2 id="å®ç°æœºåˆ¶"><a href="#å®ç°æœºåˆ¶" class="headerlink" title="å®ç°æœºåˆ¶"></a>å®ç°æœºåˆ¶</h2><p>ä¸ºäº†ä½¿ä¸€ä¸ªç®—æ³•æ»¡è¶³å·®åˆ†éšç§ä¿æŠ¤çš„è¦æ±‚ï¼Œå¯¹ä¸åŒçš„é—®é¢˜æœ‰ä¸åŒçš„å®ç°æ–¹æ³•ï¼Œè¿™äº›å®ç°æ–¹æ³•ç§°ä¸ºâ€œæœºåˆ¶â€ã€‚<strong>æ‹‰æ™®æ‹‰æ–¯æœºåˆ¶</strong>å’Œ<strong>æŒ‡æ•°æœºåˆ¶</strong>æ˜¯ä¸¤ç§æœ€åŸºç¡€çš„å·®åˆ†éšç§ä¿æŠ¤æœºåˆ¶ã€‚å…¶ä¸­ï¼Œ<strong>æ‹‰æ™®æ‹‰æ–¯æœºåˆ¶é€‚ç”¨äºå¯¹æ•°å€¼å‹ç»“æœçš„ä¿æŠ¤ï¼ŒæŒ‡æ•°æœºåˆ¶é€‚ç”¨äºéæ•°å€¼å‹ç»“æœã€‚</strong></p><h3 id="Laplaceæœºåˆ¶"><a href="#Laplaceæœºåˆ¶" class="headerlink" title="Laplaceæœºåˆ¶"></a>Laplaceæœºåˆ¶</h3><p>Laplaceæœºåˆ¶é€šè¿‡å‘ç¡®åˆ‡çš„æŸ¥è¯¢ç»“æœä¸­åŠ å…¥æœä»Laplaceåˆ†å¸ƒçš„éšæœºå™ªå£°æ¥å®ç°$\epsilon$-å·®åˆ†éšç§ä¿æŠ¤ã€‚è®°ä½ç½®å‚æ•°ä¸º0ã€å°ºåº¦å‚æ•°ä¸ºbçš„Laplaceåˆ†å¸ƒä¸º<strong>Lap(b)</strong>ï¼Œé‚£ä¹ˆå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º</p><p><img src="https://img.imgdb.cn/item/600240b93ffa7d37b3acfe3f.jpg" alt=""></p><p><img src="https://img.imgdb.cn/item/600241823ffa7d37b3ad3c91.jpg" style="zoom:67%;" /></p><p>å™ªå£°ï¼ˆå°ºåº¦ï¼‰å‚æ•°bå–å†³äºå½“æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸ªäººçš„æ•°æ®æ—¶ï¼ŒæŸ¥è¯¢ç»“æœ<strong>æ€»ä¼š</strong>æ”¹å˜å¤šå°‘ã€‚ä¸€ç»„æŸ¥è¯¢æ€»å…±çš„â€œæœ€å¤§æ”¹å˜â€è¢«ç§°ä¸ºä»–ä»¬çš„<strong>æ•æ„Ÿåº¦</strong>ï¼Œå–b=æ•æ„Ÿåº¦/$\epsilon$å³èƒ½æ»¡è¶³$\epsilon$-å·®åˆ†éšç§ã€‚</p><h3 id="æŒ‡æ•°æœºåˆ¶"><a href="#æŒ‡æ•°æœºåˆ¶" class="headerlink" title="æŒ‡æ•°æœºåˆ¶"></a>æŒ‡æ•°æœºåˆ¶</h3><p>æŒ‡æ•°æœºåˆ¶é€‚ç”¨äºéæ•°å€¼å‹çš„æ•°æ®ï¼Œè®¾æŸ¥è¯¢å‡½æ•°çš„è¾“å‡ºåŸŸä¸º$Range$,åŸŸä¸­çš„æ¯ä¸ªå€¼$r\in Range$ä¸ºä¸€ä¸ªå®ä½“å¯¹è±¡ï¼Œåœ¨æŒ‡æ•°æœºåˆ¶ä¸‹ï¼Œå‡½æ•°$q(D,r)\rightarrow R$ç§°ä¸ºè¾“å‡ºå€¼$r$çš„å¯ç”¨æ€§å‡½æ•°ï¼Œç”¨æ¥è¯„ä¼°è¾“å‡ºå€¼$r$çš„ä¼˜åŠ£ç¨‹åº¦ã€‚</p><p><img src="https://img.imgdb.cn/item/600245b43ffa7d37b3aeb3db.jpg" style="zoom:67%;" /></p>]]></content>
      
      
      <categories>
          
          <category> å·®åˆ†éšç§ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·®åˆ†éšç§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·®åˆ†éšç§åº”ç”¨ä¸å±•æœ›</title>
      <link href="/posts/40615.html"/>
      <url>/posts/40615.html</url>
      
        <content type="html"><![CDATA[<p>å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ»¡è¶³å·®åˆ†éšç§çš„ç®—æ³•ï¼Ÿ</p><blockquote><p>ä¸€èˆ¬åšæ³•ï¼šä»ä¸€ä¸ªä¸æ»¡è¶³å·®åˆ†éšç§çš„ç®—æ³•å‡ºå‘ï¼Œå¾€ç®—æ³•é‡Œé€‚å½“åœ°åŠ å…¥ä¸€å®šå™ªéŸ³ï¼Œä»¥ä½¿å…¶è¾“å‡ºæ»¡è¶³å·®åˆ†éšç§çš„è¦æ±‚ã€‚    </p></blockquote><span id="more"></span><h2 id="æ‹‰æ™®æ‹‰æ–¯æœºåˆ¶"><a href="#æ‹‰æ™®æ‹‰æ–¯æœºåˆ¶" class="headerlink" title="æ‹‰æ™®æ‹‰æ–¯æœºåˆ¶"></a>æ‹‰æ™®æ‹‰æ–¯æœºåˆ¶</h2><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç—…æ‚£æ•°æ®é›†Dï¼Œè€ƒè™‘ä»¥ä¸‹æ•°æ®åº“æŸ¥è¯¢ï¼š<img src="https://img.imgdb.cn/item/6000fe873ffa7d37b316de43.png" alt=""></p><p>å¦‚æœæˆ‘ä»¬è¦å‘å¸ƒè¿™ä¸ªæŸ¥è¯¢ç»“æœï¼Œå¦‚ä½•æ‰èƒ½æ»¡è¶³$\epsilon$-å·®åˆ†éšç§ï¼Ÿ</p><p>æˆ‘ä»¬é¦–å…ˆè€ƒè™‘è¿™ä¸ªæŸ¥è¯¢ç»“æœæœ‰å¤šä¾èµ–äºæŸä¸ªç‰¹å®šç—…äººçš„ä¿¡æ¯ï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹Dä¸­ä»»æ„ä¸€ä¸ªç—…æ‚£çš„æ•°æ®ï¼Œä¸Šè¿°æŸ¥è¯¢ç»“æœæœ€å¤šä¼šæ”¹å˜1ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½ç”¨å™ªå£°æ¥â€œæ©ç›–â€è¿™ç§ä¸å¤§äº1çš„æ”¹å˜ï¼Œå°±èƒ½æ»¡è¶³å·®åˆ†éšç§ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å¾€æŸ¥è¯¢ç»“æœä¸­åŠ å…¥ä¸€ä¸ªæœä»æ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒçš„å™ªå£°ã€‚<img src="https://img.imgdb.cn/item/6001001a3ffa7d37b31775db.jpg" alt=""></p><p>å‚æ•°$\lambda$è®¾ä¸º$\frac{1}{\epsilon}$ï¼Œå³èƒ½æ»¡è¶³$\epsilon$-å·®åˆ†éšç§ã€‚</p><p>å¦‚æœè¦å‘å¸ƒçš„ç»“æœæ˜¯ä¸‹é¢è¿™ä¸ªæŸ¥è¯¢ç»“æœå‘¢ï¼Ÿ<img src="https://img.imgdb.cn/item/600101213ffa7d37b317f01b.jpg" alt=""></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸ªç—…æ‚£çš„æ•°æ®ï¼Œåˆ™ä¸Šè¿°æŸ¥è¯¢ç»“æœæœ€å¤šæ”¹å˜3ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶åŠ å…¥æ‹‰æ™®æ‹‰æ–¯å™ªå£°ï¼Œå¹¶æŠŠå‚æ•°</p><p>$\lambda$è®¾ä¸º$\frac{3}{\epsilon}$ï¼Œ<img src="https://img.imgdb.cn/item/6001001a3ffa7d37b31775db.jpg" alt=""></p><blockquote><p>ä¸€èˆ¬è€Œè¨€ï¼Œå¦‚æœæˆ‘ä»¬è¦å‘å¸ƒä¸€ç»„æ•°å€¼å‹æŸ¥è¯¢ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯ä¸ªç»“æœåŠ å…¥ç‹¬ç«‹çš„æ‹‰æ™®æ‹‰æ–¯å™ªå£°æ¥æ»¡è¶³å·®åˆ†éšç§ã€‚</p><p>å™ªå£°å‚æ•°$\lambda$å–å†³äºå½“æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸ªäººçš„æ•°æ®æ—¶ï¼ŒæŸ¥è¯¢ç»“æœ<strong>æ€»ä¼š</strong>æ”¹å˜å¤šå°‘ã€‚ä¸€ç»„æŸ¥è¯¢æ€»å…±çš„â€œæœ€å¤§æ”¹å˜â€è¢«ç§°ä¸ºä»–ä»¬çš„<strong>æ•æ„Ÿåº¦</strong>ï¼Œå–$\lambda$=æ•æ„Ÿåº¦/$\epsilon$å³èƒ½æ»¡è¶³$\epsilon$-å·®åˆ†éšç§ã€‚</p></blockquote><h2 id="éšæœºåŒ–å›ç­”"><a href="#éšæœºåŒ–å›ç­”" class="headerlink" title="éšæœºåŒ–å›ç­”"></a>éšæœºåŒ–å›ç­”</h2><p>å¦‚æœæˆ‘ä»¬è¦å‘å¸ƒçš„æ•°æ®ä¸æ˜¯æ•°å€¼å‹çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å…¶ä»–æ–¹æ³•å¼•å…¥å™ªå£°ï¼Œä¸‹é¢ä»‹ç»ä¸€ç§æ•°æ®é‡‡é›†çš„ç®€å•æœºåˆ¶ï¼šéšæœºåŒ–å›ç­”ã€‚</p><p>å‡è®¾æˆ‘å‘ä¸€ç»„äººæé—®ä¸€ä¸ªæ•æ„Ÿçš„æ˜¯éé¢˜ï¼Œå‡ºäºéšç§ï¼Œæœ‰çš„äººå¯èƒ½ä¸æ„¿æ„ç»™çœŸå®ç­”æ¡ˆï¼Œè§£å†³æ–¹æ¡ˆæ˜¯è®©æ¯ä¸ªäººåœ¨ä»–çš„ç­”æ¡ˆä¸­åŠ å…¥å™ªå£°ã€‚<img src="https://img.imgdb.cn/item/600104713ffa7d37b319597d.jpg" alt=""></p><p><img src="https://img.imgdb.cn/item/600104903ffa7d37b3196a6c.jpg" alt=""></p><p>éšæœºåŒ–å›ç­”å¯ä»¥æ»¡è¶³$\epsilon$-å·®åˆ†éšç§ï¼Œç›´è§‚åŸå› æ˜¯ï¼šç”±äºå…¶éšæœºæ€§ï¼Œæ”»å‡»è€…ä¸èƒ½ä¸­éšæœºåŒ–çš„è¾“å‡ºåæ¨å‡ºè¾“å…¥åˆ°åº•æ˜¯â€œyesâ€è¿˜æ˜¯â€œnoâ€,åªè¦æ ¹æ®$\epsilon$æ¥è°ƒæ•´éšæœºåŒ–çš„æ¦‚ç‡å³å¯ã€‚ä½†æ˜¯æˆ‘ä»¬ä¾ç„¶å¯ä»¥é€šè¿‡éšæœºåŒ–å›ç­”çš„è¾“å‡ºæ¥å›ç­”å¦‚ä¸‹é—®é¢˜ï¼š</p><p>å¤§æ¦‚æœ‰å¤šå°‘äººçš„çœŸå®å›ç­”æ˜¯â€œyesâ€?</p><p>å‡è®¾æœ‰10000äººç”¨éšæœºåŒ–å›ç­”ç»™äº†æˆ‘å›å¤</p><ul><li>å½“ä¸­æœ‰5500ä¸ªyeså’Œ4500ä¸ªno</li></ul><p>æ¯ä¸ªäººä»¥80%æ¦‚ç‡ç»™æˆ‘å‡å›å¤</p><ul><li>æ‰€ä»¥å¤§è‡´ä¸­å…±æœ‰8000ä¸ªå‡å›å¤</li><li>å½“ä¸­å¤§è‡´ä¸Šæœ‰4000ä¸ªå‡yeså’Œ4000ä¸ªå‡no</li></ul><p>æ®æ­¤ï¼Œæˆ‘å¯ä»¥åˆ¤æ–­å‰©ä¸‹çš„çœŸå®å›ç­”é‡Œå¤§æ¦‚æœ‰1500ä¸ªyeså’Œ500ä¸ªno</p><ul><li>æ‰€ä»¥å¤§æ¦‚75%çš„äººçš„çœŸå®å›ç­”æ˜¯yes</li></ul><p><img src="https://img.imgdb.cn/item/600106bd3ffa7d37b31a7115.jpg" alt=""></p><p>æ€»ç»“ï¼š</p><ul><li>é€šè¿‡éšæœºä¿®æ”¹å›å¤æ¥æ»¡è¶³å·®åˆ†éšç§</li><li>ç”±äºä¿®æ”¹æ—¶å¼•å…¥çš„å™ªå£°åˆ†å¸ƒå·²çŸ¥ï¼Œå› æ­¤æˆ‘ä»¬æ‰”å¯ä»¥åæ¨å‡ºæºæ•°æ®çš„å¤§è‡´åˆ†å¸ƒ</li><li>ä½†æ— æ³•åæ¨å‡ºä¸ªä½“å›å¤</li></ul><h2 id="å·®åˆ†éšç§æ•°æ®åº“"><a href="#å·®åˆ†éšç§æ•°æ®åº“" class="headerlink" title="å·®åˆ†éšç§æ•°æ®åº“"></a>å·®åˆ†éšç§æ•°æ®åº“</h2><p><img src="https://img.imgdb.cn/item/600107b13ffa7d37b31ad2c3.jpg" alt=""></p><ul><li>åªå›ç­”èšåˆæŸ¥è¯¢çš„ç»“æœ</li><li>é€šè¿‡å¾€æŸ¥è¯¢ç»“æœä¸­åŠ å…¥å™ªå£°æ¥æ»¡è¶³å·®åˆ†éšç§</li><li>ä¾‹å­ï¼šå¾®è½¯çš„PINQ,Uberçš„Chorus</li></ul><p>æŠ€æœ¯éš¾ç‚¹ï¼š</p><ul><li>å¦‚ä½•ç”¨å°½é‡å°‘çš„å™ªå£°æ¥è¾¾åˆ°$\epsilon$-å·®åˆ†éšç§<ul><li>å°¤å…¶æ˜¯åœ¨æŸ¥è¯¢éœ€è¦è¿æ¥å¤šå¼ æ•°æ®åº“è¡¨çš„æ—¶å€™</li></ul></li><li>å¦‚ä½•é«˜æ•ˆåœ°è®¡ç®—æŸ¥è¯¢çš„æ•æ„Ÿåº¦</li><li>å¦‚ä½•å°†å·®åˆ†éšç§æ¨¡å—æ•´åˆåˆ°ç°æœ‰æ•°æ®åº“ä¸­</li></ul><p>å±•æœ›ï¼š</p><p>ç°æœ‰ç®—æ³•å°šæœªèƒ½åœ¨éšç§ä¿æŠ¤ã€æŸ¥è¯¢å‡†ç¡®æ€§åŠè®¡ç®—æ•ˆç‡ä¸‰è€…é—´å–å¾—å¾ˆå¥½çš„å¹³è¡¡ï¼Œä¾‹å¦‚ï¼šUberçš„Chrousåœ¨ä¸å°‘æŸ¥è¯¢ä¸­è¯¯å·®å¯è¾¾100%ä»¥ä¸Š</p><h2 id="å·®åˆ†éšç§æœºå™¨å­¦ä¹ "><a href="#å·®åˆ†éšç§æœºå™¨å­¦ä¹ " class="headerlink" title="å·®åˆ†éšç§æœºå™¨å­¦ä¹ "></a>å·®åˆ†éšç§æœºå™¨å­¦ä¹ </h2><p><img src="https://img.imgdb.cn/item/600108bc3ffa7d37b31b519f.jpg" alt=""></p><ul><li><p>åœ¨æœºå™¨å­¦ä¹ ç®—æ³•ä¸­å¼•å…¥å™ªå£°ï¼Œä½¿å¾—ç®—æ³•ç”Ÿæˆçš„æ¨¡å‹èƒ½æ»¡è¶³å·®åˆ†éšç§</p></li><li><p>ä¾‹å­ï¼šè°·æ­Œçš„TensorFlow Privacy</p><p><a href="https://github.com/tensorflow/privacy">https://github.com/tensorflow/privacy</a></p><p>å¯ç”¨äºç¥ç»ç½‘ç»œè®­ç»ƒ</p></li></ul><h3 id="TensorFlow-Privacyçš„åŸºæœ¬åŸç†"><a href="#TensorFlow-Privacyçš„åŸºæœ¬åŸç†" class="headerlink" title="TensorFlow Privacyçš„åŸºæœ¬åŸç†"></a>TensorFlow Privacyçš„åŸºæœ¬åŸç†</h3><p>ç¥ç»ç½‘ç»œé€šå¸¸æ˜¯ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ¥è¿›è¡Œè®­ç»ƒçš„ï¼š</p><ol><li>ä»ä¸€ç»„éšæœºçš„ç¥ç»ç½‘ç»œæƒé‡å‚æ•°å‡ºå‘</li><li>æ‹¿ä¸€ç»„éšæœºé€‰å–çš„å…ƒç»„æ¥è®¡ç®—æƒé‡çš„æ¢¯åº¦</li><li>ç”¨æ¢¯åº¦æ¥æ›´æ–°æƒé‡å‚æ•°</li><li>é‡å¤æ­¥éª¤2-3</li></ol><p>TensorFlow Privacyå¯¹æ­¥éª¤2ä¸­çš„æ¢¯åº¦åŠ å…¥å™ªå£°ï¼Œä»¥ä¿è¯è®­ç»ƒè¿‡ç¨‹æ»¡è¶³å·®åˆ†éšç§ã€‚</p><p>å…³äºå·®åˆ†éšç§æœºå™¨å­¦ä¹ ï¼Œç°æœ‰ç®—æ³•çš„ä¸è¶³ï¼š</p><ul><li>å‡†ç¡®æ€§è¿˜æœ‰å¾… æé«˜</li><li>å°šä¸èƒ½å¾ˆå¥½åœ°å¤„ç†å¤æ‚æ¨¡å‹ï¼Œå¦‚GAN</li></ul><p>å¦æœ‰ä¸€äº›æ–°æ–¹å‘ï¼Œå¦‚ï¼š</p><ul><li>è”é‚¦å­¦ä¹ </li><li>ä¸å®‰å…¨å¤šæ–¹è®¡ç®—çš„ç»“åˆ</li></ul><h2 id="å·®åˆ†éšç§æ•°æ®é‡‡é›†"><a href="#å·®åˆ†éšç§æ•°æ®é‡‡é›†" class="headerlink" title="å·®åˆ†éšç§æ•°æ®é‡‡é›†"></a>å·®åˆ†éšç§æ•°æ®é‡‡é›†</h2><p><img src="https://img.imgdb.cn/item/60010a903ffa7d37b31c58e3.jpg" alt=""></p><p>åœºæ™¯ï¼šä»ç§»åŠ¨è®¾å¤‡ä¸­é‡‡é›†ç”¨æˆ·æ•°æ®ï¼Œå…¥åº”ç”¨ç¨‹åºçš„ä½¿ç”¨æ—¶é•¿ç­‰</p><p>ä¸ºæ»¡è¶³å·®åˆ†éšç§ï¼Œè®©ç”¨æˆ·é‡‡ç”¨ç±»ä¼¼äºéšæœºåŒ–å›ç­” çš„æ–¹æ³•æ¥æä¾›æ•°æ®</p><p>ä¾‹å­ï¼šè°·æ­ŒChromeã€è‹¹æœiPhoneã€iPadå’ŒMacã€å¾®è½¯Windows10</p><p>æŠ€æœ¯éš¾ç‚¹ï¼šéœ€è¦é‡‡é›†çš„æ•°æ®å¯èƒ½æ¯”è¾ƒå¤æ‚ï¼Œæ— æ³•ç”¨ä¼ ç»ŸéšæœºåŒ–å›ç­”é—®é¢˜</p><ul><li>ä¾‹å­ï¼šç”¨æˆ·è¾“å…¥çš„æ–°è¯ï¼ˆå­—å…¸é‡Œé¢æ²¡æœ‰çš„ï¼‰</li></ul><p>ä¸ºæ­¤ï¼Œè°·æ­Œï¼Œè‹¹æœå’Œå¾®è½¯éƒ½å› å…¶é‡‡é›†éœ€è¦æå‡ºäº†æ–°çš„éšæœºåŒ–ç®—æ³•</p><p>ç°æœ‰ä¸è¶³ï¼š</p><ul><li>ç°æœ‰ç®—æ³•è¦æ±‚æ¯ä¸ªç”¨æˆ·å¯¹å…¶æ•°æ®åŠ å…¥ç›¸å½“ç¨‹åº¦çš„å™ªå£°</li><li>è¿™å¯¹åæœŸä¼°è®¡ç»Ÿè®¡æ•°æ®å¸¦æ¥äº†ä¸€äº›å›°éš¾</li></ul><p>è¿‘å¹´æ¥å¤§å®¶å¼€å§‹æ¢ç´¢çš„æ–°æ–¹å‘ï¼š</p><ul><li>ä¸å®‰å…¨è®¡ç®—ç›¸ç»“åˆï¼Œä»¥å‡å°‘æ»¡è¶³å·®åˆ†éšç§æ‰€éœ€çš„å™ªå£°</li></ul><h2 id="å·®åˆ†éšç§æ•°æ®åˆæˆ"><a href="#å·®åˆ†éšç§æ•°æ®åˆæˆ" class="headerlink" title="å·®åˆ†éšç§æ•°æ®åˆæˆ"></a>å·®åˆ†éšç§æ•°æ®åˆæˆ</h2><p><img src="https://img.imgdb.cn/item/6001175e3ffa7d37b324e1e1.jpg" alt=""></p><p>åŸºæœ¬åŸç†ï¼š</p><ul><li>å…ˆå¯¹æºæ•°æ®è¿›è¡Œå»ºæ¨¡ï¼Œå¾—åˆ°ä¸€ä¸ªç»Ÿè®¡æ¨¡å‹</li><li>ç”¨ç»Ÿè®¡æ¨¡å‹æ¥åˆæˆå‡ºè™šæ‹Ÿäº§å“</li></ul><p>ä¾‹å­ï¼šç¾å›½æ™®æŸ¥å±€çš„ä¸€äº›æ•°æ®äº§å“ï¼Œå¦‚<a href="https://onthemap.ces.census.gov/">https://onthemap.ces.census.gov/</a></p><p>æŠ€æœ¯éš¾ç‚¹ï¼š</p><ul><li>å¦‚ä½•æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ç»Ÿè®¡æ¨¡å‹ï¼Ÿ</li><li>å¦‚ä½•åœ¨ç»Ÿè®¡æ¨¡å‹ä¸­åŠ å…¥å™ªå£°ï¼Œä»¥æ»¡è¶³å·®åˆ†éšç§ï¼Ÿ</li></ul><p>ç°æœ‰ä¸è¶³ï¼š</p><ul><li>ç›®å‰çš„ç®—æ³•åªèƒ½å¤„ç†å…³ç³»å‹æ•°æ®</li><li>å¯¹éå…³ç³»å‹æ•°æ®çš„åˆæˆåŸºæœ¬ä¸Šè¿˜åœ¨æ‘¸ç´¢é˜¶æ®µï¼Œå¦‚å›¾æ•°æ®ã€æ–‡æœ¬æ•°æ®ç­‰</li></ul><h2 id="å±•æœ›ï¼šå¼¥è¡¥å·®åˆ†éšç§æœ¬èº«çš„ä¸è¶³"><a href="#å±•æœ›ï¼šå¼¥è¡¥å·®åˆ†éšç§æœ¬èº«çš„ä¸è¶³" class="headerlink" title="å±•æœ›ï¼šå¼¥è¡¥å·®åˆ†éšç§æœ¬èº«çš„ä¸è¶³"></a>å±•æœ›ï¼šå¼¥è¡¥å·®åˆ†éšç§æœ¬èº«çš„ä¸è¶³</h2><ul><li>å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ›´åŠ è´´è¿‘å®é™…çš„éšç§æ¨¡å‹</li><li>ç°æœ‰æ–‡çŒ®ä¸­å·²æœ‰ä¸å°‘æ”¹è¿›å·®åˆ†éšç§çš„å°è¯•ï¼Œä½†å°šæœªå¾—åˆ°å¹¿æ³›åº”ç”¨ï¼ŒåŸå› ï¼šæ”¹è¿›åçš„æ¨¡å‹å¾€å¾€è¿‡äºå¤æ‚ï¼Œéš¾ä»¥è¢«å¤§ä¼—æ‰€è®¤åŒ</li><li>å·®åˆ†éšç§è™½ç„¶æœ‰ç€ä¼˜é›…çš„æ•°å­¦è¡¨è¾¾ï¼Œä½†å¹¶ä¸ç›´æ¥å¯¹åº”ä»»ä½•æ³•å¾‹æ¡æ–‡<ul><li>æ»¡è¶³å·®åˆ†éšç§ä¸ç­‰äºæ»¡è¶³éšç§ä¿æŠ¤æ³•å¾‹</li></ul></li><li>è¦è§£å†³è¿™ä¸€é—®é¢˜ï¼Œéœ€è¦è®¡ç®—æœºç•Œä¸æ³•å¾‹ç•Œç›¸äº’åˆä½œ</li><li>è¿‘æ¥å·²æœ‰å­¦è€…å°è¯•ä¸­æ³•å¾‹æ¡æ–‡å‡ºå‘æ¥è®¾è®¡éšç§ä¿æŠ¤æ¨¡å‹ï¼Œå¹¶å€Ÿé‰´å·®åˆ†éšç§çš„æ€æƒ³</li></ul>]]></content>
      
      
      <categories>
          
          <category> å·®åˆ†éšç§ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·®åˆ†éšç§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•è¿ç§»Hexoåšå®¢åˆ°æ–°ç”µè„‘</title>
      <link href="/posts/35875.html"/>
      <url>/posts/35875.html</url>
      
        <content type="html"><![CDATA[<p>æ¢äº†å°ç¬”è®°æœ¬ï¼Œæ‡’å¾—è¿ç§»åšå®¢ï¼Œæ‹–äº†å¥½ä¹…è¿˜æ˜¯åšäº†ä¸€ä¸‹è¿ç§»ï¼Œè®°å½•ä¸€ä¸‹è¿‡ç¨‹ï¼Œæ–¹ä¾¿ä»¥åæŸ¥çœ‹ã€‚<br><span id="more"></span></p><h1 id="å¿…å¤‡æ¡ä»¶"><a href="#å¿…å¤‡æ¡ä»¶" class="headerlink" title="å¿…å¤‡æ¡ä»¶"></a>å¿…å¤‡æ¡ä»¶</h1><p>å®‰è£…<code>git</code>,<code>node.js</code></p><h1 id="é€‰æ‹©æ–‡ä»¶"><a href="#é€‰æ‹©æ–‡ä»¶" class="headerlink" title="é€‰æ‹©æ–‡ä»¶"></a>é€‰æ‹©æ–‡ä»¶</h1><p>ä»ä¹‹å‰çš„åšå®¢æ–‡ä»¶å¤¹ä¸­é€‰æ‹©å¿…é¡»è¦æ‹·è´çš„æ–‡ä»¶ï¼Œå¤‡ä»½èµ·æ¥ã€‚é¦–å…ˆæ˜¯ä¹‹å‰è‡ªå·±ä¿®æ”¹çš„æ–‡ä»¶ï¼Œåƒé…ç½®æ–‡ä»¶<code>_config.yml,theme</code>æ–‡ä»¶å¤¹ï¼Œ<code>source</code>æ–‡ä»¶å¤¹è‡ªå·±å†™çš„åŸå§‹æ–‡ä»¶è¿™äº›éƒ½æ˜¯å¿…é¡»è¦æ‹·è´èµ°çš„ã€‚é™¤æ­¤ä¹‹å¤–è¿˜æœ‰<code>scaffolds</code>æ–‡ä»¶å¤¹(æ–‡ä»¶çš„æ¨¡æ¿)ï¼Œ<code>package.json</code>(ä½¿ç”¨å“ªäº›åŒ…)ï¼Œ<code>.gitignore</code>(æäº¤å¿½ç•¥å“ªäº›æ–‡ä»¶å¤¹)<br>æ€»ç»“ï¼š     </p><ul><li>_config.yml</li><li>themes</li><li>source</li><li>scaffolds</li><li>package.json</li><li>.gitignore<br>æ˜¯éœ€è¦å¤‡ä»½çš„ï¼Œå…¶ä»–æ–‡ä»¶ä¸éœ€è¦ç®¡ã€‚<h1 id="å¼€å§‹è¿ç§»"><a href="#å¼€å§‹è¿ç§»" class="headerlink" title="å¼€å§‹è¿ç§»"></a>å¼€å§‹è¿ç§»</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// å…¨å±€å®‰è£…hexo</span><br><span class="line">npm install hexo-cli -g</span><br><span class="line"></span><br><span class="line">// æŠŠå¿…é¡»æ‹·è´çš„æ–‡ä»¶ï¼Œæ‹·è´åˆ°æ–°å»ºçš„æ–‡ä»¶å¤¹å†…ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</span><br><span class="line">// åœ¨æ–°å»ºçš„æ–‡ä»¶å¤¹å†…æ‰“å¼€å‘½ä»¤è¡Œï¼Œå®‰è£…å¿…è¦çš„æ¨¡å—ï¼Œåˆå§‹åŒ–</span><br><span class="line">// è¿™é‡Œä¸ç”¨hexo initåˆå§‹åŒ–ï¼Œå› ä¸ºé…ç½®æ–‡ä»¶æˆ‘ä»¬å·²ç»æ‹·è´è¿‡æ¥</span><br><span class="line"></span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line">// å®‰è£…å…¶ä»–ä¸€äº›å¿…è¦çš„ç»„ä»¶</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"></span><br><span class="line">npm install hexo-generator-feed --save</span><br><span class="line"></span><br><span class="line">npm install hexo-generator-sitemap --save</span><br></pre></td></tr></table></figure><h1 id="æœ¬åœ°æµ‹è¯•"><a href="#æœ¬åœ°æµ‹è¯•" class="headerlink" title="æœ¬åœ°æµ‹è¯•"></a>æœ¬åœ°æµ‹è¯•</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//å…ˆæœ¬åœ°é¢„è§ˆ</span><br><span class="line">hexo clean</span><br><span class="line"></span><br><span class="line">hexo g</span><br><span class="line"></span><br><span class="line">hexo s</span><br><span class="line"></span><br><span class="line">//æ­¤æ—¶å¯ä»¥å…ˆåœ¨localhost:4000 æœ¬åœ°é¢„è§ˆåšå®¢ï¼Œå¦‚æœä¸æŠ¥é”™ï¼Œé‚£å°±è¯´æ˜è¿ç§»æˆåŠŸ</span><br></pre></td></tr></table></figure><h1 id="éƒ¨ç½²åˆ°Github"><a href="#éƒ¨ç½²åˆ°Github" class="headerlink" title="éƒ¨ç½²åˆ°Github"></a>éƒ¨ç½²åˆ°Github</h1><h2 id="ç”ŸæˆSSHæ·»åŠ åˆ°GitHub"><a href="#ç”ŸæˆSSHæ·»åŠ åˆ°GitHub" class="headerlink" title="ç”ŸæˆSSHæ·»åŠ åˆ°GitHub"></a>ç”ŸæˆSSHæ·»åŠ åˆ°GitHub</h2>åœ¨ä½ çš„åšå®¢æ–‡ä»¶å¤¹ä¸­æ‰“å¼€git bash,å¤åˆ¶ä¸€ä¸‹ä»£ç <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;yourname&quot;</span><br><span class="line">git config --global user.email &quot;youremail&quot;</span><br></pre></td></tr></table></figure>å†…å®¹æ¢æˆä½ è‡ªå·±çš„Githubç”¨æˆ·åå’Œé‚®ç®±ã€‚<br>æ‰§è¡Œä¸€ä¸‹ä¸¤æ¡æŒ‡ä»¤ï¼Œæ£€æŸ¥ä½ æœ‰æ²¡æœ‰è¾“å…¥æ­£ç¡®ã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config user.name</span><br><span class="line">git config user.email</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ›å»ºSSH,ä¸€è·¯å›è½¦<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;youremail&quot;</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªæ—¶å€™å®ƒä¼šå‘Šè¯‰ä½ å·²ç»ç”Ÿæˆäº†.sshçš„æ–‡ä»¶å¤¹ã€‚åœ¨ä½ çš„ç”µè„‘ä¸­æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ã€‚<br>sshï¼Œç®€å•æ¥è®²ï¼Œå°±æ˜¯ä¸€ä¸ªç§˜é’¥ï¼Œå…¶ä¸­ï¼Œ<code>id_rsa</code>æ˜¯ä½ è¿™å°ç”µè„‘çš„ç§äººç§˜é’¥ï¼Œä¸èƒ½ç»™åˆ«äººçœ‹çš„ï¼Œ<code>id_rsa.pub</code>æ˜¯å…¬å…±ç§˜é’¥ï¼Œå¯ä»¥éšä¾¿ç»™åˆ«äººçœ‹ã€‚æŠŠè¿™ä¸ªå…¬é’¥æ”¾åœ¨GitHubä¸Šï¼Œè¿™æ ·å½“ä½ é“¾æ¥GitHubè‡ªå·±çš„è´¦æˆ·æ—¶ï¼Œå®ƒå°±ä¼šæ ¹æ®å…¬é’¥åŒ¹é…ä½ çš„ç§é’¥ï¼Œå½“èƒ½å¤Ÿç›¸äº’åŒ¹é…æ—¶ï¼Œæ‰èƒ½å¤Ÿé¡ºåˆ©çš„é€šè¿‡gitä¸Šä¼ ä½ çš„æ–‡ä»¶åˆ°GitHubä¸Šã€‚</p><p>è€Œååœ¨GitHubçš„settingä¸­ï¼Œæ‰¾åˆ°<code>SSH and GPC keys</code>çš„è®¾ç½®é€‰é¡¹ï¼Œç‚¹å‡»<code>New SSH key</code><br>æŠŠä½ çš„<code>id_rsa.pub</code>é‡Œé¢çš„ä¿¡æ¯å¤åˆ¶è¿›å»,titleéšä¾¿å¡«å†™ã€‚</p><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// æ­£å¼éƒ¨ç½²</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä¸­ DecimalFormat ç”¨æ³•è¯¦è§£</title>
      <link href="/posts/43254.html"/>
      <url>/posts/43254.html</url>
      
        <content type="html"><![CDATA[<h3 id="å¯¹Javaä¸­-DecimalFormat-çš„æ‰€æœ‰åŸºç¡€ç”¨æ³•è¿›è¡Œäº†ä¸€ä¸ªæ±‡æ€»ã€‚"><a href="#å¯¹Javaä¸­-DecimalFormat-çš„æ‰€æœ‰åŸºç¡€ç”¨æ³•è¿›è¡Œäº†ä¸€ä¸ªæ±‡æ€»ã€‚" class="headerlink" title="å¯¹Javaä¸­ DecimalFormat çš„æ‰€æœ‰åŸºç¡€ç”¨æ³•è¿›è¡Œäº†ä¸€ä¸ªæ±‡æ€»ã€‚"></a>å¯¹Javaä¸­ DecimalFormat çš„æ‰€æœ‰åŸºç¡€ç”¨æ³•è¿›è¡Œäº†ä¸€ä¸ªæ±‡æ€»ã€‚</h3><span id="more"></span><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.DecimalFormat;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestNumberFormat</span>&#123; </span><br><span class="line">ã€€ã€€<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[]args)</span>&#123;</span><br><span class="line">ã€€ã€€ã€€ã€€<span class="type">double</span> <span class="variable">pi</span> <span class="operator">=</span> <span class="number">3.1415927</span>;ã€€<span class="comment">//åœ†å‘¨ç‡</span></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//å–ä¸€ä½æ•´æ•°</span></span><br><span class="line">ã€€ã€€ã€€ã€€System.out.println(<span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;0&quot;</span>).format(pi));ã€€ã€€ã€€<span class="comment">//3</span></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//å–ä¸€ä½æ•´æ•°å’Œä¸¤ä½å°æ•°</span></span><br><span class="line">ã€€ã€€ã€€ã€€System.out.println(<span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;0.00&quot;</span>).format(pi));ã€€<span class="comment">//3.14</span></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//å–ä¸¤ä½æ•´æ•°å’Œä¸‰ä½å°æ•°ï¼Œæ•´æ•°ä¸è¶³éƒ¨åˆ†ä»¥0å¡«è¡¥ã€‚</span></span><br><span class="line">ã€€ã€€ã€€ã€€System.out.println(<span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;00.000&quot;</span>).format(pi));<span class="comment">// 03.142</span></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//å–æ‰€æœ‰æ•´æ•°éƒ¨åˆ†</span></span><br><span class="line">ã€€ã€€ã€€ã€€System.out.println(<span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;#&quot;</span>).format(pi));ã€€ã€€ã€€<span class="comment">//3</span></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//ä»¥ç™¾åˆ†æ¯”æ–¹å¼è®¡æ•°ï¼Œå¹¶å–ä¸¤ä½å°æ•°</span></span><br><span class="line">ã€€ã€€ã€€ã€€System.out.println(<span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;#.##%&quot;</span>).format(pi));ã€€<span class="comment">//314.16%</span></span><br><span class="line">ã€€ã€€ ã€€ <span class="type">long</span> <span class="variable">c</span> <span class="operator">=</span><span class="number">299792458</span>;ã€€ã€€<span class="comment">//å…‰é€Ÿ</span></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//æ˜¾ç¤ºä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œå¹¶å–äº”ä½å°æ•°</span></span><br><span class="line">ã€€ã€€ã€€ã€€System.out.println(<span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;#.#####E0&quot;</span>).format(c));ã€€<span class="comment">//2.99792E8</span></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//æ˜¾ç¤ºä¸ºä¸¤ä½æ•´æ•°çš„ç§‘å­¦è®¡æ•°æ³•ï¼Œå¹¶å–å››ä½å°æ•°</span></span><br><span class="line">ã€€ã€€ã€€ã€€System.out.println(<span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;00.####E0&quot;</span>).format(c));ã€€<span class="comment">//29.9792E7</span></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//æ¯ä¸‰ä½ä»¥é€—å·è¿›è¡Œåˆ†éš”ã€‚</span></span><br><span class="line">ã€€ã€€ã€€ã€€System.out.println(<span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;,###&quot;</span>).format(c));ã€€ã€€ã€€<span class="comment">//299,792,458</span></span><br><span class="line">ã€€ã€€ã€€ã€€<span class="comment">//å°†æ ¼å¼åµŒå…¥æ–‡æœ¬</span></span><br><span class="line">ã€€ã€€ã€€ã€€System.out.println(<span class="keyword">new</span> <span class="title class_">DecimalFormat</span>(<span class="string">&quot;å…‰é€Ÿå¤§å°ä¸ºæ¯ç§’,###ç±³ã€‚&quot;</span>).format(c));</span><br><span class="line">  </span><br><span class="line">ã€€ã€€&#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>DecimalFormat ç±»ä¸»è¦é  # å’Œ 0 ä¸¤ç§å ä½ç¬¦å·æ¥æŒ‡å®šæ•°å­—é•¿åº¦ã€‚0 è¡¨ç¤ºå¦‚æœä½æ•°ä¸è¶³åˆ™ä»¥ 0 å¡«å……ï¼Œ# è¡¨ç¤ºåªè¦æœ‰å¯èƒ½å°±æŠŠæ•°å­—æ‹‰ä¸Šè¿™ä¸ªä½ç½®ã€‚ä¸Šé¢çš„ä¾‹å­åŒ…å«äº†å·®ä¸å¤šæ‰€æœ‰çš„åŸºæœ¬ç”¨æ³•</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoåšå®¢çš„Nextä¸»é¢˜å®ç°æ•°å­¦å…¬å¼æ¸²æŸ“</title>
      <link href="/posts/54574.html"/>
      <url>/posts/54574.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨åšå¯†ç å­¦ç ”ç©¶æ—¶ï¼Œç»å¸¸ä¼šä½¿ç”¨æ•°å­¦å…¬å¼è¿›è¡Œä¸€ç³»åˆ—æ¨å¯¼è®¡ç®—ï¼Œè€Œhexoåšå®¢é»˜è®¤ä½¿ç”¨ hexo-renderer-marked å¼•æ“æ¸²æŸ“ç½‘é¡µï¼Œè¯¥å¼•æ“ä¼šæŠŠä¸€äº›ç‰¹æ®Šçš„ markdown ç¬¦å·è½¬æ¢ä¸ºç›¸åº”çš„ html æ ‡ç­¾ï¼Œæ¯”å¦‚åœ¨ markdown è¯­æ³•ä¸­ï¼Œä¸‹åˆ’çº¿<code>_</code>ä»£è¡¨æ–œä½“ï¼Œä¼šè¢«æ¸²æŸ“å¼•æ“å¤„ç†ä¸º<code>&lt;em&gt;</code>æ ‡ç­¾ã€‚<br><span id="more"></span><br>å› ä¸ºç±» Latex æ ¼å¼ä¹¦å†™çš„æ•°å­¦å…¬å¼ä¸‹åˆ’çº¿<code>_</code>è¡¨ç¤ºä¸‹æ ‡ï¼Œæœ‰ç‰¹æ®Šçš„å«ä¹‰ï¼Œå¦‚æœè¢«å¼ºåˆ¶è½¬æ¢ä¸º<code>&lt;em&gt;</code>æ ‡ç­¾ï¼Œé‚£ä¹ˆ MathJax å¼•æ“åœ¨æ¸²æŸ“æ•°å­¦å…¬å¼çš„æ—¶å€™å°±ä¼šå‡ºé”™ã€‚ç±»ä¼¼çš„è¯­ä¹‰å†²çªçš„ç¬¦å·è¿˜åŒ…æ‹¬<code>*</code>,<code>&#123;</code>, <code>&#125;</code>, <code>\\</code>ç­‰ã€‚</p><h3 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h3><p>æ›´æ¢ Hexo çš„ markdown æ¸²æŸ“å¼•æ“ï¼Œhexo-renderer-kramed å¼•æ“æ˜¯åœ¨é»˜è®¤çš„æ¸²æŸ“å¼•æ“ hexo-renderer-marked çš„åŸºç¡€ä¸Šä¿®æ”¹äº†ä¸€äº› bug ï¼Œä¸¤è€…æ¯”è¾ƒæ¥è¿‘ï¼Œä¹Ÿæ¯”è¾ƒè½»é‡çº§ã€‚å¦‚æœä½ æ˜¯Windowsç³»ç»Ÿï¼Œç›´æ¥ä½¿ç”¨Git Bashçš„å‘½ä»¤è¡Œåœ¨Hexoæ ¹ç›®å½•ä¸‹ä½¿ç”¨å‘½ä»¤ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line">npm install hexo-renderer-kramed --save</span><br></pre></td></tr></table></figure><br>ç„¶åï¼Œæ›´æ¢å¼•æ“åè¡Œé—´å…¬å¼å¯ä»¥æ­£ç¡®æ¸²æŸ“äº†ï¼Œä½†æ˜¯è¿™æ ·è¿˜æ²¡æœ‰å®Œå…¨è§£å†³é—®é¢˜ï¼Œè¡Œå†…å…¬å¼çš„æ¸²æŸ“è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œå› ä¸º hexo-renderer-kramed å¼•æ“ä¹Ÿæœ‰è¯­ä¹‰å†²çªçš„é—®é¢˜ã€‚æ¥ä¸‹æ¥åˆ°åšå®¢æ ¹ç›®å½•ä¸‹ï¼Œæ‰¾åˆ°node_modules\kramed\lib\rules\inline.jsï¼Œåšç›¸åº”çš„ä¿®æ”¹ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var inline = &#123;</span><br><span class="line">  // ç¬¬2è¡Œä¿®æ”¹</span><br><span class="line">  escape: /^\\([`*\[\]()#$+\-.!_&gt;])/,</span><br><span class="line">  ...</span><br><span class="line">  // ç¬¬20è¡Œä¿®æ”¹</span><br><span class="line">  em: /^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h3 id="åœ¨-Next-ä¸»é¢˜ä¸­å¼€å¯-MathJax-å¼€å…³"><a href="#åœ¨-Next-ä¸»é¢˜ä¸­å¼€å¯-MathJax-å¼€å…³" class="headerlink" title="åœ¨ Next ä¸»é¢˜ä¸­å¼€å¯ MathJax å¼€å…³"></a>åœ¨ Next ä¸»é¢˜ä¸­å¼€å¯ MathJax å¼€å…³</h3><p>æ‰¾åˆ°æ ¹ç›®å½•ä¸‹çš„/themes/next/_config.ymlæ–‡ä»¶ï¼ŒæŒ‰ä¸‹Ctrl+Fï¼Œåœ¨å¼¹å‡ºçš„æœç´¢æ¡†ä¸­è¾“å…¥mathjaxæŸ¥æ‰¾åŒ¹é…é¡¹ï¼Œç„¶åä½ æ‰¾åˆ°äº†è¿™æ ·å‡ è¡Œå­—,æŠŠ math é»˜è®¤çš„ false ä¿®æ”¹ä¸ºtrue<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Math Formulas Render Support</span><br><span class="line">math:</span><br><span class="line">  # Default (true) will load mathjax / katex script on demand.</span><br><span class="line">  # That is it only render those page which has `mathjax: true` in Front-matter.</span><br><span class="line">  # If you set it to false, it will load mathjax / katex srcipt EVERY PAGE.</span><br><span class="line">  per_page: true</span><br><span class="line"></span><br><span class="line">  # hexo-renderer-pandoc (or hexo-renderer-kramed) required for full MathJax support.</span><br><span class="line">  mathjax:</span><br><span class="line">    enable: true</span><br><span class="line">    # See: https://mhchem.github.io/MathJax-mhchem/</span><br><span class="line">    mhchem: true</span><br></pre></td></tr></table></figure><br>åœ¨éœ€è¦ä½¿ç”¨æ•°å­¦å…¬å¼çš„æ–‡ç« çš„Front-matteré‡Œæ‰“å¼€mathjaxå¼€å…³ï¼Œè€ƒè™‘åªæœ‰åœ¨ç”¨åˆ°å…¬å¼çš„é¡µé¢æ‰åŠ è½½ Mathjaxï¼Œè¿™æ ·ä¸éœ€è¦æ¸²æŸ“æ•°å­¦å…¬å¼çš„é¡µé¢çš„è®¿é—®é€Ÿåº¦å°±ä¸ä¼šå—åˆ°å½±å“äº†ã€‚å¦‚ä¸‹ï¼š<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Pythonå®ç°RSAç®—æ³•</span><br><span class="line">categories: å¯†ç å­¦</span><br><span class="line">tags: RSA</span><br><span class="line">abbrlink: 49034</span><br><span class="line">mathjax: true</span><br><span class="line">date: 2020-08-02 09:16:24</span><br><span class="line">---</span><br></pre></td></tr></table></figure><br>æœ€åä¸€é”®ä¸‰è¿<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure><br>å³å¯ç”Ÿæ•ˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pythonå®ç°RSAç®—æ³•</title>
      <link href="/posts/49034.html"/>
      <url>/posts/49034.html</url>
      
        <content type="html"><![CDATA[<p>1977å¹´ï¼Œä¸‰ä½æ•°å­¦å®¶ Rivestã€Shamir å’Œ Adleman è®¾è®¡äº†ä¸€ç§ç®—æ³•ï¼Œå¯ä»¥å®ç°éå¯¹ç§°åŠ å¯†ã€‚ç®—æ³•ç”¨ä»–ä»¬ä¸‰ä¸ªäººçš„åå­—å‘½åï¼Œå«åš RSA ç®—æ³•ã€‚ç›´åˆ°ç°åœ¨ï¼ŒRSA ç®—æ³•ä»æ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„â€éå¯¹ç§°åŠ å¯†ç®—æ³•â€ã€‚æ¯«ä¸å¤¸å¼ åœ°è¯´ï¼Œåªè¦æœ‰è®¡ç®—æœºç½‘ç»œçš„åœ°æ–¹ï¼Œå°±æœ‰ RSA ç®—æ³•ã€‚<br><span id="more"></span></p><h3 id="ç”Ÿæˆç§˜é’¥"><a href="#ç”Ÿæˆç§˜é’¥" class="headerlink" title="ç”Ÿæˆç§˜é’¥"></a>ç”Ÿæˆç§˜é’¥</h3><ul><li>é€‰å–å¤§ç´ æ•°$p,q$;è®¡ç®—$n=pq$ä»¥åŠnçš„æ¬§æ‹‰å‡½æ•°$Ï†(n) = Ï†(p) Ï†(q)=(p-1)(q-1)$ã€‚</li><li>é€‰æ‹©ä¸€ä¸ª$e(1&lt;e&lt;Ï† (n))$,ä½¿å¾—$e$å’Œ$Ï† (n)$äº’ç´ </li><li>è®¡ç®—$d$,ä½¿å¾—$edâ‰¡1(modÏ†(n))$ï¼Œç»§è€Œ$(n,e)$ä¸ºå…¬é’¥å‘é€åˆ°å…¬é’¥ç©ºé—´ï¼Œ$(n,d)$ä¸ºç§é’¥ï¼Œè‡ªå·±å¦¥å–„ä¿å­˜ã€‚  </li></ul><h3 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h3><p>å‡è®¾æ˜æ–‡ä¸º$m$ ,åˆ™å¯†æ–‡ä¸º$c$, åŠ å¯†å…¬å¼ä¸º$câ€‰=â€‰m^eâ€‰modâ€‰n$  </p><h3 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h3><p>é€šè¿‡å¯¹æ˜æ–‡$m$åŠ å¯†å¾—å¯†æ–‡ä¸º$c$,è§£å¯†å…¬å¼ä¸º$m=c^dâ€‰modâ€‰n$  </p><h3 id="pythonä»£ç å¦‚ä¸‹"><a href="#pythonä»£ç å¦‚ä¸‹" class="headerlink" title="pythonä»£ç å¦‚ä¸‹:"></a>pythonä»£ç å¦‚ä¸‹:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ex_gcd</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ‰©å±•æ¬§å‡ é‡Œå¾·ç®—æ³•&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        q = a // b</span><br><span class="line">        r = a % b</span><br><span class="line">        s, t = ex_gcd(b, r)</span><br><span class="line">        s, t = t, s-q*t</span><br><span class="line">    <span class="keyword">return</span> [s, t]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¿«é€Ÿå¹‚ç®—æ³•</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fast_expmod</span>(<span class="params">a,e,n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å¿«é€Ÿå¹‚&quot;&quot;&quot;</span></span><br><span class="line">    d = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> e != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span>(e &amp; <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">            d = (d * a) % n</span><br><span class="line">        e &gt;&gt;= <span class="number">1</span></span><br><span class="line">        a = a * a % n</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_key</span>(<span class="params">p, q, e</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç”Ÿæˆå…¬ç§é’¥</span></span><br><span class="line"><span class="string">    å‚æ•°1ï¼šå¤§ç´ æ•°p</span></span><br><span class="line"><span class="string">    å‚æ•°2ï¼šå¤§ç´ æ•°q</span></span><br><span class="line"><span class="string">    å‚æ•°3ï¼šéšæœºç”Ÿæˆeï¼Œæ»¡è¶³ gcd(e,fin)</span></span><br><span class="line"><span class="string">    è¿”å›å€¼ï¼š[å…¬é’¥,ç§é’¥]-------[[n,e],[n,d]]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    n = p * q</span><br><span class="line">    fin = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">    d = ex_gcd(e, fin)[<span class="number">0</span>]      <span class="comment"># è¾—è½¬ç›¸é™¤æ³•æ±‚é€†(å¹¿ä¹‰æ¬§å‡ é‡Œå¾—)</span></span><br><span class="line">    <span class="keyword">while</span> d &lt; <span class="number">0</span>:</span><br><span class="line">        d = (d+fin) % fin</span><br><span class="line">    <span class="keyword">return</span> [[n, e], [n, d]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encryption</span>(<span class="params">key, data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    åŠ å¯†</span></span><br><span class="line"><span class="string">    å‚æ•°1ï¼šåˆ—è¡¨[n,e]----å…¬é’¥</span></span><br><span class="line"><span class="string">    å‚æ•°2ï¼šå¾…ä»·å¯†æ•°æ®</span></span><br><span class="line"><span class="string">    è¿”å›å€¼ï¼šå¯†æ–‡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    n, e = key</span><br><span class="line">    plaintext = <span class="built_in">list</span>(data)</span><br><span class="line">    ciphertext = []</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> plaintext:</span><br><span class="line">        ciphertext.append(fast_expmod(<span class="built_in">ord</span>(item), e, n))</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">key, ciphertext</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è§£å¯†</span></span><br><span class="line"><span class="string">    å‚æ•°1ï¼škeyä¸ºç§é’¥</span></span><br><span class="line"><span class="string">    å‚æ•°2ï¼šå¯†æ–‡æ•°æ®</span></span><br><span class="line"><span class="string">    è¿”å›å€¼ï¼šæ˜æ–‡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    n, d = key</span><br><span class="line">    plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> ciphertext:</span><br><span class="line">        plaintext += (<span class="built_in">chr</span>(fast_expmod(item, d, n)))</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_p_q_e</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è¿”å›å€¼ï¼š[p,q,e]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    p = <span class="number">33478071698956898786044169848212690817704794983713768568912431388982883793878002287614711652531743087737814467999489</span></span><br><span class="line">    q = <span class="number">36746043666799590428244633799627952632279158164343087642676032283815739666511279233373417143396810270092798736308917</span></span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    <span class="keyword">return</span> [p, q, e]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    p, q, e = make_p_q_e()</span><br><span class="line">    <span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">    plaintext = <span class="built_in">input</span>(<span class="string">&quot;å¾…åŠ å¯†æ•°æ®ï¼š&quot;</span>)</span><br><span class="line">    <span class="comment"># å…¬é’¥ã€ç§é’¥</span></span><br><span class="line">    public_key, private_key = make_key(p, q, e)</span><br><span class="line">    <span class="comment"># åŠ å¯†</span></span><br><span class="line">    ciphertext = encryption(public_key, plaintext)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;åŠ å¯†åçš„æ•°æ®ï¼š&quot;</span>, ciphertext)</span><br><span class="line">    <span class="comment"># è§£å¯†</span></span><br><span class="line">    plaintext = decrypt(private_key, ciphertext)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è§£å¯†åçš„æ•°æ®ï¼š&quot;</span>, plaintext)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ºHexoçš„Nextä¸»é¢˜é¦–é¡µæ–‡ç« æ·»åŠ é˜´å½±</title>
      <link href="/posts/64817.html"/>
      <url>/posts/64817.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨nextä¸»é¢˜æ–‡ä»¶ä¸‹æ‰¾åˆ°\next\source\css_common\components\postçš„post.stylæ–‡ä»¶<br><span id="more"></span><br>åœ¨.post_blockä½ç½®,æ›´æ”¹å¦‚ä¸‹:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">if (hexo-config(&#x27;motion.transition.post_block&#x27;)) &#123;</span><br><span class="line">    .post-block &#123;</span><br><span class="line">     opacity: 0;</span><br><span class="line">     margin-top: 60px;</span><br><span class="line">     margin-bottom: 60px;</span><br><span class="line">     padding: 25px;</span><br><span class="line">     -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);</span><br><span class="line">     -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);</span><br><span class="line">    &#125;</span><br><span class="line">    .pagination, .comments &#123;</span><br><span class="line">      opacity: 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>æœ€åæ‰§è¡Œ<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure><br>å³å¯ç”Ÿæ•ˆ</p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
